<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>nginx è´Ÿè½½+ tomcat Connection reset by peer é—®é¢˜è§£å†³</title>
      <link href="2021/04/06/nginx-fu-zai-jie-jue-connection-reset-by-peer-wen-ti/"/>
      <url>2021/04/06/nginx-fu-zai-jie-jue-connection-reset-by-peer-wen-ti/</url>
      
        <content type="html"><![CDATA[<p>æœåŠ¡ç«¯Connection reset by peeré”™è¯¯é€šè¿‡nginxä»£ç†è§£å†³<br><a href="https://www.jianshu.com/p/c2ea5e9692e2">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="nginxå¢åŠ é…ç½®"><a href="#nginxå¢åŠ é…ç½®" class="headerlink" title="nginxå¢åŠ é…ç½®"></a>nginxå¢åŠ é…ç½®</h2><pre><code>proxy_buffers 16 1024k;proxy_buffer_size 1024k;</code></pre><h2 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h2><p>é”™è¯¯å‘ç”Ÿåœ¨ä¸€ä¸ªå†…ç½‘çš„excelå¯¼å‡ºæ—¶ï¼Œå› ä¸ºå†…å¤–ç½‘ä½¿ç”¨çš„æ˜¯ä¸åŒnginxï¼Œä¸€æ ·çš„æ•°æ®å’Œæ¥å£ï¼Œå¤–ç½‘æ­£å¸¸ï¼Œå†…ç½‘ä¸è¡Œï¼Œæ‰€ä»¥é—®é¢˜å¾ˆå¿«å®šä¹‰åˆ°å†…ç½‘çš„nginxé…ç½®ä¸Šäº†ã€‚</p><p>å…¶ä»–apiæ¥å£éƒ½æ­£å¸¸ï¼Œä½†æ˜¯åªæœ‰è¿™ä¸ªexcelå¯¼å‡ºæ•°æ®æµå°±æŠ¥é”™ï¼Œæ‰€ä»¥å·²ç»èƒ½çŒœæµ‹åˆ°å¯èƒ½æ˜¯nginxçš„é…ç½®é»˜è®¤è®¾å°äº†ã€‚</p><h2 id="é”™è¯¯"><a href="#é”™è¯¯" class="headerlink" title="é”™è¯¯"></a>é”™è¯¯</h2><p>è´´ä¸€ä¸‹é”™è¯¯ã€‚</p><pre><code>2020-11-03 15:35:20.082 ERROR com.hczt.haier.mobileoffice.remote.sms.SMSUtil Line:115 [e88f8d2b-e5b0-4a1d-8251-e6889d1fb86c] - ç»™ã€15898873290,ã€‘å‘é€çŸ­ä¿¡å¤±è´¥ã€‚2020-11-03 16:32:44.941 ERROR com.hczt.haier.mobileoffice.common.exception.GlobalExceptionHandler Line:48  [ef3ee6db-687b-4098-9af1-f7c3d45cd114] - å¼‚å¸¸è¢«æ•è·ï¼Œæ‰§è¡Œã€http://tech.haier.net/questionnaire/admin/budget/exportCustomerã€‘æ—¶å‘ç”Ÿå¼‚å¸¸org.apache.catalina.connector.ClientAbortException: java.io.IOException: Connection reset by peer        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:372)        at org.apache.catalina.connector.OutputBuffer.appendByteArray(OutputBuffer.java:811)        at org.apache.catalina.connector.OutputBuffer.append(OutputBuffer.java:740)        at org.apache.catalina.connector.OutputBuffer.writeBytes(OutputBuffer.java:407)        at org.apache.catalina.connector.OutputBuffer.write(OutputBuffer.java:385)        at org.apache.catalina.connector.CoyoteOutputStream.write(CoyoteOutputStream.java:96)        at org.apache.poi.poifs.nio.ByteArrayBackedDataSource.copyTo(ByteArrayBackedDataSource.java:86)        at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.writeFilesystem(NPOIFSFileSystem.java:805)        at org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:1440)        at org.jxls.transform.poi.PoiTransformer.write(PoiTransformer.java:274)        at org.jxls.util.JxlsHelper.processTemplate(JxlsHelper.java:124)        at com.hczt.haier.mobileoffice.common.utils.poi.JxlsUtil.exportExcel(JxlsUtil.java:42)        at com.hczt.haier.mobileoffice.usercenter.controller.admin.LejiaBudgetAdminController.exportCustomer(LejiaBudgetAdminController.java:220)        at com.hczt.haier.mobileoffice.usercenter.controller.admin.LejiaBudgetAdminController$$FastClassBySpringCGLIB$$9b6336b3.invoke(&lt;generated&gt;)        at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)        at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:738)        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)        at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:52)        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:168)        at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:85)        at com.hczt.haier.mobileoffice.common.aop.WebLogAspect.timeAround(WebLogAspect.java:87)        at sun.reflect.GeneratedMethodAccessor239.invoke(Unknown Source)        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)        at java.lang.reflect.Method.invoke(Method.java:498)        at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:629)        at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:618)        at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:168)        at org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor.invoke(AfterReturningAdviceInterceptor.java:52)        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:168)        at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)        at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:673)        at com.hczt.haier.mobileoffice.usercenter.controller.admin.LejiaBudgetAdminController$$EnhancerBySpringCGLIB$$58a01448.exportCustomer(&lt;generated&gt;)        at sun.reflect.GeneratedMethodAccessor1900.invoke(Unknown Source)        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)        at java.lang.reflect.Method.invoke(Method.java:498)        at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)        at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)        at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)        at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)        at javax.servlet.http.HttpServlet.service(HttpServlet.java:660)        at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)        at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)        at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)        at org.apache.catalina.filters.HttpHeaderSecurityFilter.doFilter(HttpHeaderSecurityFilter.java:126)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)        at com.alibaba.druid.support.http.WebStatFilter.doFilter(WebStatFilter.java:123)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:317)        at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:127)        at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:91)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:114)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:170)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter.doFilter(OAuth2AuthenticationProcessingFilter.java:176)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:64)        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56)        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331)        at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:214)        at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)        at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:347)        at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:263)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)        at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)        at org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:108)        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)        at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:81)        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)        at org.springframework.boot.web.support.ErrorPageFilter.doFilter(ErrorPageFilter.java:115)        at org.springframework.boot.web.support.ErrorPageFilter.access$000(ErrorPageFilter.java:59)        at org.springframework.boot.web.support.ErrorPageFilter$1.doFilterInternal(ErrorPageFilter.java:90)        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)        at org.springframework.boot.web.support.ErrorPageFilter.doFilter(ErrorPageFilter.java:108)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)        at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:96)        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:543)        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81)        at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:690)        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)        at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:615)        at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)        at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:818)        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1627)        at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)        at java.lang.Thread.run(Thread.java:748)Caused by: java.io.IOException: Connection reset by peer        at sun.nio.ch.FileDispatcherImpl.write0(Native Method)        at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)        at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)        at sun.nio.ch.IOUtil.write(IOUtil.java:65)        at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)        at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:136)        at org.apache.tomcat.util.net.NioBlockingSelector.write(NioBlockingSelector.java:101)        at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:157)        at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1312)        at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:692)        at org.apache.tomcat.util.net.SocketWrapperBase.writeBlocking(SocketWrapperBase.java:512)        at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:456)        at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.doWrite(Http11OutputBuffer.java:623)        at org.apache.coyote.http11.filters.ChunkedOutputFilter.doWrite(ChunkedOutputFilter.java:121)        at org.apache.coyote.http11.Http11OutputBuffer.doWrite(Http11OutputBuffer.java:225)        at org.apache.coyote.Response.doWrite(Response.java:600)        at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:360)</code></pre>]]></content>
      
      
      <categories>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoåˆ‡æ¢materyéä¸»æµä¸»é¢˜</title>
      <link href="2021/03/19/hexo-qie-huan-matery-fei-zhu-liu-zhu-ti/"/>
      <url>2021/03/19/hexo-qie-huan-matery-fei-zhu-liu-zhu-ti/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©å°†hexoçš„blogæ‰“ç®—ç»´æŠ¤ä¸€ä¸‹ï¼Œæ¢ä¸ªä¸»é¢˜ï¼Œææä¹‹å‰æ”¾åœ¨ç®€ä¹¦ä¸Šçš„å›¾ç‰‡ã€‚<br>å—¯~ä¸€ä¸ªå¤§å·¥ç¨‹ï¼Œæœ‰äº‹å¹²äº†</p><span id="more"></span><h2 id="å‘å¸ƒ"><a href="#å‘å¸ƒ" class="headerlink" title="å‘å¸ƒ"></a>å‘å¸ƒ</h2><p>ç»™githubå‘å¸ƒ</p><pre class="line-numbers language-shell"><code class="language-shell">hexo d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç»™è‡ªå»ºçš„æœåŠ¡å™¨å‘å¸ƒ</p><pre class="line-numbers language-shell"><code class="language-shell">rsync -rzve "ssh -p22" --delete public root@ip:/home/marvin/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p> <a href="https://qvchuang.top/archives/d3c10307.html">materyä¸»é¢˜ä¸ªæ€§åŒ–å®šåˆ¶</a><br> <a href="https://liyangzone.com/2019/07/22/hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E4%B8%80%E7%BA%A7%E5%88%86%E7%B1%BB%E7%9B%B8%E5%86%8C/">hexoåšå®¢æ·»åŠ ä¸€çº§åˆ†ç±»ç›¸å†ŒåŠŸèƒ½</a></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020å¹´æ€»ç»“</title>
      <link href="2021/03/10/2020-nian-ge-ren-zong-jie/"/>
      <url>2021/03/10/2020-nian-ge-ren-zong-jie/</url>
      
        <content type="html"><![CDATA[<p>2020å¹´å·¥ä½œå’Œç”Ÿæ´»ä¸ªäººæ€»ç»“</p><p><a href="https://www.jianshu.com/p/6ec047a09f89">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å¿«åˆ°å¹´åº•äº†ï¼ŒIt is almost the end of the year,<br>å†™ä¸ªæ€»ç»“å§, Write a summary<br>å¸®è¿‡æˆ‘çš„äººï¼ŒPeople who helped me,<br>è°¢è°¢ä½ ï¼ŒThank youï¼Œ<br>æ»´æ°´ä¹‹æ©ï¼ŒA little help,<br>æ°¸ä¸ç›¸å¿˜ï¼ŒNever forget each other<br>æˆ‘ä¼¤è¿‡çš„äººï¼Œpeople Iâ€™ve hurt<br>å¯¹ä¸èµ·ï¼Œ Iâ€™m sorry<br>æˆ‘ä¸æ˜¯æ•…æ„çš„ï¼ŒI didnâ€™t mean to<br>è‡´æˆ‘ç”Ÿå‘½ä¸­çš„æ¯ä¸€ä½æœ‹å‹ï¼ŒTo every friend in my life<br>2020å¹´ä½ è‹¥ä¸ç¦»ï¼ŒIf you donâ€™t leave in 2020<br>2021å¹´æˆ‘ä»¬ç»§ç»­ï¼ŒIn 2021ï¼Œwe will continue</p><p>å…ˆæŠ„ä¸€æ®µæ¼‚äº®çš„å¼€åœºç™½ã€‚</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-åä¸½ä¸½çš„åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“</p><h2 id="å·¥ä½œä¸Š"><a href="#å·¥ä½œä¸Š" class="headerlink" title="å·¥ä½œä¸Š"></a>å·¥ä½œä¸Š</h2><p>å¹³æ·¡æ— å¥‡çš„2020å¹´ï¼Œå·¥ä½œä¸Šä¸è¿‡å»çš„ä¸¤å¹´æ²¡æœ‰å¤ªå¤šçš„ä¸ä¸€æ ·ï¼Œå¦‚æœè¯´æœ‰ï¼Œç°åœ¨æƒ³æ¥ï¼Œå¿§ä¼¤å¤šä¸€ç‚¹ï¼Œæˆ–è®¸æ˜¯å› ä¸ºäººéƒ½ä¼šæ”¾å¤§ç—›è‹¦ï¼Œç¼©å°å¿«ä¹ï¼Œä¹Ÿæˆ–è®¸æ˜¯å·²ç»è¿‡å»çš„æ—©å·²ç»æ·¡å¿˜ã€‚</p><p>2019å¹´ï¼Œå¹´åä»æµ·å°”å›å½’åˆ°è‡ªå·±çš„å•ä½ï¼Œ30å·äººçš„åˆ›ä¸šå…¬å¸ï¼Œæˆ‘å¸¦ç€ä¸¤ä½å°å¦¹æäº†å¤§åŠå¹´çš„åŒ»ç–—é¡¹ç›®ï¼Œäº§å“æœ¬èº«ä¸€å¡Œç³Šæ¶‚ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªåƒclojureçš„é¡¹ç›®ï¼Œå‰åå°éƒ½ç”¨çš„clojureï¼Œä¹Ÿç®—æ˜¯ä¸ºå…¬å¸ä½¿ç”¨clojureåšé¡¹ç›®æ‰“å¼€äº†ç¬¬ä¸€æ‰‡å¤§é—¨ã€‚</p><p>ç¨å¾®æ€»ç»“ä¸‹è¿™ä¸ªé¡¹ç›®ã€‚<br>è‡³äºæœåŠ¡ç«¯ï¼Œéº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨ï¼Œè¿™ä¸ªå°é¡¹ç›®åå°ä¹Ÿç”¨åˆ°äº†æ‹¦æˆªå™¨(æˆæƒæ ¡éªŒã€æ‰“å°å‡ºå…¥å‚)ã€å‚æ•°æ ¡éªŒspecã€ç»Ÿä¸€å¼‚å¸¸å°è£…ã€swaggeré›†æˆã€æ•°æ®åº“è¿æ¥ã€SQLæ‰“å°ã€redisã€å®šæ—¶ä»»åŠ¡ã€ç¬¬ä¸‰æ–¹æ¥å£è°ƒç”¨ã€å¾®ä¿¡å…¬ä¼—å·æˆæƒã€JWTè®¤è¯ã€å¤šç¯å¢ƒç¯å¢ƒå˜é‡ä½¿ç”¨ã€å¤šç¯å¢ƒæ‰“åŒ…ã€testcaseç­‰ä¸€ä¸ªwebé¡¹ç›®å¸¸è§çš„åŠŸèƒ½ã€‚æˆ‘ä»¬ç”¨çš„<a href="https://luminusweb.com/">luminus</a>æ¨¡æ¿ä¸Šæ›´æœ‰oauthç­‰ã€‚</p><p>åŒ»ç”Ÿç«¯å’Œæ‚£è€…ç«¯åˆ†åˆ«ä½¿ç”¨figwheelå’Œshadow-cljsç¼–è¯‘ï¼ŒUIç»„ä»¶éƒ½æ˜¯Ant designï¼Œä½†æ˜¯åŒ»ç”Ÿç«¯å’Œæ‚£è€…ç«¯åˆ†åˆ«ä½¿ç”¨äº†<a href="https://github.com/priornix/antizer">antizer</a>å’ŒåŸç”Ÿçš„antdã€‚ä¹‹åçš„é¡¹ç›®éƒ½ç”¨shadow-cljsï¼Œä¹Ÿæ˜¯å› ä¸ºæ¯”figwheelé›†æˆnpmçš„åŒ…æ›´æ–¹ä¾¿ä¸€äº›ï¼Œä¹Ÿå¼•å…¥äº†packageï¼Œä¸è¿‡æˆ‘ä»¬æ²¡æœ‰ç”¨åˆ°ï¼Œåªæ˜¯ç”¨æ¥ç®¡ç†ä¾èµ–äº†ï¼Œç›¸ä¿¡åº”è¯¥æœ‰æ›´å¥½çš„ç”¨æ³•ã€‚</p><p>8æœˆä»½å¼€å§‹åœ¨åˆ«äººçš„å®šåˆ¶çš„é¡¹ç›®çš„åŸºç¡€ä¸Šï¼Œå®æ–½å¤šç§Ÿæˆ·çš„å¦ä¸€ç§æ¨¡å¼çš„å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªæœè£…å®šåˆ¶ä¸Šä¸€ä¸ªå•ç‹¬çš„é¡¹ç›®ï¼Œè¿™ä¸ªé˜¶æ®µï¼Œç®¡ç†ä¸Šæ¯”è¾ƒæ··ä¹±ï¼Œäººå‘˜ç®¡ç†ä¹Ÿæ˜¯éšæœºçµæ´»è°ƒåŠ¨çš„ã€‚</p><p>ä¸€ä¸å°å¿ƒå°±å¹´åº•äº†ã€‚</p><p>è¿›å…¥2020å¹´ï¼Œä¸€å¹´éƒ½åœ¨ç–«æƒ…çš„ç¬¼ç½©ä¸‹ä½œä¸šï¼Œè¿œç¨‹åŠå…¬åˆ°4æœˆåï¼Œæ‰å¼€å§‹åˆ°å•ä½ä¸Šç­ï¼Œè¿œç¨‹åŠå…¬ä¹Ÿæ˜¯æœ‰æ•ˆçš„ï¼Œä¸Šç­æ—¶é—´æ¯”åœ¨å…¬å¸è¿˜è¦é•¿ï¼Œç»å¸¸æŠŠè‡ªå·±é”åœ¨å±‹é‡Œï¼Œä¸€é”å°±æ˜¯åŠå¤©ï¼Œç”±äºåƒé¥­æ—¶é—´ä¸ä¸€æ ·ï¼Œæœ‰æ—¶å€™åˆšå¼€å§‹åƒé¥­å°±è¦å¼€ä¼šäº†ï¼Œå¾ˆæ²¡æœ‰èŠ‚å¥ã€‚</p><p>4æœˆä»½å¼€å§‹ä¸‹å•ç³»ç»Ÿé‡æ„ï¼Œæˆ‘è´Ÿè´£é—¨åº—ä¸‹å•ç³»ç»Ÿçš„è£åœ£å’Œçˆ±ä¸å±±ä¸¤ä¸ªä¸åŒçš„ä¸šåŠ¡çº¿ï¼Œé™†ç»­é‡æ„ä¸‹å•é¡µé¢å’Œè®¢å•æµç¨‹ã€æ”¯ä»˜ã€å®¡æ ¸æµç¨‹ï¼Œä¸¤ä¸ªä¸åŒçš„æµç¨‹ä¸€å¼€å§‹æ˜¯åœ¨ä¸€ä¸ªåˆ†æ”¯ä¸Šè¿›è¡Œï¼Œåæ¥å› ä¸ºå…¼å®¹é—®é¢˜ï¼Œè¢«è¿«å¼€äº†æ–°çš„åˆ†æ”¯ç»´æŠ¤äº†ã€‚å¯¹äº†ï¼Œè¿˜æœ‰ä¸ªåŠè·¯æ’å‡ºæ¥ï¼Œæœ‰åŠè·¯æ­»æ‰çš„å¦‚æ„è¿™ä¸ªåˆ†æ”¯ï¼Œæ‰€ä»¥åŠ èµ·æ¥ä¸šåŠ¡ä¸‰æ¡çº¿ã€‚ä»£ç åŠ ä¸Šåˆ«äººçš„å°±æ›´å¤šäº†ï¼Œè¿˜æœ‰æ±‰é‚¦ã€ç‰¹è£ã€‚</p><p>11æœˆä¹‹åï¼ŒåŒ»ç–—é¡¹ç›®åˆé‡æ–°çœ‹åˆ°äº†ç”Ÿæœºï¼Œæ›´æ–°ç»´æŠ¤äº†ä¸€äº›åŠŸèƒ½ï¼Œç„¶å12æœˆé‡æ–°è°ˆå•†åŠ¡ï¼Œå¯¼å‡ºæ¼”ç¤ºï¼ŒåŸ¹è®­ï¼Œåé¢è¿˜è¦åšäº›ç»Ÿè®¡ï¼Œè‡ªç”±é…ç½®ç›¸å…³çš„ä¸œè¥¿ï¼Œ å¸Œæœ›è¿™ä¸ªäº§å“èƒ½åšèµ·æ¥ï¼Œèƒ½ç»™å…¬å¸å¸¦æ¥å—ç›Šã€‚</p><p>å†™ç€å†™ç€ï¼Œå°±å¼€å§‹åšæµæ°´è´¦äº†ã€‚</p><p>2020å¹´ï¼ŒæŠ€æœ¯ä¸Šå¥½åƒæ²¡æœ‰ä»€ä¹ˆå¢é•¿ï¼Œæˆ‘çŸ¥é“è¿™æ˜¯å¯æ€•çš„ï¼Œä½†æ˜¯æ—¥å¸¸å·¥ä½œçäº‹è¾ƒå¤šï¼Œå æ®äº†æˆ‘å¤ªå¤šæ—¶é—´å’Œç²¾åŠ›ï¼Œç»å¸¸ä¼šå‡ºç°ä¸€ä¸¤å‘¨éƒ½æ²¡æœ‰æ—¶é—´ç»™è‡ªå·±è…¾å‡ºå¥½å¥½ç¼–ç çš„æ—¶é—´ï¼Œä¹Ÿè®¸æ˜¯å¤ªçœ‹é‡å›¢é˜Ÿã€é¡¹ç›®ï¼Œå¯¹è‡ªå·±ç‰ºç‰²å¤ªå¤šã€‚<br>å¹¶ä¸”å¯æ‚²çš„æ˜¯è¿™æ ·æ˜¯ä¸è®¨å¥½çš„ï¼ŒæŠ€æœ¯æ²¡æœ‰é•¿è¿›ï¼Œç»©æ•ˆè¿˜æŒç»­èµ°ä½ï¼Œè¿™å‡ ä¸ªæœˆä¸€ç›´æ˜¯è¿·å¤±çŠ¶æ€ã€‚æƒ³ç‹ ä¸‹å¿ƒæ¥ï¼Œé’»åˆ°ä»£ç é‡ŒåŠªåŠ›æå‡è‡ªå·±ï¼Œå•¥ä¹Ÿä¸ç®¡ï¼Œä½†æ˜¯ç»å¸¸åšä¸åˆ°ã€‚</p><p>2020å¹´ï¼Œæœ‰ä¸€ä»¶äº‹æƒ…ï¼Œè¿˜åšæŒç€ï¼Œé‚£å°±æ˜¯å†™åšå®¢ï¼Œè™½ç„¶ä¸åƒ2019å¹´ï¼Œå‡ºæ¥çš„éƒ½æ˜¯clojureçš„åˆ«äººæ²¡æœ‰å†™çš„ï¼Œä½†æ˜¯å·¥ä½œä¸­ç¢°åˆ°çš„é—®é¢˜å’Œè§£å†³éƒ½è¿˜æ˜¯å°½å¯èƒ½æ•´ç†æˆå¯¹è‡ªå·± æœ‰ç”¨çš„ä¸œè¥¿è®°ä¸‹æ¥äº†ã€‚</p><h2 id="ç”Ÿæ´»ä¸Š"><a href="#ç”Ÿæ´»ä¸Š" class="headerlink" title="ç”Ÿæ´»ä¸Š"></a>ç”Ÿæ´»ä¸Š</h2><p>20å¹´æ²¡æœ‰æ¯”æ€€ä¸ŠäºŒèƒæ›´å¤§çš„æ”¶è·äº†ï¼Œå°½ç®¡å‹åŠ›ä¹Ÿéšä¹‹è€Œæ¥ï¼Œä½†æ˜¯ä¹Ÿç®—æ˜¯å®Œæˆäº†ä¸¤ä»£äººçš„ä»»åŠ¡ã€‚ç”Ÿç”·ç”Ÿå¥³æ— æ‰€è°“ï¼Œèµ·ç ç»™è€å¤§ä¸€ä¸ªäº²äººï¼Œä¸€ä¸ªçœŸæ­£çš„å…„å¼Ÿå§å¦¹,åœ¨è¿™ä¸ªäººäººå­¤ç‹¬è‡ªå±çš„æ—¶ä»£ï¼Œæ²¡æœ‰æ¯”æƒ…äº²æ›´åŠ ä»¤äººæš–å¿ƒçš„æ„Ÿæƒ…äº†ã€‚</p><p>20å¹´ï¼Œä»Šå¹´å¼€å§‹ä¹Ÿè®¸æ˜¯ç”Ÿæ´»æ‰€è¿«ï¼Œä¹Ÿè®¸æ˜¯å‹¤ä¿­èŠ‚çº¦+å…¨å®¶åŠªåŠ›ï¼Œæ‰‹å¤´ä¸Šå‰å‡ å¹´å®½æ¾äº†äº›ï¼Œå¼€å§‹è€ƒè™‘æ¢æˆ¿äº†ï¼ŒæœŸæœ›21å¹´èƒ½ä»å¥—äºŒæ¢æˆå¥—ä¸‰ï¼Œæˆ¿å¥´è§’è‰²ä¸Šä¸ªæ¡£æ¬¡ï¼Œæé«˜æœˆä¾›æ°´å¹³ã€‚</p><p>20å¹´ï¼Œé—ºå¥³ä¸Šå¹¼å„¿å›­äº†ï¼Œå…¬åŠå¹¼å„¿å›­ï¼Œç¡®å®éš¾ä¸Šï¼ŒåŒè¯éƒ½å…¨ï¼Œè¿˜è¦é€šè¿‡é›†ä¼šç»´æƒçš„æ–¹å¼è®©å¹¼å„¿å›­å’Œæ•™ä½“å±€ä¸€èµ·è§£å†³å­©å­ä¸Šå­¦é—®é¢˜ï¼Œä¸­å›½çš„ç¤¾ä¼šçœŸçš„è¿˜å¯ä»¥æ›´å¥½ã€‚</p><p>20å¹´ï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰å¤§ç—…ï¼Œçˆ¶äº²å»è¿‡å‡ æ¬¡åŒ»é™¢çœ‹è…°ï¼Œä¹Ÿåšäº†ä¸€æ¬¡é’ˆç¸ï¼Œæœ‰ä¸€æ¬¡æ˜¯è‚ ç‚ã€‚å·¥ä½œå‘¢ï¼Œå¹²äº†3å¹´å¤šçš„å°åŒºä¿æ´ï¼Œ8æœˆä»½å¼€å§‹è·³æ§½åˆ°å®œå®¶çš„ç‰©ä¸šå»äº†ï¼Œæ¯äº²å½»åº•åœ¨å®¶çœ‹å­©å­äº†ã€‚æ¯äº²æ˜¯ä¸ªå‹¤å¿«äººï¼Œé—²ä¸ä½ï¼Œæœ‰æ‰¾äº†ä¸ªå¥¶åº—æ´—å¥¶ç“¶çš„å·¥ä½œï¼Œæ¯å¤©æ™šä¸Š6ï¼š30åˆ°9ï¼š00ï¼Œä¸¤ä¸ªåŠå°æ—¶28å—é’±ã€‚æ­£å¥½åª³å¦‡å›å®¶äº†ï¼Œæ¯äº²å°±å»ä¸Šç­äº†ï¼Œä¸€å®¶äººéƒ½åœ¨åŠªåŠ›ç€ã€‚</p><p>20å¹´ï¼Œæˆ‘åˆç»™å®¶é‡Œä¹°äº†ä¸ªç›’å­ï¼ŒNUC8 è±†å­å³¡è°·ï¼Œè£…ä¸Šé»‘è‹¹æœï¼Œä»¥åå¯ä»¥ä¸ç”¨å¸¦ç”µè„‘å›å®¶äº†ã€‚</p><p>20å¹´ï¼Œå¹´åº•äº†ï¼Œè…ŠæœˆäºŒåä¹æ˜¯ä¸ªå¥½æ—¥å­ï¼Œå„¿å­é©¬æ­£çƒ¨è¯ç”Ÿã€‚è…Šæœˆä¸‰åå‡ºé™¢å›å®¶å›¢åœ†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è€çˆ¸çš„ä¸€ç¬”æ”¶å…¥è´¦</title>
      <link href="2021/03/01/lao-ba-2020-nian-de-ru-zhang/"/>
      <url>2021/03/01/lao-ba-2020-nian-de-ru-zhang/</url>
      
        <content type="html"><![CDATA[<p>è€çˆ¸çš„ä¸€ç¬”æ”¶å…¥è´¦</p><p><a href="https://www.jianshu.com/p/e3b09ac0a2e4">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/blog//20210314233856.jpeg" alt="202001.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/blog//20210314233908.jpeg" alt="202002.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/blog//20210314233920.jpeg" alt="202003.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/20210320201219.jpeg" alt="202004.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/20210320201231.jpeg" alt="202005.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/20210320201242.jpeg" alt="202006.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/20210320201257.jpeg" alt="202007.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/20210320201306.jpeg" alt="202008.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/20210320201313.jpeg" alt="202009.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/20210320201320.jpeg" alt="202010.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/20210320201327.jpeg" alt="202011.jpeg"></p><p><img src="/loading.gif" data-original="https://gitee.com/marvinma/imagebed/raw/master/img/blog/20210314233943.jpeg" alt="202012.jpeg"></p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿæ´» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Macä¸Šmysql 5.7 ä¿®æ”¹sql_mode ONLY_FULL_GROUP_BY</title>
      <link href="2020/10/27/mac-shang-mysql-5.7-xiu-gai-sql-mode-only-full-group-by/"/>
      <url>2020/10/27/mac-shang-mysql-5.7-xiu-gai-sql-mode-only-full-group-by/</url>
      
        <content type="html"><![CDATA[<p>Macä¸Šmysql 5.7 ä¿®æ”¹é»˜è®¤çš„sql_modeï¼Œå»é™¤ ONLY_FULL_GROUP_BYé™åˆ¶<br><a href="https://www.jianshu.com/p/7359f28b41e4">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ONLY_FULL_GROUP_BYæ˜¯MySQLæä¾›çš„ä¸€ä¸ªsql_modeï¼Œé€šè¿‡è¿™ä¸ªsql_modeæ¥æä¾›SQLè¯­å¥GROUP BYåˆæ³•æ€§çš„æ£€æŸ¥ï¼Œåœ¨MySQLçš„sql_modeæ˜¯éONLY_FULL_GROUP_BYè¯­ä¹‰æ—¶ã€‚ä¸€æ¡selectè¯­å¥ï¼ŒMySQLå…è®¸target listä¸­è¾“å‡ºçš„è¡¨è¾¾å¼æ˜¯é™¤èšé›†å‡½æ•°æˆ–group by columnä»¥å¤–çš„è¡¨è¾¾å¼ï¼Œè¿™ä¸ªè¡¨è¾¾å¼çš„å€¼å¯èƒ½åœ¨ç»è¿‡group byæ“ä½œåå˜æˆundefinedã€‚</p><h2 id="ä¸€èˆ¬æ–¹å¼"><a href="#ä¸€èˆ¬æ–¹å¼" class="headerlink" title="ä¸€èˆ¬æ–¹å¼"></a>ä¸€èˆ¬æ–¹å¼</h2><h3 id="1ã€æŸ¥çœ‹sql-mode"><a href="#1ã€æŸ¥çœ‹sql-mode" class="headerlink" title="1ã€æŸ¥çœ‹sql_mode"></a>1ã€æŸ¥çœ‹sql_mode</h3><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> @<span class="token variable">@sql_mode</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥è¯¢å‡ºæ¥çš„å€¼ä¸ºï¼š</p><pre class="line-numbers language-sql"><code class="language-sql">ONLY_FULL_GROUP_BY<span class="token punctuation">,</span>STRICT_TRANS_TABLES<span class="token punctuation">,</span>NO_ZERO_IN_DATE<span class="token punctuation">,</span>NO_ZERO_DATE<span class="token punctuation">,</span>ERROR_FOR_DIVISION_BY_ZERO<span class="token punctuation">,</span>NO_AUTO_CREATE_USER<span class="token punctuation">,</span>NO_ENGINE_SUBSTITUTION<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2ã€å»æ‰ONLY-FULL-GROUP-BYï¼Œé‡æ–°è®¾ç½®å€¼ã€‚"><a href="#2ã€å»æ‰ONLY-FULL-GROUP-BYï¼Œé‡æ–°è®¾ç½®å€¼ã€‚" class="headerlink" title="2ã€å»æ‰ONLY_FULL_GROUP_BYï¼Œé‡æ–°è®¾ç½®å€¼ã€‚"></a>2ã€å»æ‰ONLY_FULL_GROUP_BYï¼Œé‡æ–°è®¾ç½®å€¼ã€‚</h3><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SET</span> @<span class="token variable">@global.sql_mode</span> <span class="token operator">=</span><span class="token string">'STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3ã€ä¸Šé¢æ˜¯æ”¹å˜äº†å…¨å±€sql-modeï¼Œå¯¹äºæ–°å»ºçš„æ•°æ®åº“æœ‰æ•ˆã€‚å¯¹äºå·²å­˜åœ¨çš„æ•°æ®åº“ï¼Œåˆ™éœ€è¦åœ¨å¯¹åº”çš„æ•°æ®ä¸‹æ‰§è¡Œï¼š"><a href="#3ã€ä¸Šé¢æ˜¯æ”¹å˜äº†å…¨å±€sql-modeï¼Œå¯¹äºæ–°å»ºçš„æ•°æ®åº“æœ‰æ•ˆã€‚å¯¹äºå·²å­˜åœ¨çš„æ•°æ®åº“ï¼Œåˆ™éœ€è¦åœ¨å¯¹åº”çš„æ•°æ®ä¸‹æ‰§è¡Œï¼š" class="headerlink" title="3ã€ä¸Šé¢æ˜¯æ”¹å˜äº†å…¨å±€sql_modeï¼Œå¯¹äºæ–°å»ºçš„æ•°æ®åº“æœ‰æ•ˆã€‚å¯¹äºå·²å­˜åœ¨çš„æ•°æ®åº“ï¼Œåˆ™éœ€è¦åœ¨å¯¹åº”çš„æ•°æ®ä¸‹æ‰§è¡Œï¼š"></a>3ã€ä¸Šé¢æ˜¯æ”¹å˜äº†å…¨å±€sql_modeï¼Œå¯¹äºæ–°å»ºçš„æ•°æ®åº“æœ‰æ•ˆã€‚å¯¹äºå·²å­˜åœ¨çš„æ•°æ®åº“ï¼Œåˆ™éœ€è¦åœ¨å¯¹åº”çš„æ•°æ®ä¸‹æ‰§è¡Œï¼š</h3><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SET</span> sql_mode <span class="token operator">=</span><span class="token string">'STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åºŸè¯åŠå¤©ï¼Œä½†æ˜¯å…¶å®åŒäº‹å’Œæˆ‘æœ¬åœ°è¿™æ ·è®¾ç½®éƒ½æ²¡æœ‰ç”Ÿæ•ˆã€‚</p><p>å¤§å®¶éƒ½æ˜ç™½ï¼Œå·¥å…·é‡Œé¢ä¿®æ”¹ä¸€èˆ¬æ˜¯ä¸´æ—¶çš„ï¼Œåªæœ‰ä¿®æ”¹é…ç½®æ–‡ä»¶æ‰æ˜¯æ°¸ä¹…çš„ï¼Œä½†æ˜¯æ¯”å¦‚åœ¨åŒäº‹ç”µè„‘ä¸Šå‚è€ƒå¥½å‡ ç§ç½‘ç»œä¸Šçš„è¯´æ³•ä¿®æ”¹äº†<code>/etc/my.cnf</code>æ–‡ä»¶ï¼Œä¹Ÿè¿˜æ˜¯æ²¡æœ‰å¥æ•ˆã€‚</p><p>windows åœ¨å®‰è£…ç›®å½•ä¸‹çš„my.ini æ–‡ä»¶<br>Mac æˆ–è€…Linux åœ¨/ etc/my.cnf ä¸‹é¢åº”è¯¥æ˜¯<br>æ€»ä¹‹å°±æ˜¯åœ¨ä¸ªäººmysqlé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ã€‚</p><h2 id="å¦ä¸€ä¸ªæ–¹å¼"><a href="#å¦ä¸€ä¸ªæ–¹å¼" class="headerlink" title="å¦ä¸€ä¸ªæ–¹å¼"></a>å¦ä¸€ä¸ªæ–¹å¼</h2><p>æœ€åæ²¡åŠæ³•äº†ï¼Œä¸‹é¢çš„å‘½ä»¤å´ä¸å°å¿ƒè¾¾åˆ°äº†ç›®çš„ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹ã€‚</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SET</span> @<span class="token variable">@sql_mode</span><span class="token operator">=</span>REPLACE<span class="token punctuation">(</span>@<span class="token variable">@sql_mode</span><span class="token punctuation">,</span> <span class="token string">'ONLY_FULL_GROUP_BY'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¨‹åºçŒ¿çš„MacOSç¯å¢ƒ(äºŒ)</title>
      <link href="2020/10/01/cheng-xu-yuan-de-macos-huan-jing-er/"/>
      <url>2020/10/01/cheng-xu-yuan-de-macos-huan-jing-er/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡çš„è¡¥å……<br><a href="https://www.jianshu.com/p/c485142a6a7e">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æ¨èï¼š<a href="https://www.jianshu.com/p/2f8b0f0aca93">https://www.jianshu.com/p/2f8b0f0aca93</a><br>æœ¬ç¯‡ï¼šæ¯”è¾ƒå¥½ç”¨çš„å‡ æ¬¾æ—¥å¸¸è½¯ä»¶<br>æ¨èæ¥æºï¼š<a href="https://www.jianshu.com/p/bdb899112d5b">10ä¸ªmacOSå…è´¹å°å·¥å…·ï¼Œèƒ½å¸®ä½ çœä¸‹ä¸€å¤§ç¬”é’±</a></p><h2 id="1-iShot"><a href="#1-iShot" class="headerlink" title="1. iShot"></a>1. iShot</h2><p>æˆªå›¾è½¯ä»¶,æœ¬äººä¸€ç›´ç”¨çš„æ˜¯éä¸“ä¸šç‰ˆçš„Xnipï¼Œæ—¥å¸¸æˆªå›¾ä¹ŸåŸºæœ¬å¤Ÿç”¨ï¼Œä¹Ÿèƒ½æ»šå±æˆªå›¾ï¼Œä½†æ˜¯æ²¡æœ‰å»¶æ—¶æˆªå›¾çš„åŠŸèƒ½ï¼Œä¸»è¦æ˜¯ä¸æ˜¯å…è´¹çš„ã€‚</p><p>æ›¿ä»£å“iShotæˆ‘åè€Œè§‰å¾—æ›´èƒœä¸€ç­¹ã€‚<br><img src="/loading.gif" data-original="/images/mac/iShot.png" alt="iShot"></p><p>è¿˜æ”¯æŒå½•å±ï¼Œé‡ç‚¹æ˜¯å½•å±è¿˜å¯ä»¥ç›´æ¥è½¬æˆgifï¼Œæ–¹ä¾¿è‡³æã€‚</p><h2 id="2-ç¿»è¯‘å·¥å…·Bob"><a href="#2-ç¿»è¯‘å·¥å…·Bob" class="headerlink" title="2. ç¿»è¯‘å·¥å…·Bob"></a>2. ç¿»è¯‘å·¥å…·Bob</h2><p>é™¤äº†èƒ½é€‰ä¸­æ–‡å­—ï¼Œç²˜è´´æ–‡å­—è¿›è¡Œç¿»è¯‘ï¼Œè¿˜å¯ä»¥æˆªå›¾ç¿»è¯‘ï¼Œé€šè¿‡ OCR è¯†åˆ«æ–‡å­—ï¼ŒBob å¯ä»¥ç›´æ¥æˆªå›¾ç¿»è¯‘ï¼Œè¿™æ ·çªç ´äº†æ–‡å­—é™åˆ¶ï¼Œå¯ä»¥ç›´æ¥ç¿»è¯‘å›¾ç‰‡æˆ–è€…è§†é¢‘ä¸­æŸä¸ªç”»é¢å†…å®¹ï¼Œå³ä¾¿ä½ ä¸éœ€è¦ç¿»è¯‘çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥å°†å…¶ä½œä¸ºä¸€ä¸ª OCR è¯†åˆ«å·¥å…·ä½¿ç”¨ï¼Œç›´æ¥å¤åˆ¶è¯†åˆ«åçš„å†…å®¹ï¼Œå®æµ‹è¯†åˆ«å‡†ç¡®ç‡å¾ˆå¯è§‚ã€‚</p><h2 id="3-NTFS-è¯»å†™å·¥å…·ï¼šParagon-NTFS-Tuxera-NTFSï¼ˆ100-å…ƒï¼‰â€”â€”-NTFS-Toolï¼ˆå…è´¹ï¼‰"><a href="#3-NTFS-è¯»å†™å·¥å…·ï¼šParagon-NTFS-Tuxera-NTFSï¼ˆ100-å…ƒï¼‰â€”â€”-NTFS-Toolï¼ˆå…è´¹ï¼‰" class="headerlink" title="3. NTFS è¯»å†™å·¥å…·ï¼šParagon NTFS / Tuxera NTFSï¼ˆ100+å…ƒï¼‰â€”â€” NTFS Toolï¼ˆå…è´¹ï¼‰"></a>3. NTFS è¯»å†™å·¥å…·ï¼šParagon NTFS / Tuxera NTFSï¼ˆ100+å…ƒï¼‰â€”â€” NTFS Toolï¼ˆå…è´¹ï¼‰</h2><p>æˆ‘æƒ³å¾ˆå¤šåˆšåˆšæ¥è§¦ macOS éƒ½ä¼šé‡åˆ°è¿™ä¸ªéº»çƒ¦â€”â€”NTFS æ ¼å¼ç¡¬ç›˜æ— æ³•è¯»å–ï¼Œæ­¤å‰é€šè¿‡æœç´¢å¼•æ“äº†è§£åˆ°ç”¨æˆ·é‡æ¯”è¾ƒå¤§çš„æ˜¯ Paragon NTFS å’Œ Tuxera NTFS è¿™ä¸¤æ¬¾å·¥å…·ï¼Œç”±äºä»£ç†æ–¹ä¸ä¸€æ ·ï¼Œå”®ä»·ä¹Ÿä¸ç»Ÿä¸€ï¼Œä½†ä¹ŸåŸºæœ¬éƒ½åœ¨ 100 å…ƒä»¥ä¸Šï¼Œå‡ºäºè½¯ä»¶åŒ…å¤§å°ä»¥åŠ UI é£æ ¼ï¼Œæˆ‘æœ€ç»ˆè´­ä¹°äº† Paragon NTFSï¼Œä½¿ç”¨åˆ°ç°åœ¨å€’ä¹Ÿæ²¡é‡åˆ°ä»€ä¹ˆä¸å¦‚æ„ã€‚</p><p><img src="/loading.gif" data-original="/images/mac/ParagonNTFS.jpg" alt="Paragon NTFS"></p><p>åœ¨å‡†å¤‡è¿™ç¯‡æ–‡ç« ï¼Œåˆé‡æ–°äº†è§£äº†ä¸€ä¸‹ï¼Œæ–°å‡ºç°äº†ä¸å°‘ä»·æ ¼æ›´ä½ç”šè‡³å…è´¹çš„ NTFS è¯»å†™å·¥å…·ï¼Œå…¶å®ƒä»˜è´¹çš„æˆ‘å°±ä¸è¯´äº†ï¼ŒNTFS Tool è¿™æ¬¾å…è´¹å¼€æºçš„å·¥å…·å€’æ˜¯å€¼å¾—æ¨èã€‚å®‰è£…å®Œæˆåï¼Œç›´æ¥åœ¨ Finder ä¸­å¯¹ç¡¬ç›˜ä¸­æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œã€‚ä¸è¿‡ NTFS Tool å¯¹äºç³»ç»Ÿç›˜çš„è¯†åˆ«ä¸Šä¼¼ä¹æœ‰äº›ä¸ä¸€æ ·ï¼Œä½¿ç”¨ä¸Šå€’ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ã€‚</p><p><img src="/loading.gif" data-original="/images/mac/ParagonNTFS2.jpg" alt="Paragon NTFS2"></p><p>åŸºæœ¬ macOS ä¸Šæ‰€æœ‰çš„ NTFS è¯»å†™å·¥å…·åªæ˜¯èƒ½è®©ç³»ç»Ÿæ­£å¸¸è¯»å†™ NTFS æ ¼å¼ç¡¬ç›˜ï¼Œå…¶å®ƒæ‰€æœ‰çš„æ–‡ä»¶æ“ä½œè¿˜æ˜¯åœ¨ Finder ä¸­å®Œæˆï¼Œä¸è¿‡è¿™ç±»å·¥å…·å€’æ˜¯ä¹Ÿå¯ä»¥ä½œä¸ºå¤–æ¥ç¡¬ç›˜çš„ç®¡ç†ä½œç”¨ã€‚</p><p>æ— è®ºæ˜¯ç”¨çš„å“ªä¸€æ¬¾å·¥å…·ï¼Œåªè¦èƒ½å¤Ÿå®ç°æƒ³è¦çš„ç›®çš„ï¼Œé‚£å°±å¤Ÿäº†ï¼ŒNTFS Tool å¯èƒ½ä¸æ˜¯æœ€å¥½ç”¨çš„ï¼Œä½†ä½œä¸ºå…è´¹å¼€æºå·¥å…·ï¼Œè¿™æ ·å´ä¹Ÿæ˜¯è¶³å¤Ÿäº†ã€‚</p><h2 id="4-ffmpeg"><a href="#4-ffmpeg" class="headerlink" title="4. ffmpeg"></a>4. ffmpeg</h2><p>è§†é¢‘æ ¼å¼è½¬æ¢ã€è§†é¢‘è½¬ gifã€è§†é¢‘å‹ç¼©ç­‰è§†é¢‘æ“ä½œçš„å‘½ä»¤è¡Œå·¥å…·ã€‚åŸºæœ¬ç°åœ¨æ’­æ”¾å™¨çš„è½¯ä»¶éƒ½ä½¿ç”¨äº†è¯¥ä»“åº“çš„ä»£ç ã€‚æˆ‘å¹³å¸¸ä¸»è¦ç”¨å®ƒå‹ç¼©è§†é¢‘ï¼Œä¾‹å¦‚ä»‹ç» utools ç« èŠ‚çš„è§†é¢‘ï¼ŒåŸè§†é¢‘ 23Mï¼Œç„¶åé€šè¿‡å®ƒå‹ç¼© 8Mï¼Œæ–¹ä¾¿å¿«æ·ã€‚ç¼ºç‚¹æ˜¯å‘½ä»¤è¡Œå¤æ‚ï¼Œéœ€è¦å¥½å¥½è°ƒæ•™ï¼Œæˆ‘æœ¬äººç”¨çš„è¾ƒå°‘ã€‚</p><ol><li> ä¸»é¡µåœ°å€ï¼š<a href="https://github.com/FFmpeg/FFmpeg">github.com/FFmpeg/FFmpâ€¦</a></li><li> ä¸‹è½½ï¼š <code>brew install ffmpeg</code></li></ol><p>å…³äºffmpegæˆ‘ä»¬å…¬å¸æè¿‡ä¸€ä¸ªéŸ³è§†é¢‘çš„é¡¹ç›®ï¼Œæœ‰æ›´åŠ ç»†è‡´çš„<a href="http://blog.3vyd.com/blog/posts-output/2021-02-08-ffmpeg%E9%9F%B3%E8%A7%86%E9%A2%91%E6%B5%81%E5%AA%92%E4%BD%93%E5%A4%84%E7%90%86%E6%80%BB%E7%BB%93/">ä¼ é€é—¨</a>ç»éªŒæ€»ç»“ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> mac </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mac </tag>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¨‹åºçŒ¿çš„MacOSç¯å¢ƒ(ä¸€)</title>
      <link href="2020/09/29/cheng-xu-yuan-de-macos-huan-jing-yi/"/>
      <url>2020/09/29/cheng-xu-yuan-de-macos-huan-jing-yi/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/2f8b0f0aca93">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æ¯ä¸ªæ±Ÿæ¹–ä¸Šçš„é«˜æ‰‹éƒ½æœ‰è‡ªå·±è¶æ‰‹çš„å…µå™¨ï¼Œä½ ä¹Ÿåº”è¯¥æœ‰ä½ è‡ªå·±çš„é‚£æŠŠå°æé£åˆ€ã€‚<br>å°æé£åˆ€è¿™ä¸ªå…µå™¨è¿˜çœŸä¸æ˜¯çªç„¶æƒ³åˆ°çš„ã€‚</p><p>è¦æ˜¯é—®æˆ‘ä»€ä¹ˆä¸æ˜¯æ–¹å¤©ç”»æˆŸã€é’é¾™åƒæœˆåˆ€ã€ä¸ˆå…«è›‡çŸ›äº‘äº‘ï¼Œæˆ–è€…ä¸ºå•¥ä¸æ˜¯ç‹¬å­¤æ±‚è´¥çš„åˆ©å‰‘ã€ç´«è–‡è½¯å‰‘ã€ç„é“é‡å‰‘ä¹‹ç±»çš„ã€‚æˆ‘å°±å‘µå‘µäº†ï¼Œä½ è§è¿‡å“ªä¸ªé“æ³•é«˜æ·±çš„ç¥ä»™ï¼Œéšèº«æ‰‹é‡Œæ‰›ç€è¿™ä¹ˆå¤§çš„å…µå™¨ï¼Œå…³äºŒå“¥æ‹‰å±æ—¶åº”è¯¥ä¸ä¼šæ‰›ç€é’é¾™åƒæœˆåˆ€å§ã€‚</p><p>å°æé£åˆ€åˆ™ä¸ç„¶ï¼Œéšèº«æºå¸¦ï¼Œæ€ä¼¤åŠ›ä¸å¼±äºå…¶ä»–ï¼Œæœ€é‡è¦çš„å…¶å®æ˜¯å°æé£åˆ€æ˜¯åœ¨æµªå­æå¯»æ¬¢æ‰‹é‡Œï¼Œæå¯»æ¬¢æ­¤äººæ˜¯ä¸€ä¸ªå€¾å€’å¤©ä¸‹å¤šæƒ…çº¢é¢œçš„æ½‡æ´’æµªå­ï¼Œä¸€ä¸ªé‡æƒ…é‡ä¹‰çš„æ‚²æƒ…è‹±é›„ï¼Œä¸€ç”Ÿéƒ½è¢«èº«å¿ƒçš„ç—›è‹¦æŠ˜ç£¨ï¼Œå´åˆä¸è½»æ˜“æ˜¾ç¤ºå–œæ€’å“€ä¹ï¼Œå¤æ‚çš„å†…å¿ƒæƒ…æ„Ÿå…¨é çœ¼ç¥è¡¨ç°ã€‚æ‰€ä»¥è®¡ç®—å¼å°æé£åˆ€åªæ˜¯åœ¨ç™¾æ™“ç”Ÿå…µå™¨è°±ä¸Šæ’ç¬¬ä¸‰ï¼Œæˆ‘è¿˜æ˜¯æ›´å–œæ¬¢ï¼Œä¹Ÿè®¸æˆ‘æ˜¯ä¸å–œæ¬¢å¤©æœºè€äººçš„æ‡¦å¼±ï¼Œå’Œä¸Šå®˜é‡‘è™¹çš„æ¶éœ¸è¡Œä¸ºã€‚</p><p>æœ‰äººè¯´ï¼Œè‡ªå¤æ²¡æœ‰æœ€å‰å®³çš„å…µå™¨ï¼Œåªæœ‰æœ€å‰å®³çš„äººã€‚ä¹Ÿæ˜¯ï¼Œå­¤ç‹¬å‰è¾ˆçš„ç¬¬å››æŠŠå‰‘å°±æ˜¯æœ¨å‰‘ï¼Œâ€œå››åå²åï¼Œè‰æœ¨ç«¹çŸ³å‡å¯ä¸ºå‰‘â€ï¼Œä½•å…¶é›„å£®ï¼Œäººå®¶æœ‰å‚²è§†ç¾¤é›„çš„æœ¬äº‹çš„å•Šï¼Œè¿™å¢ƒç•Œå¤ªé«˜äº†ï¼Œæ²¡å‡ ä¸ªèƒ½è¾¾åˆ°çš„ã€‚</p><p>æˆ‘ä¸åå¯¹ä¸Šé¢çš„è§‚ç‚¹ï¼Œä½†æ˜¯é¡ºæ‰‹çš„å…µå™¨æ€»ä¹Ÿæ˜¯èƒ½ä¸ºå¹³åº¸çš„äººå¢æ·»æˆ˜æ–—åŠ›ï¼Œè¦ä¸ç„¶é‚£ä¹ˆå¤šäººå»æŠ¢å€šå¤©å‰‘ã€å± é¾™åˆ€ã€‚</p><p>åºŸè¯å¤ªå¤šäº†å“ˆã€‚ã€‚ã€‚ğŸ˜</p><p>ä½œä¸ºä¸€å¨ç¨‹åºçŒ¿ï¼Œæˆ‘æƒ³è¡¨è¾¾çš„æ„æ€æ˜¯æ‰“é€ è‡ªå·±æœ€è¶æ‰‹ï¼Œæœ€é€‚åˆè‡ªå·±å·¥ä½œçš„å·¥å…·â€”-è¦ä¸æ¢ä¸ªæ ‡é¢˜ï¼šMacOSç³»ç»Ÿä¸Šå¸¸ç”¨çš„è½¯ä»¶å’Œæ’ä»¶ã€‚</p><p>å…³é”®è¯ï¼šç¨‹åºçŒ¿ã€MacOS</p><p>æ‰€ä»¥æˆ‘è¦è¯´å¾®ä¿¡ï¼ŒQQä¹‹ç±»çš„ä¼°è®¡æ‚¨çš„ææˆ‘äº†ã€‚</p><p>å…ˆæ¨èä¸¤ä¸ªèµ„æºä¸‹è½½åœ°å€ï¼š</p><p><strong><a href="https://xclient.info/?t=b43ff20a95f7a8f8c2453e68b2650326403e6b99">xclient.info</a></strong><br><strong><a href="https://www.waitsun.com/">çˆ±æƒ…å®ˆæœ›è€…</a></strong></p><p><strong>å¿…å¤‡åº”ç”¨ï¼š</strong></p><ul><li>gitå®¢æˆ·ç«¯ï¼šgitKarkenï¼ŒsourceTree</li><li>æ¥å£æµ‹è¯•å·¥å…·ï¼špostman</li><li>ç¬”è®°å·¥å…·ï¼šä¸ºçŸ¥ç¬”è®°ï¼Œå°è±¡ç¬”è®°</li><li>IDEï¼šIntellij Ideaï¼ŒVS codeï¼ŒEmcas</li><li>markdownå†™ä½œå·¥å…·ï¼šTypora</li><li>ç¿»å¢™å®¢æˆ·ç«¯ï¼šShadowsocks</li><li>æ‰‹æœºæŠ•å±è½¯ä»¶ï¼šVysorï¼Œæœ‰è°·æ­Œæµè§ˆå™¨æ’ä»¶</li><li>ç¡¬ç›˜Uç›˜è¯»å†™è½¯ä»¶ï¼šTuxera Disk Manager</li></ul><h4 id="ä¸€äº›åœ¨çº¿å·¥å…·å’Œç½‘å€"><a href="#ä¸€äº›åœ¨çº¿å·¥å…·å’Œç½‘å€" class="headerlink" title="ä¸€äº›åœ¨çº¿å·¥å…·å’Œç½‘å€:"></a>ä¸€äº›åœ¨çº¿å·¥å…·å’Œç½‘å€:</h4><blockquote><p>å‘èµ·åœ¨çº¿é—®å·è°ƒæŸ¥ï¼š<a href="https://www.wenjuan.com/">https://www.wenjuan.com/</a><br>åœ¨çº¿å®šæ—¶ä»»åŠ¡æ‰§è¡Œå†™æ³•å·¥å…·ï¼š<a href="http://cron.qqe2.com/">http://cron.qqe2.com/</a><br>å›½é™…æ¨èä½¿ç”¨ï¼š<a href="https://cdnjs.com/">https://cdnjs.com/</a><br>ä¸‹è½½ç³»ç»ŸåŠå·¥å…·ï¼š<a href="http://msdn.itellyou.cn/">http://msdn.itellyou.cn</a><br>ä¼˜é›…é«˜æ•ˆçš„å…è´¹åœ¨çº¿APPåŸå‹å·¥å…· &nbsp;<a href="http://www.xiaopiu.com/">http://www.xiaopiu.com/</a><br>showdocæ–‡æ¡£å·¥å…·ï¼š<a href="https://www.showdoc.cc/web/#/">https://www.showdoc.cc/web/#/</a><br>å„ç§javaå·¥å…·ï¼š<a href="http://www.hutool.cn/">http://www.hutool.cn/</a><br>åœ¨çº¿æ— æŸå‹ç¼©å›¾ç‰‡ï¼š<a href="https://squoosh.app/">https://squoosh.app/</a><br>ç”ŸæˆçŸ­é“¾æ¥ï¼š<a href="http://www.surl.sinaapp.com/">http://www.surl.sinaapp.com/</a>&nbsp;&nbsp;&nbsp;<br>åœ¨çº¿å·¥å…·é›†åˆï¼š<a href="http://oktools.net/">http://oktools.net</a><br>åœ¨çº¿å·¥å…·é›†åˆ2 ï¼š<a href="http://www.atoolbox.net/">http://www.atoolbox.net</a><br>mockjs:&nbsp;<a href="http://mockjs.com/">http://mockjs.com/</a><br>lispé‡Œjsonè½¬edn/mapï¼š<a href="http://pschwarz.bicycle.io/json-to-edn/">http://pschwarz.bicycle.io/json-to-edn/</a></p></blockquote><h2 id="1-shellå®¢æˆ·ç«¯"><a href="#1-shellå®¢æˆ·ç«¯" class="headerlink" title="1. shellå®¢æˆ·ç«¯"></a>1. shellå®¢æˆ·ç«¯</h2><p>iterm2æˆªæ­¢ç›®å‰æœ€å–œæ¬¢çš„shellå®¢æˆ·ç«¯ï¼Œæ²¡æœ‰ä¹‹ä¸€ï¼Œä¹‹æ‰€ä»¥åŠ ä¸ªæˆªæ­¢ç›®å‰ï¼Œæ˜¯å› ä¸ºä»Šå¹´ç”¨emcasï¼Œéƒ½è¯´è¿™é‡Œé¢çš„shellä¹Ÿå¾ˆèµã€‚</p><p>åšåç«¯å¼€å‘ï¼Œç»å¸¸è¦å¿«é€Ÿè¿›å…¥æŸä¸€å°è¿œç«¯æœåŠ¡å™¨ï¼Œç„¶åçœ‹ä¸ªlogï¼Œæ”¹ä¸ªé…ç½®å•¥çš„ï¼Œè¿™æ—¶å€™iterm+sshpasså°±èƒ½è®©ä½ äº‹åŠåŠŸå€äº†ã€‚<br>å…³äºæ€ä¹ˆé…ï¼Œæ­¤å¤„ä¸å†ç»†è¯´ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">wget http://sourceforge.net/projects/sshpass/files/sshpass/1.05/sshpass-1.05.tar.gz  tar xvzf sshpass-1.05.tar.gz  cd sshpass-1.05./configure  make  make install  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¨èä¸¤ä¸ªç½‘å‹çš„æ°ä½œï¼Œä¸€ä¸ªå®‰è£…ï¼Œä¸€ä¸ªä½¿ç”¨ã€‚<br><a href="https://www.iteye.com/blog/tinyhema-2093795">macä¸‹ä½¿ç”¨sshpasså®ç°sshè®°ä½å¯†ç </a><br><a href="https://www.jianshu.com/p/ae7bf4086b0d">Macä¸‹ï¼Œä½¿ç”¨sshpassè®©iTerm2æ”¯æŒsshç™»å½•ä¿¡æ¯ä¿å­˜</a></p><p>å®‰è£…sshpassæœ‰é—®é¢˜çš„ç”¨æˆ·ï¼Œå¯ä»¥è¯•è¯•</p><pre class="line-numbers language-shell"><code class="language-shell">brew install https://raw.githubusercontent.com/kadwanev/bigboybrew/master/Library/Formula/sshpass.rbUpdating Homebrew...Warning: Calling Non-checksummed download of sshpass formula file from an arbitrary URL is deprecated! Use 'brew extract' or 'brew create' and 'brew tap-new' to create a formula file in a tap on GitHub instead.######################################################################## 100.0%==> Downloading http://sourceforge.net/projects/sshpass/files/sshpass/1.06/sshpass-1.06.tar.gz==> Downloading from https://netcologne.dl.sourceforge.net/project/sshpass/sshpass/1.06/sshpass-1.06.tar.gz######################################################################## 100.0%==> ./configure --prefix=/usr/local/Cellar/sshpass/1.06==> make installğŸº  /usr/local/Cellar/sshpass/1.06: 9 files, 45.8KB, built in 9 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®‰è£…æˆåŠŸã€‚</p><p>itermé‡Œå¦ä¸€ä¸ªä¸å¾—ä¸ç”¨çš„æ˜¯<code>Zsh</code>å’Œ<code>Oh My Zsh</code>å®¶åº­å¥—é¤ï¼Œç‚¹åˆ°ä¸ºæ­¢ï¼Œç½‘ä¸Šä¸€æœä¸€å¤§æŠŠï¼Œé€‰ä¸ªè‡ªå·±å–œæ¬¢çš„themeç”¨å°±è¡Œäº†ã€‚</p><p>iterm2çš„profilesé‡Œæ‰§è¡Œä¸€ä¸ªç™»å½•çš„å‘½ä»¤</p><pre class="line-numbers language-shell"><code class="language-shell">/usr/local/bin/sshpass -f /Users/mahaiqiang/Documents/sshpass/<file_name> ssh -p<port> marvin@ip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>file_name åªå­˜å‚¨è¿™ä¸ªipå¯¹åº”çš„ç”¨æˆ·ç™»å½•å¯†ç ï¼Œè€Œä¸”æ–‡ä»¶æ²¡æœ‰åç¼€ã€‚</p><p>å¦‚æœæ²¡æœ‰å®‰è£…æˆåŠŸsshpassï¼Œä¹Ÿå¯ä»¥ç”¨itermçš„å‘½ä»¤è¡Œæ¨¡å¼ï¼Œæ‰§è¡Œä¸€ä¸ªshellè„šæœ¬ï¼Œè„šæœ¬çš„å†…å®¹å¯èƒ½è£å¹¸</p><pre class="line-numbers language-shell"><code class="language-shell">#!/usr/bin/expect -fset user <user-name>set host <ip>set password <password>set port <port>set timeout -1spawn ssh -p $port $user@$hostexpect "*assword:*"send "$password\r"interactexpect eof<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Highèµ·æ¥å§</p><ul><li>2020-10-04<br>json_ppï¼Œjson_pp æˆ‘ä¸»è¦æ˜¯ç”¨æ¥æ ¼å¼åŒ– curl å‘½ä»¤è¡Œçš„ç»“æœï¼Œä¾‹å¦‚æµ‹è¯•æŸä¸ª restful æ¥å£ï¼Œè¿”å›çš„ jsonï¼Œåœ¨å‘½ä»¤è¡Œå°±ä¼šè‡ªåŠ¨ç»™ä½ æ ¼å¼åŒ–å¥½è¾“å‡ºï¼Œjson_pp å®‰è£…ï¼š<code>brew install jsonpp</code></li></ul><h2 id="2-Navicat-Permium"><a href="#2-Navicat-Permium" class="headerlink" title="2. Navicat Permium"></a>2. Navicat Permium</h2><p><a href="https://navicat.com.cn/products/navicat-premium">Navicat Premium </a>æ˜¯ä¸€å¥—æ•°æ®åº“å¼€å‘å·¥å…·ï¼Œè®©ä½ ä»å•ä¸€åº”ç”¨ç¨‹åºä¸­åŒæ—¶è¿æ¥ MySQLã€MariaDBã€MongoDBã€SQL Serverã€Oracleã€PostgreSQL å’Œ SQLite æ•°æ®åº“ã€‚å®ƒä¸ Amazon RDSã€Amazon Auroraã€Amazon Redshiftã€Microsoft Azureã€Oracle Cloudã€MongoDB Atlasã€é˜¿é‡Œäº‘ã€è…¾è®¯äº‘å’Œåä¸ºäº‘ç­‰äº‘æ•°æ®åº“å…¼å®¹ã€‚ä½ å¯ä»¥å¿«é€Ÿè½»æ¾åœ°åˆ›å»ºã€ç®¡ç†å’Œç»´æŠ¤æ•°æ®åº“ã€‚</p><p>æ•°æ®åº“å·¥å…·åœ¨Macä¸Šæˆ‘æ¯”è¾ƒé’Ÿæƒ…è¿™æ¬¾ï¼Œå¯¼å…¥å¯¼å‡ºéƒ½å¾ˆæ–¹ä¾¿ï¼Œå…¶ä»–ä¸æ¨èã€‚ä¸è¦è¯´ä¸æ˜¯å…è´¹ç‰ˆï¼Œæˆ‘ç›¸ä¿¡ä½ ä¸€å®šæœ‰åŠæ³•å…è´¹ï¼Œè€Œä¸”ä½ è¿˜èƒ½æä¸ªæ±‰åŒ–ç‰ˆã€‚</p><p>åœ¨Windowsæˆ‘ç”¨çš„æœ€å¤š<a href="https://www.heidisql.com/">HeidiSQL</a>ï¼Œè½»é‡çº§ï¼Œéå¸¸ç¨³å®šçš„æ•°æ®åº“å®¢æˆ·ç«¯ã€‚æ˜¯å¯æƒœæ²¡æœ‰macç‰ˆã€‚</p><h2 id="3-transmit"><a href="#3-transmit" class="headerlink" title="3. transmit"></a>3. transmit</h2><p>ç›¸åŒåŠŸèƒ½çš„æˆ‘è¿˜ç”¨è¿‡çš„filezillaå’ŒWinScpï¼Œä½†æ˜¯ä»ä½“éªŒå’Œè§†è§‰ä¸Šæ¥è¯´ï¼Œæˆ‘æ›´å–œæ¬¢transmitï¼Œç®€æ´ç›´è§‚</p><p><img src="/loading.gif" data-original="/images/mac/transmit.png" alt="transmit"></p><h2 id="4-tinyCal"><a href="#4-tinyCal" class="headerlink" title="4. tinyCal"></a>4. tinyCal</h2><p>è¿™ä¸ªå°æ—¥å†å¯äº†ä¸å¾—ï¼Œè¯•å›¾æ¯”macè‡ªå¸¦çš„æ—¥å†å°ï¼Œä½†æ˜¯åˆæ¯”macçŠ¶æ€æ ä¸Šé‚£ä¸ªè¿˜ä¸å¦‚æ²¡æœ‰æ—¥å†è¡¨å¥½ã€‚æˆªå›¾å¦‚ä¸‹ï¼š</p><p><img src="/loading.gif" data-original="/images/mac/tinyCal.png" alt="transmit"></p><p>è¿˜æœ‰å†œå†ï¼Œçœ‹ç€ä¸é”™å§ï¼Œåœ¨è®¾ç½®ä¸ªå¼€æœºè‡ªå¯ï¼Œç³»ç»Ÿè‡ªå¸¦çš„å¯ä»¥å…³é—­äº†ã€‚</p><h2 id="5-Alfred"><a href="#5-Alfred" class="headerlink" title="5. Alfred"></a>5. Alfred</h2><p>è¿™ä¸ªæ˜¯åœ¨å»å¹´åœ¨æµ·å°”ä¸€èµ·å·¥ä½œçš„å°å”åŒå­¦é‚£é‡Œçœ‹æ¥çš„ï¼Œç›´æ¥æŠ„ä¸€ä¸‹åŸåˆ›ï¼š<br>Alfredä½œä¸ºè€ç‰Œæ•ˆç‡ç¥å™¨ï¼Œç½‘ä¸Šå¾ˆå¤šå¸–å­éƒ½å·²ç»åšè¿‡ä»‹ç»ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹Alfredçš„å‰ªè´´æ¿ã€‚</p><p>[ç«™å¤–å›¾ç‰‡ä¸Šä¼ ä¸­â€¦(image-2652a3-1572691340926)]<br>Alfredçš„å‰ªè´´æ¿å¯ä»¥ä¿å­˜æœ€è¿‘å‡ å¤©ä½äºç³»ç»Ÿå‰ªè´´æ¿çš„æ‰€æœ‰å†…å®¹ã€‚å› æ­¤å¦‚æœå½“é”®å…¥å‘½ä»¤æ—¶ï¼Œçªç„¶æƒ³èµ·æ¥è¿™ä¸ªå‘½ä»¤æˆ‘æ˜¨å¤©å¥½åƒå¤åˆ¶è¿‡ï¼Œé‚£å°±å¯ä»¥ç›´æ¥è°ƒå‡ºæ¥ï¼Œè´´è¿›å‘½ä»¤è¡Œå³å¯ã€‚</p><p>è¿™æ¬¾ç¥å™¨å¯æ˜¯<a href="https://github.com/hzlzh/Best-App">Best-App</a>æ’è¡ŒNO.1çš„ï¼Œå¯è§ä¸€æ–‘ã€‚</p><p>ä½¿ç”¨æ•™ç¨‹ï¼š<a href="https://www.jianshu.com/p/e9f3352c785f">5åˆ†é’Ÿä¸Šæ‰‹Macæ•ˆç‡ç¥å™¨Alfredä»¥åŠAlfredå¸¸ç”¨æ“ä½œ</a></p><h2 id="6-LICECap-æ•æ‰å±å¹•ç”ŸæˆGIF"><a href="#6-LICECap-æ•æ‰å±å¹•ç”ŸæˆGIF" class="headerlink" title="6. LICECap æ•æ‰å±å¹•ç”ŸæˆGIF"></a>6. LICECap æ•æ‰å±å¹•ç”ŸæˆGIF</h2><pre class="line-numbers language-shell"><code class="language-shell">brew cask install LICECap<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç›¸å¯¹åº”çš„æˆªå›¾è½¯ä»¶æ¨è<a href="https://zh.xnipapp.com/">xnipapp</a>ä¸€æ¬¾å…è´¹çš„æˆªå›¾è½¯ä»¶ï¼Œè¿˜æ”¯æŒæ»šåŠ¨æˆªå›¾ï¼Œç¦»çº¿æ“ä½œã€‚</p><h2 id="7-Recorder-it"><a href="#7-Recorder-it" class="headerlink" title="7. Recorder it"></a>7. Recorder it</h2><p>å±å¹•å½•åˆ¶è½¯ä»¶ï¼Œå¯ä»¥åœ¨xclient.infoä¸Šä¸‹è½½åˆ°ã€‚</p><h2 id="8-keycastr-æ˜¾ç¤ºå¿«æ·é”®"><a href="#8-keycastr-æ˜¾ç¤ºå¿«æ·é”®" class="headerlink" title="8. keycastr æ˜¾ç¤ºå¿«æ·é”®"></a>8. keycastr æ˜¾ç¤ºå¿«æ·é”®</h2><p>åœ¨ä½ æƒ³åšä¸€ä¸ªæ•™ç¨‹æ—¶ï¼Œä¸ç®¡æ˜¯gifäº†ï¼Œè¿˜æ˜¯å½•å±äº†ï¼Œä½ æˆ–è®¸åœ¨å†¥æ€è‹¦æƒ³åˆ°åº•æ€ä¹ˆè§£é‡Šæˆ‘åœ¨é”®ç›˜ä¸ŠæŒ‰äº†å•¥ï¼Œè¿™å›ä¸ç”¨è§£é‡Šäº†ï¼Œä½ æŒ‰äº†å•¥æœ‰è½¯ä»¶å¸®ä½ æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œç®€å•æ˜äº†ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">brew cask install keycastr<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/mac/keycastr.png" alt="keycastr"></p><p>é…åˆä¸Šç”Ÿæˆgifæä¸ªå°æ•™ç¨‹ç®€ç›´ä¸è¦å¤ªçˆ½ã€‚</p><h2 id="9-ssh-tunnel"><a href="#9-ssh-tunnel" class="headerlink" title="9. ssh tunnel"></a>9. ssh tunnel</h2><p>å†å¤åˆ¶å°å”åŒå­¦æ¨èçš„ä¸€ä¸ªç¥å™¨ssh tunnelã€‚</p><h4 id="åœºæ™¯ï¼š"><a href="#åœºæ™¯ï¼š" class="headerlink" title="åœºæ™¯ï¼š"></a>åœºæ™¯ï¼š</h4><p>æˆ‘ä»¬éœ€è¦æ­å»ºå¼€å‘ç¯å¢ƒï¼Œä½¿å¾—æœ¬åœ°çš„web server/api server èƒ½å¤Ÿè®¿é—®ä½äºäº‘æœåŠ¡å™¨ä¸Šå±€åŸŸç½‘ç¯å¢ƒä¸­çš„æ•°æ®åº“ï¼Œä¾‹å¦‚ç™¾åº¦äº‘æä¾›çš„æ•°æ®åº“æœåŠ¡ã€‚è¿™äº›æ•°æ®åº“æœåŠ¡å™¨å¯ä»¥åœ¨ç™¾åº¦äº‘çš„æœºå™¨ä¸Šç›´æ¥è®¿é—®ï¼Œè€Œä¸èƒ½åœ¨å…¬ç½‘ç¯å¢ƒä¸‹é€šè¿‡å…¬ç½‘ipè®¿é—®ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨ç™¾åº¦äº‘çš„æ™®é€šserverå»ºä¸€ä¸ªtunnelï¼Œä»è€Œå®ç°æ•°æ®è®¿é—®ã€‚åœ¨xshellä¸­ä¹Ÿæœ‰ç±»ä¼¼åŠŸèƒ½ï¼Œä¸­æ–‡ç¿»è¯‘åšï¼šéš§é“ã€‚</p><h4 id="ç•Œé¢å±•ç¤ºï¼š"><a href="#ç•Œé¢å±•ç¤ºï¼š" class="headerlink" title="ç•Œé¢å±•ç¤ºï¼š"></a>ç•Œé¢å±•ç¤ºï¼š</h4><p><img src="/loading.gif" data-original="/images/mac/ssh-tunnel.png" alt="keycastr"></p><p>å¦‚å›¾ä¾¿æ˜¯å»ºç«‹äº†ä¸‰ä¸ªtunnelï¼Œåˆ†åˆ«è¿å‘äº†ä¸¤ä¸ªå…³ç³»å‹æ•°æ®åº“æœåŠ¡å™¨å’Œä¸€ä¸ªredisæœåŠ¡å™¨ã€‚<br>ä¸¾ä¾‹æ¥è¯´ç¬¬ä¸€æ¡éš§é“è¿æ¥ï¼Œä½¿ç”¨æ—¶çš„è®¿é—®æ–¹æ³•ï¼Œå°±æ˜¯ç›´æ¥localhost:13306å³å¯ã€‚<br>å½“ç„¶ï¼Œç›´æ¥ç”¨sshå‘½ä»¤ä¹Ÿå¯è§£å†³ï¼Œä½†éº»çƒ¦ä¸æ˜¯ã€‚ç¨‹åºå‘˜å°±åº”è¯¥èƒ½å·æ‡’çš„æ—¶å€™å°½å¯èƒ½å·æ‡’ï¼Œç¾å…¶åæ›°ï¼šè§£æ”¾å’Œå‘å±•ç”Ÿäº§åŠ›~<br>å‘½ä»¤è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">ssh -CfNg -L 16306:postgresql94.rd*****lwr2zr.rds.bj.baidubce.com:3306 root@180.***.***.189<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŸä½œè€…ï¼š<a href="https://www.jianshu.com/p/e0b96caa3e7c">tangxqa</a></p><h2 id="10-PicGo"><a href="#10-PicGo" class="headerlink" title="10. PicGo"></a>10. PicGo</h2><p><a href="https://github.com/Molunerfinn/PicGo">å›¾åºŠ</a>ï¼Œä¸Šä¼ å›¾ç‰‡åç›´æ¥å°†å¤åˆ¶å¤åˆ¶åˆ°äº†ç²˜è´´æ¿ï¼Œéå¸¸æ–¹ä¾¿ï¼Œå°¤å…¶è¦å†™markdown<br><img src="/loading.gif" data-original="/images/mac/PicGo.png" alt="PicGo"></p><pre class="line-numbers language-shell"><code class="language-shell">brew cask install PicGo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœå¸¸å†™markdownçš„è¯ï¼Œç»å¯¹æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œè°è¿˜æ¯ä¸ªgithubè´¦å·ï¼Œåˆç†ä½¿ç”¨èµ„æºå°±è¡Œäº†ï¼Œå›¾ç‰‡æ‹–è¿›ä¸Šä¼ åŒºï¼Œç›´æ¥å°±èƒ½è¿”å›æ¥ä¸ªmarkdownçš„åœ°å€æ”¾åˆ°ç²˜è´´æ¿é‡Œäº†ã€‚è‡³äºæ€ä¹ˆåˆ©ç”¨githubåšå›¾åºŠè‡ªè¡Œgoogleä¸‹ã€‚</p><h2 id="11-CharlesæŠ“åŒ…å·¥å…·"><a href="#11-CharlesæŠ“åŒ…å·¥å…·" class="headerlink" title="11. CharlesæŠ“åŒ…å·¥å…·"></a>11. CharlesæŠ“åŒ…å·¥å…·</h2><p><a href="http://www.charlesproxy.com/">Charles</a>æ˜¯ä¸€æ¬¾æŠ“åŒ…ä»£ç†è°ƒè¯•å·¥å…·ã€ç±» Fiddlerã€‚<br>iosç³»ç»Ÿæ‰‹æœºä¸Šæœ‰ä¸€æ¬¾æŠ“åŒ…ç¥å™¨ï¼šstream<br>å®‰å“æ‰‹æœºä¸Šä¸€èˆ¬ç”¨ï¼šPacket Captureï¼Œæˆ–è€…æŠ“åŒ…ç²¾çµ</p><h2 id="12-å†…ç½‘ç©¿é€å·¥å…·"><a href="#12-å†…ç½‘ç©¿é€å·¥å…·" class="headerlink" title="12. å†…ç½‘ç©¿é€å·¥å…·"></a>12. å†…ç½‘ç©¿é€å·¥å…·</h2><p>è¿™ä¸ªä¸œè¥¿ä¸å¸¸ç”¨ï¼Œä½†æ˜¯å¦‚æœä¸çŸ¥é“è¿˜æœ‰ä¸ªè¿™ä¹ˆä¸ªç©æ„å„¿é‚£å°±æœ‰ç‚¹lowäº†ã€‚<br>æˆ‘ç”¨è¿‡serveoå’Œngrokï¼Œngrokç›¸å¯¹ç¨³å®šï¼Œä½†æ˜¯ä½¿ç”¨ä¾¿æ·æ€§èµ¶ä¸ä¸Šä»€ä¹ˆéƒ½ä¸ç”¨serveoä¸€å¥å‘½ä»¤çš„å¿«ã€‚<br>æˆ‘çš„ä¸¤ä¸ªæ€»ç»“ï¼š<br><a href="https://www.jianshu.com/p/57485240708c">ä½¿ç”¨serveoä¸€ç§’é’Ÿå®ç°å†…ç½‘ç©¿é€</a><br><a href="https://www.jianshu.com/p/4f008e2b7622">ä½¿ç”¨ngrokä¸€åˆ†é’Ÿå®ç°å†…ç½‘ç©¿é€</a></p><h2 id="13-ä¸ºçŸ¥ç¬”è®°-å°è±¡ç¬”è®°"><a href="#13-ä¸ºçŸ¥ç¬”è®°-å°è±¡ç¬”è®°" class="headerlink" title="13. ä¸ºçŸ¥ç¬”è®°|å°è±¡ç¬”è®°"></a>13. ä¸ºçŸ¥ç¬”è®°|å°è±¡ç¬”è®°</h2><p>æœ‰æ—¶å€™ä½ ä¼šæœ‰ä¸¤å°ç”µè„‘ï¼Œæˆ–è€…éœ€è¦ç”¨ç§»åŠ¨ç«¯çœ‹çœ‹æ›¾ç»æŠ¥é”™çš„ä¸€äº›æœ‰æ•ˆèµ„æºï¼Œè¿™æ—¶å€™å¦‚æœæ²¡æœ‰ä¸ªäº‘ç¬”è®°ï¼Œæœ‰ç‚¹è¯´ä¸è¿‡å»äº†ï¼Œè€Œä¸”è¿™ç§ç¬”è®°ä¸ç®¡æ˜¯ä¿å­˜è‡ªå·±çš„ä¸œè¥¿ï¼Œè¿˜å¯ä»¥é€šè¿‡googleæµè§ˆå™¨æ’ä»¶å¿«é€Ÿæ”¶è—ç½‘é¡µï¼Œå°†æŸ<br>ä¸€ç¯‡åšå®¢å‰ªåˆ‡æˆè‡ªå·±çš„ä¸œè¥¿ç¬”è®°ã€‚</p><p><img src="/loading.gif" data-original="/images/mac/Wiz.png" alt="ä¸ºçŸ¥ç¬”è®°"></p><h2 id="14-Parallelsè™šæ‹Ÿæœºç¥å™¨"><a href="#14-Parallelsè™šæ‹Ÿæœºç¥å™¨" class="headerlink" title="14. Parallelsè™šæ‹Ÿæœºç¥å™¨"></a>14. Parallelsè™šæ‹Ÿæœºç¥å™¨</h2><p>å¸¦ä½ é£~</p><h2 id="15-LogTail-æ—¥å¿—ç›‘æ§æŸ¥çœ‹å·¥å…·"><a href="#15-LogTail-æ—¥å¿—ç›‘æ§æŸ¥çœ‹å·¥å…·" class="headerlink" title="15. LogTail æ—¥å¿—ç›‘æ§æŸ¥çœ‹å·¥å…·"></a>15. LogTail æ—¥å¿—ç›‘æ§æŸ¥çœ‹å·¥å…·</h2><p>å‰é¢è¯´åˆ°çš„itermé…åˆsshpassç™»å½•åˆ°æœåŠ¡å™¨ä¸æ˜¯ä¸ªå•¥é—®é¢˜äº†ï¼Œä½†æ˜¯æœ€è¿‘ç”¨çš„ä¸ç®¡æ˜¯é˜¿é‡Œäº‘å’Œç™¾åº¦äº‘çš„ECSï¼Œåœ¨ç»ˆç«¯è¿æ¥ä¸€ä¼šå„¿åå°±ä¼šè‡ªåŠ¨æ–­å¼€ï¼Œè€Œä¸”æˆ‘ä¹Ÿä¸çŸ¥é“å’‹æï¼Œå°±ç®—æ˜¯tail äº†ï¼Œä¸€ä¼šå„¿æ²¡æœ‰åŠ¨å°±è‡ªå·±æ–­å¼€äº†ï¼Œéå¸¸ç³Ÿå¿ƒã€‚</p><p>ä»Šå¤©ç»ˆäºæ‰¾åˆ°äº†ä¸€æ¬¾æˆ‘ä¼—é‡Œå¯»ä»–åƒç™¾åº¦çš„logtailï¼Œæˆ‘ç®€ç›´çˆ±æ­»ä»–äº†ï¼ŒæŸ¥çœ‹äº‘æœåŠ¡å™¨æ—¥å¿—å±…ç„¶è¿˜æœ‰è¿™ä¹ˆä¸ªç©æ„å„¿ï¼Œç®€ç›´ç¥å™¨å•Šï¼Œæ¥ä¸¤å¼ å›¾çœ‹çœ‹ï¼š<br><img src="/loading.gif" data-original="/images/mac/LogTail.png" alt="æˆ‘æ”¶è—çš„æ ‡ç­¾"></p><p><img src="/loading.gif" data-original="/images/mac/LogTail2.png" alt="æ»šåŠ¨æ—¶è‡ªåŠ¨å¼€å§‹/åœæ­¢tail"></p><p><img src="/loading.gif" data-original="/images/mac/LogTail3.png" alt="æ ‡ç­¾åŠŸèƒ½"></p><p>æœ‰äº†å®ƒæœåŠ¡å™¨ä¸Šçš„æ—¥å¿—å°±ä¸éœ€è¦æ­å»ºç±»ä¼¼ELKæˆ–è€…EFKç¯å¢ƒäº†ã€‚</p><h2 id="16-mpvï¼šä¸€ä¸ªé«˜å¯é…çš„ç¨‹åºçŒ¿ä¸“ç”¨è§†é¢‘æ’­æ”¾å™¨"><a href="#16-mpvï¼šä¸€ä¸ªé«˜å¯é…çš„ç¨‹åºçŒ¿ä¸“ç”¨è§†é¢‘æ’­æ”¾å™¨" class="headerlink" title="16. mpvï¼šä¸€ä¸ªé«˜å¯é…çš„ç¨‹åºçŒ¿ä¸“ç”¨è§†é¢‘æ’­æ”¾å™¨"></a>16. <a href="https://mpv.io/">mpv</a>ï¼šä¸€ä¸ªé«˜å¯é…çš„ç¨‹åºçŒ¿ä¸“ç”¨è§†é¢‘æ’­æ”¾å™¨</h2><p>å®‰è£…ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">brew cask install mpv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ˜¯ä¸€æ¬¾ä¸€ä¸ªè·¨å¹³å°ã€ç®€æ´ã€å¼€æºã€å…è´¹ã€ä¸”æ€§èƒ½å’ŒåŠŸèƒ½å…¼å¤‡ä¸‡èƒ½è§†é¢‘æ’­æ”¾å™¨ã€‚MPV æ˜¯ä¸€ä¸ªåŸºäº MPlayer å’Œ mplayer2 çš„å¼€æºæç®€å…¨èƒ½æ’­æ”¾å™¨ã€‚æ”¯æŒå„ç§è§†é¢‘æ ¼å¼ã€éŸ³é¢‘è§£ç ã€æ”¯æŒç‰¹æ•ˆå­—å¹•ï¼ˆç”µå½±åŠ¨æ¼«çš„assç‰¹æ•ˆå­—å¹•éƒ½æ²¡å•¥é—®é¢˜ï¼‰ï¼Œä¸ä»…æ”¯æŒæœ¬åœ°æ’­æ”¾ï¼ŒåŒæ ·æ”¯æŒç½‘ç»œæ’­æ”¾ã€‚é‡ç‚¹æ˜¯ MPV å…·æœ‰å¤šç³»ç»Ÿå¹³å°æ”¯æŒã€å‘½ä»¤è¡Œã€è‡ªå®šä¹‰ã€GPU è§£ç ã€è„šæœ¬æ”¯æŒç­‰ç‰¹ç‚¹â€¦â€¦</p><p><a href="https://www.iplaysoft.com/mpv.html">çœ‹è¿™ç¯‡ä»‹ç»</a></p><h2 id="17-Moom"><a href="#17-Moom" class="headerlink" title="17 Moom"></a>17 Moom</h2><p>æˆ–è®¸æœ‰è®¸å¤šäººå’Œå°ç¼–ä¸€æ ·ï¼Œæ„Ÿè§‰Mac OSåœ¨ä½¿ç”¨æ—¶å„ç§éƒ½å¾ˆå¥½ç”¨ï¼Œä½†æ˜¯å°±æ˜¯å¯¹äºçª—å£å¤§å°çš„è°ƒæ•´éœ€è¦ç”¨é¼ æ ‡å»æ‹–åŠ¨å¤§å°ä¸æ»¡æ„ã€‚</p><p>  é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§æ›´ä¸ºå¿«é€Ÿçš„æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ è¿…é€Ÿçš„æœ€å¤§åŒ–ã€æœ€å°åŒ–å„ç§çª—å£ï¼Œç”šè‡³å’ŒWIN10ç³»ç»Ÿä¸€æ ·åšåˆ°å·¦å³å¯¹åŠåˆ†é…ä¸¤ä¸ªçª—å£å‘¢ï¼Ÿå½“ç„¶æœ‰ï¼åªéœ€è¦åœ¨ä½ çš„Macä¸Šå®‰è£…Moomè¿™ä¸€æ¬¾å°è½¯ä»¶å³å¯å®ç°ã€‚</p><p>Moomæ˜¯è‹¹æœoså¹³å°ä¸Šä¼˜ç§€çš„çª—å£ç®¡ç†å·¥å…·ï¼Œå¯ä»¥å¿«é€Ÿä¿®æ”¹å½“å‰çª—å£çš„å¤§å°å¹¶æ”¾ç½®åœ¨æŒ‡å®šä½ç½®ï¼Œé»˜è®¤æƒ…å†µä¸‹æ‹¥æœ‰äº”ç§å°ºå¯¸å¯é€‰ï¼Œå•å‡»é€‰é¡¹å³å¯æ›´æ”¹çª—å£å¤§å°ï¼Œå¦‚æœ€å¤§åŒ–ï¼Œç§»åŠ¨åˆ°å·¦è¾¹ã€å³è¾¹ç­‰æ“ä½œï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰çª—å£ï¼Œè®©ç”¨æˆ·å¯ä»¥æ›´å¥½çš„æŸ¥çœ‹macä¸Šçš„å†…å®¹ã€‚<br><img src="/loading.gif" data-original="/images/mac/Moom.png" alt="moom"></p><h2 id="18-PopClip"><a href="#18-PopClip" class="headerlink" title="18. PopClip"></a>18. PopClip</h2><p>ä¸€æ¬¾åœ¨ Mac ä¸Šäººå°½çš†çŸ¥çš„å°å·¥å…·ï¼Œå®ƒç®€å•é«˜æ•ˆï¼Œå…·æœ‰å¼ºå¤§çš„æ‹“å±•åŠŸèƒ½ï¼ŒPopClip æœ€åŸºæœ¬çš„åŠŸèƒ½å³ç”¨é¼ æ ‡é€‰ä¸­ä¸€æ®µæ–‡å­—å°±å¯ä»¥åšå¤åˆ¶ç²˜è´´çš„åŠ¨ä½œï¼Œçœå»äº†æˆ‘ä»¬å¹³æ—¶ Command+C or V çš„éº»çƒ¦ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå†æ— æ‹“å±•æ”¯æŒçš„æƒ…å†µä¸‹ï¼Œæ ¹æ®é¼ æ ‡é€‰ä¸­çš„å†…å®¹ï¼ŒPopClip è¿˜è‡ªèº«æ”¯æŒé“¾æ¥çš„è·³è½¬æ‰“å¼€ã€è‡ªå¸¦è¯å…¸çš„ç¿»è¯‘ã€é‚®ä»¶åœ°å€è·³è½¬ã€æœç´¢å¼•æ“æœç´¢ã€å•è¯çº æ­£ç­‰åŠŸèƒ½ï¼Œä½†è¿™ä¸ªå·¥å…·çœŸæ­£å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒçš„æ‹“å±•åŠŸèƒ½çš„ä½¿ç”¨å“¦ã€‚<br><img src="/loading.gif" data-original="/images/mac/PopClip.png" alt="PopClip"></p><h2 id="19-Beyond-Compare"><a href="#19-Beyond-Compare" class="headerlink" title="19. Beyond Compare"></a>19. Beyond Compare</h2><p>åœ¨<a href="https://macwk.com/soft/beyond-compare">macwk</a>ä¸‹è½½çš„beyond compareç›´æ¥æ˜¯ç ´è§£ç‰ˆå‘¢ï¼Œè¿™ä¸ªå·¥å…·æ˜¯æˆ‘åœ¨windowsä¸€ç›´ä½¿ç”¨çš„å·¥å…·ï¼Œåœ¨macä¸Šç°åœ¨ä¹Ÿæœ‰äº†ï¼Œå¯ä»¥å¯¹æ¯”æ•´ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿™ä¸€ç‚¹éå¸¸æ£’ï¼ŒğŸ‘ï¼Œæ¨èä¸€ä¸‹ã€‚<br><img src="/loading.gif" data-original="/images/mac/BeyondCompare.jpg" alt="Beyond Compare"><br><img src="/loading.gif" data-original="/images/mac/BeyondCompare2.jpg" alt="Beyond Compare"></p><h1 id="å°æ’ä»¶"><a href="#å°æ’ä»¶" class="headerlink" title="å°æ’ä»¶"></a>å°æ’ä»¶</h1><ol><li><p>Bartender<br>å±•å¼€å’Œæ”¶ç¼©çŠ¶æ€æ <br><img src="/loading.gif" data-original="/images/mac/Bartender.png" alt="Bartender"></p></li><li><p>å¤–æ¥2Kæ˜¾ç¤ºå™¨æ— æ³•å¼€å¯hign dpiæ—¶çš„å¤„ç†</p></li></ol><p>å¼€å¯æ•™ç¨‹ï¼š<a href="https://bbs.feng.com/forum.php?mod=viewthread&amp;tid=11669269&amp;page=1">https://bbs.feng.com/forum.php?mod=viewthread&amp;tid=11669269&amp;page=1</a><br>ç”¨åˆ°çš„ä¸‰ä¸ªè½¯ä»¶ï¼š</p><p><img src="/loading.gif" data-original="/images/mac/higndpi.png" alt="hign dpi"></p><p>è®¾ç½®å®Œæˆä¹‹åï¼Œåœ¨å¤–æ¥æ˜¾ç¤ºå™¨ä¹Ÿå¯ä»¥çœ‹åˆ°hign dpiçš„é€‰é¡¹ï¼š</p><p><img src="/loading.gif" data-original="/images/mac/higndpi2.png" alt="hign dpi"></p><ol start="3"><li>Go2Shell<br>åœ¨è®¿è¾¾é‡Œå¢åŠ ä¸€ä¸ªæ‰“å¼€å‘½ä»¤è¡Œçš„å¿«æ·å…¥å£ï¼Œå¿«é€Ÿè¿›å…¥å‘½ä»¤è¡Œ<br><img src="/loading.gif" data-original="/images/mac/Go2Shell.png" alt="Go2Shell1"></li></ol><p>è¿˜å¯ä»¥è®¾ç½®åœ¨å“ªæ‰“å¼€<br><img src="/loading.gif" data-original="/images/mac/Go2Shell2.png" alt="Go2Shell2"></p><ol start="4"><li><p>FeHelper<br>ä¸€æ¬¾è°·æ­Œæµè§ˆå™¨æ’ä»¶ï¼Œä¸»è¦æ˜¯å…è´¹çš„å·¥å…·é›†åˆã€‚<br><img src="/loading.gif" data-original="/images/mac/FeHelper.png" alt="FeHelper"></p></li><li><p>Octotree<br>è¿™åˆæ˜¯ä¸€æ¬¾chromeæ’ä»¶ï¼Œèƒ½å°†githubé¡¹ç›®åœ¨å·¦ä¾§è¾¹æ ä»¥ç›®å½•æ ‘å½¢ç»“æ„å±•ç¤ºã€‚è®©ä½ æ›´ç›´è§‚åœ°æ„Ÿå—è‡ªå·±æˆ–åˆ«äººçš„é¡¹ç›®ã€‚æ„Ÿè°¢@æœ‹å‹ä½ çš„å­¦ç”Ÿå¡æ‰äº† åŒå­¦çš„æ¨è<br><img src="/loading.gif" data-original="/images/mac/Octotree.png" alt="Octotree"></p></li><li><p>WeChatPlugin mac<br>macå¾®ä¿¡åŠ©æ‰‹ï¼Œ<a href="https://www.jianshu.com/p/b6ecd2c3c1dd">macå¾®ä¿¡åŠ©æ‰‹ï¼ŒåŠŸèƒ½å…¨æ–°å‡çº§</a>ï¼Œæœ‰å¾ˆå¤šæ¯”å¦‚æ¶ˆæ¯é˜²æ’¤å›ã€è¿œç¨‹æ§åˆ¶(å·²æ”¯æŒè¯­éŸ³)ã€å¾®ä¿¡å¤šå¼€ã€ç¬¬äºŒæ¬¡ç™»å½•å…è®¤è¯ç­‰ç­‰çš„åŠŸèƒ½ã€‚</p></li></ol><h2 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h2><p><a href="https://www.jianshu.com/p/65cec2a1055d">å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨-ç¨‹åºå‘˜å·¥å…·æ¨è</a><br><a href="https://www.macdown.com/news/3644.html">æ­£æ˜¯æœ‰äº†è¿™äº›ç¥å™¨ï¼Œè®©æˆ‘å†ä¹Ÿç¦»ä¸å¼€Macï¼</a></p>]]></content>
      
      
      <categories>
          
          <category> mac </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mac </tag>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰å“æœ‰çº¿æ— çº¿æŠ•å±ç¥å™¨---scrcpy</title>
      <link href="2020/09/28/an-zhuo-you-xian-wu-xian-tou-ping-shen-qi-scrcpy/"/>
      <url>2020/09/28/an-zhuo-you-xian-wu-xian-tou-ping-shen-qi-scrcpy/</url>
      
        <content type="html"><![CDATA[<p>ä¸€æ¬¾æœ€ç®€å•ï¼Œåˆ‡PCä¸Šå¯ä»¥æ“ä½œç§»åŠ¨è®¾å¤‡çš„å®‰å“æŠ•å±è½¯ä»¶ï¼ŒåŸºäºadbå®ç°<br><a href="https://www.jianshu.com/p/04bdcf8a09b9">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ç”¨è¿‡syncï¼Œç”¨è¿‡å…è´¹çš„è½¯ä»¶<a href="https://letsview.com/zh/">å¹•äº«</a>ï¼Œæœ€åå‘ç°å“ªä¸€æ¬¾ä¹Ÿæ²¡æœ‰scrcpyå¥½ä½¿ã€‚</p><p>éœ€è¦ä¸¤ä¸ªå‘½ä»¤è¡Œï¼Œ<code>adb</code>å’Œ<code>scrcpy</code></p><p>å®‰è£…å°±ä¸ç”¨æè¿°äº†ï¼Œèƒ½æœ‰æŠŠæ‰‹æœºæŠ•åˆ°ç”µè„‘ä¸Šçš„æƒ³æ³•çš„äººåº”è¯¥éƒ½èƒ½å®‰è£…ä¸Šã€‚</p><p>å®‰è£…ä¸Šä»¥åå°±æ›´äº†ä¸å¾—äº†</p><pre class="line-numbers language-shell"><code class="language-shell"># mahaiqiang @ mahaiqiangs-MacBook-Pro in ~ [8:58:14]$ adb usb* daemon not running; starting now at tcp:5037* daemon started successfullyrestarting in USB mode# mahaiqiang @ mahaiqiangs-MacBook-Pro in ~ [8:59:10]$ scrcpy2020-09-28 08:59:14.880 scrcpy[1865:48805] INFO: scrcpy 1.14 <https://github.com/Genymobile/scrcpy>/usr/local/Cellar/scrcpy/1.14_1/share/scrcpy/scrcpy-server: 1 file pushed. 1.3 MB/s (33142 bytes in 0.025s)[server] INFO: Device: HUAWEI EVA-AL00 (Android 8.0.0)2020-09-28 08:59:16.304 scrcpy[1865:48805] INFO: Created renderer: metal2020-09-28 08:59:16.304 scrcpy[1865:48805] INFO: Renderer: metal2020-09-28 08:59:16.311 scrcpy[1865:48805] INFO: Initial texture: 1080x1920<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœç”µè„‘ä¿¡ä»»äº†æ‰‹æœº,å¼€äº†USBè°ƒè¯•ï¼Œè¿™æ—¶å€™åº”è¯¥èƒ½ä»ç”µè„‘ä¸Šçœ‹åˆ°æ‰‹æœºäº†ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p><p>å¼ºçƒˆæ¨è<br><a href="https://blog.csdn.net/was172/article/details/99705855">scrcpyâ€”â€”AndroidæŠ•å±ç¥å™¨(ä½¿ç”¨æ•™ç¨‹)</a></p><p>ç¨å¾®ç»™è‡ªå·±å¤‡ä»½ä¸€ä¸‹ï¼Œä¸‡ä¸€ä»¥ä¸Šåšå®¢å“ªå¤©ä¸‹æ¶äº†ã€‚</p><h2 id="ä½¿ç”¨scrcpyçš„è¦æ±‚"><a href="#ä½¿ç”¨scrcpyçš„è¦æ±‚" class="headerlink" title="ä½¿ç”¨scrcpyçš„è¦æ±‚"></a>ä½¿ç”¨scrcpyçš„è¦æ±‚</h2><ol><li> Androidè®¾å¤‡è‡³å°‘éœ€è¦API 21ï¼ˆAndroid 5.0ä»¥ä¸Šç‰ˆæœ¬ï¼‰;</li><li> ç¡®ä¿åœ¨æ‚¨çš„è®¾å¤‡ä¸Šå¯ç”¨äº†<a href="https://developer.android.com/studio/command-line/adb.html#Enabling">adbè°ƒè¯•</a>;</li><li> åœ¨æŸäº›è®¾å¤‡ä¸Šï¼Œæ‚¨è¿˜éœ€è¦å¯ç”¨<a href="https://github.com/Genymobile/scrcpy/issues/70#issuecomment-373286323">å…¶ä»–é€‰é¡¹</a>ä»¥ä½¿ç”¨é”®ç›˜å’Œé¼ æ ‡æ§åˆ¶å®ƒã€‚</li></ol><h2 id="ä½¿ç”¨ç”µè„‘è¿æ¥æ‰‹æœº"><a href="#ä½¿ç”¨ç”µè„‘è¿æ¥æ‰‹æœº" class="headerlink" title="ä½¿ç”¨ç”µè„‘è¿æ¥æ‰‹æœº"></a>ä½¿ç”¨ç”µè„‘è¿æ¥æ‰‹æœº</h2><p>åœ¨Androidæ‰‹æœºä¸­æ‰“å¼€äº†USBè°ƒè¯•åï¼Œæˆ‘ä»¬å³å¯åœ¨ç”µè„‘ä¸­ä½¿ç”¨adbè¿›è¡Œè°ƒè¯•ã€‚</p><p>æˆ‘ä½¿ç”¨çš„æ˜¯Windows10ç³»ç»Ÿï¼Œä»¥ä¸‹ä»¥Windowsä¸ºä¾‹ï¼ŒMacOSæˆ–Linuxè¯·<a href="https://github.com/Genymobile/scrcpy#get-the-app">ç‚¹å‡»è¿™é‡Œ</a>ã€‚</p><p>ç¨‹åºä½¿ç”¨äº†Javaè¯­è¨€ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç”µè„‘ä¸­æ­å»ºJavaè¿è¡Œç¯å¢ƒï¼Œå‚è€ƒï¼š<a href="https://blog.csdn.net/sigmarising/article/details/80139287">Windows10 é…ç½® Java å¼€å‘ç¯å¢ƒ</a></p><p>é¦–å…ˆä¸‹è½½scrcpyï¼Œå¯å»<code>releases</code>ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼Œç›®å‰æœ€æ–°ç‰ˆæœ¬ä¸º<code>v1.10</code>ã€‚</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/Genymobile/scrcpy/releases">https://github.com/Genymobile/scrcpy/releases</a></p><p><img src="/loading.gif" data-original="/images/android/scrcpy.png" alt="scrcpy"></p><p>æ‰“å¼€cmdå®šä½åˆ°æ­¤ç›®å½•ï¼ˆåœ¨åœ°å€æ ä¸­è¾“å…¥<code>cmd</code>å›è½¦ï¼‰ï¼Œæˆ–è€…å°†è¯¥ç›®å½•å¦‚<code>D:\Github_Run\scrcpy-win64-v1.10</code>åŠ å…¥åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­ï¼Œç¨‹åºçš„ä½¿ç”¨éƒ½åœ¨cmdå‘½ä»¤è¡Œä¸­æ“ä½œã€‚</p><h2 id="ä½¿ç”¨USBè¿›è¡Œè¿æ¥"><a href="#ä½¿ç”¨USBè¿›è¡Œè¿æ¥" class="headerlink" title="ä½¿ç”¨USBè¿›è¡Œè¿æ¥"></a>ä½¿ç”¨USBè¿›è¡Œè¿æ¥</h2><p>æ­¤æ–¹å¼æ¨èä½¿ç”¨ï¼Œç›¸å¯¹æ›´åŠ æµç•…ã€‚</p><ol><li> æ‰‹æœºé€šè¿‡USBè¿æ¥åˆ°PCä¸Šï¼Œé¦–æ¬¡è¿æ¥ä¼šå¼¹å‡ºæ˜¯å¦ä¿¡ä»»è¯¥ç”µè„‘ï¼Œç‚¹å‡»å§‹ç»ˆä¿¡ä»»å³å¯ã€‚</li><li> è¿è¡Œ<code>adb usb</code>æŸ¥çœ‹æ˜¯å¦è¿æ¥æˆåŠŸ</li></ol><pre class="line-numbers language-shell"><code class="language-shell">D:\Github_Run\scrcpy-win64-v1.10>adb usbrestarting in USB mode<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="3"><li> è¿è¡Œ<code>scrcpy</code>å³å¯ã€‚</li></ol><h2 id="ä½¿ç”¨æ— çº¿è¿æ¥"><a href="#ä½¿ç”¨æ— çº¿è¿æ¥" class="headerlink" title="ä½¿ç”¨æ— çº¿è¿æ¥"></a>ä½¿ç”¨æ— çº¿è¿æ¥</h2><p>å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.genymotion.com/blog/open-source-project-scrcpy-now-works-wirelessly/">Open Source Project - Scrcpy now works wirelessly</a></p><p>æ­¤è¿æ¥æ–¹å¼æ›´åŠ æ–¹ä¾¿å¿«æ·ï¼Œè‹¥å®½å¸¦é€Ÿç‡é«˜ï¼Œä½¿ç”¨æ•ˆæœæ›´ä½³ï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿéå¸¸ç®€å•ã€‚</p><ol><li> ç¡®ä¿PCå’Œæ‰‹æœºåœ¨åŒä¸€Wifiä¸­</li><li> æ‰‹æœºå…ˆé€šè¿‡USBä¸PCç›¸è¿</li><li> åœ¨PCä¸Šè¿è¡Œ adb tcpip æœåŠ¡ç«¯å£ï¼Œå¦‚ç«¯å£ä¸º5555</li></ol><pre class="line-numbers language-shell"><code class="language-shell">D:\Github_Run\scrcpy-win64-v1.10>adb tcpip 5555restarting in TCP mode port: 5555<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="4"><li> æ‹”ä¸‹ä½ çš„è®¾å¤‡ï¼Œæ–­å¼€USBè¿æ¥</li><li> åœ¨PCä¸Šè¿è¡Œ adb connect æ‰‹æœºIP:æœåŠ¡ç«¯å£ï¼ˆæ‰‹æœºIPå¯é€šè¿‡æ‰‹æœºçš„<code>çŠ¶æ€ä¿¡æ¯</code>æŸ¥çœ‹ï¼Œæˆ–è€…ç™»å½•è·¯ç”±å™¨æŸ¥çœ‹ï¼Œä¸€èˆ¬ä»¥192.168å¼€å¤´ï¼‰</li></ol><pre class="line-numbers language-shell"><code class="language-shell">D:\Github_Run\scrcpy-win64-v1.10>adb connect 192.168.0.4:5555connected to 192.168.0.4:5555<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="6"><li> è¿è¡Œscrcpyï¼Œåœ¨cmdä¸­è¾“å…¥<code>scrcpy.exe</code></li></ol><p>å‚è€ƒï¼š<br><a href="https://blog.csdn.net/was172/article/details/99705855">scrcpyâ€”â€”AndroidæŠ•å±ç¥å™¨(ä½¿ç”¨æ•™ç¨‹)</a></p><p><a href="http://blog.lujun9972.win/blog/2019/03/20/%E4%BD%BF%E7%94%A8scrcpy%E6%8E%A7%E5%88%B6%E4%BD%A0%E7%9A%84%E6%89%8B%E6%9C%BA/">ä½¿ç”¨scrcpyæ§åˆ¶ä½ çš„æ‰‹æœº</a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxæ–‡ä»¶ç›®å½•æœåŠ¡å™¨</title>
      <link href="2020/09/22/nginx-wen-jian-mu-lu-fu-wu-qi/"/>
      <url>2020/09/22/nginx-wen-jian-mu-lu-fu-wu-qi/</url>
      
        <content type="html"><![CDATA[<p>nginxæ­å»ºä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨<br><a href="https://www.jianshu.com/p/96560e2f4e47">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ç”¨nginxé…ç½®ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨ï¼Œå¹¶è§£å†³ä¸­æ–‡ä¹±ç é—®é¢˜ï¼Œé…ç½®æ–‡ä»¶</p><pre class="line-numbers language-conf"><code class="language-conf">server {    listen 80;    server_name downloadapp.3vyd.com;    location / {        add_header 'Access-Control-Allow-Origin' '*' always;    add_header 'Access-Control-Allow-Credentials' 'true';    add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range';    add_header 'Access-Control-Allow-Headers' 'Range';        root /var/packages;        autoindex on;        autoindex_localtime on;        autoindex_exact_size off;    charset utf-8;        try_files $uri $uri/ /index.html;    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/nginx/nginx-file1.png" alt="file list"></p><p>å¦‚æœï¼Œå¼€æ”¾ç›®å½•ï¼Œå½“æ—¶ä¸å…è®¸ç›´æ¥è®¿é—®ï¼Œåªèƒ½è®¿é—®æŒ‡å®šè·¯å¾„ä¸‹çš„htmlæ–‡ä»¶ï¼Œnginx.confçš„é…ç½®å¦‚ä¸‹</p><pre class="line-numbers language-conf"><code class="language-conf">pid        /var/run/nginx.pid;events {    worker_connections  1024;}http {    include       /etc/nginx/mime.types;    default_type  application/octet-stream;    add_header Access-Control-Allow-Origin *;    add_header Access-Control-Allow-Headers *;    add_header Access-Control-Allow-Credentials true always;    add_header Access-Control-Allow-Methods GET,POST,OPTIONS;    add_header Access-Control-Max-Age 1728000 always;    server {        listen 8088;        server_name localhost;                # location / {        #     root   /var/jenkins/report/admin/dist;        #     try_files $uri $uri/ /index.html;        #     index  index.html;        # }        location /report {            if ($request_method = 'OPTIONS') {                add_header 'Access-Control-Allow-Origin' '*';                add_header 'Access-Control-Allow-Methods' 'GET,POST,OPTIONS';                add_header 'Access-Control-Allow-Headers' '*';                return 204;            }            root   /var/jenkins_home;            try_files $uri $uri/ /index.html;            index  index.html;        }        location ~* \.(eot|ttf|woff)$ {          add_header Access-Control-Allow-Origin *;        }    }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/nginx/nginx-file-html.png" alt="nginx æ–‡ä»¶ç½‘é¡µ"></p><p><img src="/loading.gif" data-original="/images/nginx/nginx-file-403.png" alt="403é¡µé¢"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://cloud.tencent.com/developer/article/1142152">nginxå¼€å¯ç›®å½•æµè§ˆåŠè§£å†³ä¸­æ–‡æ–‡ä»¶åä¹±ç é—®é¢˜</a></p>]]></content>
      
      
      <categories>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>websocketæœ¬åœ°è°ƒè¯•html</title>
      <link href="2020/09/13/websocket-ben-di-diao-shi-html/"/>
      <url>2020/09/13/websocket-ben-di-diao-shi-html/</url>
      
        <content type="html"><![CDATA[<p>æ–°èµ·websocketæœåŠ¡åæœ¬åœ°å¦‚ä½•è°ƒè¯•å‘¢ï¼Ÿ<br><a href="https://www.jianshu.com/p/8ad2746b0866">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å…ˆçœ‹çœ‹æœ¬åœ°è¿™ä¸ªé™æ€htmlåœ¨æµè§ˆå™¨é‡Œçœ‹åˆ°çš„é¡µé¢ã€‚</p><p><img src="/loading.gif" data-original="/images/cljs/websocket-test-html.png" alt="websocket æµ‹è¯•é¡µé¢"></p><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>IE<span class="token punctuation">=</span>edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>æœ¬åœ°websocketæµ‹è¯•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>robots<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>all<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>keywords<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>æœ¬åœ°,websocket,æµ‹è¯•å·¥å…·<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>description<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>æœ¬åœ°,websocket,æµ‹è¯•å·¥å…·<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">            <span class="token selector"><span class="token class">.btn-group</span></span><span class="token punctuation">{</span>                <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>text<span class="token punctuation">'</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>ws://localhost:3000/api/ws<span class="token punctuation">'</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">='</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span><span class="token number">390</span>px<span class="token punctuation">;</span><span class="token property">display</span><span class="token punctuation">:</span>inline</span><span class="token punctuation">'</span></span>         <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>wsaddr<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn-group<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn btn-default<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>addsocket();<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>è¿æ¥<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn btn-default<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>closesocket();<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>æ–­å¼€<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn btn-default<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>$(<span class="token punctuation">"</span>#wsaddr<span class="token punctuation">"</span>).val(<span class="token punctuation">"</span><span class="token punctuation">"</span>)<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>æ¸…ç©º<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>output<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span><span class="token number">1</span>px solid <span class="token hexcode">#ccc</span><span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span><span class="token number">365</span>px<span class="token punctuation">;</span><span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">20</span>px <span class="token number">0</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>message<span class="token punctuation">'</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">='</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span><span class="token number">810</span>px</span><span class="token punctuation">'</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>å¾…å‘ä¿¡æ¯<span class="token punctuation">"</span></span> <span class="token attr-name">onkeydown</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en(event);<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input-group-btn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn btn-default<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>doSend();<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>å‘é€<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>anonymous<span class="token punctuation">"</span></span> <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sha384-LVoNJ6yst/aLxKvxwp6s2GAabqPczfWh6xzm38S/YtjUyZ+3aTKOnD/OJVGYLZDl<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://lib.baomitu.com/jquery/3.5.0/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>javascript<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">            <span class="token keyword">function</span> <span class="token function">formatDate</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">var</span> year <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">var</span> month <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token keyword">var</span> date <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">var</span> hour <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">var</span> minute <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">var</span> second <span class="token operator">=</span> now<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> year <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>month <span class="token operator">=</span> month <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token string">"0"</span> <span class="token operator">+</span> month<span class="token punctuation">)</span> <span class="token punctuation">:</span> month<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>date <span class="token operator">=</span> date <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token string">"0"</span> <span class="token operator">+</span> date<span class="token punctuation">)</span> <span class="token punctuation">:</span> date<span class="token punctuation">)</span> <span class="token operator">+</span>                    <span class="token string">" "</span> <span class="token operator">+</span> <span class="token punctuation">(</span>hour <span class="token operator">=</span> hour <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token string">"0"</span> <span class="token operator">+</span> hour<span class="token punctuation">)</span> <span class="token punctuation">:</span> hour<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>minute <span class="token operator">=</span> minute <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token string">"0"</span> <span class="token operator">+</span> minute<span class="token punctuation">)</span> <span class="token punctuation">:</span> minute<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>                        second <span class="token operator">=</span> second <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token string">"0"</span> <span class="token operator">+</span> second<span class="token punctuation">)</span> <span class="token punctuation">:</span> second<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">var</span> output<span class="token punctuation">;</span>            <span class="token keyword">var</span> websocket<span class="token punctuation">;</span>             <span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                output <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"output"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">testWebSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>             <span class="token keyword">function</span> <span class="token function">addsocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">var</span> wsaddr <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#wsaddr"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>wsaddr <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è¯·å¡«å†™websocketçš„åœ°å€"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token function">StartWebSocket</span><span class="token punctuation">(</span>wsaddr<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>             <span class="token keyword">function</span> <span class="token function">closesocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                websocket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>             <span class="token keyword">function</span> <span class="token function">StartWebSocket</span><span class="token punctuation">(</span>wsUri<span class="token punctuation">)</span> <span class="token punctuation">{</span>                websocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>wsUri<span class="token punctuation">)</span><span class="token punctuation">;</span>                websocket<span class="token punctuation">.</span>onopen <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">onOpen</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span>                <span class="token punctuation">}</span><span class="token punctuation">;</span>                websocket<span class="token punctuation">.</span>onclose <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">onClose</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span>                <span class="token punctuation">}</span><span class="token punctuation">;</span>                websocket<span class="token punctuation">.</span>onmessage <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">onMessage</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span>                <span class="token punctuation">}</span><span class="token punctuation">;</span>                websocket<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">onError</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span>                <span class="token punctuation">}</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>             <span class="token keyword">function</span> <span class="token function">onOpen</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">writeToScreen</span><span class="token punctuation">(</span><span class="token string">"&lt;span style='color:red'>è¿æ¥æˆåŠŸï¼Œç°åœ¨ä½ å¯ä»¥å‘é€ä¿¡æ¯å•¦ï¼ï¼ï¼&lt;/span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>             <span class="token keyword">function</span> <span class="token function">onClose</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">writeToScreen</span><span class="token punctuation">(</span><span class="token string">"&lt;span style='color:red'>websocketè¿æ¥å·²æ–­å¼€!!!&lt;/span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                websocket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>             <span class="token keyword">function</span> <span class="token function">onMessage</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">writeToScreen</span><span class="token punctuation">(</span><span class="token string">'&lt;span style="color:blue">æœåŠ¡ç«¯å›åº”&amp;nbsp;'</span> <span class="token operator">+</span> <span class="token function">formatDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&lt;/span>&lt;br/>&lt;span class="bubble">'</span> <span class="token operator">+</span>                    evt<span class="token punctuation">.</span>data <span class="token operator">+</span> <span class="token string">'&lt;/span>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>             <span class="token keyword">function</span> <span class="token function">onError</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">writeToScreen</span><span class="token punctuation">(</span><span class="token string">'&lt;span style="color: red;">å‘ç”Ÿé”™è¯¯:&lt;/span> '</span> <span class="token operator">+</span> evt<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>             <span class="token keyword">function</span> <span class="token function">doSend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#message"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>message <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è¯·å…ˆå¡«å†™å‘é€ä¿¡æ¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#message"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> websocket <span class="token operator">===</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"websocketè¿˜æ²¡æœ‰è¿æ¥ï¼Œæˆ–è€…è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æµ‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>websocket<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"websocketå·²ç»å…³é—­ï¼Œè¯·é‡æ–°è¿æ¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>websocket<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#message"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">writeToScreen</span><span class="token punctuation">(</span><span class="token string">'&lt;span style="color:green">ä½ å‘é€çš„ä¿¡æ¯&amp;nbsp;'</span> <span class="token operator">+</span> <span class="token function">formatDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&lt;/span>&lt;br/>'</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>                websocket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>             <span class="token keyword">function</span> <span class="token function">writeToScreen</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">var</span> div <span class="token operator">=</span> <span class="token string">"&lt;div class='newmessage'>"</span> <span class="token operator">+</span> message <span class="token operator">+</span> <span class="token string">"&lt;/div>"</span><span class="token punctuation">;</span>                <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#output"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">var</span> d <span class="token operator">=</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">var</span> doScroll <span class="token operator">=</span> d<span class="token punctuation">.</span>scrollTop <span class="token operator">==</span> d<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> d<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>                <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#output"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>doScroll<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    d<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> d<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> d<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>              <span class="token keyword">function</span> <span class="token function">en</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">var</span> evt <span class="token operator">=</span> evt <span class="token operator">?</span> evt <span class="token punctuation">:</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>event <span class="token operator">?</span> window<span class="token punctuation">.</span>event <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>evt<span class="token punctuation">.</span>keyCode <span class="token operator">==</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">doSend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cljs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾®ä¿¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shadow-cljs hooksè§£å†³csså»¶è¿ŸåŠ è½½å¯¼è‡´é¡µé¢é‚¹å½¢é—®é¢˜</title>
      <link href="2020/08/29/shadow-cljs-hooks-jie-jue-css-yan-chi-jia-zai-dao-zhi-ye-mian-zou-xing-wen-ti/"/>
      <url>2020/08/29/shadow-cljs-hooks-jie-jue-css-yan-chi-jia-zai-dao-zhi-ye-mian-zou-xing-wen-ti/</url>
      
        <content type="html"><![CDATA[<p>åœ¨shadow-cljsé¡¹ç›®ä¸­åœ¨æœ€åç¼–è¯‘çš„æ—¶å€™å°†æ‰€æœ‰çš„csså†™å…¥åˆ°åŒä¸€ä¸ªcssæ–‡ä»¶ï¼Œåœ¨index.htmlé‡Œå¼•ç”¨ä¸€æ¬¡<br><a href="https://www.jianshu.com/p/ff7885afaab9">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="ç°çŠ¶"><a href="#ç°çŠ¶" class="headerlink" title="ç°çŠ¶"></a>ç°çŠ¶</h2><p>æˆ‘å¸ä½¿ç”¨shadow-cljsç¼–è¯‘clojure scriptä»£ç ï¼Œè€ƒè™‘åˆ°å¤§å®¶éƒ½ç¼–è¾‘ä¸€ä¸ªcssæ–‡ä»¶çš„è¯ï¼Œå†²çªæ¯”è¾ƒä¸¥é‡ï¼Œå¹¶ä¸”ä»£ç ä¹Ÿæ²¡æœ‰æ¨¡å—åŒ–ï¼Œæ‰€ä»¥æ¯ä¸ªæ¨¡å—æœ‰è‡ªå·±çš„æ ·å¼æ–‡ä»¶ï¼Œç›®å‰éƒ½æ˜¯åœ¨è‡ªå·±ä¸šåŠ¡æ¨¡å—æˆ–è€…componenté‡Œå¼•å…¥è‡ªå·±çš„cssæ–‡ä»¶ï¼Œç»“æ„åŸºæœ¬æ˜¯è¿™æ ·çš„ï¼š</p><pre class="line-numbers language-cljs"><code class="language-cljs">(defn login-main []  [:div   [:link {:rel "stylesheet" :href "/css/login.css" }]   [:div "ç™»å½•ç»„ä»¶æ ·å¼"]])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>å¥½å¤„ï¼š</p><ul><li>ä»£ç æ¨¡å—åŒ–ï¼Œä¸šåŠ¡ç»„ä»¶ä¸æ ·å¼æ–‡ä»¶ä¸€ä¸€å¯¹åº”ï¼Œä¾¿äºå¼€å‘å›¢é˜Ÿç»´æŠ¤ä»£ç ã€‚</li><li>ä¸ç”¨åœ¨å…¥å£æ–‡ä»¶é‡Œå¼•å…¥ä¸€å †cssæ–‡ä»¶ï¼Œå‡å°‘commitå†²çªã€‚</li><li>å‡å°‘èµ„æºæµªè´¹ï¼Œåªæœ‰é¡µé¢åŠ è½½å¤„æ‰åŠ è½½cssï¼Œç³»ç»Ÿä¸åŠ è½½æ— ç”¨çš„èµ„æºæ–‡ä»¶ã€‚</li></ul><p>ç—›ç‚¹</p><ul><li>ä¸€æ¡è¶³ä»¥è‡´å‘½ï¼Œé‚£å°±æ˜¯äº§å“ä½“éªŒä¸å¥½ï¼ŒcssåŠ è½½å»¶è¿Ÿï¼Œå‡ ä¹æ¯ä¸ªé¡µé¢éƒ½å‡ºç°å¦‚ä¸‹ä¸€ä¸ªç¬é—´ã€‚<br><img src="/loading.gif" data-original="/images/cljs/css-error1.png" alt="å®šåˆ¶"></li></ul><p><img src="/loading.gif" data-original="/images/cljs/css-error2.png" alt="è®¢å•"></p><p>æ˜¯çš„ï¼Œä½ çœ‹çš„æ²¡æœ‰é”™ï¼Œæµè§ˆç¡®å®æ²¡æœ‰åŠ è½½å®Œï¼Œç½‘ç»œå¥½çš„è¯è¿™ä¸ªé¡µé¢ç¬é—´å°±è¿‡äº†ï¼Œä½†æ˜¯ä¸‡ä¸€ç¢°ä¸Šä¸å¥½çš„ï¼Œé‚£å°±å°´å°¬äº†ï¼Œå¹¶ä¸”æœ‰æ—¶å€™è¿˜å‡ºç°è¿‡æœ€åæ ·å¼å°±æ²¡æœ‰å‡ºæ¥çš„æƒ…å†µã€‚</p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>ä¸èƒ½è®©ç»„ä»¶æ¸²æŸ“æ—¶æ‰å»åŠ è½½cssï¼Œæ‰€ä»¥linkè¿™ä¸ªæ–¹æ¡ˆpassæ‰ã€‚<br>é‚£ä¹ˆåªèƒ½å°†cssåœ¨<code>index.html</code>é‡Œå¼•å…¥ï¼Œä¸ç®¡ç”¨ä¸ç”¨å¾—åˆ°ï¼Œéƒ½å…ˆåŠ è½½å‡ºæ¥ï¼Œè®©æµè§ˆå™¨å…ˆç¼“å­˜ä¸‹æ¥å¤‡ç”¨ã€‚</p><h2 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" class="headerlink" title="æ–¹æ¡ˆ"></a>æ–¹æ¡ˆ</h2><ol><li>ä»£ç å±‚é¢ï¼Œè¿˜æ˜¯åˆ†æ¨¡å—ï¼Œä¸šåŠ¡æ¨¡å—å’Œcssæ¨¡å—ä¸€ä¸€å¯¹åº”ã€‚</li><li>åœ¨ç³»ç»Ÿè¿è¡Œæ—¶å°†æ‰€æœ‰è‡ªå®šä¹‰çš„cssåˆå¹¶åˆ°ä¸€ä¸ªæ ·å¼æ–‡ä»¶ï¼Œåœ¨<code>index.html</code>ä¸­å¼•ç”¨ã€‚</li></ol><p>å…¶ä¸­ç¬¬äºŒç‚¹ï¼Œåœ¨éƒ¨ç½²æ—¶å¯ä»¥ä½¿ç”¨è„šæœ¬å¤„ç†ï¼Œä½†æ˜¯åœ¨æœ¬åœ°å¼€å‘æ—¶å°±æ¯”è¾ƒä¸ä¾¿ï¼Œä¸è¿‡å¥½åœ¨shadow-cljsæä¾›äº†<a href="https://shadow-cljs.github.io/docs/UsersGuide.html#build-hooks">build-hooks</a>ç¥å™¨ã€‚åŠ è½½é…ç½®ä¸­ï¼Œè®©æˆ‘ä»¬ä»£ç ç¼–è¯‘æ—¶åšäº†è¿™ä¸ªåˆå¹¶cssæ–‡ä»¶çš„å·¥ä½œã€‚å…·ä½“çš„é…ç½®æ˜¯åœ¨æ ¹ç›®å½•çš„<code>shadow-cljs.edn</code>ä¸­åŠ å…¥å¦‚ä¸‹é…ç½®:</p><pre class="line-numbers language-cljs"><code class="language-cljs">{... :builds {:app {:target ...           :build-hooks [(utils.hooks/watch-resource)]        ...}}}}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªhooksçš„å…¨éƒ¨ä»£ç å¦‚ä¸‹:</p><pre class="line-numbers language-cljs"><code class="language-cljs">(ns utils.hooks  (:require [clojure.java.shell :as shell]))(defn watch-resource  {:shadow.build/stage :flush}  [build-state & args]  (future    (prn "configure completed")    (let [dir (System/getProperty "user.dir")]      (clojure.java.shell/with-sh-dir (str dir "/src/cljs/utils")        (clojure.java.shell/sh "mergecss.sh" (str dir "/resources/public/css") (str dir "/resources/public/css/style.css")))))  build-state)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœå‚è€ƒï¼Œshadow-cljså®˜æ–¹å¯¹<a href="https://shadow-cljs.github.io/docs/UsersGuide.html#build-hooks">build-hooks</a>çš„è¯´æ˜ï¼Œä¸éš¾ç†è§£ã€‚è§£é‡Šä¸¤ä¸ªä¸œè¥¿</p><ol><li><code>(System/getProperty "user.dir")</code>ï¼Œè¿™ä¸ªæ˜¯è·å–å½“å‰é¡¹ç›®çš„å·¥ä½œç›®å½•ï¼Œä¹Ÿå°±æ˜¯é¡¹ç›®è·Ÿç›®å½•ï¼Œæ³¨æ„ä¸æ˜¯gitæ ¹ç›®å½•ã€‚æœ‰äº†è¿™ä¸ªï¼Œæƒ³è·å–ä»€ä¹ˆç›®å½•æˆ–è€…æ–‡ä»¶ï¼Œæ‰‹åˆ°æ“’æ¥ã€‚</li><li>hooksé‡Œè¿˜è°ƒç”¨äº†ä¸€ä¸ªè„šæœ¬æ–‡ä»¶<code>mergecss.sh</code>,è¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨æ˜¯æŠŠå¼€å‘å›¢é˜Ÿè‡ªå·±å†™çš„æ‰€æœ‰cssçš„å†…å®¹copyåˆ°åŒä¸€ä¸ª<code>style.css</code>æ–‡ä»¶ä¸­å»ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦å¤„ç†çš„ç›®å½•(ä¼šå‘ä¸‹éå†ç›®å½•)ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦å†™å…¥çš„ç›®æ ‡æ–‡ä»¶ï¼Œé™„ä¸Šè„šæœ¬ä»£ç ï¼š</li></ol><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/bash#è·å–ç¬¬ä¸€ä¸ªå‚æ•°,ç›®æ ‡ç›®å½•srcpath=$1#ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¾“å‡ºæ–‡ä»¶target_file=$2#å…ˆåˆ é™¤åŸç›®æ ‡æ–‡ä»¶rm -rf ${target_file};function writeByDir(){    for file in $1/*      do        if test -f $file; then      #_echo $(basename $file)          if [[ $(basename $file) = "antd.min.css" ]] || [[ $(basename $file) = "slick.min.css" ]] || [[ $(basename $file) = "slick-theme.min.css" ]]; then            echo "uncopy css :"$(basename $file)          else            cat "$file" >> "${target_file}"              echo "" >> "${target_file}"          fi        else          writeByDir $file       fi    done}writeByDir ${srcpath}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ­¤å¤„ç”±è¡·æ„Ÿæ…¨ä¸‹ï¼ŒreplçœŸå¥½ç”¨ï¼Œclojure.java.shellè¿™ä¸ªåº“çš„ä½¿ç”¨ï¼ŒåŠæœ€åé’©å­å†…å®¹å¥½ä¸å¥½ä½¿å…¨é è¿™ä¸ªå·¥å…·è°ƒè¯•ã€‚å¦åˆ™çš„è¯ï¼Œä¿®æ”¹hookså°±è¦é¢‘ç¹å¯åŠ¨shadow-cljsé¡¹ç›®ï¼Œå¹¶ä¸”å¦‚æœhookså‡½æ•°æœ‰é”™è¯¯çš„æ²¡æœ‰ä»»ä½•æŠ¥é”™ä¿¡æ¯ï¼Œåªæ˜¯é’©å­å‡½æ•°ä¸æ‰§è¡Œã€‚</p></blockquote><p>è¿™æ ·æœ¬åœ°å¼€å‘çš„cssæ–‡ä»¶ä¹Ÿèƒ½åŠæ—¶å†™å…¥åˆ°<code>style.css</code>é‡Œï¼Œåœ¨<code>index.html</code>å¼•ç”¨è¿™ä¸ªæ–‡ä»¶ï¼Œå¦¥äº†ã€‚</p><pre class="line-numbers language-html"><code class="language-html"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/css/style.css<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼Œå®šç›ä¸€çœ‹åŸåœ°æµ"><a href="#ä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼Œå®šç›ä¸€çœ‹åŸåœ°æµ" class="headerlink" title="ä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼Œå®šç›ä¸€çœ‹åŸåœ°æµ"></a>ä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼Œå®šç›ä¸€çœ‹åŸåœ°æµ</h2><p>ä»¥ä¸Šæ“ä½œè¿˜æ˜¯ä¸å¤Ÿå®Œç¾ï¼Œ</p><ol><li><p>åŠ ä¸Šhookåï¼Œåœ¨æœ¬åœ°ä¿®æ”¹è‡ªå·±çš„cssåï¼Œé’©å­ä¸æ‰§è¡Œï¼Œæ”¹çš„ä»£ç ä¸ä¼šè‡ªå·±å†™å…¥ç›®æ ‡æ–‡ä»¶ã€‚<br>æ–¹æ¡ˆä¸€ï¼šåœ¨9630ç«¯å£ä¸Šæ‰‹åŠ¨è§¦å‘compileï¼Œå¼ºåˆ¶flushã€‚<br>æ–¹æ¡ˆäºŒï¼šå¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥åœ¨cljsæ–‡ä»¶é‡Œlinkè‡ªå·±çš„æ ·å¼æ–‡ä»¶ï¼Œè¾¾åˆ°é«˜æ•ˆå¼€å‘ï¼Œlinkæ®µè½ä¸ç”¨æäº¤ã€‚</p></li><li><p>ä¸ºäº†å¼€å‘æ—¶ä¸å†²çªï¼Œæ›´æ–°gitignoreï¼Œç”Ÿæˆçš„cssä¸ç”¨commitåˆ°é¡¹ç›®é‡Œï¼Œreleaseç¯å¢ƒåœ¨æŒç»­é›†æˆæ—¶æ‰§è¡Œè¯¥hookçš„æ“ä½œï¼Œè°ƒç”¨æœåŠ¡å™¨çš„è„šæœ¬æ–‡ä»¶ã€‚</p></li><li><p>æ ·å¼æ–‡ä»¶æ²¡æœ‰hashï¼Œçº¯copyï¼Œåªä¸ºè§£å†³cssåŠ è½½å»¶è¿Ÿå¯¼è‡´çš„é¡µé¢ä¸‘é™‹ã€‚</p></li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://blog.csdn.net/sirfenygu/article/details/47025083">https://blog.csdn.net/sirfenygu/article/details/47025083</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> cljs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shadow-cljs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macä¸Šsoundflower+OBS+å¾®ä¿¡å…¬ä¼—å·ç›´æ’­é¡¹ç›®æ€»ç»“</title>
      <link href="2020/08/16/mac-shang-soundflower-obs-wei-xin-gong-zhong-hao-zhi-bo-xiang-mu-zong-jie/"/>
      <url>2020/08/16/mac-shang-soundflower-obs-wei-xin-gong-zhong-hao-zhi-bo-xiang-mu-zong-jie/</url>
      
        <content type="html"><![CDATA[<p>macä¸Šä½¿ç”¨è…¾è®¯ä¼šè®®+OBSå®¢æˆ·ç«¯åšç›´æ’­<br><a href="https://www.jianshu.com/p/7764b4c643a6">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="1-æœ¬åœ°å¾®ä¿¡å…¬ä¼—å·å¼€å‘"><a href="#1-æœ¬åœ°å¾®ä¿¡å…¬ä¼—å·å¼€å‘" class="headerlink" title="1. æœ¬åœ°å¾®ä¿¡å…¬ä¼—å·å¼€å‘"></a>1. æœ¬åœ°å¾®ä¿¡å…¬ä¼—å·å¼€å‘</h2><p>å‚è€ƒï¼š<a href="https://www.jianshu.com/p/05a58682cbac">å¾®ä¿¡é…ç½®æœ¬åœ°å…¬ä¼—å·å¼€å‘ç¯å¢ƒ</a></p><h2 id="2-runtimeçš„addShutdownHooké’©å­ä¸æ‰§è¡Œ"><a href="#2-runtimeçš„addShutdownHooké’©å­ä¸æ‰§è¡Œ" class="headerlink" title="2. runtimeçš„addShutdownHooké’©å­ä¸æ‰§è¡Œ"></a>2. runtimeçš„addShutdownHooké’©å­ä¸æ‰§è¡Œ</h2><p>å‚è€ƒï¼š<a href="https://www.jianshu.com/p/8001a66d37c9">Linux kill &amp; Java shutdownhook</a><br>æœ€åç”¨çš„kill-15 pidåœæ­¢è¿›ç¨‹ï¼Œæˆ–è®¸æœ‰æ›´å¥½çš„æ–¹å¼ï¼Œæ¯”å¦‚System.exit();</p><h4 id="è¯»æ–‡ä»¶å¥½è¯´ï¼Œé¡¹ç›®å¯åŠ¨æ—¶ç¼–è¯‘å°±ä¼šè¯»"><a href="#è¯»æ–‡ä»¶å¥½è¯´ï¼Œé¡¹ç›®å¯åŠ¨æ—¶ç¼–è¯‘å°±ä¼šè¯»" class="headerlink" title="è¯»æ–‡ä»¶å¥½è¯´ï¼Œé¡¹ç›®å¯åŠ¨æ—¶ç¼–è¯‘å°±ä¼šè¯»"></a>è¯»æ–‡ä»¶å¥½è¯´ï¼Œé¡¹ç›®å¯åŠ¨æ—¶ç¼–è¯‘å°±ä¼šè¯»</h4><pre class="line-numbers language-clojure"><code class="language-clojure">(def file-url "/opt/xhlive-training/pkg/activity/db.edn")(def messages (atom (clojure.edn/read-string (slurp file-url))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="å¢åŠ hook"><a href="#å¢åŠ hook" class="headerlink" title="å¢åŠ hook"></a>å¢åŠ hook</h4><pre class="line-numbers language-clojure"><code class="language-clojure">(defn -main [& args]  (start!)  (.addShutdownHook (Runtime/getRuntime)                    (new Thread (fn[]                                  (prn "I am going down....")                                  (when (not (empty? @messages))                                    (spit file-url @messages)))))  (println "å¯åŠ¨ws...."))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-é¡¹ç›®å¯åŠ¨æ—¶è¯»æ–‡ä»¶ï¼Œé¡¹ç›®ç»“æŸæ—¶å†™æ–‡ä»¶"><a href="#3-é¡¹ç›®å¯åŠ¨æ—¶è¯»æ–‡ä»¶ï¼Œé¡¹ç›®ç»“æŸæ—¶å†™æ–‡ä»¶" class="headerlink" title="3. é¡¹ç›®å¯åŠ¨æ—¶è¯»æ–‡ä»¶ï¼Œé¡¹ç›®ç»“æŸæ—¶å†™æ–‡ä»¶"></a>3. é¡¹ç›®å¯åŠ¨æ—¶è¯»æ–‡ä»¶ï¼Œé¡¹ç›®ç»“æŸæ—¶å†™æ–‡ä»¶</h2><p>ç±»ä¼¼åœ¨æœåŠ¡ç»“æŸæ—¶å¢åŠ ä¸€äº›é”€æ¯ç°åœºçš„èƒ½åŠ›ã€‚<a href="https://zhuanlan.zhihu.com/p/82350423">Javaä¸­ä½¿ç”¨shutdownHookçš„ä¸€äº›æ³¨æ„äº‹é¡¹</a><br>ä¸Šåšä¸»çš„ä»‹ç»ç›¸å¯¹æ¥è¯´èƒ½å¤Ÿå¸®åŠ©addShutdownHookçš„åœºæ™¯äº†ã€‚</p><p>æœ¬æ–‡ä»‹ç»clojureç‰ˆå®è·µã€‚</p><h4 id="slurp-è¯»å‡½æ•°"><a href="#slurp-è¯»å‡½æ•°" class="headerlink" title="slurp è¯»å‡½æ•°"></a>slurp è¯»å‡½æ•°</h4><p>è¯»å–ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹</p><blockquote><p>clojure.core/slurp<br>è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›</p></blockquote><pre class="line-numbers language-clojure"><code class="language-clojure">(comment  (slurp "files/file-test.txt" :encoding "UTF-8")  ;; => "a txt file line1\na txt file line2\nè¿™æ˜¯ä¸­æ–‡å­—ç¬¦"  )<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="spit-å†™å‡½æ•°"><a href="#spit-å†™å‡½æ•°" class="headerlink" title="spit å†™å‡½æ•°"></a>spit å†™å‡½æ•°</h4><p>clojure.core/spit [file-path content &amp; options]<br>file-pathï¼šä¸ºæ–‡ä»¶è·¯å¾„ï¼›<br>contentï¼šä¸ºè¦å†™å…¥æ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€æœ‰çš„å†…å®¹éƒ½ä¼šè¢«è½¬ä¸ºStringç±»å‹å†™å…¥ã€‚<br>optionsï¼šä¸€äº›è®¾ç½®å‚æ•°ï¼Œå¸¸è§çš„æœ‰ï¼š</p><p>:append true/falseï¼›å½“ä¸ºtrueæ˜¯ï¼Œå†…å®¹ä¼šä»æ–‡ä»¶åé¢å†™å…¥ï¼Œå¦‚æœè¦æ¢è¡Œå†™å…¥ï¼Œéœ€è¦åœ¨å†…å®¹åé¢åŠ å…¥\næ¢è¡Œç¬¦ï¼Œå½“ä¸ºfalseæ—¶ï¼Œä¼šæ“¦æ‰æ–‡ä»¶åŸæœ‰çš„å†…å®¹ã€‚<br>:encoding â€œUTF-8â€æˆ–â€GBKâ€ç­‰ã€‚ é»˜è®¤æ˜¯UTF-8.<br>spitå‡½æ•°ä¼šå…ˆæ‰“å¼€æ–‡ä»¶ï¼Œå†å°†å†…å®¹å†™å…¥ï¼Œå†å…³é—­æ–‡ä»¶ã€‚<br>spitéƒ½æ˜¯ä»¥å­—ç¬¦ä¸²å½¢å¼å†™å…¥ã€‚</p><pre class="line-numbers language-clojure"><code class="language-clojure">(comment  (spit "files/file-test.txt" "æ–°å¢æ–‡ä»¶å†…å®¹\n" :append false :encoding "GBK")  (slurp "files/file-test.txt" :encoding "GBK")  ;; => "æ–°å¢æ–‡ä»¶å†…å®¹\n"  (slurp "files/file-test.txt" :encoding "UTF-8")  ;; => "ï¿½ï¿½ï¿½ï¿½ï¿½Ä¼ï¿½ï¿½ï¿½ï¿½ï¿½\n"  (spit "files/file-test.txt" "æ–°å¢æ–‡ä»¶å†…å®¹\n" :append false)  (slurp "files/file-test.txt" :encoding "GBK")  ;; => "é‚æ¿î–ƒé‚å›¦æ¬¢éå‘­î†\n"  (slurp "files/file-test.txt" :encoding "UTF-8")  ;; => "æ–°å¢æ–‡ä»¶å†…å®¹\n"  ;; é€è¡Œå†™å¤§é‡æ•°æ®åˆ°æ–‡ä»¶æ—¶ï¼Œç”¨spitä¼šé™ä½æ•ˆç‡ï¼Œå› ä¸ºå®ƒæ¯å†™ä¸€æ¬¡éƒ½ä¼šæ‰§è¡Œæ‰“å¼€ã€å…³é—­æ–‡ä»¶ã€‚  ;; æ­¤æ—¶å¯ä»¥ç”¨java.io.writer.  (with-open [w (cio/writer "files/file-test.txt")]    (doseq [l  ["ç¬¬ä¸€è¡Œ" "ç¬¬äºŒè¡Œ" "ç¬¬ä¸‰è¡Œ"]]      (.write w l)      ;; æ–°èµ·ä¸€è¡Œ      (.newLine w)))  )<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="websocket"><a href="#websocket" class="headerlink" title="websocket"></a>websocket</h2><p>clojureä½¿ç”¨ä¸¤ä¸ªåº“ï¼Œä¸é™„æºç ã€‚<br><a href="https://github.com/ptaoussanis/sente">https://github.com/ptaoussanis/sente</a><br><a href="https://github.com/ptaoussanis/timbre">https://github.com/ptaoussanis/timbre</a></p><h2 id="macä¸Šä½¿ç”¨OBSåšç›´æ’­"><a href="#macä¸Šä½¿ç”¨OBSåšç›´æ’­" class="headerlink" title="macä¸Šä½¿ç”¨OBSåšç›´æ’­"></a>macä¸Šä½¿ç”¨OBSåšç›´æ’­</h2><p>æˆ‘ä»¬çš„æ–¹æ¡ˆæ˜¯æŠŠè…¾è®¯ä¼šè®®çš„ä¼šè®®å†…å®¹åšä¸€å®šçš„èƒŒæ™¯ã€å¤´åƒçš„è£å‰ªå¤„ç†åç”¨OBS studioè½¯ä»¶æŠŠæµæ¨å‡ºå»ï¼Œç„¶ååœ¨å®¢æˆ·ç«¯ç”¨m3u8çš„æ ¼å¼æ‹‰å–æ’­æ”¾ã€‚</p><p>ä¸ºä»€ä¹ˆå•ç‹¬æä¸€ä¸‹è¿™ä¸ªï¼Œå› ä¸ºmacä¸Šèƒ½æŠŠéº¦å…‹é£çš„å£°éŸ³æ’­å‡ºå»ï¼Œä½†æ˜¯æ¡Œé¢çš„å£°éŸ³æ‹¨ä¸å‡ºå»ã€‚æ¢å¥è¯è¯´ï¼Œä½ ç”¨ç½‘æ˜“äº‘éŸ³ä¹ï¼Œæƒ³åªæŠŠè¿™ä¸ªè½¯ä»¶çš„å£°éŸ³ç”¨OBSæ’­å‡ºå»ï¼Œæ˜¯ä¸å¯ä»¥çš„ï¼Œäºæ˜¯å€ŸåŠ©soundFlowerè¿™æ¬¾è½¯ä»¶å¯ä»¥å®ç°ï¼Œåœ¨è…¾è®¯ä¼šè®®ä¸Šé€‰æ‹©soundflower (64ch)è¿™ä¸ªé€šé“ã€‚<br><img src="/loading.gif" data-original="/images/fontend/soundflower1.png" alt="å‡ºå…¥å£é€‰æ‹©soundflower"></p><p>OBSé‡Œè®¾ç½®ä¹Ÿé€‰æ‹©soundflower (64ch)<br><img src="/loading.gif" data-original="/images/fontend/soundflower2.png" alt="OBSé‡Œè®¾ç½®soundflower"><br>å¯ä»¥åªå°†è…¾è®¯ä¼šè®®çš„å£°éŸ³æ’­å‡ºå»ã€‚</p><p>ç„¶è€Œï¼Œè¿™æ ·æœ‰äº§ç”Ÿä¸ªæ–°é—®é¢˜ï¼Œè…¾è®¯ä¼šè®®çš„å£°éŸ³éƒ½è¢«OBSæ‹¨å‡ºå»äº†ï¼Œè‡ªå·±çš„ç”µè„‘ç«¯å´å¬ä¸è§äº†ï¼Œäºæ˜¯å‚è€ƒ<br><a href="https://www.bilibili.com/video/av32168478/">åœ¨MacOSä¸Šåˆ©ç”¨OBS+Soundflowerå†…å½•å£°éŸ³ä¸ç›´æ’­</a>è¿™ä¸ªæ•™ç¨‹é…ç½®äº†èšåˆè¾“å…¥å’Œæ··åˆè¾“å‡ºï¼Œç›¸å½“äºå°†ä¸€ä¸ªå£°éŸ³è¿›è¡Œäº†æ‰©å±•ï¼Œè¿™æ ·æ‰å¦¥å½“äº†ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.csdn.net/linux2_scdn/article/details/52575659">clojureå®æˆ˜â€”â€”IOï¼ˆ1ï¼‰</a><br><a href="https://www.bilibili.com/video/av32168478/">åœ¨MacOSä¸Šåˆ©ç”¨OBS+Soundflowerå†…å½•å£°éŸ³ä¸ç›´æ’­</a></p>]]></content>
      
      
      <categories>
          
          <category> cljs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾®ä¿¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ant Design Pro V4å®‰è£…&quot;è¾›&quot;è·¯å†ç¨‹</title>
      <link href="2020/08/09/ant-design-pro-v4-an-zhuang-xin-lu-li-cheng/"/>
      <url>2020/08/09/ant-design-pro-v4-an-zhuang-xin-lu-li-cheng/</url>
      
        <content type="html"><![CDATA[<p>æ–°ç‰ˆæœ¬antd proåå°é¡¹ç›®çš„demoæ­å»ºä½¿ç”¨<br><a href="https://www.jianshu.com/p/5c5c2d0fc119">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ä»¥å‰å®‰è£…ant design proä»githubä¸Šcloneä¸‹æ¥ï¼Œä¸¤å¥è¯å°±åœ¨æµè§ˆå™¨çœ‹åˆ°ç™»å½•é¡µé¢äº†ï¼Œç°åœ¨è¿™ä¸ªä¸œè¥¿è¶Šæ¥è¶Šè‡ƒè‚¿äº†ï¼Œæˆ‘å°±æƒ³è¦ä¸ªé¡µé¢ï¼Œè·‘èµ·æ¥ç»™å®¢æˆ·çœ‹çœ‹æ ·å­ï¼Œç»“æœåºŸäº†è€åŠ²äº†ï¼Œä¹Ÿä¸çŸ¥é“éƒ½å¾€é‡Œé¢æäº†å•¥ã€‚</p><p>ä»Šå¤©è®°å½•ä¸€ä¸‹å§ã€‚<br>å‚è€ƒ<a href="https://pro.ant.design/docs/getting-started-cn">å®˜ç½‘</a>æ•™ç¨‹.<br>é€‰æ‹©ant-design-pro,Pro V4ï¼ŒTypeScriptï¼Œcomplete.</p><pre class="line-numbers language-shell"><code class="language-shell">$ npm create umi? Select the boilerplate type ant-design-pro? ğŸ§™ Be the first to experience the new umi@3 ? Pro V4? ğŸ¤“ Which language do you want to use? TypeScript? ğŸš€ Do you need all the blocks or a simple scaffold? complete> ğŸ™ˆ complete mode can only use the version of antd@4Cloning into '/Users/marvin/git/opensource/react/antd-pro'...remote: Enumerating objects: 564, done.remote: Counting objects: 100% (564/564), done.remote: Compressing objects: 100% (481/481), done.remote: Total 564 (delta 89), reused 318 (delta 62), pack-reused 0Receiving objects: 100% (564/564), 461.41 KiB | 435.00 KiB/s, done.Resolving deltas: 100% (89/89), done.> ğŸšš clone success> Clean up...âœ¨ File Generate Done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¡¹ç›®åˆ›å»ºæˆåŠŸåæ‰§è¡Œ<code>npm install</code>,å‡ºä¸ªé”™</p><pre class="line-numbers language-shell"><code class="language-shell">> node-pty@0.10.0-beta9 install /Users/marvin/git/opensource/react/antd-pro/node_modules/node-pty> node scripts/install.jsgyp WARN install got an error, rolling back installgyp ERR! configure errorgyp ERR! stack ZlibError: zlib: unexpected end of filegyp ERR! stack     at Unzip.write (/Users/marvin/.nvm/versions/node/v14.5.0/lib/node_modules/npm/node_modules/minizlib/index.js:147:22)gyp ERR! stack     at Unzip.flush (/Users/marvin/.nvm/versions/node/v14.5.0/lib/node_modules/npm/node_modules/minizlib/index.js:98:10)gyp ERR! stack     at Unzip.end (/Users/marvin/.nvm/versions/node/v14.5.0/lib/node_modules/npm/node_modules/minizlib/index.js:104:10)gyp ERR! stack     at Unpack.end (/Users/marvin/.nvm/versions/node/v14.5.0/lib/node_modules/npm/node_modules/tar/lib/parse.js:421:21)gyp ERR! stack     at IncomingMessage.onend (_stream_readable.js:679:10)gyp ERR! stack     at Object.onceWrapper (events.js:420:28)gyp ERR! stack     at IncomingMessage.emit (events.js:326:22)gyp ERR! stack     at IncomingMessage.<anonymous> (/Users/marvin/.nvm/versions/node/v14.5.0/lib/node_modules/npm/node_modules/request/request.js:1000:23)gyp ERR! stack     at IncomingMessage.emit (events.js:326:22)gyp ERR! stack     at TLSSocket.socketCloseListener (_http_client.js:435:11)gyp ERR! System Darwin 19.6.0gyp ERR! command "/Users/marvin/.nvm/versions/node/v14.5.0/bin/node" "/Users/marvin/.nvm/versions/node/v14.5.0/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "rebuild"gyp ERR! cwd /Users/marvin/git/opensource/react/antd-pro/node_modules/node-ptygyp ERR! node -v v14.5.0gyp ERR! node-gyp -v v5.1.0gyp ERR! not ok<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥äº†åŠå¤©ï¼ŒæŒ‰ç…§<a href="https://www.jianshu.com/p/a2a2ddeb174c">https://www.jianshu.com/p/a2a2ddeb174c</a><br>çš„æ€è·¯ï¼Œé”™è¯¯å˜æˆäº†ä¸‹é¢è¿™ä¸ª</p><pre class="line-numbers language-shell"><code class="language-shell">$ npm install> fsevents@1.2.13 install /Users/marvin/git/opensource/react/antd-pro/node_modules/jest-environment-jsdom-fourteen/node_modules/fsevents> node install.jsNo receipt for 'com.apple.pkg.CLTools_Executables' found at '/'.No receipt for 'com.apple.pkg.DeveloperToolsCLILeo' found at '/'.No receipt for 'com.apple.pkg.DeveloperToolsCLI' found at '/'.gyp: No Xcode or CLT version detected!gyp ERR! configure errorgyp ERR! stack Error: `gyp` failed with exit code: 1gyp ERR! stack     at ChildProcess.onCpExit (/Users/marvin/.nvm/versions/node/v12.8.0/lib/node_modules/npm/node_modules/node-gyp/lib/configure.js:344:16)gyp ERR! stack     at ChildProcess.emit (events.js:203:13)gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:272:12)gyp ERR! System Darwin 19.6.0gyp ERR! command "/Users/marvin/.nvm/versions/node/v12.8.0/bin/node" "/Users/marvin/.nvm/versions/node/v12.8.0/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "rebuild"gyp ERR! cwd /Users/marvin/git/opensource/react/antd-pro/node_modules/jest-environment-jsdom-fourteen/node_modules/fseventsgyp ERR! node -v v12.8.0gyp ERR! node-gyp -v v5.0.3gyp ERR! not ok<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨æŸ¥è¯¢é”™è¯¯ï¼Œç»ˆäº<a href="https://juejin.im/post/6844904058076020743">https://juejin.im/post/6844904058076020743</a>ä¸Šæ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><ol><li>å°è¯•ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œä¿®å¤<pre class="line-numbers language-shell"><code class="language-shell">$ xcode-select --install<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>å¤åˆ¶ä»£ç ç³»ç»Ÿæç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼š<pre class="line-numbers language-shell"><code class="language-shell">xcode-select: error: command line tools are already installed, use "Software Update" to install updates<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>å¤åˆ¶ä»£ç è€Œäº‹å®ä¸Šå¹¶æ²¡æœ‰æ‰€è°“çš„â€Software Updateâ€å¯ä»¥æ›´æ–°</li><li>æ­£ç¡®å§¿åŠ¿<br>ä¸€ç­¹è«å±•ä¹‹é™…ï¼Œæ‰¾åˆ°å¦‚ä¸‹è§£å†³æ–¹æ¡ˆï¼š<pre class="line-numbers language-shell"><code class="language-shell">$ sudo rm -rf $(xcode-select -print-path)$ xcode-select --install<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>ç»ˆäºå®‰è£…æˆåŠŸäº†ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> antd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡é…ç½®æœ¬åœ°å…¬ä¼—å·å¼€å‘ç¯å¢ƒ</title>
      <link href="2020/08/06/wei-xin-pei-zhi-ben-di-gong-zhong-hao-kai-fa-huan-jing/"/>
      <url>2020/08/06/wei-xin-pei-zhi-ben-di-gong-zhong-hao-kai-fa-huan-jing/</url>
      
        <content type="html"><![CDATA[<p>é…ç½®å¾®ä¿¡å…¬ä¼—å·çš„æœ¬åœ°å¼€å‘ç¯å¢ƒ<br><a href="https://www.jianshu.com/p/05a58682cbac">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="ç¬¬ä¸€æ­¥ï¼šç”³è¯·å¾®ä¿¡æµ‹è¯•å·"><a href="#ç¬¬ä¸€æ­¥ï¼šç”³è¯·å¾®ä¿¡æµ‹è¯•å·" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šç”³è¯·å¾®ä¿¡æµ‹è¯•å·"></a>ç¬¬ä¸€æ­¥ï¼šç”³è¯·å¾®ä¿¡æµ‹è¯•å·</h2><p><a href="https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&amp;t=sandbox/index">https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&amp;t=sandbox/index</a></p><p> <img src="/loading.gif" data-original="/images/fontend/weixin-setting.png" alt="å¾®ä¿¡æµ‹è¯•å·è®¾ç½®-é•¿å›¾"></p><h2 id="ç¬¬äºŒæ­¥ï¼šåœ¨ç”³è¯·çš„æµ‹è¯•å·ä¸Šé…ç½®å›è°ƒåŸŸåç­‰"><a href="#ç¬¬äºŒæ­¥ï¼šåœ¨ç”³è¯·çš„æµ‹è¯•å·ä¸Šé…ç½®å›è°ƒåŸŸåç­‰" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šåœ¨ç”³è¯·çš„æµ‹è¯•å·ä¸Šé…ç½®å›è°ƒåŸŸåç­‰"></a>ç¬¬äºŒæ­¥ï¼šåœ¨ç”³è¯·çš„æµ‹è¯•å·ä¸Šé…ç½®å›è°ƒåŸŸåç­‰</h2><p><img src="/loading.gif" data-original="/images/fontend/weixin-set-appid.png" alt="é…ç½®å›è°ƒåŸŸå"></p><h2 id="ç¬¬ä¸‰æ­¥ï¼šæ ¸å¿ƒ"><a href="#ç¬¬ä¸‰æ­¥ï¼šæ ¸å¿ƒ" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæ ¸å¿ƒ"></a>ç¬¬ä¸‰æ­¥ï¼šæ ¸å¿ƒ</h2><p>åœ¨ä¸Šé¢çš„<code>| ç½‘é¡µå¸å· | [ç½‘é¡µæˆæƒè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯]"ç½‘é¡µæˆæƒè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯" </code>åç‚¹å‡»ã€ä¿®æ”¹ã€‘,å¢åŠ æœ¬åœ°ipï¼Œæ³¨æ„</p><blockquote><p>ä¸€å®šå¸¦ç€ç«¯å£å·</p></blockquote><p><img src="/loading.gif" data-original="/images/fontend/weixin-oauth-url.png" alt="OAuth2.0ç½‘é¡µæˆæƒé…ç½®"></p><h2 id="ç¬¬å››æ­¥ï¼šå¾®ä¿¡å¼€å‘è€…å·¥å…·è®¿é—®åœ°å€"><a href="#ç¬¬å››æ­¥ï¼šå¾®ä¿¡å¼€å‘è€…å·¥å…·è®¿é—®åœ°å€" class="headerlink" title="ç¬¬å››æ­¥ï¼šå¾®ä¿¡å¼€å‘è€…å·¥å…·è®¿é—®åœ°å€"></a>ç¬¬å››æ­¥ï¼šå¾®ä¿¡å¼€å‘è€…å·¥å…·è®¿é—®åœ°å€</h2><p>redirect_uriè¦<a href="http://tool.chinaz.com/tools/urlencode.aspx">åœ¨è¿™å„¿</a>è¿›è¡ŒURLç¼–ç ï¼Œç„¶åç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€<br><code>https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx6d8c0247f15f96df&amp;redirect_uri=http%3a%2f%2f192.168.0.110%3a8000%2fweixin-redirect&amp;response_type=code&amp;scope=snsapi_userinfo&amp;state=STATE#wechat_redirect</code></p><p>çœ‹åˆ°çš„å¦‚å›¾ï¼š<br><img src="/loading.gif" data-original="/images/fontend/weixin-auth.png" alt="å¾®ä¿¡æˆæƒé¡µé¢"></p><h2 id="å¸¸è§é”™è¯¯"><a href="#å¸¸è§é”™è¯¯" class="headerlink" title="å¸¸è§é”™è¯¯"></a>å¸¸è§é”™è¯¯</h2><ul><li>redirect_uri å‚æ•°é”™è¯¯</li></ul><ol><li>å¾®ä¿¡æµ‹è¯•å·ä¸Šæ²¡æœ‰é…ç½®æˆæƒå›è°ƒåŸŸå</li><li>é…ç½®çš„æˆæƒå›è°ƒé¡µé¢åŸŸåè·Ÿè¯·æ±‚æ—¶å¸¦ç€çš„å‚æ•°ä¸ä¸€æ ·</li><li>æœ¬åœ°å¼€å‘æœ‰ç«¯å£ï¼Œé…ç½®çš„å›è°ƒåŸŸåæ²¡æœ‰å¸¦ç€ç«¯å£</li></ol>]]></content>
      
      
      <categories>
          
          <category> cljs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾®ä¿¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€è½¬ã€‘Clojure å¼•ç”¨javaæ–‡ä»¶ lein javac æŠ¥ClassNotFoundException</title>
      <link href="2020/07/23/zhuan-clojure-yin-yong-java-wen-jian-lein-javac-bao-classnotfoundexception/"/>
      <url>2020/07/23/zhuan-clojure-yin-yong-java-wen-jian-lein-javac-bao-classnotfoundexception/</url>
      
        <content type="html"><![CDATA[<p>åœ¨luminus webçš„clojureæ¨¡æ¿é‡Œç›´æ¥ä½¿ç”¨javaæ–‡ä»¶çš„æ­£ç¡®å§¿åŠ¿ã€‚<br><a href="https://www.jianshu.com/p/80e3fcb4267e">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ç»è¿‡ä¸¤æ¬¡æ‰å½»åº•è§£å†³çš„ä¸€ä¸ªé—®é¢˜ï¼ŒæŠŠåŒäº‹æ€»è®¡çš„åœ¨è‡ªå·±çš„å°æœ¬å­ä¸Šè½¬å­˜ä¸€ä¸‹ã€‚<a href="%5Bhttp://blog.3vyd.com/blog/posts-output/2020-07-04-Clojure-Java-%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E9%94%99%E8%AF%AF/%5D(http://blog.3vyd.com/blog/posts-output/2020-07-04-Clojure-Java-%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E9%94%99%E8%AF%AF/)">çŒ›æˆ³æ­¤å¤„</a>è¿›å…¥æˆ‘å¸blogç³»ç»Ÿã€‚</p><p>åœ¨Clojureä¸­ä½¿ç”¨Luminusè¿›è¡ŒWebå¼€å‘æ—¶ï¼Œå¦‚æœæœ‰è‡ªå®šä¹‰Javaæ–‡ä»¶ï¼Œåœ¨<strong>å¼€å‘ç¯å¢ƒ</strong>ä¸­ç¼–è¯‘ï¼ˆ<code>lein javac</code>ï¼‰æ—¶ï¼Œä¼šå‡ºç°<code>ClassNotFoundException</code>é”™è¯¯ã€‚</p><p>äº§ç”ŸåŸå› ï¼šåœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œ<code>env-&gt;dev-&gt;clj-&gt;user.clj</code>æ–‡ä»¶ä¼šè‡ªåŠ¨åŠ è½½ï¼Œå¹¶ä¸”æ˜¯åœ¨Javaæ–‡ä»¶ç¼–è¯‘å‰æ‰§è¡Œã€‚<code>user.clj</code>æ–‡ä»¶ä¼šå¼•ç”¨<code>core</code>ä¸‹çš„<code>start-app</code>ï¼Œ<code>core.clj</code>æ–‡ä»¶åˆä¼šå¼•ç”¨<code>handler</code>ï¼Œå¦‚æœåœ¨<code>handler</code>çš„å¼•ç”¨æ–‡ä»¶ä¸­å¼•ç”¨äº†è‡ªå®šä¹‰Javaç±»æ—¶ï¼Œå°±ä¼šå‡ºç°<code>ClassNotFoundException</code>é”™è¯¯ã€‚</p><p>è§£å†³æ–¹æ³•ä¸€ï¼šä¿®æ”¹<code>user.clj</code>æ–‡ä»¶å</p><pre class="line-numbers language-clojure"><code class="language-clojure">;; 1. å°† user.clj æ–‡ä»¶åä¿®æ”¹ä¸º hctest.clj;; 2. ä¿®æ”¹ hctest.clj æ–‡ä»¶å‘½åç©ºé—´(ns hctest);; 3. ä¿®æ”¹ project.clj æ–‡ä»¶ä¸‹çš„ :project/dev -> :repl-options -> :init-ns å€¼{:project/dev {:repl-options  {:init-ns hctest}}}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£å†³æ–¹æ³•äºŒï¼šç§»åŠ¨<code>user.clj</code>æ–‡ä»¶</p><pre class="line-numbers language-clojure"><code class="language-clojure">;; å¯é€‰ --> 1. ä¿®æ”¹ project.clj ä¸‹çš„ :profiles -> :uberjar -> :prep-tasksï¼Œåœ¨å¼€å§‹æ·»åŠ  "javac"{:profiles {:uberjar   {:prep-tasks ["javac" "compile"]}}};; 2. å°† env->clj->user.clj æ–‡ä»¶ç§»åˆ°åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ä¸‹ï¼Œæ¯”å¦‚ env->clj->empty-> user.cljï¼Œå¹¶ä¿®æ”¹å‘½åç©ºé—´ä¸º empty.user(ns empty.user);; 3. ä¿®æ”¹ project.clj ä¸‹çš„ :project/dev -> :repl-options -> :init-ns å€¼{:project/dev {:repl-options  {:init-ns empty.user}}}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h4><p><a href="https://github.com/luminus-framework/luminus-template/issues/319">https://github.com/luminus-framework/luminus-template/issues/319</a></p>]]></content>
      
      
      <categories>
          
          <category> clojure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>postgressqlæ•°æ®åº“+postgrestæœåŠ¡æ­å»º</title>
      <link href="2020/06/21/postgressql-shu-ju-ku-postgrest-fu-wu-da-jian/"/>
      <url>2020/06/21/postgressql-shu-ju-ku-postgrest-fu-wu-da-jian/</url>
      
        <content type="html"><![CDATA[<p>åœ¨linuxä¸Šæ­å»ºpostgresqlå’ŒpostgrestæœåŠ¡<br><a href="https://www.jianshu.com/p/a71fa1207042">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ç¯å¢ƒï¼šubuntu</p><h2 id="å¼€ç¯‡"><a href="#å¼€ç¯‡" class="headerlink" title="å¼€ç¯‡"></a>å¼€ç¯‡</h2><p>postgresqlæ˜¯åˆä¸€æ¬¾å¼€æºçš„å…³ç³»æ•°æ®åº“ï¼Œç»å¸¸æœ‰äººæ‹¿æ¥è·Ÿmysqlè¿›è¡Œå¯¹æ¯”ï¼Œæ¯”å¦‚<a href="https://www.zhihu.com/question/20010554">PostgreSQL ä¸ MySQL ç›¸æ¯”ï¼Œä¼˜åŠ¿ä½•åœ¨ï¼Ÿ</a>ï¼Œä¸Šç½‘æœäº†ä¸‹ï¼Œè¿˜çœŸä¸å°‘ã€‚æœ¬äººäº†è§£å¤ªå°‘ï¼Œä¸åšè¯„è®ºï¼Œè€æ¿è¦æ±‚ç”¨ç”¨å’±å°±ç”¨ï¼Œåˆå¯ä»¥å­¦ä¸œè¥¿äº†ï¼ˆåˆæœ‰å‘è¦è¸©äº†ï¼‰ï¼Œå­¦æ— æ­¢å¢ƒâ€¦ã€‚</p><h2 id="postgresSql"><a href="#postgresSql" class="headerlink" title="postgresSql"></a>postgresSql</h2><h4 id="1-å®‰è£…æœåŠ¡"><a href="#1-å®‰è£…æœåŠ¡" class="headerlink" title="1.å®‰è£…æœåŠ¡"></a>1.å®‰è£…æœåŠ¡</h4><pre class="line-numbers language-shell"><code class="language-shell">sudo apt updatesudo apt install postgresql postgresql-contrib<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2-è¿›å…¥æœåŠ¡"><a href="#2-è¿›å…¥æœåŠ¡" class="headerlink" title="2.è¿›å…¥æœåŠ¡"></a>2.è¿›å…¥æœåŠ¡</h4><p>ä¸Šä¸€æ­¥å®‰è£…å®Œæˆåï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¯åŠ¨æœåŠ¡ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">service postgresql statusservice postgresql start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒPostgreSQL ä¼šåˆ›å»ºä¸€ä¸ªæ‹¥æœ‰æ‰€æƒé™çš„ç‰¹æ®Šç”¨æˆ· postgresã€‚è¦å®é™…ä½¿ç”¨ PostgreSQLï¼Œä½ å¿…é¡»å…ˆç™»å½•è¯¥è´¦æˆ·ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">sudo su postgres<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½ çš„æç¤ºç¬¦ä¼šæ›´æ”¹ä¸ºç±»ä¼¼äºä»¥ä¸‹çš„å†…å®¹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">postgres@ubuntu-VirtualBox:/home/ubuntu$ <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç°åœ¨ï¼Œä½¿ç”¨ psql æ¥å¯åŠ¨ PostgreSQL Shellï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">psql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½ åº”è¯¥ä¼šçœ‹åˆ°å¦‚ä¸‹æç¤ºç¬¦ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">postgress=#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¦æŸ¥çœ‹ç°æœ‰çš„æ‰€æœ‰è¡¨ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">\l<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½ å¯ä»¥è¾“å…¥ \q ä»¥é€€å‡ºï¼Œè¾“å…¥ ? è·å–å¸®åŠ©ã€‚å…¶ä»–æ›´å¤šå‘½ä»¤å‚è€ƒï¼š<a href="https://blog.csdn.net/ifucking/article/details/80005241">PostgreSQLå‘½ä»¤è¡Œå¸¸ç”¨å‘½ä»¤psql</a></p><h4 id="3-ä¿®æ”¹postgresæ•°æ®åº“ç”¨æˆ·çš„å¯†ç "><a href="#3-ä¿®æ”¹postgresæ•°æ®åº“ç”¨æˆ·çš„å¯†ç " class="headerlink" title="3.ä¿®æ”¹postgresæ•°æ®åº“ç”¨æˆ·çš„å¯†ç "></a>3.ä¿®æ”¹postgresæ•°æ®åº“ç”¨æˆ·çš„å¯†ç </h4><ol><li>æ‰“å¼€å®¢æˆ·ç«¯å·¥å…·ï¼ˆpsqlï¼‰<pre class="line-numbers language-shell"><code class="language-shell">sudo -u postgres psql  (æˆ–è€…åˆ†ä¸¤æ­¥ï¼š sudo -u postgres -i; psql)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>å…¶ä¸­ï¼Œ<code>sudo -u postgres </code>æ˜¯ä½¿ç”¨postgres ç”¨æˆ·ç™»å½•çš„æ„æ€</li></ol><p>PostgreSQLæ•°æ®é»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªpostgresçš„æ•°æ®åº“ç”¨æˆ·ä½œä¸ºæ•°æ®åº“çš„ç®¡ç†å‘˜ï¼Œå¯†ç æ˜¯éšæœºçš„ï¼Œåˆ›å»ºç”¨æˆ·ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">postgres=# <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>postgres=# </code>ä¸ºPostgreSQLä¸‹çš„å‘½ä»¤æç¤ºç¬¦ï¼Œâ€“æ³¨æ„æœ€åçš„åˆ†å·ï¼›</p><ol start="2"><li>é€€å‡ºPostgreSQL psqlå®¢æˆ·ç«¯<pre class="line-numbers language-shell"><code class="language-shell">postgres=# \q<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><ol start="4"><li>ä¿®æ”¹ubuntuæ“ä½œç³»ç»Ÿçš„postgresç”¨æˆ·çš„å¯†ç ï¼ˆå¯†ç è¦ä¸æ•°æ®åº“ç”¨æˆ·postgresçš„å¯†ç ç›¸åŒï¼‰</li></ol><ul><li><p>åˆ‡æ¢åˆ°rootç”¨æˆ·</p><pre class="line-numbers language-shell"><code class="language-shell">su root  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>åˆ é™¤PostgreSQLç”¨æˆ·å¯†ç </p><pre class="line-numbers language-shell"><code class="language-shell">sudo passwd -d postgres<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>passwd -d æ˜¯æ¸…ç©ºæŒ‡å®šç”¨æˆ·å¯†ç çš„æ„æ€</p></li><li><p>è®¾ç½®PostgreSQLç³»ç»Ÿç”¨æˆ·çš„å¯†ç </p><pre class="line-numbers language-shell"><code class="language-shell">sudo -u postgres passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŒ‰ç…§æç¤ºï¼Œè¾“å…¥ä¸¤æ¬¡æ–°å¯†ç </p></li></ul><p>è¾“å…¥æ–°çš„ UNIX å¯†ç </p><p>é‡æ–°è¾“å…¥æ–°çš„ UNIX å¯†ç </p><p>passwdï¼šå·²æˆåŠŸæ›´æ–°å¯†ç </p><ol start="5"><li>ä¿®æ”¹PostgresSQLæ•°æ®åº“é…ç½®å®ç°è¿œç¨‹è®¿é—®<pre class="line-numbers language-shell"><code class="language-shell">vi /etc/postgresql/9.5/main/postgresql.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>ç›‘å¬ä»»ä½•åœ°å€è®¿é—®ï¼Œä¿®æ”¹è¿æ¥æƒé™<pre class="line-numbers language-shell"><code class="language-shell">#listen_addresses = 'localhost' æ”¹ä¸º listen_addresses = '*' (uncomment it)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>å¯ç”¨å¯†ç éªŒè¯<pre class="line-numbers language-shell"><code class="language-shell">#password_encryption = on æ”¹ä¸º password_encryption = on (uncomment it)vi /etc/postgresql/9.6/main/pg_hba.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>åœ¨æ–‡æ¡£æœ«å°¾åŠ ä¸Šä»¥ä¸‹å†…å®¹<pre class="line-numbers language-shell"><code class="language-shell">host all all 0.0.0.0 0.0.0.0 md5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><p>åˆ›å»ºç”¨æˆ·ã€æ•°æ®åº“ï¼Œæˆæƒ</p><pre class="line-numbers language-postgresql"><code class="language-postgresql">postgres=# CREATE USER training WITH CREATEROLE PASSWORD 'training_plat';postgres=# CREATE DATABASE traindb OWNER lizy;postgres=# GRANT ALL PRIVILEGES ON DATABASE traindb to lizy;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>postgresqlçš„æ•™ç¨‹ï¼Œç›®å‰åˆšä¸Šæ‰‹ï¼Œæ¨èï¼š</p><h2 id="postgrestæœåŠ¡"><a href="#postgrestæœåŠ¡" class="headerlink" title="postgrestæœåŠ¡"></a>postgrestæœåŠ¡</h2><p>ä½¿ç”¨æºç ä¸‹è½½å®‰è£…çš„æ–¹å¼</p><h4 id="1-å®‰è£…"><a href="#1-å®‰è£…" class="headerlink" title="1. å®‰è£…"></a>1. å®‰è£…</h4><pre class="line-numbers language-shell"><code class="language-shell"># download from https://github.com/PostgREST/postgrest/releases/latest# ä¸‹è½½åè¿›è¡Œè§£å‹curl https://github.com/PostgREST/postgrest/releases/download/v7.0.1/postgrest-v7.0.1-linux-x64-static.tar.xztar xfJ postgrest-v7.0.1-linux-x64-static.tar.xz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£å‹æ–‡ä»¶åªæœ‰ä¸€ä¸ªåä¸º<code>postgrest</code>çš„å¯æ‰§è¡Œè„šæœ¬ã€‚</p><h4 id="2-è¿è¡ŒpostgrestæœåŠ¡"><a href="#2-è¿è¡ŒpostgrestæœåŠ¡" class="headerlink" title="2.è¿è¡ŒpostgrestæœåŠ¡"></a>2.è¿è¡ŒpostgrestæœåŠ¡</h4><p>è¿è¡Œpostgrestæ˜¯éœ€è¦æŒ‡å®šä¸€ä¸ªconfæ–‡ä»¶ï¼Œæ–‡ä»¶åå¯ä»¥éšæ„ï¼Œæ¯”å¦‚<code>tutorial.conf</code>,å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-conf"><code class="language-conf">db-uri = "postgres://training:training_plat@localhost:5432/traindb"db-schema = "testapp_db, basic_auth,global_info"db-anon-role = "training"jwt-secret = "MqQx7uwtxH3JjphNvRzgeQMkNjDt5JzfpqWwNHrQ13c="log_statement = "all"server-port = 3032<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä¸æŒ‡å®š<code>server-port</code>,åˆ™é»˜è®¤çš„ç«¯å£æ˜¯3000ã€‚<br>æœ‰äº†é…ç½®æ–‡ä»¶ååœ¨è§£å‹åçš„ç›®å½•æ‰§è¡Œ</p><pre class="line-numbers language-shell"><code class="language-shell">./postgrest tutorial.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¨èï¼šæ€»æ˜¯åœ¨è§£å‹ç›®å½•æ‰§è¡Œå¯æ‰§è¡Œè„šæœ¬ï¼Œå†™è·¯å¾„è¿˜æ˜¯éº»çƒ¦äº†äº›ï¼Œå¯ä»¥å°†æ­¤è„šæœ¬åŠ å…¥ç¯å¢ƒå˜é‡<code>/usr/local/bin</code>ä¸‹ï¼Œè¿™æ ·ä»»æ„ç›®å½•éƒ½å¯ä»¥æ‰§è¡Œè¯¥å‘½ä»¤ã€‚</p><h2 id="ä¸€ä¸ªç®€å•ç”¨æ¥å¯åŠ¨postgrestçš„è„šæœ¬"><a href="#ä¸€ä¸ªç®€å•ç”¨æ¥å¯åŠ¨postgrestçš„è„šæœ¬" class="headerlink" title="ä¸€ä¸ªç®€å•ç”¨æ¥å¯åŠ¨postgrestçš„è„šæœ¬"></a>ä¸€ä¸ªç®€å•ç”¨æ¥å¯åŠ¨postgrestçš„è„šæœ¬</h2><p>ä½œç”¨ï¼šä¿®æ”¹äº†æ•°æ®åº“ä»¥åï¼Œéœ€è¦é‡å¯postgrestæœåŠ¡ï¼Œæ¥å£æ‰èƒ½ç”Ÿæ•ˆï¼Œåœ¨jenkinsä¸Šå¯ä»¥æ‰§è¡Œè„šæœ¬é‡å¯ï¼Œè„šæœ¬å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/bash#è·å–ç¬¬1ä¸ªå‚æ•°ï¼Œconfæ–‡ä»¶ï¼Œè·¯å¾„+æ–‡ä»¶å#è·å–ç¬¬2ä¸ªå‚æ•°ï¼ŒpostgrestæœåŠ¡çš„logç›®å½•config_file=$1log_dir=$2echo "================== server restart start======================="pid=`ps -aux | grep ${config_file} | grep -v bash |grep -v grep | awk '{print $2}'`if [ -n "${pid}" ]then#!kill -9 å¼ºåˆ¶ç»ˆæ­¢   echo "kill -9 çš„pid:" $pid   kill -9 $pidfinohup postgrest ${config_file} > ${log_dir}nohup.log 2>&1 &echo "================== server restart end ======================="<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¡ºä¾¿ï¼Œæ¨èä¸€æ¬¾macçš„æ•°æ®åº“è¿æ¥å®¢æˆ·ç«¯<code>Dbeaver</code>å°¤å…¶æ˜¯çœ‹postgresqlçš„è¡¨å…³è”å…³ç³»è¿˜æ˜¯å¾ˆä¸é”™çš„ã€‚<br><img src="/loading.gif" data-original="/images/mysql/ER.png" alt="ERå›¾"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.cnblogs.com/tanql/p/10444512.html">Install Postgresql on Ubuntu</a><br><a href="http://postgrest.org/">PostgRESTå®˜ç½‘</a></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> postgrest </tag>
            
            <tag> postgresql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>emacsçš„cider-debug-defun-point</title>
      <link href="2020/06/08/emacs-de-cider-debug-defun-point/"/>
      <url>2020/06/08/emacs-de-cider-debug-defun-point/</url>
      
        <content type="html"><![CDATA[<p>ç”¨emacså·¥å…·debugåç«¯çš„cljä»£ç </p><p><a href="https://www.jianshu.com/p/36a065d7d46c">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æ¼”ç¤ºä»£ç </p><pre class="line-numbers language-clojure"><code class="language-clojure">;; 1. Call M-x cider-debug-init-connectiong(only needed once),;; 2. Call M-x cider-debug-defun-at-ponit with point inside this defn.;; 3. Run the function, and using key word;; 4. link:https://docs.cider.mx/cider/debugging/debugger.html(defn foo [n]  (map (partial * 2)       (filter even?               (range 0 n))));; break out when reaching a condition(defn foo2 []  (dotimes [i 10]    #dbg ^{:break/when (= i 7)}    (prn i)))(defn eval-msg [{:keys [inspect] :as msg}]  (if inspect    #break (clojure.inspector/inspect msg)    msg))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿›å…¥debug<br><code>M-x cider-debug-defun-at-point</code></p><p>å¸¸è§çš„æ“ä½œï¼š</p><p>j   Inject a value into running code</p><p>e   <code>C-c M-:</code>  è¡¨è¾¾å¼æ±‚å€¼</p><p>enlightenæ¨¡å¼ï¼šæŸ¥çœ‹æœ€åä¸€æ¬¡è¡¨è¾¾å¼çš„å€¼<br><code> M-x cider-enlighten-mode</code><br><code> C-M-x æˆ–è€… C-x C-e</code> å¼€å§‹æ‰§è¡Œã€‚ <code>C-c C-k</code>å–æ¶ˆæ“ä½œã€‚<br><code> M-x cider-enlighten-mode</code>å…³é—­enlightenæ¨¡å¼</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defn foo2 [x]  (let [y (* 3 x)]    (+ x y)))(defn bar [x]  (dotimes [i x]    (foo2 i)))(bar 5)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://docs.cider.mx/cider/debugging/debugger.html">debugger</a><br><a href="https://docs.cider.mx/cider/debugging/enlighten.html">Enlighten</a></p>]]></content>
      
      
      <categories>
          
          <category> emacs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> emacs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>emacsé‡Œçš„å°æ¸¸æˆ</title>
      <link href="2020/04/24/emacs-li-de-xiao-you-xi/"/>
      <url>2020/04/24/emacs-li-de-xiao-you-xi/</url>
      
        <content type="html"><![CDATA[<p>ç‰©æ–™çš„æ—¶å€™ç©ç©emacsé‡Œçš„å°æ¸¸æˆæ”¾æ¾æ”¾æ¾</p><p><a href="https://www.jianshu.com/p/1cf86d794219">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å¼•ç”¨ï¼š<a href="https://linux.cn/article-11949-1-rel.html">https://linux.cn/article-11949-1-rel.html</a></p><h2 id="1-æ¶ˆæ¶ˆä¹"><a href="#1-æ¶ˆæ¶ˆä¹" class="headerlink" title="1. æ¶ˆæ¶ˆä¹"></a>1. æ¶ˆæ¶ˆä¹</h2><p><code>M-x bubble</code> æ¸¸æˆç›¸å½“ç®€å•ï¼šä½ å¿…é¡»ç”¨å°½å¯èƒ½å°‘ç§»åŠ¨æ¸…é™¤å°½å¯èƒ½å¤šçš„â€œæ³¡æ³¡â€ã€‚å½“ä½ ç§»é™¤æ°”æ³¡æ—¶ï¼Œå…¶ä»–æ°”æ³¡ä¼šæ‰è½å¹¶ç²˜åœ¨ä¸€èµ·ã€‚è¿™æ˜¯ä¸€æ¬¾æœ‰è¶£çš„æ¸¸æˆï¼Œæ­¤å¤–å¦‚æœä½ ä½¿ç”¨ Emacs çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼Œå®ƒè¿˜æ”¯æŒå›¾åƒæ˜¾ç¤ºã€‚è€Œä¸”å®ƒè¿˜æ”¯æŒé¼ æ ‡ã€‚</p><p>ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ <code>M-x bubbles-set-game-&lt;difficulty&gt; </code>æ¥è®¾ç½®éš¾åº¦ï¼Œå…¶ä¸­<code>&lt;difficulty&gt;</code>å¯ä»¥æ˜¯è¿™äº›ä¹‹ä¸€ï¼šeasyã€mediumã€difficultã€hard æˆ– userdefinedã€‚æ­¤å¤–ï¼Œä½ å¯ä»¥ä½¿ç”¨ï¼š<code>M-x custom-group bubbles </code>æ¥æ›´æ”¹å›¾å½¢ã€ç½‘æ ¼å¤§å°å’Œé¢œè‰²ã€‚</p><p>ç”±äºå®ƒå³ç®€å•åˆæœ‰è¶£ï¼Œè¿™æ˜¯ Emacs ä¸­æˆ‘æœ€å–œæ¬¢çš„æ¸¸æˆä¹‹ä¸€ã€‚</p><h2 id="2-äº”å­æ£‹"><a href="#2-äº”å­æ£‹" class="headerlink" title="2. äº”å­æ£‹"></a>2. äº”å­æ£‹</h2><p>ä½ å¿…é¡»å°† 5 ä¸ªæ–¹å—è¿æˆä¸€æ¡çº¿ï¼Œäº•å­—æ£‹é£æ ¼ã€‚ä½ å¯ä»¥è¿è¡Œ <code>M-x gomoku </code>æ¥ä¸ Emacs å¯¹æŠ—ã€‚æ¸¸æˆè¿˜æ”¯æŒé¼ æ ‡ï¼Œéå¸¸æ–¹ä¾¿ã€‚ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ gomoku ç»„æ¥è°ƒæ•´ç½‘æ ¼çš„å¤§å°ã€‚</p><h2 id="3-ä¹’ä¹“ã€è´ªé£Ÿè›‡ã€ä¿„ç½—æ–¯æ–¹å—"><a href="#3-ä¹’ä¹“ã€è´ªé£Ÿè›‡ã€ä¿„ç½—æ–¯æ–¹å—" class="headerlink" title="3. ä¹’ä¹“ã€è´ªé£Ÿè›‡ã€ä¿„ç½—æ–¯æ–¹å—"></a>3. ä¹’ä¹“ã€è´ªé£Ÿè›‡ã€ä¿„ç½—æ–¯æ–¹å—</h2><p>è¿™äº›ç»å…¸æ¸¸æˆéƒ½æ˜¯ä½¿ç”¨ Emacs åŒ… gamegrid å®ç°çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç½‘æ ¼æ¸¸æˆï¼ˆå¦‚ä¿„ç½—æ–¯æ–¹å—å’Œè´ªåƒè›‡ï¼‰çš„é€šç”¨æ¡†æ¶ã€‚gamegrid åŒ…çš„ä¼Ÿå¤§ä¹‹å¤„åœ¨äºå®ƒåŒæ—¶å…¼å®¹å›¾å½¢åŒ–å’Œç»ˆç«¯ Emacsï¼šå¦‚æœä½ åœ¨ GUI ä¸­è¿è¡Œ Emacsï¼Œä½ ä¼šå¾—åˆ°ç²¾ç¾çš„å›¾å½¢ï¼›å¦‚æœä½ æ²¡æœ‰ï¼Œä½ çœ‹åˆ°ç®€å•çš„ ASCII è‰ºæœ¯ã€‚</p><p>ä½ å¯ä»¥é€šè¿‡è¾“å…¥ M-x pongã€M-x snakeã€M-x tetris æ¥è¿è¡Œè¿™äº›æ¸¸æˆã€‚</p><h2 id="4-Zone"><a href="#4-Zone" class="headerlink" title="4. Zone"></a>4. Zone</h2><p>æˆ‘çš„å¦ä¸€ä¸ªæœ€çˆ±ã€‚è¿™æ˜¯ä¸€ä¸ªå±å¹•ä¿æŠ¤ç¨‹åºâ€”â€”æˆ–è€…æ›´ç¡®åˆ‡åœ°è¯´ï¼Œæ˜¯ä¸€ç³»åˆ—çš„å±å¹•ä¿æŠ¤ç¨‹åºã€‚</p><p>è¾“å…¥ <code>M-x zone</code>ï¼Œç„¶åçœ‹çœ‹å±å¹•ä¸Šå‘ç”Ÿäº†ä»€ä¹ˆï¼</p><p>ä½ å¯ä»¥é€šè¿‡è¿è¡Œ <code>M-x zone-when-idle</code>ï¼ˆæˆ–ä» elisp è°ƒç”¨å®ƒï¼‰æ¥é…ç½®å±å¹•ä¿æŠ¤ç¨‹åºçš„ç©ºé—²æ—¶é—´ï¼Œæ—¶é—´ä»¥ç§’ä¸ºå•ä½ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡ <code>M-x zone-leave-me-alone </code>æ¥å…³é—­å®ƒã€‚</p><p>å¦‚æœåœ¨ä½ çš„åŒäº‹çœ‹ç€çš„æ—¶å€™å¯åŠ¨å®ƒï¼Œä½ çš„åŒäº‹è‚¯å®šä¼šæŠ“ç‹‚çš„ã€‚go</p>]]></content>
      
      
      <categories>
          
          <category> emacs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> emacs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux shell ç›‘æ§åº”ç”¨å­˜æ´»å¹¶å‘é‚®ä»¶é€šçŸ¥</title>
      <link href="2020/04/18/linux-shell-jian-kong-ying-yong-cun-huo-bing-fa-you-jian-tong-zhi/"/>
      <url>2020/04/18/linux-shell-jian-kong-ying-yong-cun-huo-bing-fa-you-jian-tong-zhi/</url>
      
        <content type="html"><![CDATA[<p>curléœ€è¦ç›‘æ§çš„æ¥å£ï¼Œå°†ç»“æœå‘é€é‚®ä»¶é€šçŸ¥ï¼Œä¹Ÿå¯ä»¥åˆ¤æ–­RESTæ¥å£çš„è¿”å›æ•°æ®å†…å®¹ã€‚<br><a href="https://www.jianshu.com/p/4b025d8dc12a">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><ol><li><p>æ¯å¤©æ‰§è¡Œä¸‰æ¬¡ï¼Œåˆ†åˆ«ä¸ºï¼š7:10ï¼Œ12:10ï¼Œ16:10</p></li><li><p>7:10æ‰§è¡Œæ—¥æœŸå‚æ•°ä¸ºT-1ï¼Œ12:10,16:10æ‰§è¡Œæ—¥æœŸå‚æ•°ä¸ºT(Tæ˜¯æŒ‡å½“å¤©)</p></li><li><p>æ¯æ¬¡æ‰§è¡Œåˆ¤æ–­ä¸€ä¸‹æ¥å£è¿”å›çš„æ•°æ®é‡ï¼Œä»¥é‚®ä»¶å½¢å¼å‘é€ç»™ç›¸å…³äººå‘˜</p></li></ol><h2 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h2><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/bashvar1=$1webUrls=("http://sso1169sjdptest.haier.net/fx_app/common/inter?fresh=1&dataType=rrs_fxapp_for_leader&params=period_date::${var1}""http://sso1169sjdptest.haier.net/fx_app/common/inter?fresh=1&dataType=rrs_fxapp_m_wl_gongm_result_info_view&params=period_date::${var1}""http://sso1169sjdptest.haier.net/fx_app/common/inter?fresh=1&dataType=rrs_fxapp_m_wl_lianq_result_info_view&params=period_date::${var1}""http://sso1169sjdptest.haier.net/fx_app/common/inter?fresh=1&dataType=rrs_fxapp_for_soldier_mall_score&params=period_date::${var1}")declare -a name#ä½¿ç”¨curlå‘½ä»¤æ£€æŸ¥httpæœåŠ¡å™¨çš„çŠ¶æ€#-mè®¾ç½®curlä¸ç®¡è®¿é—®æˆåŠŸæˆ–å¤±è´¥ï¼Œæœ€å¤§æ¶ˆè€—çš„æ—¶é—´ä¸º5ç§’ï¼Œ5ç§’è¿æ¥æœæœªå“åº”åˆ™è§†ä¸ºæ— æ³•è¿æ¥#-sè®¾ç½®é™é»˜è¿æ¥ï¼Œä¸æ˜¾ç¤ºè¿æ¥æ—¶çš„è¿æ¥é€Ÿåº¦ã€æ—¶é—´æ¶ˆè€—ç­‰ä¿¡æ¯#-oå°†curlä¸‹è½½çš„é¡µé¢å†…å®¹å¯¼å‡ºåˆ°/dev/null(é»˜è®¤ä¼šåœ¨å±å¹•æ˜¾ç¤ºé¡µé¢å†…å®¹)#-wè®¾ç½®curlå‘½ä»¤éœ€è¦æ˜¾ç¤ºçš„å†…å®¹%{http_code}ï¼ŒæŒ‡å®šcurlè¿”å›æœåŠ¡å™¨çš„çŠ¶æ€ç # å¦‚æœä¸æ˜¯çœ‹ç»“æœï¼Œæ˜¯çœ‹httpçŠ¶æ€çš„è¯ä½¿ç”¨å¦‚ä¸‹å‡½æ•°check_http(){    status_code=$(curl -m 5 -s-o /dev/null -w %{http_code} https://www.baidu.com)}function httpRequest(){    echo  "æ—¥æœŸå‚æ•°ï¼š${var1}"    for ((i=0; i<${#webUrls[@]}; i++))    do        echo "é¡ºåºï¼š${i}ï¼Œè¯·æ±‚ï¼š${webUrls[i]}"        res=$(curl -m 5 -s ${webUrls[i]} | jq '.data' | jq 'length')        name[$i]=$res        echo ${name[$i]} #ä¸ºæ–¹ä¾¿æ£€æŸ¥ï¼ŒåŠ äº†æ‰“å°    done}httpRequest "$@"emailContent="é“¾æ¥æ•°æ®æ¥å£ï¼š${name[0]}      ä¸­å¿ƒæ•°æ®æ¥å£ï¼š${name[1]}      é“¾ç¾¤æ•°æ®æ¥å£ï¼š${name[2]}     è¯„åˆ†æ•°æ®æ¥å£ï¼š${name[3]}"echo "${emailContent}" | mail -s '4ä¸ªæŒ‡æ ‡æ¥å£å½“å‰çš„æ•°æ®é€šçŸ¥' marvin.ma@redcreation.net,zhangsan@163.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ”¶åˆ°çš„é‚®ä»¶ï¼š"><a href="#æ”¶åˆ°çš„é‚®ä»¶ï¼š" class="headerlink" title="æ”¶åˆ°çš„é‚®ä»¶ï¼š"></a>æ”¶åˆ°çš„é‚®ä»¶ï¼š</h2><p><img src="/loading.gif" data-original="https://upload-images.jianshu.io/upload_images/4109786-dcac1c6ef2dffc2d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="email"></p><h2 id="çŸ¥è¯†å‚¨å¤‡"><a href="#çŸ¥è¯†å‚¨å¤‡" class="headerlink" title="çŸ¥è¯†å‚¨å¤‡"></a>çŸ¥è¯†å‚¨å¤‡</h2><h4 id="è·å–å½“å‰æ—¶é—´ï¼š"><a href="#è·å–å½“å‰æ—¶é—´ï¼š" class="headerlink" title="è·å–å½“å‰æ—¶é—´ï¼š"></a>è·å–å½“å‰æ—¶é—´ï¼š</h4><pre class="line-numbers language-shell"><code class="language-shell">time=$(date "+%Y%m%d-%H%M%S")time2=$(date "+%Y-%m-%d %H:%M:%S")echo "${time}"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ˜¨å¤©:</p><pre class="line-numbers language-shell"><code class="language-shell">echo $(date +"%Y-%m-%d" -d "-1day")<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…¶ä»–å‚è€ƒï¼š<a href="https://blog.csdn.net/liu0808/article/details/79899139">shell date è·å–æ˜¨å¤©æ—¥æœŸ</a></p><h4 id="curl-åˆ°jsonå†…å®¹"><a href="#curl-åˆ°jsonå†…å®¹" class="headerlink" title="curl åˆ°jsonå†…å®¹:"></a>curl åˆ°jsonå†…å®¹:</h4><pre class="line-numbers language-shell"><code class="language-shell">#ä½¿ç”¨curlå‘½ä»¤æ£€æŸ¥httpæœåŠ¡å™¨çš„çŠ¶æ€#-mè®¾ç½®curlä¸ç®¡è®¿é—®æˆåŠŸæˆ–å¤±è´¥ï¼Œæœ€å¤§æ¶ˆè€—çš„æ—¶é—´ä¸º5ç§’ï¼Œ5ç§’è¿æ¥æœæœªå“åº”åˆ™è§†ä¸ºæ— æ³•è¿æ¥#-sè®¾ç½®é™é»˜è¿æ¥ï¼Œä¸æ˜¾ç¤ºè¿æ¥æ—¶çš„è¿æ¥é€Ÿåº¦ã€æ—¶é—´æ¶ˆè€—ç­‰ä¿¡æ¯#-oå°†curlä¸‹è½½çš„é¡µé¢å†…å®¹å¯¼å‡ºåˆ°/dev/null(é»˜è®¤ä¼šåœ¨å±å¹•æ˜¾ç¤ºé¡µé¢å†…å®¹)#-wè®¾ç½®curlå‘½ä»¤éœ€è¦æ˜¾ç¤ºçš„å†…å®¹%{http_code}ï¼ŒæŒ‡å®šcurlè¿”å›æœåŠ¡å™¨çš„çŠ¶æ€ç res=$(curl  -s "https://www.baidu.com")echo  $res<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ¥æ”¶å‚æ•°ï¼š"><a href="#æ¥æ”¶å‚æ•°ï¼š" class="headerlink" title="æ¥æ”¶å‚æ•°ï¼š"></a>æ¥æ”¶å‚æ•°ï¼š</h4><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/bash# å¿…é¡»å†™ç»å¯¹è·¯å¾„ï¼Œä¸ç„¶crontabä¸æ‰§è¡Œï¼Œå› ä¸ºæ‰¾ä¸åˆ°è·¯å¾„log=/opt/jc/task.logvar1=$1test(){    time=$(date "+%Y-%m-%d %H:%M:%S")    echo "${time} do something, set var1 = ${var1}" >> $log}test<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•å®šæ—¶ä»»åŠ¡</p><pre class="line-numbers language-shell"><code class="language-shell">vi /etc/crontab<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ·»åŠ ä¸€è¡Œï¼Œæ¯2åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</p><pre class="line-numbers language-shell"><code class="language-shell">*/2 * * * * root /opt/jc/curl.sh hahaha<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸ºäº†å®Œæˆè¿™ä¸ªéœ€æ±‚ï¼Œæˆ‘çš„crontabçš„å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-shell"><code class="language-shell">10 7 * * * root /opt/jc/curl.sh $(date +"%Y%m%d" -d "-1day")10 12,16 * * * root /opt/jc/curl.sh $(date "+%Y%m%d")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="shellå¤„ç†jsonæ•°æ®å·¥å…·â€”â€“jq"><a href="#shellå¤„ç†jsonæ•°æ®å·¥å…·â€”â€“jq" class="headerlink" title="shellå¤„ç†jsonæ•°æ®å·¥å…·â€”â€“jq"></a>shellå¤„ç†jsonæ•°æ®å·¥å…·â€”â€“jq</h4><p>è·å–æ¥å£è¿”å›çš„æ•°æ®ä¸­<code>data</code>çš„å€¼æ•°ç»„å¤§å°</p><pre class="line-numbers language-shell"><code class="language-shell">res=$(curl -m 5 -s ${webUrls[i]}  |  jq '.data'  |  jq 'length')<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…¶ä»–jqçš„ç”¨æ³•å‚è€ƒï¼š<a href="https://www.cnblogs.com/lurenjiashuo/p/bash-json-jq.html">shellè„šæœ¬å¤„ç†JSONæ•°æ®å·¥å…·jq</a></p><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><ol><li><p>è„šæœ¬ä¸æ‰§è¡Œä¸çŸ¥é“ä¸ºå•¥<br>æ–¹æ¡ˆï¼šå…ˆç”¨å¦‚ä¸‹å‘½ä»¤çœ‹çœ‹crontabæœåŠ¡æ˜¯å¦æ­£å¸¸ï¼Œä¸æ­£å¸¸çš„è¿›è¡Œå®‰è£…ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">service crond status<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ²¡æœ‰å®‰è£…çš„è¯å…ˆå®‰è£…ã€‚</p></li><li><p>å®šæ—¶ä»»åŠ¡å‡ºé”™<br>å‡ºé”™çš„æƒ…å†µä¼šæœ‰é‚®ä»¶é€šçŸ¥ï¼Œä½ç½®åœ¨<code>/var/mail/root</code>ä¸­ï¼Œå¯ä»¥æŸ¥çœ‹è„šæœ¬æ‰§è¡Œå¤±è´¥çš„åŸå› </p></li><li><p>Shell è„šæœ¬æ—¶æ˜¾ç¤ºdeclare not foundçš„é—®é¢˜<br>ubuntuç³»ç»Ÿå°†é»˜è®¤çš„bashæ¢æˆäº†dashï¼Œéœ€è¦æ‰‹åŠ¨æ›¿æ¢ä¸‹ï¼Œå‚è€ƒä¸‹é¢çš„å‚è€ƒé“¾æ¥<a href="http://blog.sina.com.cn/s/blog_7cb1c50e0100rapz.html">Shell è„šæœ¬æ—¶æ˜¾ç¤ºdeclare not foundçš„é—®é¢˜</a>é…ç½®ã€‚</p></li></ol><h4 id="shellé‡Œå‘é€é‚®ä»¶"><a href="#shellé‡Œå‘é€é‚®ä»¶" class="headerlink" title="shellé‡Œå‘é€é‚®ä»¶"></a>shellé‡Œå‘é€é‚®ä»¶</h4><p>ä½¿ç”¨<a href="https://www.cnblogs.com/kerrycode/p/6432579.html">sendmail</a>å·¥å…·å‘é€é‚®ä»¶ã€‚<br><a href="http://blog.sina.com.cn/s/blog_7cb1c50e0100rapz.html">Shell è„šæœ¬æ—¶æ˜¾ç¤ºdeclare not foundçš„é—®é¢˜</a></p>]]></content>
      
      
      <categories>
          
          <category> è¿ç»´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux é…ç½®sendmailå‘é€é‚®ä»¶</title>
      <link href="2020/04/18/linux-pei-zhi-sendmail-fa-song-you-jian/"/>
      <url>2020/04/18/linux-pei-zhi-sendmail-fa-song-you-jian/</url>
      
        <content type="html"><![CDATA[<p>linuxæœåŠ¡å™¨é…ç½®sendmailåœ¨å‘½ä»¤è¡Œé‡Œæ–¹ä¾¿å‘é€é‚®ä»¶<br><a href="https://www.jianshu.com/p/e663f29f0eca">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="Ubuntu-å®‰è£…å·¥å…·"><a href="#Ubuntu-å®‰è£…å·¥å…·" class="headerlink" title="Ubuntu å®‰è£…å·¥å…·"></a>Ubuntu å®‰è£…å·¥å…·</h2><pre class="line-numbers language-shell"><code class="language-shell">apt-get install heirloom-mailx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ä¿®æ”¹é…ç½®"><a href="#ä¿®æ”¹é…ç½®" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h2><p><code>vim /etc/s-nail.rc</code>åœ¨æ–‡ä»¶æœ€ååŠ å…¥å¦‚ä¸‹é…ç½®é¡¹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">set from="mailtest@3vyd.com"set smtp="smtp.exmail.qq.com"set smtp-auth-user="mailtest@3vyd.com"set smtp-auth-password="xxxx"set smtp-auth=login<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æµ‹è¯•é‚®ä»¶"><a href="#æµ‹è¯•é‚®ä»¶" class="headerlink" title="æµ‹è¯•é‚®ä»¶"></a>æµ‹è¯•é‚®ä»¶</h2><pre class="line-numbers language-shell"><code class="language-shell">echo "æµ‹è¯•çš„é‚®ä»¶å†…å®¹" | s-nail  -s "æµ‹è¯•çš„é‚®ä»¶ä¸»é¢˜" marvin.ma@redcreation.net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/linux/email-test.png" alt="mail"></p><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><pre class="line-numbers language-shell"><code class="language-shell">root@hk-server:~# Could not connect: Operation now in progressâ€œ/root/dead.letterâ€ 8/209â€¦ message not sent<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæ³¨æ„ï¼å› ä¸ºæ˜¯é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œå¯èƒ½æ˜¯25ç«¯å£è¢«å°ï¼Œå¾—æ”¹ç”¨465ç«¯å£ï¼Œæ‰€ä»¥é…ç½®å†…å®¹é‚£é‡Œè¦æ³¨æ„å°†smtpé…ç½®åŠ ä¸Šç«¯å£ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">set smtp=smtp.exmail.qq.com:465<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="centos"><a href="#centos" class="headerlink" title="centos"></a>centos</h2><ol><li><p>install Mailx </p><pre class="line-numbers language-shell"><code class="language-shell">yum install -y mailx <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>Config SMTP Params</p><pre class="line-numbers language-shell"><code class="language-shell">vi /etc/mail.rc# Add Gmail SMTPset from=yiilib.com_t@gmail.com  #send from mail addressset smtp=smtp.gmail.com    #SMTP server domainset smtp-auth-user=yiilib.com_t  #send accountset smtp-auth-password=mailBoxPassword  #account passwordset smtp-auth=login     #auth way<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>send test </p><pre class="line-numbers language-shell"><code class="language-shell">echo "mail body" |ã€€mail marvin.ma@redcreation.net -s "test mail subject" -a /root/backup/yiilib.com_tmp.sql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><h2 id="ä¸¤ç§å¸¸ç”¨é…ç½®"><a href="#ä¸¤ç§å¸¸ç”¨é…ç½®" class="headerlink" title="ä¸¤ç§å¸¸ç”¨é…ç½®"></a>ä¸¤ç§å¸¸ç”¨é…ç½®</h2><ul><li>è…¾è®¯ä¼ä¸šé‚®ç®±<pre class="line-numbers language-shell"><code class="language-shell">set from="mailtest@3vyd.com"set smtp="smtp.exmail.qq.com"set smtp-auth-user="mailtest@3vyd.com"set smtp-auth-password="xxxx"set smtp-auth=login<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>163ç½‘æ˜“é‚®ç®±(å¯†ç æ˜¯æŒ‡å®¢æˆ·ç«¯æˆæƒå¯†ç )<pre class="line-numbers language-shell"><code class="language-shell">set from="chuangkehui@163.com"set smtp="smtp.163.com"set smtp-auth-user="chuangkehui@163.com"set smtp-auth-password="xxxx"set smtp-auth=login<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><a href="https://blog.csdn.net/MissEel/article/details/79588808">Linuxå‘é‚®ä»¶-ubuntuå’Œcentos</a><br><a href="http://yiilib.com/en/topic/731/Centos+use+Mailx+send+SMTP+Mail">http://yiilib.com/en/topic/731/Centos+use+Mailx+send+SMTP+Mail</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> è¿ç»´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojureScripté¡µé¢å›½é™…åŒ–(i18nå¤šè¯­è¨€)å®ç°</title>
      <link href="2020/04/04/clojurescript-i18n/"/>
      <url>2020/04/04/clojurescript-i18n/</url>
      
        <content type="html"><![CDATA[<p>clojurescript å›½é™…åŒ–æ ¸å¿ƒä»£ç </p><p><a href="https://www.jianshu.com/p/97867dd37db5">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="å…ˆçœ‹ä¸‹æ•ˆæœï¼ˆè¯æ˜æ˜¯å®è·µè¿‡çš„ï¼‰"><a href="#å…ˆçœ‹ä¸‹æ•ˆæœï¼ˆè¯æ˜æ˜¯å®è·µè¿‡çš„ï¼‰" class="headerlink" title="å…ˆçœ‹ä¸‹æ•ˆæœï¼ˆè¯æ˜æ˜¯å®è·µè¿‡çš„ï¼‰"></a>å…ˆçœ‹ä¸‹æ•ˆæœï¼ˆè¯æ˜æ˜¯å®è·µè¿‡çš„ï¼‰</h2><p><img src="/loading.gif" data-original="/images/cljs/i18n-zh-cn.png" alt="ä¸­æ–‡"></p><p><img src="/loading.gif" data-original="/images/cljs/i18n-en.png" alt="è‹±æ–‡"></p><p>å›½é™…åŒ–æ–¹æ¡ˆæ¯”è¾ƒå¤šï¼Œé¡µé¢ä¸Šçš„å›½é™…åŒ–ä¸€èˆ¬æ¯”è¾ƒç®€å•ï¼Œéº»çƒ¦çš„è¿˜æ˜¯æ•°æ®åº“çš„æ•°æ®çš„å›½é™…åŒ–ã€‚<br>æœ¬åœ°cljsé‡Œçš„å›½é™…åŒ–é‡‡ç”¨å‰ç«¯dbçš„atomæ§åˆ¶å½“å‰è¯­è¨€ï¼Œæ‰€æœ‰å¯è§çš„ç¿»è¯‘åˆ†ä¸ºé¡µé¢éƒ¨åˆ†å’Œæ•°æ®åº“éƒ¨åˆ†ï¼Œæœ€ååœ¨é€šè¿‡æ¥å£æ‹¿åˆ°æ•°æ®åº“çš„ç¿»è¯‘åè·Ÿé¡µé¢çš„è¿›è¡Œmergeã€‚</p><h2 id="æ–¹æ¡ˆåŸç†"><a href="#æ–¹æ¡ˆåŸç†" class="headerlink" title="æ–¹æ¡ˆåŸç†"></a>æ–¹æ¡ˆåŸç†</h2><ol><li>å°†å½“å‰ç”¨æˆ·è®¾å®šçš„è¯­è¨€ä¿å­˜åœ¨æœ¬åœ°localstorageï¼Œå¹¶ä¸”ä¿å­˜åœ¨é¡µé¢dbä¸­ã€‚</li><li>åˆ‡æ¢è¯­è¨€æ—¶ï¼Œæ¯ä¸ªéœ€è¦å›½é™…åŒ–çš„æ–‡æ¡ˆå‰å¢åŠ <code>i18n-str</code>å‡½æ•°è°ƒç”¨ï¼Œå®æ—¶è·å–ç›®æ ‡æ–‡æ¡ˆå¯¹åº”çš„i18næ–‡æ¡ˆã€‚</li><li>æµè§ˆå™¨è¢«åˆ·æ–°æ—¶ä»localstorageä¸­å›å¤å·²ç»é€‰æ‹©çš„è¯­éŸ³ç±»å‹ã€‚</li><li>å¯è§†çš„å¤šè¯­è¨€æ–‡æ¡ˆï¼Œåˆ†ä¸ºé¡µé¢éƒ¨åˆ†æ•°æ•°æ®åº“éƒ¨åˆ†ï¼Œåœ¨å‰ç«¯è¿›è¡Œmergeå¤„ç†ï¼Œä¿å­˜æˆä¸€ä¸ªã€‚</li></ol><h2 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h2><p>å‰ç«¯ä½¿ç”¨re-frameã€kee-frameã€shadow-cljsã€antdæ¡†æ¶</p><h2 id="å½“å‰æ–¹æ¡ˆæ ¸å¿ƒä»£ç "><a href="#å½“å‰æ–¹æ¡ˆæ ¸å¿ƒä»£ç " class="headerlink" title="å½“å‰æ–¹æ¡ˆæ ¸å¿ƒä»£ç "></a>å½“å‰æ–¹æ¡ˆæ ¸å¿ƒä»£ç </h2><p>åˆ†é¡µé¡µé¢éƒ¨åˆ†ï¼Œåˆ‡æ¢è¯­è¨€éƒ¨åˆ†ï¼ˆä¿å­˜dbï¼Œä¿å­˜localstorageï¼Œé˜²æ­¢æ‰‹åŠ¨åˆ·æ–°é¡µé¢æ—¶æ•°æ®è¿˜åŸï¼‰ã€‚</p><h4 id="1-é¡µé¢åˆ‡æ¢ä»£ç "><a href="#1-é¡µé¢åˆ‡æ¢ä»£ç " class="headerlink" title="1. é¡µé¢åˆ‡æ¢ä»£ç "></a>1. é¡µé¢åˆ‡æ¢ä»£ç </h4><p>ç»§ç»­ä½¿ç”¨antdç»„ä»¶</p><pre class="line-numbers language-cljs"><code class="language-cljs">(def lang (rf/subscribe [:i18n/lang]));; è¯­è¨€(def ^:private language  {:zh-cn "ä¸­æ–‡"   :en-us "English"   :ja-jp "æ—¥æœ¬èª"});; è¯­è¨€èœå•(defn- dropdown-menu []  [:> ant/Menu   {:className "menu"    :onClick   (fn [menu]                 (let [value (js->clj menu :keywordize-keys true)]                   (rf/dispatch [:i18n/change-lang (keyword (:key value))])))}   [:> MenuItem {:key "zh-cn" :title "ä¸­æ–‡"}    [:span (i18n-str "ä¸­æ–‡")]]   [:> MenuItem {:key "en-us" :title "è‹±æ–‡"}    [:span (i18n-str "è‹±æ–‡")]]   [:> MenuItem {:key "ja-jp" :title "æ—¥æ–‡"}    [:span (i18n-str "æ—¥æ–‡")]]])[:div {:style {:margin-left 20                         :font-size   "14px"                         :font-family "PingFangSC-Medium,PingFang SC"                         :font-weight 500                         :color       "rgba(0,0,0,1)"}}           [:> ant/Dropdown {:overlay (reagent.core/as-element [dropdown-menu])}            [:span (i18n-str (or (get language @lang) "ä¸­æ–‡"))]]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-åˆ‡æ¢å’Œä¿å­˜å½“å‰è¯­è¨€"><a href="#2-åˆ‡æ¢å’Œä¿å­˜å½“å‰è¯­è¨€" class="headerlink" title="2. åˆ‡æ¢å’Œä¿å­˜å½“å‰è¯­è¨€"></a>2. åˆ‡æ¢å’Œä¿å­˜å½“å‰è¯­è¨€</h4><pre class="line-numbers language-cljs"><code class="language-cljs">;;é€šè¿‡keyè®¾ç½®å’Œè·å–localstorageé‡Œçš„æ•°æ®(defn set-local-storage [key value]  (.setItem js/localStorage key value))(defn get-local-storage [key]  (.getItem js/localStorage key));;åªè¦è·¯ç”±å˜åŒ–ï¼Œå°±è¦è§¦å‘è·å–å½“å‰è¯­è¨€çš„é€»è¾‘(kf/reg-controller :lang-controller {:params (constantly true)  :start  [::set-lang-by-local]});;å¦‚æœé¡µé¢åˆ·æ–°çš„è¯ä»localstorageé‡Œè·å–(kf/reg-event-fx ::set-lang-by-local (fn [_ [_ _]]   (when-not @(rf/subscribe [:i18n/lang])     (if (get-current-lang)       (rf/dispatch [:i18n/change-lang (get-current-lang)])       (rf/dispatch [:i18n/change-lang :zh-cn])))   {:dispatch [:request/get {:url (:get-lang-map mutil-lang)                             :params {:hostname (.. js/window -location -hostname)}   ;;æ­¤å¤„æ ¹æ®å½“å‰åŸŸåè·å–è¯¥åŸŸåçš„å¯¹åº”ç§Ÿæˆ·çš„å¤šè¯­è¨€æ–‡æ¡ˆ                             :callback-event ::save-db-lang}]}))(kf/reg-event-fx ::save-db-lang (fn [{:keys [db]} [db-lang-map]]   {:db (-> db            (assoc-in [:db-lang-map] db-lang-map))}))(rf/reg-event-fx :i18n/change-lang (fn [{:keys [db]} [_ data]]   (js/console.log "åˆ‡æ¢è¯­è¨€åˆ°ï¼š" data)   (set-current-lang data)   {:db (assoc-in db [:global :lang] data)}))(rf/reg-sub :i18n/lang (fn [data]   (get-in data [:global :lang])))(rf/reg-sub :i18n/db-lang-map (fn [db]   (get-in db [:db-lang-map])))(defn- merge-lang-map  "å¯¹é¡µé¢ä¸Šçš„æ–‡æ¡ˆå’Œdbé‡Œçš„æ–‡æ¡ˆè¿›è¡Œä¸€æ¬¡merge"  [page-lang-map db-lang-map]  (if db-lang-map    (merge page-lang-map           (#(zipmap (map :key %) (map :value %))            db-lang-map))    page-lang-map));;è¿”å›å½“å‰è¯­è¨€çš„å…³é”®å­—(defn i18n-str [s]  (let [lang (rf/subscribe [:i18n/lang])        db-lang-map (rf/subscribe [:i18n/db-lang-map])]    (get-in (merge-lang-map language-map @db-lang-map)            [s @lang] s)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-é¡µé¢æ–‡æ¡ˆç¿»è¯‘"><a href="#3-é¡µé¢æ–‡æ¡ˆç¿»è¯‘" class="headerlink" title="3. é¡µé¢æ–‡æ¡ˆç¿»è¯‘"></a>3. é¡µé¢æ–‡æ¡ˆç¿»è¯‘</h4><p>ä¸Šé¢ä»£ç é‡Œç”¨åˆ°çš„<code>language-map</code>ç±»ä¼¼å¦‚ä¸‹ç»“æ„:</p><pre class="line-numbers language-clojure"><code class="language-clojure">(def language-map  { "åˆ‡æ¢è¯­è¨€"                      {:en-us "Switch language"  :ja-jp "è¨€èªã‚’åˆ‡ã‚Šæ›¿ãˆ"}     "ä¸­æ–‡"                        {:en-us "Chinese"           :ja-jp "ä¸­å›½èª"}     "è‹±æ–‡"                        {:en-us "English"           :ja-jp "è‹±èª"}     "æ—¥æ–‡"                        {:en-us "Japanese"          :ja-jp "æ—¥æœ¬èª"}     "ä½“éªŒé—¨åº—"                     {:en-us "Experience Store"  :ja-jp "åº—ã‚’ä½“é¨“ã™ã‚‹"}     "è¿”å›é¦–é¡µ"                     {:en-us "Back to Home"      :ja-jp "ãƒ›ãƒ¼ãƒ ã‚’æˆ»ã™"}}  )<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-æ•°æ®åº“è¿”å›çš„æ–‡æ¡ˆ"><a href="#4-æ•°æ®åº“è¿”å›çš„æ–‡æ¡ˆ" class="headerlink" title="4. æ•°æ®åº“è¿”å›çš„æ–‡æ¡ˆ"></a>4. æ•°æ®åº“è¿”å›çš„æ–‡æ¡ˆ</h4><p>å³ä¸Šæ–‡ä¸­<code>:i18n/db-lang-map</code>è¿™ä¸ªeventä»dbä¸­è·å–çš„å¯¹è±¡ï¼Œä»æ¥å£è·å–çš„å­˜åœ¨å‰ç«¯dbä¸­æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure"> [        {            "key": "åŒæ’å…­ç²’",            "value": {                "en-us": "Double six buttons",                "ja-jp": "w6*3"            }        },        {            "key": "ä¸‹æ‘†(æˆè¡£)",            "value": {                "en-us": "Bottom(garment)",                "ja-jp": "è¹´å»»ã—ï¼ˆä¸ŠãŒã‚Šå¯¸æ³•ï¼‰"            }        },        {            "key": "å¹³é’‰çº½æ‰£",            "value": {                "en-us": "Level buttons",                "ja-jp": "å¹³é’‰é’®é‡¦"            }        }]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å°†æ•°æ®åº“ä¸­çš„å’Œé¡µé¢ä¸Šçš„è¿›è¡Œmergeåä½¿ç”¨ã€‚<br>å½“ç„¶ï¼Œæˆ‘ä»¬äº§å“æ˜¯å› ä¸ºå¯¹å¤šä¸ªç§Ÿæˆ·ï¼Œå„ç§Ÿæˆ·çš„ç¿»è¯‘ä¸åŒï¼Œæ‰€ä»¥é¡µé¢ä¸Šæ²¡æœ‰å¾€DBé‡Œé‡å¤ä¿å­˜ï¼Œé‡‡ç”¨mergeä¸¤ç«¯çš„å½¢å¼ã€‚ç®€å•çš„å¯ä»¥åªåœ¨æ•°æ®åº“ç»´æŠ¤ã€‚</p><h2 id="æ”¹è¿›ç‚¹"><a href="#æ”¹è¿›ç‚¹" class="headerlink" title="æ”¹è¿›ç‚¹"></a>æ”¹è¿›ç‚¹</h2><ul><li>é¡µé¢æ–‡æ¡ˆä¾¿äºæ‰©å±•æ–°è¯­è¨€<br>å½“å‰ä¸‰ä¸ªè¯­è¨€ï¼Œåœ¨æ•°æ®åº“é‡‡ç”¨ä¸€è¡Œä¿å­˜ä¸€ä¸ªå½¢å¼<br>```</li></ul><p>+â€”â€”â€”â€”â€”-+â€”â€”â€”â€”â€“+â€”â€”+â€”â€“+â€”â€”â€”â€”â€”â€”-+â€”â€”-+<br>| Field          | Type         | Null | Key | Default           | Extra |<br>+â€”â€”â€”â€”â€”-+â€”â€”â€”â€”â€“+â€”â€”+â€”â€“+â€”â€”â€”â€”â€”â€”-+â€”â€”-+<br>| id             | varchar(40)  | NO   | PRI | NULL              |       |<br>| company_id     | varchar(40)  | NO   |     | NULL              |       |<br>| lang_key       | varchar(255) | NO   |     | NULL              |       |<br>| lang_value     | varchar(255) | NO   |     | NULL              |       |<br>| lang           | varchar(40)  | NO   |     | NULL              |       |<br>| delete_flag    | varchar(4)   | YES  |     | 0                 |       |<br>| create_time    | timestamp    | NO   |     | CURRENT_TIMESTAMP |       |<br>| create_user_id | varchar(40)  | YES  |     | NULL              |       |<br>| update_time    | timestamp    | NO   |     | CURRENT_TIMESTAMP |       |<br>| update_user_id | varchar(40)  | YES  |     | NULL              |       |<br>+â€”â€”â€”â€”â€”-+â€”â€”â€”â€”â€“+â€”â€”+â€”â€“+â€”â€”â€”â€”â€”â€”-+â€”â€”-+</p><pre><code>ä¸€ä¸ªæ–‡æ¡ˆçš„ç¿»è¯‘æ•°æ®å¦‚ä¸‹ï¼š```sqlINSERT INTO  `t_store_language`(`id`, `company_id`, `lang_key`, `lang_value`, `lang`, `delete_flag`, `create_time`, `create_user_id`, `update_time`, `update_user_id`) VALUES ('611348', '61', 'å¸¸è§„(9ä¸ªå·¥ä½œæ—¥)', 'Regular (9 working days)', 'en-us', '0', '2020-04-01 00:00:00', NULL, '2020-04-01 00:00:00', NULL);INSERT INTO  `t_store_language`(`id`, `company_id`, `lang_key`, `lang_value`, `lang`, `delete_flag`, `create_time`, `create_user_id`, `update_time`, `update_user_id`) VALUES ('611359', '61', 'å¸¸è§„(9ä¸ªå·¥ä½œæ—¥)', 'æ™®é€šï¼ˆï¼™ç¨¼å‹•æ—¥ï¼‰', 'ja-jp', '0', '2020-04-01 00:00:00', NULL, '2020-04-01 00:00:00', NULL);</code></pre><p>è¿™ä¸ªæ˜¯ä¾¿äºæ‰©å±•çš„ï¼Œè€Œé¡µé¢ä¸Šå°±ä¸æ˜¯é‚£æ ·çš„ï¼Œå¦‚åŒä¸Šé¢çš„<code>language-map</code>ï¼Œå¦‚æœå†å¢åŠ ä¸€é—¨æ¯”å¦‚éŸ©è¯­çš„è¯ï¼Œéœ€è¦é€é¡¹åœ¨åŸæ¥çš„æ•°æ®ä¸Šä¿®æ”¹ï¼Œä¸åˆ©äºæ‰©å±•ã€‚</p><blockquote><p>æ”¹è¿›æ–¹å‘ï¼š<br>ä¸€ä¸ªè¯­éŸ³ä¸€ä¸ªmapï¼Œæœ€åå°†å¤šä¸ªè¯­è¨€çš„æ–‡æ¡ˆè¿›è¡Œåˆå¹¶</p></blockquote><p>ä»“ä¿ƒä¸‹æ²¡æœ‰è€ƒè™‘å¤ªå¤šï¼Œå¦‚æœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œæ¬¢è¿äº¤æµã€‚QQï¼š389709260</p>]]></content>
      
      
      <categories>
          
          <category> cljs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cljs </tag>
            
            <tag> å¤šè¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shadow-cljsç¼–è¯‘çš„clojurescript-antdé¡¹ç›®ä½¿ç”¨lesså®ç°è¿è¡Œæ—¶ä¸»é¢˜åˆ‡æ¢</title>
      <link href="2020/03/21/clojurescript-antd-xiang-mu-shi-yong-less-shi-xian-yun-xing-shi-zhu-ti-qie-huan/"/>
      <url>2020/03/21/clojurescript-antd-xiang-mu-shi-yong-less-shi-xian-yun-xing-shi-zhu-ti-qie-huan/</url>
      
        <content type="html"><![CDATA[<p>é¡¹ç›®é¡µé¢ä¸ŠåŠ¨æ€åˆ‡æ¢ä¸»é¢˜</p><p><a href="https://www.jianshu.com/p/4db2e4214ed8">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æœ€è¿‘å…¬å¸çš„ç”µå•†å®šåˆ¶å¹³å°çš„é¡¹ç›®ç»§ä¸Šäº†å›½é™…åŒ–ï¼Œåˆè¦æå¤šä¸»é¢˜äº†ï¼Œåˆè®©æˆ‘ç»ƒäº†ä¸€æŠŠæ‰‹ã€‚</p><p>å®ç°äº†ï¼Œä¹Ÿå°±é‚£ä¹ˆå›äº‹ï¼Œä½†æ˜¯åŠ¨æ‰‹ä¹‹å‰çš„çŠ¹è±«å’Œæ— æ€è·¯ä¹Ÿç€å®è®©æˆ‘æ…Œäº†ä¸€é€¼ã€‚</p><h2 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h2><p>çœ‹äº†antdå®˜ç½‘ä¸Š<a href="https://ant.design/docs/react/customize-theme-cn">å®šåˆ¶ä¸»é¢˜</a>ä¸Šçš„ä¸»é¢˜ä»‹ç»ï¼Œä¹Ÿçœ‹äº†å…¶ä»–åšä¸»çš„ä¸€äº›æ‰‹æ®µï¼Œæ¯”è¾ƒå¤šçš„è¿˜æ˜¯æ‰“åŒ…æ—¶å°†æŸäº›ä¸»é¢˜è‰²æ‰“åŒ…åˆ°ä»£ç é‡Œï¼Œè¿è¡Œèµ·æ¥å°±æ˜¯è¿™ä¸ªä¸»é¢˜è‰²ã€‚</p><p>ä¸€æ¥è¿™ä¸ªæ–¹å¼æ˜¯é™æ€çš„ï¼Œé€šè¿‡æ‰“åŒ…ä¹‹å‰å»è®¾ç½®ä¸€äº›configï¼Œä¸æ˜¯æœ€ç»ˆæƒ³è¦çš„ï¼ŒäºŒæ¥é‡Œé¢çš„ä»‹ç»è¦ä¹ˆå°±æ˜¯å€ŸåŠ©webpackï¼Œè¦ä¹ˆå°±æ˜¯ç”¨Umiã€‚å·§çš„æ˜¯æˆ‘ä»¬é¡¹ç›®ç”¨clojurescriptå¼€å‘ï¼Œåªç”¨äº†antdçš„componentï¼Œå¹¶æ²¡æœ‰ç”¨åˆ°<a href="https://pro.ant.design/docs/getting-started-cn/">Antd Proåå°</a>çš„æ‰€æœ‰åŠŸèƒ½ï¼Œæ‰€ä»¥å®˜ç½‘çš„ä»‹ç»å¯¹æˆ‘æ¥è¯´å°±æ˜¯ä¸ªå¤§å¤§çš„â€œ0ï¸âƒ£â€</p><p>è¿è¡Œæ—¶åˆ‡æ¢ä¸»é¢˜ï¼Œæ˜¾ç„¶åªåœ¨ç¼–è¯‘æ—¶æ‰“åŒ…lessæ˜¯ä¸å¤Ÿçš„çš„ï¼Œå¿…é¡»æ˜¯èµ°åœ¨æµè§ˆå™¨ç«¯åŠ¨æ€ä¿®æ”¹lessçš„æ–¹æ¡ˆã€‚</p><p>æœ‰äº†ç›®çš„å°±å¥½åŠäº†ï¼Œå¯¹äºæˆ‘ä¸€ä¸ªå‰ç«¯èœé¸¡æ¥è¯´ï¼Œåˆ†æåˆ°è¿™ä¸€æ­¥å·²ç»æ¶¨çŸ¥è¯†äº†ã€‚</p><p>ä¸‹é¢è¿›å…¥è§£å†³æ–¹æ¡ˆæ­£é¢˜ã€‚</p><h2 id="ç¾ä¸½çš„æ’ä»¶"><a href="#ç¾ä¸½çš„æ’ä»¶" class="headerlink" title="ç¾ä¸½çš„æ’ä»¶"></a>ç¾ä¸½çš„æ’ä»¶</h2><p>é¦–å…ˆè¿é¢èµ°æ¥çš„ï¼Œæ˜‚é¦–æŒºèƒ¸çš„ç¾å¥³å°±æ˜¯<a href="https://www.npmjs.com/package/antd-theme-generator">antd-theme-generator</a>ï¼Œéå¸¸æ„Ÿè°¢ï¼Œå¸®å¤§å¿™äº†ã€‚</p><p>æ ¸å¿ƒä»£ç å°±è¡¥è´´äº†ï¼Œä½œè€…å¤ªæ‡’ï¼Œä¸è®ºæ˜¯<a href="https://github.com/mzohaibqc/antd-theme-generator#readme">github</a>è¿˜æ˜¯npmåº“é‡Œï¼Œè¿™ä¸ªæ’ä»¶çš„<code>README.md</code>æ–‡ä»¶å†™çš„æœ‰ç‚¹é©¬è™ã€‚</p><p>å‚è€ƒäº†ç®€ä¹¦ä¸Š<a href="https://www.jianshu.com/p/b635211658c8">antdåœ¨çº¿æ¢è‚¤å®šåˆ¶åŠŸèƒ½</a>è¿™ä½ä»å…„çš„ä»‹ç»ï¼Œæˆ‘çš„ä»£ç åšäº†å¦‚ä¸‹æ”¹åŠ¨</p><h4 id="1-å¢åŠ ä¾èµ–"><a href="#1-å¢åŠ ä¾èµ–" class="headerlink" title="1. å¢åŠ ä¾èµ–"></a>1. å¢åŠ ä¾èµ–</h4><pre class="line-numbers language-shell"><code class="language-shell">npm i antd-theme-generator --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2-å¼•å…¥æ–‡ä»¶ï¼Œæ ¹æ®æˆ‘çš„é¡¹ç›®ä¿®æ”¹æ–‡ä»¶å†…å®¹"><a href="#2-å¼•å…¥æ–‡ä»¶ï¼Œæ ¹æ®æˆ‘çš„é¡¹ç›®ä¿®æ”¹æ–‡ä»¶å†…å®¹" class="headerlink" title="2. å¼•å…¥æ–‡ä»¶ï¼Œæ ¹æ®æˆ‘çš„é¡¹ç›®ä¿®æ”¹æ–‡ä»¶å†…å®¹"></a>2. å¼•å…¥æ–‡ä»¶ï¼Œæ ¹æ®æˆ‘çš„é¡¹ç›®ä¿®æ”¹æ–‡ä»¶å†…å®¹</h4><p>åœ¨<code>resources/public</code>ä¸‹æ–°å»ºlessç›®å½•ï¼Œåˆ›å»º2ä¸ªæ–‡ä»¶</p><ul><li><p>main.less</p><pre class="line-numbers language-js"><code class="language-js"><span class="token comment" spellcheck="true">//å†…å®¹ä¸ºç©ºå°±è¡Œï¼Œé˜²æ­¢ç”Ÿæˆcolor.lessæŠ¥é”™</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>vars.less</p><pre class="line-numbers language-JavaScript"><code class="language-JavaScript">@import "~antd/lib/style/themes/default.less"; //å¼•å…¥antdçš„å˜é‡æ–‡ä»¶ï¼Œå®ç°å˜é‡çš„è¦†ç›–@primary-color: #800019;@link-color: #800019;@btn-primary-bg:#800019;//color.lessä¸­åŠ å…¥cssåŸç”Ÿå˜é‡ï¼š--PC:root {   --PC: @primary-color;     --BPB: @btn-primary-bg;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>é¡¹ç›®<strong>æ ¹ç›®å½•</strong>æ–°å»º<code>color.js</code>æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-JavaScript"><code class="language-JavaScript">const path = require('path');const { generateTheme, getLessVars } = require('antd-theme-generator');const options = {stylesDir: path.join(__dirname, './resources/public/less'),    //å¯¹åº”å…·ä½“ä½ç½®antDir: path.join(__dirname, './node_modules/antd'), //å¯¹åº”å…·ä½“ä½ç½®varFile: path.join(__dirname, './resources/public/less/vars.less'), //å¯¹åº”å…·ä½“ä½ç½®mainLessFile: path.join(__dirname, './resources/public/less/main.less'), //å¯¹åº”å…·ä½“ä½ç½®themeVariables: [  '@primary-color',  '@secondary-color',  '@text-color',  '@text-color-secondary',  '@heading-color',  '@layout-body-background',  '@btn-primary-bg',  '@layout-header-background'],indexFileName: 'index.html',outputFilePath: path.join(__dirname, './resources/public/css/color.less'),}generateTheme(options).then(less => {console.log('Theme generated successfully');}).catch(error => {  console.log('Error', error);});<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ä¿®æ”¹index.htmlæ–‡ä»¶ï¼Œå¦‚ä¸‹</p><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>é—¨åº—å®šåˆ¶ç³»ç»Ÿ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/css/antd.min.css<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/css/redantd.css<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/css/color.less<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span>  <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet/less<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!--è¿™ä¸ªä»£ç ä¸èƒ½æ”¾åœ¨æœ€å--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">window<span class="token punctuation">.</span>less <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token keyword">async</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  env<span class="token punctuation">:</span> <span class="token string">'production'</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/less.js/2.7.2/less.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- Our JavaScript will modify the DOM inside this element --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- All our ClojureScript gets compiled into this file --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&lt;script type='text/javascript' src='/js/app.js?v="</span><span class="token operator">+</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"' type='text/javascript'>&lt;\/script>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ä¿®æ”¹<code>package.json</code>ï¼Œå‘½ä»¤å‰é¢å¢åŠ <code>node color</code></p><pre class="line-numbers language-JavaScript"><code class="language-JavaScript">"scripts": {  "start": "node color && shadow-cljs server",  "build": "node color && shadow-cljs release app"}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-åˆ‡æ¢æµ‹è¯•"><a href="#3-åˆ‡æ¢æµ‹è¯•" class="headerlink" title="3. åˆ‡æ¢æµ‹è¯•"></a>3. åˆ‡æ¢æµ‹è¯•</h4><p>é¡¹ç›®è¿è¡Œåé¡µé¢æ¯”å¦‚é¡µé¢æœ‰ä¸ªButtonçš„type=â€primaryâ€é‚£å®ƒé»˜è®¤æ˜¯çº¢è‰²çš„ã€‚</p></li></ul><p>åœ¨æµè§ˆå™¨çš„æ§åˆ¶å°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><pre class="line-numbers language-JavaScript"><code class="language-JavaScript">window.less.modifyVars(    {        '@primary-color': '#722ed1',        '@link-color': '#722ed1',        '@btn-primary-bg': '#722ed1',    })<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼šå‘ç°é¢œè‰²å˜æˆäº†é…±ç´«è‰²ã€‚</p><p>åˆ°æ­¤ï¼Œå®ç°é€»è¾‘ä¿®æ”¹å®Œã€‚</p><h2 id="åœ¨clojurescriptä¸­å®ç°åŠ¨æ€åˆ‡æ¢"><a href="#åœ¨clojurescriptä¸­å®ç°åŠ¨æ€åˆ‡æ¢" class="headerlink" title="åœ¨clojurescriptä¸­å®ç°åŠ¨æ€åˆ‡æ¢"></a>åœ¨clojurescriptä¸­å®ç°åŠ¨æ€åˆ‡æ¢</h2><h4 id="é¡µé¢viewéƒ¨åˆ†"><a href="#é¡µé¢viewéƒ¨åˆ†" class="headerlink" title="é¡µé¢viewéƒ¨åˆ†"></a>é¡µé¢viewéƒ¨åˆ†</h4><p>åœ¨é¡µé¢å¸ƒå±€æ–‡ä»¶çš„å³ä¸Šè§’åŠ äº†ä¸ªåˆ‡æ¢ä¸‹æ‹‰æŒ‰é’®ã€‚</p><pre class="line-numbers language-cljs"><code class="language-cljs">(def ^:private theme-map  {:#800019 "å–œåº†çº¢"   :#4880FF "æ‹‚æ™“è“"});; ä¸»é¢˜èœå•(defn dropdown-theme []  [:> ant/Menu   {:className "menu"    :onClick   (fn [menu]                 (let [value (js->clj menu :keywordize-keys true)]                   (rf/dispatch [:theme/generate-theme (:key value)])))}   [:> MenuItem {:key "#800019" :title (:#800019 theme-map)                 :style {:background "#800019"                         :color "white"                         :border-radius "5px"}}    [:span (i18n-str (:#800019 theme-map))]]   [:> MenuItem {:key "#4880FF" :title (:#4880FF theme-map)                 :style {:background "#4880FF"                         :color "white"                         :border-radius "5px"}}    [:span (i18n-str (:#4880FF theme-map))]]]);;åœ¨æŸä¸ªviewç»„ä»¶é‡Œå†™å…¥å†…å®¹[:div {:style {:margin-left 20                         :font-size   "14px"                         :font-family "PingFangSC-Medium,PingFang SC"                         :font-weight 500                         :color       "rgba(0,0,0,1)"}}           [:> ant/Dropdown {:overlay (reagent.core/as-element [dropdown-theme])}            [:div {:className "theme-setting"}             [:span (i18n-str "é¢œè‰²")]]]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="åˆ‡æ¢äº‹ä»¶"><a href="#åˆ‡æ¢äº‹ä»¶" class="headerlink" title="åˆ‡æ¢äº‹ä»¶"></a>åˆ‡æ¢äº‹ä»¶</h4><pre class="line-numbers language-cljs"><code class="language-cljs">(ns store-pc.common.theme  (:require   [re-frame.core :as rf]   [kee-frame.core :as kf]   [store-pc.common.storage :as storage]))(defn- gen-theme [color]  #js{      "@primary-color"   color      "@link-color"      color      "@btn-primary-bg"  color      })(kf/reg-controller :theme-controller {:params (constantly true)  :start  [::set-theme-by-local]});;å¦‚æœé¡µé¢åˆ·æ–°çš„è¯ä»localstorageé‡Œè·å–(kf/reg-event-fx ::set-theme-by-local (fn [_ [_ _]]   (when-not @(rf/subscribe [:theme/now-theme])     (rf/dispatch [:theme/generate-theme (storage/get-current-theme)])     )))(rf/reg-event-fx :theme/generate-theme (fn [{:keys [db]} [_ color]]   (js/console.log "è®¾ç½®ä¸»é¢˜ä¸º:" (gen-theme color))   (.modifyVars (.-less js/window ) (gen-theme color))   (storage/set-current-theme color)   {:db (assoc-in db [:global :theme] color)}))(rf/reg-sub :theme/now-theme (fn [db]   (get-in db [:global :theme])))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡Œé¢å”¯ä¸€ç”¨åˆ°çš„æ¡†æ¶å¤–çš„å°±æ˜¯å­˜å‚¨localstoreå’Œä»localstoreé‡Œæ‹¿å€¼ï¼Œæ ¸å¿ƒä»£ç å°±ä¸¤ä¸ªï¼š</p><pre class="line-numbers language-cljs"><code class="language-cljs">(defn get-local-storage [key]  (.getItem js/localStorage key))(defn set-local-storage [key value]  (.setItem js/localStorage key value))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><blockquote><ol><li><code>index.html</code>é‡Œä¸€å¼€å§‹å¼•å…¥çš„less.min.jsç‰ˆæœ¬å¤ªé«˜ï¼Œå¾—é™æˆ2.7.2æ‰ä¸ä¼šæŠ¥é”™ï¼Œå¦åˆ™modifyVarsæœ‰é”™è¯¯æç¤º</li><li>jsé‡Œçš„window.less.modifyVars(obj)è¿™å¥è°ƒç”¨åœ¨cljsé‡Œä¸ä¼šå†™</li><li>ä¸Šé¢ä¸€æ¡è§£å†³äº†ï¼Œä½†æ˜¯modifyVarsçš„å‚æ•°ä¸ä¼šä¼ ï¼Œåæ¥æŸ¥åˆ°åŸæ¥æ˜¯ç”¨ <code>#js</code>å®šä¹‰çš„å°±æ˜¯åŸå§‹jsçš„æ„æ€ã€‚</li></ol></blockquote><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.jianshu.com/p/b635211658c8">antdåœ¨çº¿æ¢è‚¤å®šåˆ¶åŠŸèƒ½</a><br><a href="https://github.com/bestRenekton/demos/tree/master/themeChanger">themeChanger demo</a></p>]]></content>
      
      
      <categories>
          
          <category> cljs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> antd </tag>
            
            <tag> cljs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·å°”åˆ›å®¢æ±‡ç¬”è®°----å®‰å“ä¸Šadbçš„ä½¿ç”¨</title>
      <link href="2020/03/01/hai-er-chuang-ke-hui-bi-ji-an-zhuo-shang-adb-de-shi-yong-bi-ji/"/>
      <url>2020/03/01/hai-er-chuang-ke-hui-bi-ji-an-zhuo-shang-adb-de-shi-yong-bi-ji/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨adbå‘½ä»¤æŠ“åŒ…ç­‰<br><a href="https://www.jianshu.com/p/6151dca25217">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="æŠ“åŒ…"><a href="#æŠ“åŒ…" class="headerlink" title="æŠ“åŒ…"></a>æŠ“åŒ…</h3><pre class="line-numbers language-shell"><code class="language-shell">adb logcat -v time tag 1>F:\log.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/android/adb1.png" alt="å›¾ç‰‡1.png"></p><p><img src="/loading.gif" data-original="/images/android/adb-log.png" alt="å›¾ç‰‡2.png"></p><p><img src="/loading.gif" data-original="/images/android/adb-log-content.png" alt="å›¾ç‰‡3.png"></p><blockquote><p>adb logcat -b main -v time&gt;app.log&nbsp; æ‰“å°åº”ç”¨ç¨‹åºçš„log<br>adb logcat -b radio -v time&gt; radio.log æ‰“å°å°„é¢‘ç›¸å…³çš„logï¼ŒSIM STKä¹Ÿä¼šåœ¨é‡Œé¢ï¼Œmodemç›¸å…³çš„ATcommandç­‰ï¼Œå½“ç„¶è·ŸQXDMå·®çš„å¾ˆè¿œäº†ã€‚<br>adb logcat -b events -v time&nbsp; æ‰“å°ç³»ç»Ÿäº‹ä»¶çš„æ—¥å¿—ï¼Œæ¯”å¦‚è§¦å±äº‹ä»¶ã€‚ã€‚ã€‚<br>//android logçš„æŠ“å–<br>adb logcat<br>//kernel logçš„æŠ“å–<br>adb shell cat /proc/kmsg<br>//log ä¿¡æ¯çš„ä¿å­˜<br>mkdir&nbsp; /data/anr<br>logcat *ï¼šV &gt; /data/anr/android<br>demsg &gt;/data/anr/kernel<br>//æŒ‰ctrl+cç»“æŸlogè¾“å‡º<br>adb pull /data/anr ./log/</p></blockquote><h3 id="æ‰‹åŠ¨å½»åº•å¸è½½app"><a href="#æ‰‹åŠ¨å½»åº•å¸è½½app" class="headerlink" title="æ‰‹åŠ¨å½»åº•å¸è½½app"></a>æ‰‹åŠ¨å½»åº•å¸è½½app</h3><pre class="line-numbers language-shell"><code class="language-shell">D:\Git\pingtai\Portal>adb uninstall com.haierchuangkeappFailure [DELETE_FAILED_INTERNAL_ERROR]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åœ¨æœ¬åœ°ç”¨ç®¡ç†å‘˜èº«ä»½è¿è¡Œcmdå‘½ä»¤è¡Œå·¥å…·ï¼Œä½¿ç”¨adb shellè¿›å…¥æ‰‹æœºåº”ç”¨å‘½ä»¤è¡Œï¼Œ<br>æ ¹æ®æç¤º ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">D:\Git\pingtai\Portal>adb shellM1E:/ $ cd /data/local/tmp/M1E:/data/local/tmp $ ll/system/bin/sh: ll: not found127|M1E:/data/local/tmp $ lscom.haierchuangkeapp com.haierchuangkeapp-build-id.txtM1E:/data/local/tmp $ rm -rf cocom.haierchuangkeapp                    com.haierchuangkeapp-build-id.txtM1E:/data/local/tmp $ rm -rf com.haierchuangkeapp*M1E:/data/local/tmp $<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæ‰‹åŠ¨æ¨é€å®‰è£…åŒ…ï¼Œç„¶åå®‰è£…ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">D:\Git\pingtai\Portal\android>adb push D:\Git\pingtai\Portal\android\app\build\outputs\apk\debug\app-debug.apk /data/local/tmp/com.haierchuangkeappD:\Git\pingtai\Portal\android\app\build\outputs\apk\debug\app-debug.apk: 1 file pushed. 13.0 MB/s (64737700 bytes in 4.756s)D:\Git\pingtai\Portal\android>D:\Git\pingtai\Portal\android>D:\Git\pingtai\Portal\android>adb shell pm install -t -r "/data/local/tmp/com.haierchuangkeapp"Success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> android </tag>
            
            <tag> adb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>excelæ“ä½œå¤‡å¿˜</title>
      <link href="2020/02/29/excel-cao-zuo-bei-wang/"/>
      <url>2020/02/29/excel-cao-zuo-bei-wang/</url>
      
        <content type="html"><![CDATA[<p>æŠŠexcelé‡Œçš„æ•°æ®è¿›è¡ŒæŸäº›å¤„ç†ï¼Œè®°å½•ä¸€ä¸‹ï¼Œä»¥åå¥½å¤åˆ¶ç²˜è´´</p><p><a href="https://www.jianshu.com/p/f6005d906ce5">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="1-excelæ•°å­—æŒ‰é•¿åº¦è¡¥0ï¼Œå¹¶è½¬æ¢æˆæ–‡æœ¬"><a href="#1-excelæ•°å­—æŒ‰é•¿åº¦è¡¥0ï¼Œå¹¶è½¬æ¢æˆæ–‡æœ¬" class="headerlink" title="1. excelæ•°å­—æŒ‰é•¿åº¦è¡¥0ï¼Œå¹¶è½¬æ¢æˆæ–‡æœ¬"></a>1. excelæ•°å­—æŒ‰é•¿åº¦è¡¥0ï¼Œå¹¶è½¬æ¢æˆæ–‡æœ¬</h2><p>åœ¨æµ·å°”è¿™æ®µæ—¶é—´ä»æ•°æ®åº“é‡Œå¯¼å‡ºæ¥çš„å‘˜å·¥å·¥å·8ä½æ•°ï¼Œå› ä¸ºæœ‰äº›0å¼€å¤´çš„ï¼Œå¯¼å‡ºåˆ°excelé‡Œåå‰é¢çš„0å°±æ²¡æœ‰äº†ã€‚<br>å¯ä»¥æ–°å»ºä¸€åˆ—ï¼Œç„¶åä»¥å¯¼å‡ºçš„é‚£åˆ—ä¸ºåŸºç¡€æ•°æ®ç”¨å…¬å¼å¤„ç†æˆæƒ³è¦çš„ï¼Œè¡¥é½8ä½ï¼Œå‰é¢è¡¥0ã€‚å…¬å¼å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">=REPT(0,8-LEN(A2))&A2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/tools/excel-format.png" alt="è¡¥é½8ä½ï¼Œå‰é¢è¡¥0"></p><h2 id="2-excelé‡Œå°†æ•°æ®æ‹¼æ¥æˆè¯­å¥"><a href="#2-excelé‡Œå°†æ•°æ®æ‹¼æ¥æˆè¯­å¥" class="headerlink" title="2. excelé‡Œå°†æ•°æ®æ‹¼æ¥æˆè¯­å¥"></a>2. excelé‡Œå°†æ•°æ®æ‹¼æ¥æˆè¯­å¥</h2><p>æœ‰æ—¶å€™éœ€è¦å°†excelé‡Œçš„æ•°æ®ï¼Œæ‹¼æ¥æˆæƒ³è¦çš„jsonæˆ–è€…sqlã€‚</p><ul><li><p>æ‹¼æ¥æˆjsonæˆ–è€…map</p><pre class="line-numbers language-shell"><code class="language-shell">=CONCATENATE("""",B2,"""","    {:en-us """,C2,"""  :ja-jp """,D2,"""}")<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/tools/excel-CONCATENATE.png" alt="æ‹¼æ¥æˆjson"><br>ç›®æ ‡å†…å®¹æ¯”å¦‚ï¼š<code>"ä¼˜è£ç²¾é€‰"    {:en-us "Retail"  :ja-jp "å„ªã‚ŒãŸè£æ–­"}</code></p></li><li><p>æ ¹æ®è¡¨å¤´ï¼Œæ‹¼æ¥æˆsqlçš„insertè¯­å¥</p><pre class="line-numbers language-shell"><code class="language-shell">=CONCATENATE("INSERT INTO t_sys_user (`"&A$1&"`, `"&B$1&"`, `"&C$1&"`, `"&D$1&"`, `"&E$1&"`, `"&F$1&"`) VALUES ('"&A3&"',"&" '"&B3&"','"&C3&"',"&"'"&D3&"',"&"'"&E3&"',"&"'"&F3&"');")<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/tools/excel-contact-sql.png" alt="æ‹¼æ¥æˆsql"></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>leiningen clojure webé¡¹ç›®ä½¿ç”¨æœ¬åœ°jaråŒ…</title>
      <link href="2020/02/06/clojure-lein-use-local-jar/"/>
      <url>2020/02/06/clojure-lein-use-local-jar/</url>
      
        <content type="html"><![CDATA[<p>leiningen clojure webé¡¹ç›®ä½¿ç”¨æœ¬åœ°jarç®€æ˜“æ–¹å¼</p><p><a href="https://www.jianshu.com/p/6642d446f087">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ç”¨<a href="https://luminusweb.com/">luminusweb</a>æ¨¡æ¿åˆ›å»ºçš„clojure webæœåŠ¡ç«¯é¡¹ç›®å¦‚ä½•ä½¿ç”¨æœ¬åœ°çš„jarã€‚</p><h3 id="æˆ‘çš„æ–¹æ¡ˆ"><a href="#æˆ‘çš„æ–¹æ¡ˆ" class="headerlink" title="æˆ‘çš„æ–¹æ¡ˆ"></a>æˆ‘çš„æ–¹æ¡ˆ</h3><p>å°†jaræ”¾åœ¨é¡¹ç›®é‡Œçš„æŸä¸ªç›®å½•ä¸‹ï¼Œæ¨èresourcesä¸‹ï¼Œç„¶ååœ¨<code>project.clj</code>é‡ŒåŠ å…¥å¼•ç”¨å³å¯ã€‚</p><pre class="line-numbers language-clojure"><code class="language-clojure">:resource-paths ["resources/jars/sheet-clone-0.1.jar"]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨çš„æ—¶å€™åƒè·Ÿè°ƒç”¨å…¶ä»–ç¬¬ä¸‰æ–¹çš„java sdkä¸€æ ·ä½¿ç”¨</p><pre class="line-numbers language-clojure"><code class="language-clojure">(:import (com.alibaba.excel EasyExcel #_ExcelWriter)           [com.hczt.sheetclone.utils CloneExcelByPoi]           [org.apache.poi.xssf.usermodel XSSFWorkbook])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="å…¶ä»–æ–¹æ¡ˆï¼š"><a href="#å…¶ä»–æ–¹æ¡ˆï¼š" class="headerlink" title="å…¶ä»–æ–¹æ¡ˆï¼š"></a>å…¶ä»–æ–¹æ¡ˆï¼š</h3><p>å‚è€ƒPaulå¤§ç¥çš„æ–‡ç« <a href="https://www.pgrs.net/2011/10/30/using-local-jars-with-leiningen/">using-local-jars-with-leiningen</a><br>è´´ä¸€ä¸‹ä¸»è¦å†…å®¹ã€‚<br>Create a directory in the project.<br>mkdir maven_repository.<br>Add local jars to this repository.<br>For example, this command adds the jaad-0.8.3.jar file to the maven repository.</p><pre class="line-numbers language-shell"><code class="language-shell">mvn install:install-file -Dfile=jaad-0.8.3.jar -DartifactId=jaad -Dversion=0.8.3 -DgroupId=jaad -Dpackaging=jar -DlocalRepositoryPath=maven_repository<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Add the following to project.clj</p><pre class="line-numbers language-clojure"><code class="language-clojure">:repositories {"local" ~(str (.toURI (java.io.File. "maven_repository")))}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Now a regular lein deps should work</p><pre class="line-numbers language-shell"><code class="language-shell">lein depsDownloading: jaad/jaad/0.8.3/jaad-0.8.3.pom from localTransferring 0K from local[WARNING] *** CHECKSUM FAILED - Error retrieving checksum file for jaad/jaad/0.8.3/jaad-0.8.3.pom - IGNORING<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>The warning can be ignored, since the jar will be checked into the project and not downloaded from the internet.</p>]]></content>
      
      
      <categories>
          
          <category> clojure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>springbooté¡¹ç›®æç¤º No converter found for return value of type:class java.util.LinkedHashMap,@RequestBodyæ— æ•ˆ</title>
      <link href="2020/02/03/springboot-requestbody-zhu-jie-bu-qi-zuo-yong/"/>
      <url>2020/02/03/springboot-requestbody-zhu-jie-bu-qi-zuo-yong/</url>
      
        <content type="html"><![CDATA[<p>springbooté¡¹ç›®æç¤º </p><pre class="line-numbers language-shell"><code class="language-shell">Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'application/json;charset=UTF-8' not supported]Resolved [org.springframework.http.converter.HttpMessageNotWritableException: No converter found for return value of type: class java.util.LinkedHashMap]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>@RequestBodyæ³¨è§£ç›´æ¥æ— æ•ˆ<br><a href="https://www.jianshu.com/p/a6f35524dc25">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å…ˆè¯´è§£å†³æ–¹æ¡ˆï¼Œåœ¨pomä¸­åŠ å…¥å¦‚ä¸‹ä¾èµ–ï¼Œè§£å†³ã€‚</p><pre class="line-numbers language-java"><code class="language-java">        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>json<span class="token operator">--</span><span class="token operator">></span>        <span class="token operator">&lt;</span>dependency<span class="token operator">></span>            <span class="token operator">&lt;</span>groupId<span class="token operator">></span>com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>core<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>            <span class="token operator">&lt;</span>artifactId<span class="token operator">></span>jackson<span class="token operator">-</span>core<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>            <span class="token operator">&lt;</span>version<span class="token operator">></span><span class="token number">2.9</span><span class="token punctuation">.</span><span class="token number">9</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span>        <span class="token operator">&lt;</span>dependency<span class="token operator">></span>            <span class="token operator">&lt;</span>groupId<span class="token operator">></span>com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>core<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>            <span class="token operator">&lt;</span>artifactId<span class="token operator">></span>jackson<span class="token operator">-</span>annotations<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>            <span class="token operator">&lt;</span>version<span class="token operator">></span><span class="token number">2.9</span><span class="token punctuation">.</span><span class="token number">9</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span>        <span class="token operator">&lt;</span>dependency<span class="token operator">></span>            <span class="token operator">&lt;</span>groupId<span class="token operator">></span>com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>core<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>            <span class="token operator">&lt;</span>artifactId<span class="token operator">></span>jackson<span class="token operator">-</span>databind<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>            <span class="token operator">&lt;</span>version<span class="token operator">></span><span class="token number">2.9</span><span class="token punctuation">.</span><span class="token number">9</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯´èµ·æ¥ï¼Œè¿™å¯çœŸçœŸæ˜¯ä¸€ä¸ªå‘çˆ¹çš„é—®é¢˜ï¼Œå›°æ‰°äº†ä¸€å¤©ï¼Œçƒ¦äº†ä¸€å¤©ï¼Œæˆ‘çœŸä»¥ä¸ºæˆ‘å¤§åŠå¹´æ²¡ç¢°javaï¼Œè¿æ–°å»ºä¸ªsprintbootçš„restæ¥å£ç”¨å®Œç¾çš„intellij ideaè¿™ä¹ˆé«˜å¤§ä¸Šçš„å·¥å…·éƒ½åˆ›å»ºä¸å‡ºæ¥äº†å‘¢ã€‚</p><h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><p>çœ‹çœ‹é”™è¯¯å§.<br>ä¸¤ä¸ªè¿å…¥é—¨éƒ½ç®—ä¸ä¸Šçš„æ¥å£</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>marvin<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>controller<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>marvin<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>vo<span class="token punctuation">.</span>DemoEntity<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>GetMapping<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>PostMapping<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>RequestBody<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>RestController<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * * @Author mahaiqiang * @Create 2020/2/1 11:06 ä¸‹åˆ * @Description TODO **/</span><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoController</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/demo1"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> DemoEntity <span class="token function">demo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"ç¬¬ä¸€ä¸ªgetæ¥å£"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        DemoEntity de <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DemoEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        de<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"æå››"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> de<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/demo2"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> DemoEntity <span class="token function">demo2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> DemoEntity entity<span class="token punctuation">)</span> <span class="token punctuation">{</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"ç¬¬ä¸€ä¸ªpostæ¥å£, å‚æ•°:{}"</span><span class="token punctuation">,</span> entity<span class="token punctuation">)</span><span class="token punctuation">;</span>        entity<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"Hello, "</span> <span class="token operator">+</span> entity<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> entity<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é”™è¯¯"><a href="#é”™è¯¯" class="headerlink" title="é”™è¯¯"></a>é”™è¯¯</h2><p>GETæ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯POSTçš„è¿™ä¸ªæ¥å£ï¼Œå› ä¸ºç”¨äº†<code>@RequestBody</code>æ³¨è§£ï¼Œè¦è½¬æ¢jsonï¼Œæ‰€ä»¥å°±æ­»æ´»ä¸è¡Œã€‚<br>é”™è¯¯æ˜¯è¿™æ ·çš„ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">2020-02-03 22:55:34.382  WARN 40841 --- [nio-8080-exec-2] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'application/json;charset=UTF-8' not supported]2020-02-03 22:55:34.405  WARN 40841 --- [nio-8080-exec-2] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.http.converter.HttpMessageNotWritableException: No converter found for return value of type: class java.util.LinkedHashMap]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å‡ºè¿™ä¸ªé”™æˆ‘å…ˆä¸Šç½‘æŸ¥ï¼Œæœ‰ä¸ªæ¨èæ‰¾ä¸åˆ°äº†è¯´å¼•å…¥<code>jackson</code>çœ‹æ—¥å¿—æˆ‘å¼•å…¥çš„æ˜¯2.9.6ä¸çŸ¥é“æ˜¯ä¸æ˜¯è¿˜å°‘å¼•ç”¨äº†å•¥ï¼Œåæ­£æ²¡æˆã€‚</p><p>è®©åˆ«çš„åŒäº‹è¯•äº†ä¸‹ï¼Œäººå®¶è¯´å•¥ä¹Ÿä¸ç”¨å¹²ï¼Œå¯¼å…¥è¿›å»å°±èƒ½è¿è¡Œï¼Œæ—¥äº†ç‹—äº†ï¼Œå’‹å›äº‹ï¼Œè‚¯å®šå°±æ˜¯ç¯å¢ƒé—®é¢˜äº†å‘—ã€‚</p><p>äºæ˜¯å°±jdkã€mavenã€intellij ideaï¼Œé‡æ–°é…ç½®ï¼Œç”šè‡³é‡è£…ï¼Œéƒ½æä¸€éä¹Ÿæ²¡åŠæ³•äº†ã€‚</p><p>ç¬¬äºŒå¤©ç»§ç»­æŒ‰ç…§é”™è¯¯æç¤ºæ‰¾ï¼Œæ‰¾åˆ°ä¸ªåŸæ¥å°±ç¿»å‡ºæ¥è¿‡çš„é“¾æ¥ï¼ŒåŠ äº†ä¾èµ–åè«åå…¶å¦™å¥½äº†ï¼Œè€Œä¸”åˆ é™¤äº†ä¾èµ–ç«‹é©¬å°±èƒ½å¤ç°é—®é¢˜äº†ã€‚</p><h2 id="æ­£å¸¸"><a href="#æ­£å¸¸" class="headerlink" title="æ­£å¸¸"></a>æ­£å¸¸</h2><p>é¢„æœŸæ˜¯è¿™æ ·çš„</p><pre class="line-numbers language-shell"><code class="language-shell">com.marvin.demo.DemoApplication  .   ____          _            __ _ _ /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \ \\/  ___)| |_)| | | | | || (_| |  ) ) ) )  '  |____| .__|_| |_|_| |_\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot ::        (v2.2.4.RELEASE)2020-02-03 22:51:16.565  INFO 40753 --- [           main] com.marvin.demo.DemoApplication          : Starting DemoApplication on 192.168.0.105 with PID 40753 (/Users/mahaiqiang/git/mygitrepo/secret-demo/target/classes started by mahaiqiang in /Users/mahaiqiang/git/mygitrepo/secret-demo)2020-02-03 22:51:16.571  INFO 40753 --- [           main] com.marvin.demo.DemoApplication          : No active profile set, falling back to default profiles: default2020-02-03 22:51:17.751  INFO 40753 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)2020-02-03 22:51:17.763  INFO 40753 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]2020-02-03 22:51:17.764  INFO 40753 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.30]2020-02-03 22:51:17.838  INFO 40753 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext2020-02-03 22:51:17.838  INFO 40753 --- [           main] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 1205 ms2020-02-03 22:51:18.043  INFO 40753 --- [           main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'applicationTaskExecutor'2020-02-03 22:51:18.230  INFO 40753 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''2020-02-03 22:51:18.234  INFO 40753 --- [           main] com.marvin.demo.DemoApplication          : Started DemoApplication in 2.039 seconds (JVM running for 2.681)2020-02-03 22:51:29.934  INFO 40753 --- [nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'2020-02-03 22:51:29.934  INFO 40753 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'2020-02-03 22:51:29.942  INFO 40753 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 8 ms2020-02-03 22:51:30.045  INFO 40753 --- [nio-8080-exec-1] c.marvin.demo.controller.DemoController  : ç¬¬ä¸€ä¸ªpostæ¥å£, å‚æ•°:DemoEntity(name=a)2020-02-03 22:51:50.866  INFO 40753 --- [nio-8080-exec-3] c.marvin.demo.controller.DemoController  : ç¬¬ä¸€ä¸ªpostæ¥å£, å‚æ•°:DemoEntity(name=marvin)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ¬¡æ˜¯ç™¾åº¦æ•‘äº†æˆ‘ï¼Œæˆ‘ä¸€èˆ¬ç”¨çš„<a href="https://www.bing.com/">å¿…åº”</a>æœç´¢å¼•æ“ï¼Œæ²¡æƒ³åˆ°æŒ‰ç…§ç¬¬äºŒä¸ªé”™è¯¯ç™¾åº¦å‡ºæ¥çš„ç¬¬ä¸€æ¡ç›´æ¥å°±æ˜¯è§£å†³æ–¹æ¡ˆã€‚</p><p>ä½†æ˜¯æŒ‰ç…§æ–¹æ¡ˆè¯´ç¬¬ä¸€æ¡ï¼Œæˆ‘çš„pomæ–‡ä»¶é‡Œå·²ç»æœ‰<code>spring-boot-starter-web</code>ï¼Œ</p><pre class="line-numbers language-java"><code class="language-java"><span class="token operator">&lt;</span>dependency<span class="token operator">></span>          <span class="token operator">&lt;</span>groupId<span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>          <span class="token operator">&lt;</span>artifactId<span class="token operator">></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>web<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯è¿˜æ˜¯é€¼ç€æˆ‘åŠ äº†jacksonæ‰å¥½ä½¿äº†ã€‚<br>å…ˆè®°å½•ä¸€ç¬”ï¼Œå†æ…¢æ…¢æƒ³åŸå› å§ï¼Œå¸Œæœ›æ—¥åä¸ä¼šå†ç¢°åˆ°è¿™ä¹ˆæ¶å¿ƒçš„é—®é¢˜ã€‚</p><h2 id="æ„Ÿè°¢"><a href="#æ„Ÿè°¢" class="headerlink" title="æ„Ÿè°¢"></a>æ„Ÿè°¢</h2><p><a href="https://blog.csdn.net/fxbin123/article/details/83221986">SpringBoot2.X é­é‡ No converter found for return value of type: class java.util.LinkedHashMap</a></p>]]></content>
      
      
      <categories>
          
          <category> springboot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> springboot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java-jar jaråŒ…å¸¦ç¯å¢ƒå˜é‡(å‚æ•°)å¯åŠ¨</title>
      <link href="2020/01/20/java-jar-jar-bao-dai-huan-jing-bian-liang-can-shu-qi-dong/"/>
      <url>2020/01/20/java-jar-jar-bao-dai-huan-jing-bian-liang-can-shu-qi-dong/</url>
      
        <content type="html"><![CDATA[<p>java -jarå¯åŠ¨æ—¶åŠ è½½ç¯å¢ƒå˜é‡</p><p><a href="https://www.jianshu.com/p/fed7a174bfb8">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>javaå·¥ç¨‹æˆ‘ä»¬å¯ä»¥ç¼–è¯‘æˆjarä¹Ÿå¯ä»¥ç¿»è¯‘æˆwarï¼Œä¸€èˆ¬åœ°ï¼ŒwaråŒ…æˆ‘ä¼šä¸¢åˆ°tomcatå®¹å™¨é‡Œï¼Œå¯åŠ¨tomcatæ¥è®¿é—®æœåŠ¡ï¼Œç«¯å£ã€SSLè¯ä¹¦ã€æ—¥å¿—ç­‰ç­‰ï¼Œéƒ½æ‰˜ç»™tomcatã€‚</p><p>å¦‚æœæ‰“çš„æ˜¯jaråŒ…ï¼Œæˆ‘é€šå¸¸ä¼šç”¨nohupå¯åŠ¨ï¼Œæ¯”å¦‚ç”Ÿäº§ç¯å¢ƒçš„ä¸€äº›dbã€redisã€ç¬¬ä¸‰æ–¹secretç­‰ä¸ä¼šé…ç½®åˆ°é¡¹ç›®é‡Œï¼Œä»Šå¤©è¦è®°å½•çš„ä¾¿æ˜¯ç”¨nohup java -jar å¯åŠ¨jaråŒ…æ—¶å¦‚ä½•åŠ è½½ç¯å¢ƒå˜é‡é…ç½®çš„é—®é¢˜ã€‚</p><p>javaè¯­è¨€å¼€å‘çš„jaråŒ…å¯åŠ¨æ—¶å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼åŠ å¯åŠ¨å‚æ•°ã€‚</p><h3 id="æ–¹å¼ä¸€ï¼š-DpropName-propValue"><a href="#æ–¹å¼ä¸€ï¼š-DpropName-propValue" class="headerlink" title="æ–¹å¼ä¸€ï¼š-DpropName=propValue"></a>æ–¹å¼ä¸€ï¼š-DpropName=propValue</h3><p>è¿™ç§æ–¹å¼åº”è¯¥å¾ˆå¿«éƒ½èƒ½æ‰¾åˆ°</p><pre class="line-numbers language-shell"><code class="language-shell">-DpropName=propValue<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¯”å¦‚ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">java -jar -DdatabaseUrl="mysql://localhost:3306/pdb?user=root&password=root"  -Dapp.key="123" -Dapp.secret="xxx"  demo.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¤šä¸ªå‚æ•°ä¹Ÿå¯ä»¥ã€‚</p><h3 id="æ–¹å¼äºŒï¼šå‚æ•°ç›´æ¥è·Ÿåœ¨å‘½ä»¤åé¢ï¼Œå¤šä¸ªå‚æ•°ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€"><a href="#æ–¹å¼äºŒï¼šå‚æ•°ç›´æ¥è·Ÿåœ¨å‘½ä»¤åé¢ï¼Œå¤šä¸ªå‚æ•°ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€" class="headerlink" title="æ–¹å¼äºŒï¼šå‚æ•°ç›´æ¥è·Ÿåœ¨å‘½ä»¤åé¢ï¼Œå¤šä¸ªå‚æ•°ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€"></a>æ–¹å¼äºŒï¼šå‚æ•°ç›´æ¥è·Ÿåœ¨å‘½ä»¤åé¢ï¼Œå¤šä¸ªå‚æ•°ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€</h3><pre class="line-numbers language-shell"><code class="language-shell">java -jar demo.jar JOURNAL_TREENODE_DATA-20190404174502.txt processType=1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ç§æ–¹å¼å‚æ•°å°±æ˜¯jaråŒ…é‡Œä¸»å¯åŠ¨ç±»ä¸­mainæ–¹æ³•çš„argså‚æ•°ï¼ŒæŒ‰é¡ºåºæ¥</p><h3 id="æ–¹å¼ä¸‰ï¼šä½¿ç”¨springbootçš„æ–¹å¼ï¼Œâ€“propName-propValueæ–¹å¼"><a href="#æ–¹å¼ä¸‰ï¼šä½¿ç”¨springbootçš„æ–¹å¼ï¼Œâ€“propName-propValueæ–¹å¼" class="headerlink" title="æ–¹å¼ä¸‰ï¼šä½¿ç”¨springbootçš„æ–¹å¼ï¼Œâ€“propName=propValueæ–¹å¼"></a>æ–¹å¼ä¸‰ï¼šä½¿ç”¨springbootçš„æ–¹å¼ï¼Œâ€“propName=propValueæ–¹å¼</h3><pre class="line-numbers language-shell"><code class="language-shell">java -jar demo.jar  --spring.profiles.active=dev  --server.port=8181<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æ³¨æ„ï¼š</strong><br>è¿è¡ŒjaråŒ…æ—¶æŒ‡å®šç«¯å£ï¼šjava -jar xxx.jar â€“server.port=8088<br>è‹¥å‘½ä»¤è¡Œä¼ å…¥çš„server.portæ²¡æœ‰ä½œç”¨ï¼ŒæœåŠ¡ä»ç„¶ä½¿ç”¨8081ç«¯å£å¯åŠ¨ï¼ŒåŸå› æ˜¯spring-cloud-configä¼šè¦†ç›–å‘½ä»¤è¡Œä¼ å…¥çš„å‚æ•°ï¼Œè¿™æ˜¯æœ‰æ„ä¸ºä¹‹ï¼Œ</p><p>åŠæ³•æ˜¯åœ¨web-prod.ymlä¸­åšç‚¹å°æ”¹åŠ¨ï¼Œè®©â€œé…ç½®â€å˜å¾—â€œå¯é…ç½®â€ï¼šåŠ ä¸€å¯¹èŠ±æ‹¬ç¬¦</p><pre class="line-numbers language-shell"><code class="language-shell">server.port={port:8081}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç”¨clojureç¼–å†™çš„jaré‡Œæœ‰æƒŠå–œ"><a href="#ç”¨clojureç¼–å†™çš„jaré‡Œæœ‰æƒŠå–œ" class="headerlink" title="ç”¨clojureç¼–å†™çš„jaré‡Œæœ‰æƒŠå–œ"></a>ç”¨clojureç¼–å†™çš„jaré‡Œæœ‰æƒŠå–œ</h2><p>åœ¨clojureä¸Šé¢çš„é…ç½®å°±å˜å¾—è¯¡å¼‚äº†ï¼ŒçŒœçŒœä¸‹é¢çš„é…ç½®èƒ½ä¸èƒ½ç”Ÿæ•ˆå‘¢ï¼Ÿ</p><pre class="line-numbers language-shell"><code class="language-shell">java -jar -Ddatabase-url="mysql://localhost:3306/pdb?user=root&password=root"  -Dapp.key="123" -Dapp.secret="xxx"  demo.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœä½ ç”¨<code>cider-conect</code>é€šè¿‡nreplçš„ç«¯å£è¿æ¥ä¸Šä½ çš„æœåŠ¡ï¼Œä½ ä¼šå‘ç°ï¼Œè¿™ä¸ªé…ç½®å¯¼è‡´<code>database-url</code>çš„å€¼ç¡®å®å·²ç»æ”¹äº†ï¼Œä½†æ˜¯åé¢ä¸¤ä¸ªæ²¡æœ‰ã€‚</p><p>ç©¶å…¶åŸå› ï¼Œæˆ‘ä»¬javaä»classpathé‡Œè·å–å‚æ•°ä½¿ç”¨çš„æ˜¯propertieså½¢å¼çš„ï¼Œä¹Ÿå°±æ˜¯jsonçš„æ ¼å¼ã€‚è¿™ä¸éš¾ç†è§£ï¼Œspringæœ‰å®ƒçš„åŠæ³•ï¼Œclojureå½“ç„¶ä¹Ÿæœ‰è‡ªå·±çš„æ–¹å¼ã€‚</p><pre class="line-numbers language-json"><code class="language-json"><span class="token property">"app"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"123"</span><span class="token punctuation">,</span>    <span class="token property">"secret"</span><span class="token operator">:</span><span class="token string">"xxx"</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è™½ç„¶jsonå’Œæˆ‘ä»¬çš„edné‡Œmapæ˜¯å¾ˆåƒçš„ï¼Œä½†æ˜¯æ¯•ç«Ÿæ˜¯ä¸åŒï¼Œäºæ˜¯è¦åˆ†æä¸‹ç°åœ¨çš„edné‡Œçš„é…ç½®ä¿¡æ¯ä»–æ˜¯æ€ä¹ˆè¯»å–çš„å‘¢ï¼Ÿ</p><h3 id="ä»£ç é‡Œçš„env"><a href="#ä»£ç é‡Œçš„env" class="headerlink" title="ä»£ç é‡Œçš„env"></a>ä»£ç é‡Œçš„env</h3><p>åœ¨<code>config</code>è¿™ä¸ªnamespaceé‡Œæ‰¾åˆ°äº†env</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defstate env  :start  (load-config   :merge   [(args)    (source/from-system-props)    (source/from-env)]))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="cpropåŠ è½½é…ç½®"><a href="#cpropåŠ è½½é…ç½®" class="headerlink" title="cpropåŠ è½½é…ç½®"></a>cpropåŠ è½½é…ç½®</h3><p><code>cprop.source</code>è¿™ä¸ªæ–‡ä»¶å°±æ˜¯ç”¨æ¥åŠ è½½ednæ–‡ä»¶çš„</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defn- env->path [k]  (k->path k "_" #"__"))(defn read-system-env  ([]   (read-system-env {}))  ([opts]   (->> (System/getenv)        (map (fn [[k v]] [(env->path k)                          (str->value v opts)]))        (into {}))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»è·å–çš„è¿‡ç¨‹çœ‹ï¼Œåº”è¯¥æ˜¯ä¼šæŠŠ<code>_</code>åšä¸ºå•å…ƒèŠ‚ç‚¹æ–­å¼€ï¼Œå› æ­¤éœ€è¦æ”¹æˆè¿™æ ·</p><pre class="line-numbers language-clojure"><code class="language-clojure">java -jar -Ddatabase-url="mysql://localhost:3306/pdb?user=root&password=root"  -Dapp_key="123" -Dapp_secret="xxx"  demo.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¹åº”åˆ°edné‡Œåº”è¯¥æ˜¯</p><pre class="line-numbers language-clojure"><code class="language-clojure">{:app    {:key "123"     :secret "xxx"}}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä»”ç»†çœ‹çœ‹<a href="https://github.com/tolitius/cprop#loading-config">cprop</a>è¿™ä¸ªåº“å°±ä¸éš¾ç†è§£äº†ã€‚<br>cpropåŠ è½½é…ç½®æ–‡ä»¶çš„é¡ºåºæ˜¯ :</p><blockquote><p>By default cprop will merge all configurations it can find in the following order:<br>classpath resource config<br>file on a file system (pointed by a conf system property or by (load-config :file <path>))<br>custom configurations, maps from various sources, etc.<br>System properties<br>ENV variables</path></p></blockquote><p>å¯¹äºENVçš„åŠ è½½ä¹Ÿæœ‰æ˜ç¡®è¯´æ˜</p><blockquote><p>ENV variables lack structure. The only way to mimic the structure is via use of an underscore character. The _ is converted to - by cprop, so instead, to identify nesting, two underscores can be used.</p></blockquote><p>äº†è§£æ›´å¤šè¯¦æƒ…ï¼Œè¯·é˜…è¯»<a href="https://github.com/tolitius/cprop#speaking-env-variables">cpropä»‹ç»</a></p><h2 id="æˆ‘çš„æœŸæœ›"><a href="#æˆ‘çš„æœŸæœ›" class="headerlink" title="æˆ‘çš„æœŸæœ›"></a>æˆ‘çš„æœŸæœ›</h2><p>åƒä¸Šé¢çš„å‘½ä»¤å¦‚æœæœ‰20ä¸ªå‚æ•°éœ€è¦åœ¨å¯ä¸œæ—¶æŒ‡å®šï¼Œä¼°è®¡çœ‹é‚£ä¸ªå‘½ä»¤å°±ç–¯äº†ï¼Œé‚£èƒ½ä¸èƒ½åœ¨å¯ä¸œæ—¶æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚prod-config.ednä¹‹ç±»çš„å‘¢ï¼Ÿæˆ‘æ²¡æœ‰æ‰¾åˆ°ï¼Œå¦‚æœæœ‰å°±æ›´æ–¹ä¾¿äº†ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://github.com/tolitius/cprop#loading-config">cprop</a></p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shadow-cljså¤šç¯å¢ƒå¤šbase dominé…ç½®(closure-definesç¯‡)</title>
      <link href="2020/01/03/shadow-cljs-duo-huan-jing-duo-base-domin-pei-zhi-closure-defines-pian/"/>
      <url>2020/01/03/shadow-cljs-duo-huan-jing-duo-base-domin-pei-zhi-closure-defines-pian/</url>
      
        <content type="html"><![CDATA[<p>ç”¨shadow-cljsç¼–è¯‘ä»£ç æ—¶ä½¿ç”¨ç¯å¢ƒå˜é‡å®ç°å¤šç¼–è¯‘ç¯å¢ƒ</p><p><a href="https://www.jianshu.com/p/fc68c58cae5c">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="åŸæ–¹æ¡ˆ"><a href="#åŸæ–¹æ¡ˆ" class="headerlink" title="åŸæ–¹æ¡ˆ"></a>åŸæ–¹æ¡ˆ</h2><p>å‰ç«¯æœ‰ä¸ªconfig.cljsæ–‡ä»¶ï¼Œå®šä¹‰äº†ä¸€ä¸ªdomainçš„å‡½æ•°ï¼ŒæŒ‡å®šapiæ¥å£çš„base-urlï¼Œæœ¬åœ°å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§åˆ†åˆ«ä¿®æ”¹æˆä¸åŒåœ°å€ã€‚ç±»ä¼¼è¿™æ ·å§ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns <<project-ns>>.config);; æµ‹è¯•ç¯å¢ƒ#_(def domain "https://test.url.com");; ç”Ÿäº§ç¯å¢ƒ#_(def domain "https://prod.url.com");;å¼€å‘ç¯å¢ƒ(def domain "http://localhost:3000")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªä¸æ˜¯é•¿ä¹…ä¹‹è®¡ï¼Œåˆä¸æ™ºèƒ½ï¼Œéƒ¨ç½²æ—¶è¿˜è¦ä¿®æ”¹åœ°å€ï¼Œå®¹æ˜“å¿˜è®°ï¼Œå¹¶ä¸”è¿˜æœ‰æ—¶ä¼šæŠŠä¿®æ”¹æäº¤ä¸Šå»ã€‚å°¤å…¶æ˜¯æ²¡æœ‰æŒç»­é›†æˆå·¥å…·å¸®åŠ©åšéƒ¨ç½²å·¥ä½œçš„æ—¶å€™ã€‚~</p><h2 id="å½“å‰æ–¹æ¡ˆ"><a href="#å½“å‰æ–¹æ¡ˆ" class="headerlink" title="å½“å‰æ–¹æ¡ˆ"></a>å½“å‰æ–¹æ¡ˆ</h2><p><a href="https://shadow-cljs.github.io/docs/UsersGuide.html">shadow-cljsç”¨æˆ·æŒ‡å—</a>æˆ‘æ²¡æœ‰é€šè¯»ï¼Œä½†æ˜¯ä»ç›®å½•çœ‹ä¹Ÿæœ‰<a href="https://shadow-cljs.github.io/docs/UsersGuide.html#shadow-env">ç¯å¢ƒå˜é‡</a>ç« èŠ‚çœ‹ï¼Œä¹Ÿæœ‰æ–¹æ¡ˆã€‚</p><p>é‡‡ç”¨<a href="https://github.com/shadow-cljs/shadow-cljs.github.io/blob/master/docs/build-config.adoc#closure-defines">closure-defines</a>çš„æ–¹æ¡ˆï¼ŒæŒ‡å®šå¤šä¸ªbuild id,åœ¨ä¸åŒçš„buildä¸­ä¼ å…¥ç¯å¢ƒå˜é‡ã€‚</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns <<project-ns>>.config);;æ­¤å¤„çš„å˜é‡éœ€è¦ä¿®æ”¹çš„è¯·åœ¨é¡¹ç›®è·Ÿç›®å½•çš„shadow-cljs.ednä¸­ä¿®æ”¹(goog-define domain "http://localhost:3000")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><code>shadow-cljs.edn</code>é…ç½®å¤§æ¦‚è¿™æ ·</p><pre class="line-numbers language-clojure"><code class="language-clojure">:builds{:app  {:target :browser   :output-dir "target/cljsbuild/public/dev/js"   :asset-path "/js"   :modules {:app {:entries [YOUR-APP.app]}}   :devtools   {:watch-dir "resources/public"    :ignore-warnings true    :preloads [re-frisk.preload]}   :closure-defines {"re_frame.trace.trace_enabled_QMARK_" true}   :dev  {:closure-defines {<<project-ns>>.config/domain "http://localhost:3000"}}}  :test-app  {:target :browser   :output-dir "target/cljsbuild/public/test/js"   :asset-path "/js"   :modules {:app {:entries [YOUR-APP.app]}}   :release {:closure-defines {<<project-ns>>.config/domain "https://test.url.com"}}}  :prod-app  {:target :browser   :output-dir "target/cljsbuild/public/prod/js"   :asset-path "/js"   :modules {:app {:entries [YOUR-APP.app]}}   :release {:closure-defines {<<project-ns>>.config/domain "https://prod.url.com"}}}}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å¥½å¤„"><a href="#å¥½å¤„" class="headerlink" title="å¥½å¤„"></a>å¥½å¤„</h4><ul><li>å¯ä»¥å®šä¹‰å¤šä¸ªå˜é‡ï¼Œæ¯”å¦‚ä»å¤šä¸ªapiåœ°å€</li><li>å¯ä»¥é…ç½®æ— é™å¤šä¸ª</li></ul><h4 id="ä¸å¥½å¤„"><a href="#ä¸å¥½å¤„" class="headerlink" title="ä¸å¥½å¤„"></a>ä¸å¥½å¤„</h4><ul><li>å¦‚æœæœ‰æ–°å¢åœ°å€ï¼Œéœ€è¦ä¿®æ”¹å¤šä¸ªbuildsçš„é…ç½®</li><li>åœ°å€æ˜æ–‡å¯è§ï¼Œæƒ³åšéƒ¨ç½²å±‚çš„ä¿å¯†çš„è¯ï¼Œä¸å¯ä»¥ã€‚</li></ul><h2 id="å…¶ä»–æ–¹æ¡ˆ"><a href="#å…¶ä»–æ–¹æ¡ˆ" class="headerlink" title="å…¶ä»–æ–¹æ¡ˆ"></a>å…¶ä»–æ–¹æ¡ˆ</h2><p>è¿˜æ˜¯åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œåé¢æåˆ°äº†åˆ«çš„æ–¹æ¡ˆã€‚å½“å‰æ¥è¯´ä¸Šé¢çš„ä¸åˆ©ä¹‹å¤„è¿˜ä¸æ˜¯ä¸ªé—®é¢˜ï¼Œç”¨åˆ°æ—¶å†è°ƒæ•´å…¶ä»–æ–¹æ¡ˆã€‚</p><ul><li><a href="https://github.com/shadow-cljs/shadow-cljs.github.io/blob/master/docs/build-config.adoc#conditional-reading">Conditional Reading</a></li><li><a href="https://github.com/shadow-cljs/shadow-cljs.github.io/blob/master/docs/build-config.adoc#overriding-from-the-cli">overriding-from-the-cli</a></li><li><a href="https://github.com/shadow-cljs/shadow-cljs.github.io/blob/master/docs/build-config.adoc#using-environment-variables">using-environment-variables</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> shadow-cljs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojurescript </tag>
            
            <tag> shadow-cljs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojurescriptç¼–è¯‘ååˆå¹¶cssæ–‡ä»¶è§£å†³ç¼“å­˜é—®é¢˜</title>
      <link href="2020/01/02/clojurescript-bian-yi-hou-he-bing-css-wen-jian-jie-jue-huan-cun-wen-ti/"/>
      <url>2020/01/02/clojurescript-bian-yi-hou-he-bing-css-wen-jian-jie-jue-huan-cun-wen-ti/</url>
      
        <content type="html"><![CDATA[<p>clojurescripté¡¹ç›®ç”¨<code>shadow-cljs</code>ç¼–è¯‘åå°†æ‰€æœ‰cssæ–‡ä»¶å‹ç¼©æˆä¸€ä¸ªï¼Œå¹¶åŠ ç‰ˆæœ¬å·è®¿é—®è¾ƒå°‘ç¼“å­˜ã€‚</p><p><a href="https://www.jianshu.com/p/3bc7713a5b08">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æœ¬ç¯‡è·Ÿ<a href="https://www.jianshu.com/p/b60fe36cbe84">electronå®‰è£…åŒ…é‡Œå°è£…æµè§ˆå™¨ç›´æ¥è®¿é—®URLé…ç½®</a>æœ‰å…³ã€‚</p><p>æˆ‘ä»¬ç›®å‰çš„é…ç½®ç”¨<code>shadow-cljs release app</code> æ‰“åŒ…å¥½jsæ–‡ä»¶åï¼Œéœ€è¦å°†å…¥å£æ–‡ä»¶ã€å›¾ç‰‡ã€cssã€jsä¸€èµ·copyåˆ°éƒ¨ç½²æœåŠ¡å™¨ã€‚<br>å…¶ä¸­cssæ˜¯æ•£ç¢çš„å„ä¸ªé¡µé¢è‡ªè¡Œæ·»åŠ çš„æ ·å¼æ–‡ä»¶ã€‚<br>ä½†æ˜¯ç”¨electronç›´æ¥è®¿é—®URLä»¥åï¼Œcssæ€»æ˜¯è¢«ç¼“å­˜ä¸‹æ¥ï¼Œè¿™æ ·å°±å¯¼è‡´äº†ä¸€ä¸ªç³»ç»Ÿä¿®æ”¹çš„æ ·å¼ååœ¨åº”ç”¨é‡Œæ‰“å¼€ä¸ç”Ÿæ•ˆçš„é—®é¢˜ã€‚</p><h2 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" class="headerlink" title="æ–¹æ¡ˆ"></a>æ–¹æ¡ˆ</h2><p>å°†åœ¨éƒ¨ç½² æ—¶å°†ä¼—å¤šcssæ–‡ä»¶å†…å®¹åˆå¹¶åˆ°ä¸€ä¸ªcssæ–‡ä»¶ï¼Œç„¶ååœ¨å…¥å£çš„<code>index.html</code>é‡Œå¼•å…¥è¿™ä¸ªè¢«åˆå¹¶çš„cssæ–‡ä»¶ï¼ŒåŒæ—¶åŠ ä¸Šç‰ˆæœ¬å·ï¼Œç¦æ­¢ç¼“å­˜ã€‚</p><h2 id="å®æ–½"><a href="#å®æ–½" class="headerlink" title="å®æ–½"></a>å®æ–½</h2><ul><li><h3 id="ç¬¬ä¸€æ­¥ï¼Œå‡†å¤‡è„šæœ¬"><a href="#ç¬¬ä¸€æ­¥ï¼Œå‡†å¤‡è„šæœ¬" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼Œå‡†å¤‡è„šæœ¬"></a>ç¬¬ä¸€æ­¥ï¼Œå‡†å¤‡è„šæœ¬</h3><p>å› ä¸ºä½¿ç”¨jenkinså‘å¸ƒï¼Œæ‰€ä»¥å…ˆæä¸€ä¸ªåˆå¹¶æ–‡ä»¶çš„è„šæœ¬(merge_css.sh)ï¼Œç­‰ç€åœ¨jenkinsé‡Œè¿œç«¯æ‰§è¡Œä¸€ä¸‹ã€‚å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/bash#è·å–ç¬¬ä¸€ä¸ªå‚æ•°,ç›®æ ‡ç›®å½•srcpath=$1#ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¾“å‡ºæ–‡ä»¶target_file=$2#å…ˆåˆ é™¤åŸç›®æ ‡æ–‡ä»¶rm -rf ${target_file};function writeByDir(){  echo $1  for file in $1/*    do      if test -f $file        then    echo $file        cat "$file" >> "${target_file}"        echo "" >> "${target_file}"      else        writeByDir $file     fi  done}writeByDir ${srcpath}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾ˆç®€å•ï¼Œè¿å‚æ•°åˆç†æ€§éƒ½æ²¡æœ‰æ ¡éªŒï¼Œè‡ªå·±ç”¨è‡ªå·±çŸ¥é“å°±è¡Œã€‚</p></li><li><h3 id="ç¬¬äºŒæ­¥ï¼Œè¿œç«¯æ‰§è¡Œ"><a href="#ç¬¬äºŒæ­¥ï¼Œè¿œç«¯æ‰§è¡Œ" class="headerlink" title="ç¬¬äºŒæ­¥ï¼Œè¿œç«¯æ‰§è¡Œ"></a>ç¬¬äºŒæ­¥ï¼Œè¿œç«¯æ‰§è¡Œ</h3><p>åœ¨jenkinsé‡Œï¼Œè·ŸåŸæ¥ä¸€æ ·ï¼Œå°†cssã€imgã€index.htmlã€app.jsæ ¸å¿ƒæ–‡ä»¶<code>rsync -rzve</code> åˆ°è¿œç«¯ä»¥åï¼Œå†æ„å»ºæœ€ååŠ ä¸€ä¸ªåˆå¹¶çš„shell</p><pre class="line-numbers language-shell"><code class="language-shell">ssh -p2020 root@*.*.*.* 'bash -s ' < /opt/auto-deploy-scripts/merge_css.sh /opt/site/project/css /opt/site/project/css/main.css<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨åŸæ¥çš„cssæ–‡ä»¶ä¸‹ï¼Œå°†ç”Ÿæˆä¸€ä¸ªmain.cssæ–‡ä»¶ã€‚</p></li></ul><h3 id="ç¬¬ä¸‰æ­¥ï¼Œä½¿ç”¨åˆå¹¶çš„cssæ–‡ä»¶"><a href="#ç¬¬ä¸‰æ­¥ï¼Œä½¿ç”¨åˆå¹¶çš„cssæ–‡ä»¶" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼Œä½¿ç”¨åˆå¹¶çš„cssæ–‡ä»¶"></a>ç¬¬ä¸‰æ­¥ï¼Œä½¿ç”¨åˆå¹¶çš„cssæ–‡ä»¶</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>å¹³å°<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdn.bootcss.com/antd/3.18.0/antd.min.css<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- Our JavaScript will modify the DOM inside this element --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&lt;link rel='stylesheet' type='text/css' href='css/main.css?v="</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"'>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&lt;script type='text/javascript' src='doctorjs/app.js?v="</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"' type='text/javascript'>&lt;\/script>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»æ£€æŸ¥ï¼Œå·²ç”Ÿæ•ˆã€‚<br>å®Œï¼ï¼ï¼</p><p><img src="/loading.gif" data-original="/images/clojure/merge-css.png" alt="cssåˆå¹¶å.png"></p><h2 id="é—ç•™é—®é¢˜"><a href="#é—ç•™é—®é¢˜" class="headerlink" title="é—ç•™é—®é¢˜"></a>é—ç•™é—®é¢˜</h2><ul><li>æœ¬åœ°å¼€å‘å› ä¸ºæ²¡æœ‰å‹ç¼©æˆä¸€ä¸ªcssæ–‡ä»¶ï¼Œæ‰€ä»¥å¯èƒ½ä¼šæç¤ºmain.cssä¸‹è½½404ï¼Œå¯ä»¥åˆ›å»ºä¸ªåŒåç©ºæ–‡ä»¶</li><li>å› ä¸ºå•ä¸ªé¡µé¢è¿˜æ˜¯å¼•ç”¨çš„è‡ªå·±çš„cssæ–‡ä»¶ï¼Œæ‰€ä»¥é‚£äº›ç¢ç‰‡cssæ–‡ä»¶åŠ è½½å®Œæˆå‰é¡µé¢å…ƒç´ è¿˜æ˜¯èšé›†åœ¨viewçš„å·¦ä¸Šè§’ã€‚åŠ ä¸Šåˆå¹¶çš„cssï¼Œç›¸å½“äºåŒé‡æ ·å¼ã€‚</li><li>è¿˜æ˜¯æŠŠcsséƒ½å¤åˆ¶åˆ°äº†è¿œç«¯ï¼Œåšå¥½äº†å½“ç„¶æ˜¯ç¼–è¯‘æ—¶å°±ç¼–è¯‘æˆä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å»é‡ï¼Œå‹ç¼©ç­‰ç­‰ï¼Œèƒ½é›†æˆwebpackäº†å†æ</li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.jianshu.com/p/3e3b1a5fa077">Shellè„šæœ¬åˆå¹¶æ–‡æœ¬æ–‡ä»¶</a></p>]]></content>
      
      
      <categories>
          
          <category> cljs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cljs </tag>
            
            <tag> electron </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>electronå®‰è£…åŒ…é‡Œå°è£…æµè§ˆå™¨ç›´æ¥è®¿é—®URLé…ç½®</title>
      <link href="2019/12/31/electron-an-zhuang-bao-li-feng-zhuang-liu-lan-qi-zhi-jie-fang-wen-url-pei-zhi/"/>
      <url>2019/12/31/electron-an-zhuang-bao-li-feng-zhuang-liu-lan-qi-zhi-jie-fang-wen-url-pei-zhi/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ä¸‹è½½çš„electroné‡Œç›´æ¥è®¿é—®æŸä¸ªurlåœ°å€</p><p><a href="https://www.jianshu.com/p/b60fe36cbe84">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ä¹Ÿæ˜¯å› ä¸º<a href="https://www.jianshu.com/p/bb7a92618379">clojurescriptç¼–è¯‘åç”¨electronæ‰“åŒ…æˆæ¡Œé¢åº”ç”¨å®‰è£…ç¨‹åº</a>è¿™ç¯‡æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œæ‰€ä»¥è€ƒè™‘ç›´æ¥ç”¨electronæ‰“ä¸ªchromeæµè§ˆå™¨è¿›å»ï¼Œç„¶ååˆ¶å®šè®¿é—®çš„ç½‘é¡µï¼Œä»£æ›¿æœ¬åœ°èµ„æºã€‚</p><p>è¯è¯´å‰ä¸€ç¯‡ä¹‹æ‰€ä»¥æ²¡æœ‰æˆåŠŸï¼Œä¹Ÿä¸æ˜¯å®Œå…¨è§£å†³ä¸äº†ï¼Œè€Œæ˜¯å› ä¸ºä¸æƒ³æŠ˜è…¾äº†ï¼Œè§£å†³çš„è¯æ€è·¯åº”è¯¥æœ‰ä¸¤æ¡ï¼š</p><blockquote><ol><li>figwheelä¸æ”¯æŒnpmç¨‹åºï¼Œæ¢æˆshadow-cljsä¹‹ç±»çš„ç¼–è¯‘å™¨</li><li>å¢åŠ electronä¾èµ–ï¼Œåœ¨åº”ç”¨å±‚è§¦å‘æ›´æ–°æ£€æŸ¥</li></ol></blockquote><p>è¿™ç¯‡è¯´æ˜ä¸€ä¸‹ç›´æ¥è¿è¡ŒURLçš„é…ç½®å’Œæ³¨æ„äº‹é¡¹ã€‚</p><h3 id="1-ä¸‹è½½electronçš„å‹ç¼©åŒ…"><a href="#1-ä¸‹è½½electronçš„å‹ç¼©åŒ…" class="headerlink" title="1. ä¸‹è½½electronçš„å‹ç¼©åŒ…"></a>1. ä¸‹è½½electronçš„å‹ç¼©åŒ…</h3><p><a href="https://electronjs.org/releases/stable">https://electronjs.org/releases/stable</a></p><p>ä¸‹è½½è§£å‹ï¼Œå†…éƒ¨ç›®å½•å¤§æ¦‚å¦‚æ­¤<br><img src="/loading.gif" data-original="/images/fontend/electron-dir.png" alt="electronå‹ç¼©åŒ…æ–‡ä»¶ç»“æ„"></p><p>ä¸»è¦è¿è¡Œæ—¶æ–‡ä»¶å°±æ˜¯<code>resources/default_app.asar</code></p><h3 id="2-å®‰è£…asaråŒ…è§£å‹ç¼©å‘½ä»¤"><a href="#2-å®‰è£…asaråŒ…è§£å‹ç¼©å‘½ä»¤" class="headerlink" title="2. å®‰è£…asaråŒ…è§£å‹ç¼©å‘½ä»¤"></a>2. å®‰è£…<code>asar</code>åŒ…è§£å‹ç¼©å‘½ä»¤</h3><pre class="line-numbers language-shell"><code class="language-shell">yum install -g asar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸¤ä¸ªå‘½ä»¤(asar â€“help)ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">asar pack app default_app.asar    asar extract|e <archive> <dest>   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å…¶ä»–å‘½ä»¤è‡ªè¡Œç™¾åº¦ã€‚</p><h3 id="3-æ ¸å¿ƒæ–‡ä»¶"><a href="#3-æ ¸å¿ƒæ–‡ä»¶" class="headerlink" title="3.æ ¸å¿ƒæ–‡ä»¶"></a>3.æ ¸å¿ƒæ–‡ä»¶</h3><p>æ ¸å¿ƒæ–‡ä»¶å°±æ˜¯æ‰“åŒ…æˆ<code>resources/default_app.asar</code>æ‰€éœ€è¦çš„æ–‡ä»¶ã€‚åœ¨<code>electron</code>çš„é¡¹ç›®ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹<code>app</code> ï¼Œé‡Œé¢æ–°å»ºä¸¤ä¸ªæ–‡ä»¶ã€‚</p><h4 id="3-1-main-js"><a href="#3-1-main-js" class="headerlink" title="3.1 main.js"></a>3.1 main.js</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// app æ¨¡å—æ˜¯ä¸ºäº†æ§åˆ¶æ•´ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸè®¾è®¡çš„ã€‚</span><span class="token comment" spellcheck="true">// BrowserWindow ç±»è®©ä½ æœ‰åˆ›å»ºä¸€ä¸ªæµè§ˆå™¨çª—å£çš„æƒåŠ›ã€‚</span><span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">,</span> Menu<span class="token punctuation">,</span> ipcMain<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> nativeImage <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nativeImage<span class="token punctuation">;</span><span class="token keyword">var</span> overlay <span class="token operator">=</span> nativeImage<span class="token punctuation">.</span><span class="token function">createFromPath</span><span class="token punctuation">(</span><span class="token string">'icon.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> mainWindowURL <span class="token operator">=</span> <span class="token string">'https://www.baidu.com'</span><span class="token punctuation">;</span><span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//api:https://wizardforcel.gitbooks.io/electron-doc/content/api/browser-window.html</span><span class="token keyword">function</span> createWindow <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"createWindow......"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// fullscreen: true,</span>      maximizable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//æ”¯æŒæœ€å¤§åŒ–</span>      show<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>   <span class="token comment" spellcheck="true">//ä¸ºäº†è®©åˆå§‹åŒ–çª—å£æ˜¾ç¤ºæ— é—ªçƒï¼Œå…ˆå…³é—­æ˜¾ç¤ºï¼Œç­‰å¾…åŠ è½½å®Œæˆåå†æ˜¾ç¤ºã€‚</span>      <span class="token comment" spellcheck="true">// icon: "https://medical.3vyd.com/alk/prod/pc/icon/icon.ico"</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// Emitted when the window is closed.</span>    mainWindow<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"closed......"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       mainWindow <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// mainWindow.once('ready-to-show', () => {    //å¼€å¯è¿™ä¸ªä»¥åç‚¹å‡»äº†å›¾ç‰‡è™½ç„¶æ²¡æœ‰ç™½å±ï¼Œä½†æ˜¯ä¼šæ„Ÿè§‰ä¸åˆ°ç‚¹äº†æ²¡ç‚¹</span>    mainWindow<span class="token punctuation">.</span><span class="token function">maximize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ‰“å¼€æ—¶æœ€å¤§åŒ–æ‰“å¼€ï¼Œä¸æ˜¯å…¨å±ï¼Œä¿ç•™çŠ¶æ€æ </span>    <span class="token comment" spellcheck="true">// })</span>  <span class="token comment" spellcheck="true">// mainWindow.setOverlayIcon(overlay, "åŒ»æ•")</span>  mainWindow<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">"è¿‡æ•æ€§ç–¾ç—…é«˜ç«¯ç”¨æˆ·å¹³å°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  mainWindow<span class="token punctuation">.</span><span class="token function">setAutoHideMenuBar</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è‡ªåŠ¨éšè—èœå•</span>  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span>mainWindowURL<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// app.commandLine.appendSwitch("--disable-http-cache")   ç¦ç”¨ç¼“å­˜</span>  <span class="token comment" spellcheck="true">// mainWindow.webContents.openDevTools({mode:'bottom'});</span>  mainWindow<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ready......"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// Quit when all windows are closed.</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'window-all-closed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// On OS X it is common for applications and their menu bar</span>  <span class="token comment" spellcheck="true">// to stay active until the user quits explicitly with Cmd + Q</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>platform <span class="token operator">!==</span> <span class="token string">'darwin'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-2-package-json"><a href="#3-2-package-json" class="headerlink" title="3.2 package.json"></a>3.2 package.json</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"electron"</span><span class="token punctuation">,</span>  <span class="token string">"productName"</span><span class="token punctuation">:</span> <span class="token string">"Electron"</span><span class="token punctuation">,</span>  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"main.js"</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„ï¼š</strong><code>productName</code>çš„å€¼åƒä¸‡ä¸éœ€è¦æ”¹ã€‚</p><h4 id="4-æ‰“åŒ…"><a href="#4-æ‰“åŒ…" class="headerlink" title="4. æ‰“åŒ…"></a>4. æ‰“åŒ…</h4><p>åœ¨<code>electron/resources</code>ç›®å½•ä¸‹æ‰§è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">rm -rf default_app.asarasar pack app default_app.asar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¹Ÿå°±æ˜¯ç”¨è‡ªå·±å¿ƒå¤§çš„asaræ–‡ä»¶æ›¿æ¢åŸæ¥æ—§çš„ã€‚</p><h4 id="5-æµ‹è¯•"><a href="#5-æµ‹è¯•" class="headerlink" title="5. æµ‹è¯•"></a>5. æµ‹è¯•</h4><p>åœ¨windowsä¸Šè®¿é—®è¯¥exeåº”ç”¨ï¼Œä¸€èˆ¬åº”è¯¥æ²¡æœ‰é—®é¢˜æ‰“å¼€ç™¾åº¦çš„ã€‚</p><h2 id="é—®é¢˜ï¼š"><a href="#é—®é¢˜ï¼š" class="headerlink" title="é—®é¢˜ï¼š"></a>é—®é¢˜ï¼š</h2><ol><li>electronç¼“å­˜é—®é¢˜<br>æµè§ˆå™¨è®¿é—®çš„èµ„æºéƒ½ä¼šè¢«ç¼“å­˜ï¼Œå‡ ç§æ–¹å¼é¿å…ç¼“å­˜ã€‚</li></ol><ul><li>åœ¨cssæˆ–è€…jsç­‰èµ„æºåé¢åŠ ç‰ˆæœ¬å·</li><li>æ‰“åŒ…æ—¶ç¦ç”¨ç¼“å­˜ï¼Œå‚è€ƒï¼š<a href="https://newsn.net/say/electron-no-cache.html">electron å¦‚ä½•ç¦ç”¨æœ¬åœ°ç¼“å­˜ï¼Ÿå¼ºåˆ¶åˆ·æ–°ç¼“å­˜æ–¹æ¡ˆ</a></li><li>æ¸…é™¤æœ¬åœ°cache<blockquote><p>windowsä¸Šä½ç½®ï¼š<br>The Electron stores itâ€™s cache in these folders:<br>Windows:<br>C:\Users&lt;user&gt;\AppData\Roaming&lt;yourAppName&gt;\Cache<br>Linux:<br>/home/<user>/.config/<yourappname>/Cache<br>OS X:<br>/Users/<user>/Library/Application Support/<yourappname>/Cache</yourappname></user></yourappname></user></p></blockquote></li></ul><ol start="2"><li>å‡çº§é—®é¢˜<br>å› ä¸ºç›´æ¥è®¿é—®urlï¼Œæ‰€ä»¥ä¸å­˜åœ¨ä¸Šä¸€ç¯‡è¯´çš„ç‰ˆæœ¬æ›´æ–°é—®é¢˜ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> electron </category>
          
      </categories>
      
      
        <tags>
            
            <tag> electron </tag>
            
            <tag> clojurescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojurescriptç¼–è¯‘åç”¨electronæ‰“åŒ…æˆæ¡Œé¢åº”ç”¨å®‰è£…ç¨‹åº</title>
      <link href="2019/12/22/clojurescript-bian-yi-hou-yong-electron-da-bao-cheng-zhuo-mian-ying-yong-an-zhuang-cheng-xu/"/>
      <url>2019/12/22/clojurescript-bian-yi-hou-yong-electron-da-bao-cheng-zhuo-mian-ying-yong-an-zhuang-cheng-xu/</url>
      
        <content type="html"><![CDATA[<p>ç”¨electronæŠŠclojurescriptç¼–è¯‘åçš„é™æ€èµ„æºæ–‡ä»¶æ‰“åŒ…æˆwindowså®‰è£…ç¨‹åº</p><p><a href="https://www.jianshu.com/p/bb7a92618379">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>clojurescriptæœ€ç»ˆè¿˜æ˜¯ç¼–è¯‘æˆjavascriptåœ¨æµè§ˆå™¨æ‰§è¡Œï¼Œæœ¬æ–‡æè¿°çš„æ˜¯åœ¨é¡¹ç›®æœ¬èº«åœ¨C/Sç¯å¢ƒä¸Šè¿è¡Œæ²¡æœ‰é—®é¢˜çš„æƒ…å†µä¸‹ï¼Œæ€ä¹ˆå°†è¿™äº›èµ„æºæ–‡ä»¶ç”¨electronæ‰“åŒ…æˆwindowsæˆ–è€…macçš„B/Såº”ç”¨ã€‚</p><p>æŠ€æœ¯è¯­è¨€å’Œå·¥å…·ï¼š</p><ul><li><a href="https://clojurescript.org/">clojurescript</a></li><li><a href="https://electronjs.org/">electronjs</a></li><li><a href="https://www.electron.build/">electron-builder</a></li></ul><h2 id="ç¬¬ä¸€æ­¥ï¼šæ‰“åŒ…cljsæˆå¯é€šè¿‡æµè§ˆå™¨æµè§ˆçš„ç½‘ç»œèµ„æº"><a href="#ç¬¬ä¸€æ­¥ï¼šæ‰“åŒ…cljsæˆå¯é€šè¿‡æµè§ˆå™¨æµè§ˆçš„ç½‘ç»œèµ„æº" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šæ‰“åŒ…cljsæˆå¯é€šè¿‡æµè§ˆå™¨æµè§ˆçš„ç½‘ç»œèµ„æº"></a>ç¬¬ä¸€æ­¥ï¼šæ‰“åŒ…cljsæˆå¯é€šè¿‡æµè§ˆå™¨æµè§ˆçš„ç½‘ç»œèµ„æº</h2><p>æˆ‘è¿™ä¸ªé¡¹ç›®æ˜¯ç”¨figwheelç¼–è¯‘çš„ï¼Œæ‰“åŒ…å‘½ä»¤å¦‚ä¸‹:</p><pre class="line-numbers language-shell"><code class="language-shell">lein cljsbuild once min-doctor<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœæ˜¯ç”¨shadow-cljsç¼–è¯‘é¡¹ç›®çš„è¯ï¼Œå‘½ä»¤åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">shadow-cljs release app <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>é‡ç‚¹æ¥äº†</strong>ï¼šè¿™äº›ç¼–è¯‘æ–‡ä»¶åªæ˜¯å°†cljsæ‰“åŒ…æˆapp.jsæ–‡ä»¶ï¼Œç›®å½•ä¸€èˆ¬åœ¨targetç›®å½•çš„æŸä¸ªé—®é¢˜ï¼Œè¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯è¿™æ ·çš„ã€‚<br>ä½†æ˜¯ä¼—æ‰€å‘¨çŸ¥ï¼Œè¿è¡Œä¸€ä¸ªç½‘é¡µåªè¦ä¸€ä¸ªjsè‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œåœ¨ç”¨luminusåˆ›å»ºå‡ºæ¥çš„æ¨¡æ¿é‡Œï¼Œcsså’Œimageæ–‡ä»¶éƒ½åœ¨<code>resource/public</code>ç›®å½•ä¸‹ï¼ŒåŒ…æ‹¬å…¥å£çš„index.htmlæ–‡ä»¶ã€‚</p><p>ç”¨nginxç­‰éƒ¨ç½²æ—¶éœ€è¦å°†è¿™äº›æ–‡ä»¶ä¹Ÿä¸€å¹¶copyåˆ°nginxæœåŠ¡å™¨ä¸Šï¼Œè¿™ä¸€æ­¥å°±ä¸è¯´äº†ã€‚</p><h2 id="ç¬¬äºŒæ­¥ï¼šå°†è¿™äº›ç½‘ç»œèµ„æºæ‰“åŒ…æˆelectronå®‰è£…ç¨‹åº"><a href="#ç¬¬äºŒæ­¥ï¼šå°†è¿™äº›ç½‘ç»œèµ„æºæ‰“åŒ…æˆelectronå®‰è£…ç¨‹åº" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šå°†è¿™äº›ç½‘ç»œèµ„æºæ‰“åŒ…æˆelectronå®‰è£…ç¨‹åº"></a>ç¬¬äºŒæ­¥ï¼šå°†è¿™äº›ç½‘ç»œèµ„æºæ‰“åŒ…æˆelectronå®‰è£…ç¨‹åº</h2><p>æœ‰äº†ä¸Šé¢çš„å…¥å£æ–‡ä»¶ï¼Œcsså’Œimageï¼Œä»¥åŠå”¯ä¸€çš„ä¸€ä¸ªjsæ–‡ä»¶ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¿™äº›æ–‡ä»¶å’Œelectronçš„é…ç½®æ–‡ä»¶æ”¾åœ¨ä¸€èµ·ä¾¿å¯ä»¥äº†è¿›è¡Œä¸‹ä¸€æ­¥äº†ã€‚</p><h4 id="1-æ„å»ºelectronçš„æ‰“åŒ…ç›®å½•"><a href="#1-æ„å»ºelectronçš„æ‰“åŒ…ç›®å½•" class="headerlink" title="1. æ„å»ºelectronçš„æ‰“åŒ…ç›®å½•"></a>1. æ„å»ºelectronçš„æ‰“åŒ…ç›®å½•</h4><p>æˆ‘åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºäº†ä¸ª<code>electron</code>æ–‡ä»¶å¤¹ï¼Œä¼šå°†èµ„æºæ–‡ä»¶copyåˆ°è¿™ä¸ªä½ç½®ä¸‹ã€‚æ‰€ä»¥æ•´ä¸ªé¡¹ç›®ç»“æ„å¤§æ¦‚å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">â”œâ”€â”€ project    â”‚   â”œâ”€â”€ resource    â”‚   â”‚     â””â”€â”€public    â”‚   â”‚            â””â”€â”€ img    â”‚   â”‚                    â”œâ”€â”€ logo.png    â”‚   â”‚                    â”œâ”€â”€ user-header.png    â”‚   â”‚            â””â”€â”€ css    â”‚   â”‚            â””â”€â”€ js    â”‚   â”‚            â””â”€â”€ index.html    â”‚   â”œâ”€â”€ src    â”‚   â”œâ”€â”€ electron    â”‚   â”‚      â””â”€â”€public    â”‚   â”‚            â””â”€â”€ img    â”‚   â”‚                    â”œâ”€â”€ logo.png    â”‚   â”‚                    â”œâ”€â”€ user-header.png    â”‚   â”‚            â””â”€â”€ css    â”‚   â”‚            â””â”€â”€ js    â”‚   â”‚            â””â”€â”€ index.html    â”‚   â”‚      â””â”€â”€package.json    â”‚   â”‚      â””â”€â”€main.js<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­electronä¸‹çš„publicæ–‡ä»¶å¤¹å†…å®¹ç»“æ„å°±è·Ÿå¾€nginxéƒ¨ç½²æ—¶æ˜¯ä¸€æ ·çš„ï¼Œ<code>main.js</code>å’Œ<code>package.json</code>æ˜¯ä¸ºelectronæ‰‹åŠ¨åŠ å…¥çš„ã€‚main.jsæ˜¯winçš„é»˜è®¤è¡Œä¸ºçš„æŒ‡å®šæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// Modules to control application life and create native browser window</span><span class="token keyword">const</span> <span class="token punctuation">{</span>app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'electron'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// Keep a global reference of the window object, if you don't, the window will</span><span class="token comment" spellcheck="true">// be closed automatically when the JavaScript object is garbage collected.</span><span class="token keyword">let</span> mainWindow<span class="token keyword">const</span> mainWindowURL <span class="token operator">=</span> <span class="token string">'http://localhost:10386/doc.html'</span><span class="token punctuation">;</span><span class="token keyword">function</span> createWindow <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// Create the browser window.</span>  mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//fullscreen: true,</span>    webPreferences<span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// and load the index.html of the app.</span>  <span class="token comment" spellcheck="true">//   mainWindow.loadFile('index.html')</span>  mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span>mainWindowURL<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// Emitted when the window is closed.</span>  mainWindow<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'closed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// Dereference the window object, usually you would store windows</span>    <span class="token comment" spellcheck="true">// in an array if your app supports multi windows, this is the time</span>    <span class="token comment" spellcheck="true">// when you should delete the corresponding element.</span>    mainWindow <span class="token operator">=</span> <span class="token keyword">null</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">bootstrapServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'serve-handler'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// You pass two more arguments for config and middleware</span>    <span class="token comment" spellcheck="true">// More details here: https://github.com/zeit/serve-handler#options</span>    <span class="token keyword">return</span> <span class="token function">handler</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> <span class="token punctuation">{</span>      <span class="token keyword">public</span><span class="token punctuation">:</span> <span class="token string">'resources/app.asar/public'</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>  server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">10386</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> bootstrapServer<span class="token punctuation">)</span><span class="token comment" spellcheck="true">// Quit when all windows are closed.</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'window-all-closed'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// On OS X it is common for applications and their menu bar</span>  <span class="token comment" spellcheck="true">// to stay active until the user quits explicitly with Cmd + Q</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>platform <span class="token operator">!==</span> <span class="token string">'darwin'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// On OS X it's common to re-create a window in the app when the</span>  <span class="token comment" spellcheck="true">// dock icon is clicked and there are no other windows open.</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>mainWindow <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// In this file you can include the rest of your app's specific main process</span><span class="token comment" spellcheck="true">// code. You can also put them in separate files and require them here.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>package.jsonçš„å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"eallergy"</span><span class="token punctuation">,</span>  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>  <span class="token string">"license"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>  <span class="token string">"main"</span><span class="token punctuation">:</span> <span class="token string">"main.js"</span><span class="token punctuation">,</span>  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token string">"start"</span><span class="token punctuation">:</span> <span class="token string">"electron ."</span><span class="token punctuation">,</span>    <span class="token string">"dist"</span><span class="token punctuation">:</span> <span class="token string">"electron-builder -c.extraMetadata.main=main.js"</span><span class="token punctuation">,</span>    <span class="token string">"dist-32"</span><span class="token punctuation">:</span> <span class="token string">"electron-builder -c.extraMetadata.main=main.js --ia32"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token string">"build"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token string">"productName"</span><span class="token punctuation">:</span> <span class="token string">"eallergy"</span><span class="token punctuation">,</span>    <span class="token string">"appId"</span><span class="token punctuation">:</span> <span class="token string">"alk.doctor"</span><span class="token punctuation">,</span>    <span class="token string">"copyright"</span><span class="token punctuation">:</span><span class="token string">"çº¢åˆ›ç§‘æŠ€"</span><span class="token punctuation">,</span>    <span class="token string">"directories"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>      <span class="token string">"buildResources"</span><span class="token punctuation">:</span> <span class="token string">"public"</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token string">"files"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>      <span class="token string">"main.js"</span><span class="token punctuation">,</span>      <span class="token string">"public/**/*"</span><span class="token punctuation">,</span>      <span class="token string">"node_modules/**/*"</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">"mac"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>      <span class="token string">"category"</span><span class="token punctuation">:</span> <span class="token string">"your.app.category.type"</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token string">"devDependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token string">"electron"</span><span class="token punctuation">:</span> <span class="token string">"^5.0.7"</span><span class="token punctuation">,</span>    <span class="token string">"electron-builder"</span><span class="token punctuation">:</span> <span class="token string">"^21.0.15"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token string">"dependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token string">"serve-handler"</span><span class="token punctuation">:</span> <span class="token string">"^6.1.0"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†èµ„æºæ–‡ä»¶copyåˆ°<code>electron/public/</code>ä½ç½®åæ‰§è¡Œ<code>yarn</code>å’Œ<code>yarn dist</code>å‘½ä»¤ï¼ˆæ‰§è¡Œå‡ºé”™çš„è¯·çœ‹ä¸‹é¢çš„è§£å†³æ–¹æ¡ˆï¼‰ã€‚</p><h4 id="2-æ‰“åŒ…"><a href="#2-æ‰“åŒ…" class="headerlink" title="2. æ‰“åŒ…"></a>2. æ‰“åŒ…</h4><p>æ‰§è¡Œæ‰“åŒ…ä¹‹å‰è¿˜æœ‰ç‚¹ç¯å¢ƒå‡†å¤‡å·¥ä½œ</p><blockquote><p>å®‰è£…node<br>å®‰è£…yarn<br>å®‰è£…electron<br>å®‰è£…electron-builder</p></blockquote><p>ç„¶åå¯ä»¥åœ¨electronç›®å½•ä¸‹è½½æ‰§è¡Œæ‰“åŒ…æ“ä½œ</p><pre class="line-numbers language-shell"><code class="language-shell"># yarnyarn install v1.21.1warning package.json: License should be a valid SPDX license expressionwarning eallergy@1.0.0: License should be a valid SPDX license expression[1/4] Resolving packages...[2/4] Fetching packages...[3/4] Linking dependencies...[4/4] Building fresh packages...Done in 13.47s.$$$$ yarn distyarn run v1.21.1warning package.json: License should be a valid SPDX license expression$ electron-builder -c.extraMetadata.main=main.js  â€¢ electron-builder  version=21.0.15 os=10.0.18363  â€¢ loaded configuration  file=package.json ("build" field)  â€¢ description is missed in the package.json  appPackageFile=Z:\git\redcreation\alk-wxapi\alk-web\electron\package.json  â€¢ author is missed in the package.json  appPackageFile=Z:\git\redcreation\alk-wxapi\alk-web\electron\package.json  â€¢ packaging       platform=win32 arch=x64 electron=5.0.7 appOutDir=dist\win-unpacked  â€¢ default Electron icon is used  reason=application icon is not set  â€¢ building        target=nsis file=dist\eallergy Setup 1.0.0.exe archs=x64 oneClick=true perMachine=false  â€¢ building block map  blockMapFile=dist\eallergy Setup 1.0.0.exe.blockmapDone in 45.81s.$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-æ‰“åŒ…æ–‡ä»¶"><a href="#3-æ‰“åŒ…æ–‡ä»¶" class="headerlink" title="3. æ‰“åŒ…æ–‡ä»¶"></a>3. æ‰“åŒ…æ–‡ä»¶</h4><p><img src="/loading.gif" data-original="/images/fontend/electron-package.png" alt="electronæ‰“åŒ…æ–‡ä»¶"></p><h2 id="electronå’Œelectron-builderç›¸å…³æ–‡ä»¶å®‰è£…å¤±è´¥è§£å†³æ–¹æ¡ˆ"><a href="#electronå’Œelectron-builderç›¸å…³æ–‡ä»¶å®‰è£…å¤±è´¥è§£å†³æ–¹æ¡ˆ" class="headerlink" title="electronå’Œelectron-builderç›¸å…³æ–‡ä»¶å®‰è£…å¤±è´¥è§£å†³æ–¹æ¡ˆ"></a>electronå’Œelectron-builderç›¸å…³æ–‡ä»¶å®‰è£…å¤±è´¥è§£å†³æ–¹æ¡ˆ</h2><p>é”™è¯¯ç‰ˆæœ¬ä¸å°½ç›¸åŒï¼Œä½†æ˜¯å¤§æ¦‚å¦‚ä¸‹å§</p><pre class="line-numbers language-shell"><code class="language-shell">$ yarn distyarn run v1.21.1warning package.json: License should be a valid SPDX license expression$ electron-builder -c.extraMetadata.main=main.js  â€¢ electron-builder  version=21.0.15 os=10.0.18363  â€¢ loaded configuration  file=package.json ("build" field)  â€¢ description is missed in the package.json  appPackageFile=Z:\git\redcreation\alk-wxapi\alk-web\electron\package.json  â€¢ author is missed in the package.json  appPackageFile=Z:\git\redcreation\alk-wxapi\alk-web\electron\package.json  â€¢ packaging       platform=win32 arch=x64 electron=5.0.7 appOutDir=dist\win-unpacked  â€¢ default Electron icon is used  reason=application icon is not set  â€¢ building        target=nsis file=dist\eallergy Setup 1.0.0.exe archs=x64 oneClick=true perMachine=false  â€¢ downloading     url=https://github.com/electron-userland/electron-builder-binaries/releases/download/nsis-3.0.3.2/nsis-3.0.3.2.7z size=1.4 MB parts=1  â€¢ retrying        attempt=1  â€¢ retrying        attempt=2  â€¢ retrying        attempt=3  â¨¯ part download request failed with status code 403github.com/develar/app-builder/pkg/download.(*Part).doRequest        /Volumes/data/Documents/app-builder/pkg/download/Part.go:126github.com/develar/app-builder/pkg/download.(*Part).download        /Volumes/data/Documents/app-builder/pkg/download/Part.go:67github.com/develar/app-builder/pkg/download.(*Downloader).DownloadResolved.func1.1        /Volumes/data/Documents/app-builder/pkg/download/downloader.go:107github.com/develar/app-builder/pkg/util.MapAsyncConcurrency.func2        /Volumes/data/Documents/app-builder/pkg/util/async.go:68runtime.goexit        /usr/local/Cellar/go/1.12.7/libexec/src/runtime/asm_amd64.s:1337  â¨¯ Z:\git\redcreation\alk-wxapi\alk-web\electron\node_modules\app-builder-lib\node_modules\app-builder-bin\win\x64\app-builder.exe exited with code ERR_ELECTRON_BUILDER_CANNOT_EXECUTE  stackTrace=          Error: Z:\git\redcreation\alk-wxapi\alk-web\electron\node_modules\app-builder-lib\node_modules\app-builder-bin\win\x64\app-builder.exe exited with code ERR_ELECTRON_BUILDER_CANNOT_EXECUTEat ChildProcess.childProcess.once.code (Z:\git\redcreation\alk-wxapi\alk-web\electron\node_modules\app-builder-lib\node_modules\builder-util\src\util.ts:239:14)                   at Object.onceWrapper (events.js:273:13)                                                                                                                                                                    at ChildProcess.emit (events.js:182:13)                                                                                                                                        at maybeClose (internal/child_process.js:962:16)                                                                                                                                        at Process.ChildProcess._handle.onexit (internal/child_process.js:251:5)                                                                                                                                    From previous event:                                                                                                                                        at processImmediate (timers.js:632:19)                                                                                                                                    From previous event:                                                                                                                                        at NsisTarget.buildInstaller (Z:\git\redcreation\alk-wxapi\alk-web\electron\node_modules\app-builder-lib\src\targets\nsis\NsisTarget.ts:202:29)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®‰è£…electronä¾èµ–æ—¶è¢«å¢™åŸºæœ¬ä¸Šèº²ä¸è¿‡å»çš„ï¼Œè¿æ°”ä¸å¥½çš„æ—¶å€™å°±æ˜¯ä¸€å®šèº²ä¸è¿‡å»ï¼Œè¿™æ—¶å€™æœ‰ä¸‰ç§æ–¹æ¡ˆ</p><ul><li>è®¾ç½®electronçš„é•œåƒä¸ºæ·˜å®é•œåƒ,ç„¶åç»§ç»­æ‰§è¡Œï¼ˆ<strong>æ¨èæ­¤æ–¹æ¡ˆ</strong>ï¼‰</li></ul><pre class="line-numbers language-shell"><code class="language-shell">set ELECTRON_MIRROR=http://npm.taobao.org/mirrors/electron/set SELENIUM_CDNURL=http://npm.taobao.org/mirrorss/seleniumset CHROMEDRIVER_CDNURL=https://npm.taobao.org/mirrors/chromedriverset SASS_BINARY_SITE=https://npm.taobao.org/mirrors/node-sass/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>ä½¿ç”¨è¿…é›·æˆ–è€…æµè§ˆå™¨æ‰‹åŠ¨ä¸‹è½½downloadå¤±è´¥çš„æ–‡ä»¶<br>ä¸‹è½½å®Œåæ‹–åˆ°<code>C:\Users\mahaiqiang\AppData\Local\electron-builder\Cache\</code>è¿™ä¸ªç›®å½•ï¼Œè§£å‹å¥½ï¼Œé‡æ–°distï¼Œä¼šä¼˜å…ˆä½¿ç”¨ç¼“å­˜ä¸­çš„æ–‡ä»¶ã€‚æ³¨æ„ç‰ˆæœ¬ä¸€è‡´ã€‚<br>æ‰”ä¸Šå»å¯èƒ½æ˜¯è¿™æ ·ï¼š<br><img src="/loading.gif" data-original="/images/fontend/electron-cache.png" alt="æ‰‹åŠ¨ä¸‹è½½cache"></p></li><li><p>åœ¨å‡ºé”™çš„å‘½ä»¤ä¸Šæ‰‹åŠ¨æŒ‡å®šé•œåƒ<br>æ‰§è¡Œç±»ä¼¼ä¸‹é¢çš„å‘½ä»¤ï¼Œåœ¨çœŸæ­£çš„å‘½ä»¤å‰åŠ å‚æ•°</p></li></ul><pre class="line-numbers language-shell"><code class="language-shell">ELECTRON_MIRROR=https://npm.taobao.org/mirrors/electron/ yarn install<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¨èæ–¹æ¡ˆä¸€ã€‚</p><h2 id="ç¬¬ä¸‰æ­¥ï¼šé…ç½®æ›´æ–°â€”-è¿™ä¸€æ­¥æ²¡æœ‰æˆåŠŸå°±æ¢æ–¹æ¡ˆäº†ï¼Œä¸å€¼å¾—çœ‹"><a href="#ç¬¬ä¸‰æ­¥ï¼šé…ç½®æ›´æ–°â€”-è¿™ä¸€æ­¥æ²¡æœ‰æˆåŠŸå°±æ¢æ–¹æ¡ˆäº†ï¼Œä¸å€¼å¾—çœ‹" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šé…ç½®æ›´æ–°â€”-è¿™ä¸€æ­¥æ²¡æœ‰æˆåŠŸå°±æ¢æ–¹æ¡ˆäº†ï¼Œä¸å€¼å¾—çœ‹"></a>ç¬¬ä¸‰æ­¥ï¼šé…ç½®æ›´æ–°â€”-è¿™ä¸€æ­¥æ²¡æœ‰æˆåŠŸå°±æ¢æ–¹æ¡ˆäº†ï¼Œä¸å€¼å¾—çœ‹</h2><pre class="line-numbers language-shell"><code class="language-shell">$ npm install electron-updater --savenpm WARN rm not removing /Users/mahaiqiang/git/redcreation/alk-wxapi/alk-web/electron/node_modules/.bin/semver as it wasn't installed by /Users/mahaiqiang/git/redcreation/alk-wxapi/alk-web/electron/node_modules/semver> ejs@2.7.4 postinstall /Users/mahaiqiang/git/redcreation/alk-wxapi/alk-web/electron/node_modules/ejs> node ./postinstall.jsThank you for installing EJS: built with the Jake JavaScript build tool (https://jakejs.com/)npm notice created a lockfile as package-lock.json. You should commit this file.npm WARN eallergy@1.0.0 No repository field.npm WARN eallergy@1.0.0 No license field.+ electron-updater@4.2.0added 20 packages from 19 contributors, removed 10 packages, updated 289 packages and audited 909 packages in 304.234sfound 0 vulnerabilities<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸ºäº†é…åˆæ‰“åŒ… package.json éœ€è¦ç»™ build æ–°å¢é…ç½®é¡¹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token string">"build"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token string">"publish"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">{</span>          <span class="token string">"provider"</span><span class="token punctuation">:</span> <span class="token string">"generic"</span><span class="token punctuation">,</span>          <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"http://127.0.0.1:5500/"</span> #è¿™é‡Œæ˜¯æˆ‘æœ¬åœ°å¼€çš„æœåŠ¡å™¨çš„åœ°å€        <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token operator">...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‚è€ƒæ–‡æ¡£ï¼š"><a href="#å‚è€ƒæ–‡æ¡£ï¼š" class="headerlink" title="å‚è€ƒæ–‡æ¡£ï¼š"></a>å‚è€ƒæ–‡æ¡£ï¼š</h2><p> <a href="https://www.cnblogs.com/buzhiqianduan/p/7620099.html">electronå…¥é—¨å¿ƒå¾—</a><br><a href="https://lzw.me/a/build-electron-desktop-app-installer.html">ä½¿ç”¨ electron-builder ä¸ electron-packager çš„ JSAPI æ„å»º electron æ¡Œé¢åº”ç”¨å®‰è£…ç¨‹åº</a></p>]]></content>
      
      
      <categories>
          
          <category> electron </category>
          
      </categories>
      
      
        <tags>
            
            <tag> electron </tag>
            
            <tag> clojurescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>emacsé‡Œç”¨agå…¨å±€æ£€ç´¢æ˜¯æ’é™¤æŸäº›ç›®å½•</title>
      <link href="2019/12/22/emacs-li-yong-ag-quan-ju-jian-suo-shi-pai-chu-mou-xie-mu-lu/"/>
      <url>2019/12/22/emacs-li-yong-ag-quan-ju-jian-suo-shi-pai-chu-mou-xie-mu-lu/</url>
      
        <content type="html"><![CDATA[<p>é¡¹ç›®æ ¹ç›®å½•åˆ›å»º<code>.projectile</code>æ–‡ä»¶ï¼Œç»´æŠ¤agæœç´¢è¦æ’é™¤çš„ç›®å½•ï¼Œå¦‚åŒ<code>.gitignore</code>ä¸€æ ·ã€‚</p><p><a href="https://www.jianshu.com/p/a2461ab7cdd0">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å¦‚æœä¸åšä¸‹é¢çš„é…ç½®ï¼Œåœ¨emacsé‡Œæ‰§è¡Œå…¨å±€æœç´¢<c-c p="" s="">æ—¶ä¼šæœç´¢æ‰€æœ‰ç›®å½•ï¼Œæ¯”å¦‚node_mudulesï¼Œtargetç­‰ç›®å½•ã€‚</c-c></p><p>å› ä¸ºæˆ‘ä»¬æ˜¯shadow-cljså’ŒleinåŠŸèƒ½ï¼Œæ˜¯ä»luminuså“­åˆ›å»ºçš„ï¼Œæ‰€ä»¥æœ‰è¿™ä¸ªé—®é¢˜</p><p>éœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸ªæ–‡ä»¶<code>.projectile</code> ,</p><p>å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">-/log-/tmp-/node_modules-/target%<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å†™æ³•ä¸<code>.gitignore</code>å¦‚å‡ºä¸€è¾™ã€‚</p><p>è¿™æ ·é…ç½®åï¼Œå†ä½¿ç”¨agæœç´¢ï¼Œä¾¿ä¸ä¼šå†å»è¿™äº›ç›®å½•ä¸‹æœç´¢ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> emacs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> emacs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoä¹‹é«˜çº§ç¾åŒ–ç¯‡</title>
      <link href="2019/11/15/hexo-zhi-gao-ji-mei-hua-pian/"/>
      <url>2019/11/15/hexo-zhi-gao-ji-mei-hua-pian/</url>
      
        <content type="html"><![CDATA[<p>å¢åŠ ä¸€äº›å…¶ä»–åŠŸèƒ½</p><p><a href="https://www.jianshu.com/p/728a9594bb6c">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å‚è€ƒåŸæ–‡åœ°å€ï¼š<a href="https://blog.dfface.com/2019/60aa2e39.html">hexoå»ºç«™è®°</a></p><h2 id="ä¸»åŠ¨æ¨é€åˆ°ç™¾åº¦"><a href="#ä¸»åŠ¨æ¨é€åˆ°ç™¾åº¦" class="headerlink" title="ä¸»åŠ¨æ¨é€åˆ°ç™¾åº¦"></a>ä¸»åŠ¨æ¨é€åˆ°ç™¾åº¦</h2><p>å‚è€ƒ<a href="https://hui-wang.info/2016/10/23/Hexo%E6%8F%92%E4%BB%B6%E4%B9%8B%E7%99%BE%E5%BA%A6%E4%B8%BB%E5%8A%A8%E6%8F%90%E4%BA%A4%E9%93%BE%E6%8E%A5/">Hexoæ’ä»¶ä¹‹ç™¾åº¦ä¸»åŠ¨æäº¤é“¾æ¥</a><br>å®‰è£…hexo-baidu-url-submitæ’ä»¶ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">npm install hexo-baidu-url-submit --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¯¥æ’ä»¶åœ¨githubä¸Šï¼š<a href="https://github.com/huiwang/hexo-baidu-url-submit">hexo-baidu-url-submit</a></p><p>åœ¨æ ¹ç›®å½•çš„é…ç½®æ–‡ä»¶ä¸­å¢åŠ baidu_url_submitå­—æ®µï¼Œæ›´æ”¹deployå­—æ®µ</p><pre class="line-numbers language-conf"><code class="language-conf">baidu_url_submit:  count: 1000 ## æäº¤æœ€æ–°çš„ä¸€ä¸ªé“¾æ¥  host: alili.tech ## åœ¨ç™¾åº¦ç«™é•¿å¹³å°ä¸­æ³¨å†Œçš„åŸŸå  token: xxxxx ## è¯·æ³¨æ„è¿™æ˜¯æ‚¨çš„ç§˜é’¥ï¼Œ æ‰€ä»¥è¯·ä¸è¦æŠŠåšå®¢æºä»£ç å‘å¸ƒåœ¨å…¬ä¼—ä»“åº“é‡Œ!  path: baidu_urls.txt ## æ–‡æœ¬æ–‡æ¡£çš„åœ°å€ï¼Œ æ–°é“¾æ¥ä¼šä¿å­˜åœ¨æ­¤æ–‡æœ¬æ–‡æ¡£é‡Œ  xz_appid: 'xxxxxx' ## ä½ çš„ç†ŠæŒå· appid  xz_token: 'xxxxxx' ## ä½ çš„ç†ŠæŒå· token  xz_count: 10 ## ä»æ‰€æœ‰çš„æäº¤çš„æ•°æ®å½“ä¸­é€‰å–æœ€æ–°çš„10æ¡,è¯¥æ•°é‡è·Ÿä½ çš„ç†ŠæŒå·è€Œå®šdeploy:- type: git    repo: https://github.com/dfface/dfface.github.io.git    branch: master- type: baidu_url_submitter # ç™¾åº¦- type: baidu_xz_url_submitter # ç™¾åº¦ç†ŠæŒå·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç†ŠæŒå·çš„idå’Œtokenï¼Œè¯·çœ‹å›¾ï¼š<br><img src="/loading.gif" data-original="/images/tools/hexo-baidu.png" alt="hexo-baidu.png"></p><p>ç„¶ååœ¨ä¸»é¢˜ä¸­å¼€å¯:</p><pre class="line-numbers language-conf"><code class="language-conf"># Enable baidu push so that the blog will push the url to baidu automatically which is very helpful for SEObaidu_push: true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="è‡ªåŠ¨æ¢èƒŒæ™¯"><a href="#è‡ªåŠ¨æ¢èƒŒæ™¯" class="headerlink" title="è‡ªåŠ¨æ¢èƒŒæ™¯"></a>è‡ªåŠ¨æ¢èƒŒæ™¯</h2><p>å‚è€ƒï¼š<a href="https://theme-next.org/docs/advanced-settings">injects</a><br>é¦–å…ˆå†™å…¥ï¼šsource/_data/auto-bg.styl:</p><pre class="line-numbers language-conf"><code class="language-conf">// èƒŒæ™¯æ›´æ¢è®¾ç½®ï¼ŒåŸæ¥ï¼šbackground:url(https://source.unsplash.com/random/1600x900);body {    background:url("https://img.xjh.me/random_img.php?type=bg&ctype=nature&return=302");    background-repeat: no-repeat;    -webkit-background-size:100%;    background-size:cover;    -webkit-background-size: cover !important;     -moz-background-size: cover !important;     -o-background-size: cover;     background-attachment:fixed, scroll;    padding-top: 0px;}.main-inner {     margin-top: 2rem;    padding: 2rem;    background: #fff;    opacity: 0.7;    min-height: 500px;    transition: opacity 1s;}header,footer {    opacity: 0.7;    transition: opacity 1s;}.main-inner:hover {    opacity:1.0;}header:hover {    opacity:1.0;}footer:hover {    opacity:1.0;}body {  -moz-user-select:none; /* Firefoxç§æœ‰å±æ€§ */  -webkit-user-select:none; /* WebKitå†…æ ¸ç§æœ‰å±æ€§ */  -ms-user-select:none; /* IEç§æœ‰å±æ€§(IE10åŠä»¥å) */  -khtml-user-select:none; /* KHTMLå†…æ ¸ç§æœ‰å±æ€§ */  -o-user-select:none; /* Operaç§æœ‰å±æ€§ */  user-select:none; /* CSS3å±æ€§ */}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶ååœ¨_config.ymlä¸­æ³¨é‡Šï¼š</p><pre class="line-numbers language-conf"><code class="language-conf">custom_file_path:  #head: source/_data/head.swig  #header: source/_data/header.swig  #sidebar: source/_data/sidebar.swig  #postMeta: source/_data/post-meta.swig  #postBodyEnd: source/_data/post-body-end.swig  #footer: source/_data/footer.swig  #bodyEnd: source/_data/body-end.swig  #variable: source/_data/variables.styl  #mixin: source/_data/mixins.styl  style: source/_data/auto-bg.styl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è½¬--Gource:è®©gitå¼€å‡ºèŠ±æ¥</title>
      <link href="2019/11/13/gource-rang-git-kai-chu-hua-lai/"/>
      <url>2019/11/13/gource-rang-git-kai-chu-hua-lai/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/acaudwell/Gource">gource</a> æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®, å¤„ç†å„ç§ä»£ç ç®¡ç†å·¥å…·(git,svn,hg,bzr,cvs2cl)çš„å†å², ç”¨åŠ¨ç”»å±•ç¤ºä»£ç ç»“æ„å’Œä½œè€…çš„çŠ¶æ€ã€‚</p><p><a href="https://www.jianshu.com/p/6d120dbd45e4">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="gourceä»‹ç»"><a href="#gourceä»‹ç»" class="headerlink" title="gourceä»‹ç»"></a>gourceä»‹ç»</h2><p>gitçš„å†å²æ˜¯ä¸€éƒ¨ç”µå½±, gourceçš„èƒ½è®©å®ƒæ´»èµ·æ¥, ffmpegeå¯ä»¥æŠŠè¿™æ®µè§†é¢‘ä¿å­˜ä¸‹æ¥ã€‚</p><p><img src="/loading.gif" data-original="/images/tools/gource/gource.jpg" alt="gource"></p><p><a href="https://github.com/acaudwell/Gource">gource</a> æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®, å¤„ç†å„ç§ä»£ç ç®¡ç†å·¥å…·(git,svn,hg,bzr,cvs2cl)çš„å†å², ç”¨åŠ¨ç”»å±•ç¤ºä»£ç ç»“æ„å’Œä½œè€…çš„çŠ¶æ€ã€‚</p><p>ä¸‹é¢è¿™æ®µgifå±•ç¤ºäº†è¿‡æ•å¹³å°é¡¹ç›®å¼€å§‹çš„æ—¶å€™ä»4æœˆ25åˆ°4æœˆ30ä¹‹é—´MarvinåŒå­¦å¿™ç¢Œäºä»£ç åº“å„å¤„çš„æƒ…å½¢ã€‚ä¸­é—´çš„é‚£ä¸ªå°çº¢äººæ˜¯MarvinğŸ˜‚</p><p><img src="/loading.gif" data-original="/images/tools/gource/movie.gif" alt="gource"></p><p><strong>å¾ˆå¸…å§ï¼</strong></p><p><code>gource --title "ALK-project" --date-format "%y-%m-%d:%R"  alk-wxapi</code> å®‰è£…å¥½å·¥å…·ä»¥åï¼Œä½ å¯ä»¥æ‰§è¡Œä¸‹é¢è¿™ä¸ªå‘½ä»¤æ¥çœ‹åˆ°ä¸€æ ·çš„ç»“æœã€‚</p><h2 id="gourceä½¿ç”¨"><a href="#gourceä½¿ç”¨" class="headerlink" title="gourceä½¿ç”¨"></a>gourceä½¿ç”¨</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å®‰è£…gource</span>brew <span class="token function">install</span> gource<span class="token comment" spellcheck="true"># å®‰è£…ffmpeg</span>brew <span class="token function">install</span> ffmpeg<span class="token comment" spellcheck="true"># æ‰§è¡Œ</span>gource project.git<span class="token comment" spellcheck="true"># ç”Ÿæˆmp4ç”µå½±</span>gource --title <span class="token string">"ALK project"</span> --date-format <span class="token string">"%D"</span> -1280x720 alk-wxapi -o - <span class="token operator">|</span> ffmpeg -y -r 60 -f image2pipe -vcodec ppm -i - -vcodec libx264 -preset ultrafast -pix_fmt yuv420p -crf 1 -threads 0 -bf 0 gource.mp4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‡ªå·±è¯•è¯•å§ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è½¬--macä¸Šshellç»ˆç«¯ç¼–è¾‘å‘½ä»¤è¡Œå¿«æ·é”®</title>
      <link href="2019/11/11/zhuan-cong-eclipse-zhuan-yi-dao-intellij-idea-yi-dian-xin-de-copy/"/>
      <url>2019/11/11/zhuan-cong-eclipse-zhuan-yi-dao-intellij-idea-yi-dian-xin-de-copy/</url>
      
        <content type="html"><![CDATA[<p>macOS ä¸Šshellç»ˆç«¯ç¼–è¾‘å‘½ä»¤è¡Œå¿«æ·é”®</p><p><a href="https://www.jianshu.com/p/9b288d8bf849">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p><a href="https://www.cnblogs.com/cina33blogs/p/8608473.html">mac shellç»ˆç«¯ç¼–è¾‘å‘½ä»¤è¡Œå¿«æ·é”®â€”â€”è¡Œé¦–ï¼Œè¡Œå°¾</a></p><p>Ctrl + d        åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œç›¸å½“äºé€šå¸¸çš„Deleteé”®ï¼ˆå‘½ä»¤è¡Œè‹¥æ— æ‰€æœ‰å­—ç¬¦ï¼Œåˆ™ç›¸å½“äºexitï¼›å¤„ç†å¤šè¡Œæ ‡å‡†è¾“å…¥æ—¶ä¹Ÿè¡¨ç¤ºeofï¼‰</p><p>Ctrl + h        é€€æ ¼åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œç›¸å½“äºé€šå¸¸çš„Backspaceé”®</p><p>Ctrl + u        åˆ é™¤å…‰æ ‡ä¹‹å‰åˆ°è¡Œé¦–çš„å­—ç¬¦<br>Ctrl + k        åˆ é™¤å…‰æ ‡ä¹‹å‰åˆ°è¡Œå°¾çš„å­—ç¬¦</p><p>Ctrl + c        å–æ¶ˆå½“å‰è¡Œè¾“å…¥çš„å‘½ä»¤ï¼Œç›¸å½“äºCtrl + Break</p><p>Ctrl + a        å…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦–ï¼ˆAhead of lineï¼‰ï¼Œç›¸å½“äºé€šå¸¸çš„Homeé”®<br>Ctrl + e        å…‰æ ‡ç§»åŠ¨åˆ°è¡Œå°¾ï¼ˆEnd of lineï¼‰<br>Ctrl + f        å…‰æ ‡å‘å‰(Forward)ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦ä½ç½®<br>Ctrl + b        å…‰æ ‡å¾€å›(Backward)ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦ä½ç½®</p><p>Ctrl + l        æ¸…å±ï¼Œç›¸å½“äºæ‰§è¡Œclearå‘½ä»¤<br>Ctrl + p        è°ƒå‡ºå‘½ä»¤å†å²ä¸­çš„å‰ä¸€æ¡ï¼ˆPreviousï¼‰å‘½ä»¤ï¼Œç›¸å½“äºé€šå¸¸çš„ä¸Šç®­å¤´<br>Ctrl + n        è°ƒå‡ºå‘½ä»¤å†å²ä¸­çš„ä¸‹ä¸€æ¡ï¼ˆNextï¼‰å‘½ä»¤ï¼Œç›¸å½“äºé€šå¸¸çš„ä¸Šç®­å¤´<br>Ctrl + r        æ˜¾ç¤ºï¼šå·æç¤ºï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥æŸ¥æ‰¾ç›¸å…³å†å²å‘½ä»¤ï¼ˆreverse-i-searchï¼‰<br>Ctrl + w        åˆ é™¤ä»å…‰æ ‡ä½ç½®å‰åˆ°å½“å‰æ‰€å¤„å•è¯ï¼ˆWordï¼‰çš„å¼€å¤´<br>Ctrl + y        ç²˜è´´æœ€åä¸€æ¬¡è¢«åˆ é™¤çš„å•è¯<br>å…¶ä»–Command-LineæŠ€å·§æç¤º<br>â€¢è¾“å…¥å‘½ä»¤open .å¯ä»¥ç”¨Finderæ‰“å¼€å½“å‰çš„ä½ç½®ã€‚</p><p>â€¢åœ¨Terminalçš„åå¥½é‡Œé¢å¯ä»¥è®¾å®šå®ƒçš„å¤–è§‚å’Œé£æ ¼ã€‚</p><p>â€¢ä¸­æ­¢ä¸€ä¸ªé”™è¯¯çš„æˆ–è€…å‘ç–¯çš„å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ç»„åˆé”®control + Cã€‚</p><p>â€¢ä½ å¯ä»¥åœ¨æ‰§è¡Œå‰ç¼–è¾‘å‘½ä»¤ï¼Œåªéœ€è¦ä½¿ç”¨ç®­å¤´å’Œé”®ç›˜ä¸Šçš„å…¶ä»–å­—æ¯ã€‚</p><p>â€¢æ²¡æœ‰è¾“å…¥ä»»ä½•å‘½ä»¤æ—¶ï¼Œä½ å¯ä»¥ç”¨â–²å’Œâ–¼æ¥æµè§ˆå†å²å‘½ä»¤ã€‚åŒæ ·å¯ä»¥ç¼–è¾‘å’Œå†æ¬¡æ‰§è¡Œã€‚</p><p>â€¢ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨historyå‘½ä»¤æŸ¥çœ‹å†å²è®°å½•ã€‚</p><p>Command + K    æ¸…å±</p><p>Command + T     æ–°å»ºæ ‡ç­¾</p><p>Command +W     å…³é—­å½“å‰æ ‡ç­¾é¡µ</p><p>Command + S     ä¿å­˜ç»ˆç«¯è¾“å‡º</p><p>Command + D     å‚ç›´åˆ†éš”å½“å‰æ ‡ç­¾é¡µ</p><p>Command + Shift + D       æ°´å¹³åˆ†éš”å½“å‰æ ‡ç­¾é¡µ</p><p>Command + shift +  {æˆ–}   å‘å·¦/å‘å³åˆ‡æ¢æ ‡ç­¾</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mac </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojure&amp;clojurescriptå‰åç«¯å®ç°websocketåè®®é€šä¿¡</title>
      <link href="2019/11/03/clojure-clojurescript-qian-hou-duan-shi-xian-websocket-xie-yi-tong-xin/"/>
      <url>2019/11/03/clojure-clojurescript-qian-hou-duan-shi-xian-websocket-xie-yi-tong-xin/</url>
      
        <content type="html"><![CDATA[<p>åå°çš„luminusæ¨¡æ¿çš„clojureé¡¹ç›®å’Œå‰ç«¯reagent clojurescripté¡¹ç›®ï¼Œå„è‡ªæ­å»ºwebsocketé€šä¿¡</p><p><a href="https://www.jianshu.com/p/c229a6368625">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h2><p>æœåŠ¡ç«¯é…ç½®websocketç›¸å¯¹æ¥è¯´æŒºç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬é¡¹ç›®å½“åˆnewçš„æ—¶å€™æ²¡æœ‰åŠ websocketï¼Œç°åœ¨æ˜¯å‚è€ƒ<a href="http://www.luminusweb.net/docs/websockets.html">luminusweb websocket</a>å¾€é‡Œå¢åŠ å…³é”®ä»£ç </p><ol><li><strong>åˆ›å»ºws-route</strong></li></ol><p>åˆ›å»ºå¦‚ä¸‹routeï¼Œå¹¶è·Ÿæ™®é€šhttp api routeä¸€æ ·åŠ å…¥handleråºåˆ—ä¸­ã€‚</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns alk-wxapi.routes.websockets  (:require   [alk-wxapi.routes.service.ws-service :refer [ws-handler countdown]]))(defn websocket-routes []  ["/ws"   {:swagger {:tags ["websocket"]}}   [""    {:get {:summary    "websocket å…¥å£"           :parameters {}           :handler    (fn [request]                         (ws-handler request))}}]   ])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><strong>åˆ›å»ºws-service</strong><br>å³ä¸Šé¢requireçš„ws-serviceï¼Œå†…å®¹å¦‚ä¸‹ï¼š</li></ol><pre class="line-numbers language-clojure"><code class="language-clojure">(ns alk-wxapi.routes.service.ws-service  (:require   [clojure.tools.logging :as log]   [immutant.web.async :as async]   [immutant.web.sse :as sse]))(defonce channels (atom #{}))(defn broadcast-msg  "å¹¿æ’­æ¶ˆæ¯"  [data]  (log/info "å¹¿æ’­æ¶ˆæ¯ï¼š" data)  (doseq [channel @channels]    (async/send! channel (str data))))(defn notify-clients! [channel data]  (log/info (java.util.Date.) "æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„messageï¼š" data)  (async/send! channel (str {:message data                             :type "reply"})))(defn connect! [channel]  (log/info "channel open")  (swap! channels conj channel))(defn disconnect! [channel {:keys [code reason]}]  (log/info "close code:" code "reason:" reason)  (swap! channels #(remove #{channel} %)))(def websocket-callbacks  "WebSocket callback functions"  {:on-open connect!   :on-close disconnect!   :on-message notify-clients!})(defn ws-handler [request]  (async/as-channel request websocket-callbacks))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li><strong>æµ‹è¯•è¿æ¥</strong><br>è¿™æ ·å†æ¬¡å¯åŠ¨replï¼Œåœ¨å¯åŠ¨http æ¥å£çš„åŒæ—¶å°±åœ¨åŒä¸€ç«¯å£å¯åŠ¨äº†wsåè®®çš„websocketæœåŠ¡ï¼Œå¯ä»¥ç”¨<a href="https://github.com/websockets/wscat">wscatå‘½ä»¤è¡Œ</a>æµ‹è¯•å·¥å…·æˆ–è€…åœ¨<a href="http://oktools.net/websocket">åœ¨çº¿æµ‹è¯•</a>å·¥å…·è¿›è¡Œè¿æ¥æµ‹è¯•ã€‚</li></ol><pre class="line-numbers language-shell"><code class="language-shell">$ wscat -c ws://localhost:3000/api/wsConnected (press CTRL+C to quit)><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h2><p>åœ¨ä»»æ„ä¸€ä¸ªé¡µé¢æ‰¾ä¸ªå¥‘æœºå¼€å§‹åˆ›å»ºè¿æ¥ï¼Œå‚è€ƒ<a href="https://github.com/luminus-framework/examples/tree/master/multi-client-ws-immutant">multi-client-ws-immutant</a>åˆ›å»ºæ—¶æŒ‡å®šæ¶ˆæ¯å¤„ç†å›è°ƒå‡½æ•°ã€‚<br>ä»£ç å¦‚ä¸‹ï¼š</p><ol><li><strong>æ ¹ç›®å½•æˆ–è€…ä»»æ„ç›®å½•åˆ›å»ºwsè¿æ¥å·¥å…·ç±»</strong></li></ol><pre class="line-numbers language-clojure"><code class="language-clojure">(defn- receive-transit-msg!  [update-fn]  (fn [msg]    (js/clearTimeout clear-time)    (update-fn (cljs.reader/read-string (.-data msg)))))(defn- send-transit-msg!  [msg]  (if @ws-chan    (.send @ws-chan msg)    (throw (js/Error. "Websocket is not available!"))))(defn make-websocket! [url receive-handler] (println "attempting to connect websocket") (if-let [chan (js/WebSocket. url)]   (do     (set! (.-onmessage chan) (receive-transit-msg! receive-handler))     (reset! ws-chan chan)     (println "Websocket connection established with: " url))   (throw (js/Error. "Websocket connection failed!"))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><strong>åœ¨æŸä¸ªé¡µé¢è§¦å‘websocketè¿æ¥</strong></li></ol><pre class="line-numbers language-clojure"><code class="language-clojure">(require ' [alk-doc.ws :as ws :refer [webSocketUrl click-one]])(defn handler-ws-msg â€œå¯ä»¥æ ¹æ®æ¶ˆæ¯å†…å®¹æˆ–è€…è‡ªå®šä¹‰çš„ç±»å‹ï¼Œè¿›è¡Œç›¸åº”çš„ä¸šåŠ¡å¤„ç†â€ [msg] (js/console.info "æ”¶åˆ°å¹¿æ’­æ¶ˆæ¯:" msg))(ws/make-websocket! webSocketUrl handler-ws-msg)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å°±å»ºç«‹äº†å‰åç«¯wsé€šä¿¡ã€‚</p><h2 id="ç”Ÿäº§ç¯å¢ƒä¸Šçš„ç‰¹æ®Šå¤„ç†"><a href="#ç”Ÿäº§ç¯å¢ƒä¸Šçš„ç‰¹æ®Šå¤„ç†" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒä¸Šçš„ç‰¹æ®Šå¤„ç†"></a>ç”Ÿäº§ç¯å¢ƒä¸Šçš„ç‰¹æ®Šå¤„ç†</h2><p>ä½†æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒ(https+nginx)ä¸Šè¦åšç‚¹ç‰¹æ®Šå¤„ç†ï¼Œè¿™é‡Œçš„å¤„ç†ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½æœ‰ã€‚</p><ol><li><strong>ç”Ÿäº§ç¯å¢ƒå¤šæ˜¯httpsçš„ï¼Œè¿™å°±è¦æ±‚é¡µé¢é‡Œé¢çš„websocketå¿…é¡»è¦æ˜¯<code>wss</code>çš„ï¼Œè€Œä¸èƒ½æ˜¯<code>ws</code>çš„</strong></li></ol><p>å› æ­¤websocketçš„è¿æ¥å˜æˆäº†<code>wss://www.abc.com/api/ws/</code></p><ol start="2"><li> <strong>æœåŠ¡ç«¯nginxé…ç½®æ”¯æŒwebsocket</strong></li></ol><p>ç”Ÿäº§ç¯å¢ƒæœåŠ¡ç«¯çš„æ¥å£ä½¿ç”¨nginxåšäº†åå‘ä»£ç†ï¼Œä¸å‡ºæ„å¤–çš„è¯ï¼Œä¸Šé¢çš„è¿æ¥å³ä½¿æ”¹æˆwssä¹Ÿè¿æ¥ä¸æˆåŠŸï¼Œéœ€è¦nginxçš„é…ç½®å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-conf"><code class="language-conf">http {    map $http_upgrade $connection_upgrade {        default upgrade;        ''      close;    }    server {        ...        location /chat/ {            proxy_pass http://backend;            proxy_http_version 1.1;            proxy_set_header Upgrade $http_upgrade;            proxy_set_header Connection $connection_upgrade;            proxy_read_timeout 600s;         }  }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li><strong>æœ€é‡è¦çš„ï¼Œå®¢æˆ·ç«¯åŠ å…¥å¿ƒè·³æ£€æµ‹ï¼Œç«¯å£åè‡ªåŠ¨é‡è¿</strong></li></ol><p>æˆ‘ä»¬çš„ç¨‹åºæ˜¯ä¸€ä¸ªjarç›´æ¥javaå¯åŠ¨çš„ï¼Œè¿™æ ·åœ¨è¿æ¥ä¸Šåä¸ä¼šè‡ªå·±æ–­å¼€çš„ï¼Œä½†æ˜¯ä¸Šé¢è¯´äº†ï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨nginxä»£ç†çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ©ç”¨nginxä»£ç†websocketçš„æ—¶å€™ï¼Œå‘ç°å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ¡æ‰‹æˆåŠŸåï¼Œå¦‚æœåœ¨60sæ—¶é—´å†…æ²¡æœ‰æ•°æ®äº¤äº’ï¼Œè¿æ¥å°±ä¼šè‡ªåŠ¨æ–­å¼€ã€‚å› æ­¤ä¸Šé¢é…ç½®äº†<code>proxy_read_timeout 600s</code>ï¼Œä¹Ÿå°±æ˜¯10åˆ†é’Ÿæ²¡æœ‰é€šä¿¡å†æ–­å¼€ã€‚<br>è¿™ä¸ªæ—¶é—´å¯ä»¥é•¿ï¼Œä½†æˆ‘æ²¡è¯•è¿‡æ˜¯ä¸æ˜¯å¯ä»¥æ— é™é•¿ã€‚<br>æ‰€ä»¥æœ€å¥½æ˜¯åœ¨å®¢æˆ·ç«¯åŠ ä¸Šå¿ƒè·³æ£€æµ‹ï¼Œæ–­å¼€åæœ‰èƒ½åŠ›è‡ªå·±é‡è¿ï¼ŒåŠæ—¶æœåŠ¡å™¨ä¸è®¾ç½®10åˆ†é’Ÿï¼Œ60ç§’é’Ÿæ–­å¼€ä¹Ÿå¯ä»¥è‡ªå·±é‡è¿ã€‚<br>ç»ˆææ–¹æ¡ˆæ˜¯å¿ƒè·³æ£€æµ‹+å»¶é•¿read-timeoutæ—¶é—´ï¼Œå®¢æˆ·ç«¯çš„ä»£ç ï¼š</p><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(require '[reagent.core :as reagent :refer [atom]])(defonce ws-chan (atom nil))(def lockReconnect (atom false))(def clear-time (atom nil))(def click-one (atom true))(def webSocketUrl "ws://182.61.51.177:3055/api/ws")(defn receive-transit-msg!  [update-fn]  (fn [msg]    (js/clearTimeout clear-time)    (update-fn (cljs.reader/read-string (.-data msg)))))(defn send-transit-msg!  [msg]  (if @ws-chan    (.send @ws-chan msg)    (throw (js/Error. "Websocket is not available!"))))(set! (.-onbeforeunload js/window) (fn []                                     (.close (js/WebSocket. webSocketUrl))))(defn initEventHandle [url chan receive-handler]  (do    (set! (.-onmessage chan) (receive-transit-msg! receive-handler))    (reset! ws-chan chan)    (js/console.log "Websocket connection established with: " url)    (set! (.-onopen chan) (fn []                            (js/console.log "è¿æ¥æˆåŠŸ")                            (js/clearTimeout clear-time)))    (set! (.-onclose chan) (fn []                             (js/console.log "è¿æ¥æ–­å¼€>>>")                             (reset! lockReconnect true)                             (if (true? @lockReconnect)                               (do                                                                  ;;æ²¡è¿æ¥ä¸Šä¼šä¸€ç›´é‡è¿ï¼Œè®¾ç½®å»¶è¿Ÿé¿å…è¯·æ±‚è¿‡å¤š                                 (reset! clear-time                                         (js/setTimeout (fn []                                                          (initEventHandle webSocketUrl                                                                           (js/WebSocket. url)                                                                           receive-handler)                                                          (reset! lockReconnect false)) 2000))                                 (reset! lockReconnect false))                               (do                                                                  (js/clearTimeout clear-time)))))    (set! (.-onerror chan) (fn []                             (js/console.Error "è¿æ¥é”™è¯¯")                             (reset! lockReconnect true)                             (if (true? @lockReconnect)                               (do                                                                  ;;æ²¡è¿æ¥ä¸Šä¼šä¸€ç›´é‡è¿ï¼Œè®¾ç½®å»¶è¿Ÿé¿å…è¯·æ±‚è¿‡å¤š                                 (reset! clear-time                                         (js/setTimeout (fn []                                                          (initEventHandle webSocketUrl                                                                           (js/WebSocket. url)                                                                           receive-handler)                                                          (reset! lockReconnect false)) 2000))                                 (reset! lockReconnect false))                               (do                                                                  (js/clearTimeout clear-time)))))))(defn make-websocket! [url receive-handler]  (js/console.log "attempting to connect websocket")  (if-let [chan (js/WebSocket. url)]    (initEventHandle url chan receive-handler)    (throw (js/Error. "Websocket connection failed!"))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‚è€ƒ<a href="https://github.com/luminus-framework/examples/tree/master/multi-client-ws-immutant">å®˜æ–¹demo</a>çš„å®ç°åï¼Œåªæ˜¯æˆåŠŸè¿›è¡Œäº†è¿æ¥ï¼Œå¹¶ä¸èƒ½ä¿è¯çœŸæ­£çš„é•¿è¿ï¼Œå› æ­¤ä¸Šé¢ä»£ç é‡Œå¯¹å½“å‰channelçš„<code>onclose</code>å’Œ<code>onerror</code>äº‹ä»¶çš„å¤„ç†æ˜¯æˆ‘ä»¬å‰ç«¯çš„å§‘å¨˜å‚è€ƒ<a href="https://www.jianshu.com/p/1141dcf6de3e">WebSocketåŠ å…¥å¿ƒè·³åŒ…é˜²æ­¢è‡ªåŠ¨æ–­å¼€è¿æ¥</a>jsç‰ˆæœ¬ç”¨cljsåšçš„å®ç°ï¼Œç»™å¥¹ç‚¹ä¸ªèµğŸ‘ã€‚</p><p>åˆ°è¿™é‡Œï¼Œclojureå’Œclojurescripté‡Œæ­å»ºwebsocketé€šä¿¡å°±ç®—æ˜¯å¯ç”¨äº†ã€‚</p><h2 id="client-testing"><a href="#client-testing" class="headerlink" title="client testing"></a>client testing</h2><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(require '[reagent.core :as reagent :refer [atom]])(defonce messages (reagent/atom []))(defn message-list []  [:ul   (for [[i message] (map-indexed vector @messages)]     ^{:key i}     [:li message])])(defn message-input []  (reagent/with-let [value (reagent/atom nil)]    [:input     {:type        :text      :placeholder "è¾“å…¥&å›è½¦å‘é€"      :value       @value      :on-change   #(reset! value (-> % .-target .-value))      :on-key-down #(when (= (.-keyCode %) 13)                      (send-transit-msg!                       {:message @value})                      (reset! value nil))}]))(defn update-messages! [{:keys [message]}]  (js/console.info "æ”¶åˆ°æœåŠ¡ç«¯è¿”å›çš„æ¶ˆæ¯")  (swap! messages #(vec (take 10 (conj % message)))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-klipse-reagent"><code class="language-klipse-reagent">(make-websocket! webSocketUrl update-messages!)(defn home-page [] [:div.container  [:div.row   [:div.col-md-12    [:h2 "Welcome to chat"]    [:h4 "æœåŠ¡ç«¯å°†ä½ å‘é€çš„å†…å®¹åŠ äº†ä¸ªkeyåšäº†å›ç­”"]]]  [:div.row   [:div.col-sm-6    [message-list]]]  [:div.row   [:div.col-sm-6    [message-input]]]])[home-page]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="http://www.luminusweb.net/docs/websockets.html#immutant">immutant websockets sample</a></p><p><a href="http://nginx.org/en/docs/http/websocket.html">WebSocket proxying</a></p><p><a href="https://www.jianshu.com/p/1141dcf6de3e">WebSocketåŠ å…¥å¿ƒè·³åŒ…é˜²æ­¢è‡ªåŠ¨æ–­å¼€è¿æ¥</a></p>]]></content>
      
      
      <categories>
          
          <category> clojure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
            <tag> cljs </tag>
            
            <tag> websocket </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>emacsä¸Šä½¿ç”¨pxè½¬æ¢vwæ’ä»¶</title>
      <link href="2019/10/30/emacs-shang-shi-yong-px-zhuan-huan-vw-cha-jian/"/>
      <url>2019/10/30/emacs-shang-shi-yong-px-zhuan-huan-vw-cha-jian/</url>
      
        <content type="html"><![CDATA[<p>å­¦ä¹ ä½¿ç”¨elispç»™emacså†™ä¸€ä¸ªpxè½¬æ¢æˆvwçš„æ’ä»¶</p><p><a href="https://www.jianshu.com/p/f8153a735294">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å› ä¸ºemacsç¼ºå°‘ä¸€ä¸ªæ’ä»¶å·²ç»å½±å“äº†å‰ç«¯åŒå­¦å¯¹emacsçš„å…´è¶£äº†ï¼Œè¿™æœ‰ç‚¹å°´å°¬ï¼Œå…¶å®emacså¾ˆå¼ºå¤§çš„ã€‚<br>å¯¹æ ‡vs codeçš„<a href="https://marketplace.visualstudio.com/items?itemName=liurongqing.px2vw">px2vwæ’ä»¶</a>ï¼Œä»Šå¤©èŠ±åŠå¤©å®ç°äº†ä¸€ä¸ªç®€æ˜“çš„ç›¸ä¼¼åŠŸèƒ½çš„emacsæ’ä»¶ã€‚</p><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>å‚è€ƒ<a href="https://github.com/qdhaiqiang/px2vw-emacs-plugin">px2vw-px2vw-emacs-plugin</a>ä¸Šä¸­å¼è‹±æ–‡è¯´æ˜ä¹Ÿèƒ½çœ‹æ‡‚ã€‚</p><p>ä¸‹è½½<a href="https://github.com/qdhaiqiang/px2vw-emacs-plugin/blob/master/px2vw.el">px2vw.el</a>åˆ°æœ¬åœ°<code>~/emacs.d/lisp/</code>ç›®å½•ä¸‹ã€‚</p><p>æˆ–åœ¨<code>~/emacs.d/lisp/</code>è‡ªä»¶ä¸€ä¸ªåä¸º<code>px2vw.el</code>æ–‡ä»¶ï¼Œå°†ä»£ç å¤åˆ¶è¿›å»ï¼Œä¿å­˜ã€‚</p><p>åœ¨<code>~/.emacs.d/custom.el</code>æ–‡ä»¶é‡Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(require 'px-to-vw-vh)(global-set-key (kbd "C-c w") 'px->vw)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚æœè¿™ä¸ªæ“ä½œå¾ˆå¸¸ç”¨çš„è¯ï¼Œä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªæ›´ç®€æ´çš„å¿«æ·é”®ï¼Œæ¯”å¦‚<code>F9</code>ï¼Œé‚£å°±å°†ä¸Šé¢çš„ç¬¬äºŒè¡Œæ¢æˆ</p><pre class="line-numbers language-clojure"><code class="language-clojure">(global-set-key [f9] 'px->vw)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‡å¯emacsã€‚</p><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>åœ¨pxä»£ç å‡ºï¼ŒæŒ‰ä¸‹ä½ è®¾ç½®çš„å¿«æ·é”®ï¼Œå°†æ‰§è¡Œç»‘å®šçš„å‡½æ•°ï¼Œè¿™ä¼šæŠŠæ¯”å¦‚<code>200px;</code>æ¢ç®—æˆ<code>13.8889vw</code>ä¿ç•™äº†4ä½å°æ•°ç‚¹ï¼Œæ›¿æ¢æ‰åŸæ¥çš„ä»¥pxä¸ºå•ä½çš„ä»£ç ã€‚</p><h3 id="å±€é™è¯´æ˜"><a href="#å±€é™è¯´æ˜" class="headerlink" title="å±€é™è¯´æ˜"></a>å±€é™è¯´æ˜</h3><ol><li>ç›®å‰æ’ä»¶å†…ç½®äº†å®½åº¦æ˜¯<strong>1440</strong>ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹ï¼Œå¯ä»¥åœ¨ä¸‹è½½ä¸‹æ¥çš„<code>px2vw.el</code>é‡ŒæŠŠç¬¬ä¸€è¡Œå®šä¹‰çš„å¸¸é‡<code>viewpoint-width</code>æ”¹æˆä½ éœ€è¦çš„å€¼ã€‚</li><li>é‰´äºvhå¾ˆå°‘ç”¨åˆ°ï¼Œå› æ­¤è¿˜æ²¡æœ‰åšé€‚åº”ï¼Œéœ€è¦çš„æ—¶å€™æ‰‹åŠ¨è®¡ç®—ä¸‹ã€‚</li></ol><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://emacsist.github.io/2018/01/03/%E6%9D%8E%E6%9D%80%E7%9A%84elisp%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">ææ€çš„Elispå­¦ä¹ ç¬”è®°</a><br><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/">Emacs Lisp</a></p><h2 id="px2vw-elé™„ä»¶"><a href="#px2vw-elé™„ä»¶" class="headerlink" title="px2vw.elé™„ä»¶"></a>px2vw.elé™„ä»¶</h2><pre class="line-numbers language-clojure"><code class="language-clojure">(defvar viewpoint-width 1440) (defvar viewpoint-height 900) (defun kill-thing-at-point (thing)  "Kill the `thing-at-point' for the specified kind of THING."  (let ((bounds (bounds-of-thing-at-point thing)))    (if bounds        (kill-region (car bounds) (cdr bounds))      (error "No %s at point" thing))))(defun kill-word-at-point ()  "Kill the word at point."  (interactive)  (kill-thing-at-point 'word))(defun convert-to-vw (px-v)  (format "%.2f" (/ (float (* (string-to-number px-v) 100)) viewpoint-width)))(defun convert-to-vh (px-v)  (format "%.2f" (/ (float (* (string-to-number px-v) 100)) viewpoint-height )))(defun px->vw ()  "Convert word at point (or selected region) from px to vw."  (interactive)  (let* ((char (if (use-region-p)                     (cons (region-beginning) (region-end))                   (thing-at-point 'symbol))))    (when (and char (not (string-blank-p char)) )      (if (string-match "px" char)      (progn        (setq word (current-word char))        (setq px-v (substring word 0 (- (length word) 2)))        (kill-word-at-point)        (insert (concat (convert-to-vw px-v) "vw")))      (print "there's no px value to converting")))));;(global-set-key (kbd "C-c w") 'px->vw);;(global-set-key [f9] 'px->vw)(provide 'px2vw)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¤§ç¥åŠ å¼ºç‰ˆ"><a href="#å¤§ç¥åŠ å¼ºç‰ˆ" class="headerlink" title="å¤§ç¥åŠ å¼ºç‰ˆ"></a>å¤§ç¥åŠ å¼ºç‰ˆ</h2><p>ä¸Šé¢çš„pluginä¸æ”¯æŒæ•´ä¸ªæ–‡ä»¶æˆ–è€…é€‰ä¸­åŒºåŸŸä¸€æ¬¡æ€§æ“ä½œæ˜¯ä¸ªç¡¬ä¼¤ã€‚å¤§ç¥ç‰ˆä¼˜åŒ–çš„åŒæ—¶ï¼ŒåŒæ—¶è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚<br>å†™çš„ä»£ç æœ‰é•¿åˆçƒ‚çš„åŸå› åªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯å­¦çš„å¤ªæµ…ã€‚</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defun k-test (string &optional posBegin posEnd)  "æ”¯æŒå½“å‰æ®µè½å’Œé€‰ä¸­åŒºåŸŸï¼ˆregionï¼‰."  (interactive   (if (use-region-p)       (list nil (region-beginning) (region-end))     (let ((bds (bounds-of-thing-at-point 'paragraph)))       (progn         (goto-char (car bds))         (list nil (car bds) (cdr bds))))))  (while (re-search-forward "\\([0-9.]+\\)\\(px\\)" posEnd t)    (let* ((px-digit-str (match-string 1))           (px-digit (string-to-number px-digit-str))           (vw-digit (format                      "%.2f"                      (/                       (* 100.0 px-digit)                       1400.0))))      (replace-match (concat vw-digit  "vw") t nil)      )))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> emacs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> emacs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojurescripté¡µé¢å®šæ—¶åˆ·æ–°</title>
      <link href="2019/10/24/clojurescript-timer-refresh/"/>
      <url>2019/10/24/clojurescript-timer-refresh/</url>
      
        <content type="html"><![CDATA[<p>clojurescript é¡µé¢å®šæ—¶å™¨</p><p><a href="https://www.jianshu.com/p/df7fe14ae3e2">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h2><p>æœ€è¿‘åšè“ç‰™è®¾å¤‡çš„è¿æ¥ï¼Œéœ€è¦åœ¨appä¸Šå®æ—¶æ˜¾ç¤ºè“ç‰™çš„è¯»æ•°ï¼Œæ¯•ç«Ÿåªæœ‰ä½¿ç”¨è®¾å¤‡çš„æ—¶å€™æ‰è¦æ±‚å®æ—¶æ€§ï¼Œç®€æ˜“æœŸé—´æˆ‘ä»¬ä½¿ç”¨æœåŠ¡ç«¯é€šä¿¡ï¼Œæˆ–è€…socketè¿™ç§åŒå‘é€šä¿¡çš„ï¼Œç›´æ¥åœ¨é¡µé¢æ—¶å®šæ—¶åˆ·æ–°</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(require '[reagent.core :as r])(require '[re-frame.core :as rf])(defn dispatch-timer-event  []  (let [now (js/Date.)]    (rf/dispatch [:timer now])))(defonce do-timer (js/setInterval dispatch-timer-event 1000))(rf/reg-event-db                  :timer   (fn [db [_ new-time]]   (prn "<<<<< this is a test log >>>>>" (str new-time))   (assoc db :time new-time)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åœæ­¢"><a href="#åœæ­¢" class="headerlink" title="åœæ­¢"></a>åœæ­¢</h2><p>åœæ­¢ä¸€ä¸ªintervalä½¿ç”¨å¦‚ä¸‹æ“ä½œ</p><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(r/render-component (r/create-element "button"                                      #js {:onClick #(. js/window (clearInterval do-timer))}                                      "åœæ­¢åˆ·æ–°"                                      ) js/klipse-container)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>åˆ’é‡ç‚¹</strong>ï¼šå®šæ—¶ä»»åŠ¡å¯åŠ¨åå¿…é¡»æ‰¾åˆ°å¯¹åº”çš„æ‰èƒ½åœæ­¢æ‰ï¼Œåœ¨å®é™…å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œä½ ä¹Ÿä¸€å®šä¸å¸Œæœ›å•é¡µé¢çš„åº”ç”¨ï¼Œåªè¦å®šæ—¶ä»»åŠ¡å¯åŠ¨äº†ï¼Œå…³é—­äº†å½“å‰é¡µå®šæ—¶ä»»åŠ¡è¿˜åœ¨æ‰§è¡Œç€ï¼Œä¸€å®šæ˜¯è¦æ‰¾åˆ°æŸä¸ªåˆé€‚çš„å¥‘æœºåœæ­¢æ‰çš„ã€‚<br>æˆ‘ä»¬æ˜¯è¿™æ ·å®ç°çš„ï¼Œä¸€ä¸ªæŒ‰é’®æ§åˆ¶è·³é¡µåŒæ—¶å¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼ŒsetIntervalçš„è¿”å›å€¼ç”¨atomæˆ–è€…dbä¿å­˜èµ·æ¥ã€‚<br>é¡µé¢é€€å‡ºï¼Œæˆ–è€…å…¶ä»–buttonæœ‰æ“ä½œæ—¶ï¼Œè°ƒç”¨clearIntervalå°†atomæˆ–è€…dbé‡Œè®¢é˜…çš„intervalåœæ­¢æ‰ã€‚</p><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p>å®é™…ä½¿ç”¨ä¸­æˆ‘ä»¬å½“ç„¶ä¸æ˜¯åªæ‰“ä¸ªlogï¼Œæ˜¯è°ƒç”¨æ¥å£ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š<br><img src="/loading.gif" data-original="/images/cljs/timer-log.png" alt="å®šæ—¶å™¨æµè§ˆå™¨log"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://github.com/Day8/re-frame/blob/master/examples/simple/src/simple/core.cljs">https://github.com/Day8/re-frame/blob/master/examples/simple/src/simple/core.cljs</a></p>]]></content>
      
      
      <categories>
          
          <category> cljs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
            <tag> cljs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>emacsä¸Šå®‰è£…ç±»ä¼¼exploreræ’ä»¶neotree</title>
      <link href="2019/10/24/emacs-shang-an-zhuang-lei-si-explorer-cha-jian-neotree/"/>
      <url>2019/10/24/emacs-shang-an-zhuang-lei-si-explorer-cha-jian-neotree/</url>
      
        <content type="html"><![CDATA[<p>emacsä½¿ç”¨æ„Ÿå—å’Œä¸¤ä¸ªæ’ä»¶</p><p><a href="https://www.jianshu.com/p/185840de08a8">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="emacsæ¨èåŸå› "><a href="#emacsæ¨èåŸå› " class="headerlink" title="emacsæ¨èåŸå› "></a>emacsæ¨èåŸå› </h2><p>æˆ‘å¼€å§‹å­¦clojureæ˜¯ç”¨intellij ideaçš„ï¼Œæ„Ÿè§‰è¿™æ¬¾ç¥å™¨é…ä¸Šcursive plugin + Rainbow Bracketsæ’¸ç æ•ˆæœä¹Ÿè¿˜ä¸é”™ï¼Œç°åœ¨æƒ³æƒ³å¯èƒ½è¿™ç§æ„Ÿè§‰æ¥è‡ªå½“æ—¶å¤ªä¸ä¹ æƒ¯clojureçš„å†™ä½œä¹ æƒ¯ï¼Œå’Œä¸ç†Ÿæ‚‰clojureçš„å“ªæ€•æœ€åŸºç¡€çš„å‡½æ•°ã€‚</p><p>ä½¿ç”¨çš„ä¸€ä¸ªå¤šæœˆæœŸé—´ï¼Œæ•´ä½“code fomatterä¸å¤§ç¥çš„emacsä¸ä¸€æ ·ï¼Œæ‰€ä»¥æ‰“å¼€ä¸€ä¸ªnamespaceæ€»æ˜¯ä¼šé‡æ–°æ ¹æ®cursiveè®¤ä¸ºçš„ç¼©è¿›ç»™åŠ å‡æ‹¬å·ï¼Œå‡ å¤©é‡Œæ€»ä¼šå‡ºç°é‚£ä¹ˆä¸€ä¸¤æ¬¡ï¼Œæ‹¬å·ä¹±çš„åŒ¹é…ä¸ä¸Šï¼Œè´¹å¾ˆå¤§åŠ²ã€‚</p><p>å­¦ä¹ æœŸé—´ï¼Œçœ‹é«˜æ‰‹ç©å¼„ä»£ç ï¼Œå°¤å…¶æ˜¯repläº¤äº’é‡Œï¼Œæ‰å¼€å§‹è§‰å¾—intellij ideaæ¬ ç¼ºç‚¹ä»€ä¹ˆã€‚äºæ˜¯å¼€å§‹ä½¿ç”¨emacsï¼Œå„ç§æŸ¥ï¼Œå„ç§é—®ï¼Œå¼ºè¿«è‡ªå·±ä¹ æƒ¯ï¼Œä¹Ÿå°±ä¸€å‘¨çš„æ—¶é—´ï¼Œå¸¸ç”¨çš„å¿«æ·é”®ä¹Ÿå°±èƒ½è®°å·®ä¸å¤šäº†ï¼ˆæ¯•ç«Ÿèœé¸Ÿçº§çš„å…¥é—¨ç”¨æˆ·å¸¸ç”¨çš„ä¹Ÿä¸å¤šğŸ˜ï¼‰ã€‚</p><p>ä¸¤ä¸‰å‘¨ä»¥åæˆ‘å°±çœŸçš„ä¸æƒ³å†åœ¨intellijä¸Šç©äº†ï¼Œå°¤å…¶æ˜¯å­¦ä¼šæ‹¬å·åƒè¿›ã€åå‡ºè¿™ç§åæ¥éå¸¸éå¸¸å¸¸ç”¨çš„å¿«æ·é”®ï¼Œç†Ÿæ‚‰äº†ä¹‹åæ„Ÿè§‰åœ¨emascé‡Œç¼–è¾‘clojureä¹Ÿæ˜¯ä¸€ç§äº«å—ã€‚</p><p>Visual Studio Codeä¹Ÿæœ‰å¥½å‡ ä¸ªclojureæ’ä»¶ï¼Œé…ä¸Šå½©è™¹æ‹¬å·ï¼Œä»£ç å¯è¯»æ€§ä¹Ÿè¿˜ä¸é”™ï¼Œä½†æ˜¯ç¼–è¾‘èµ·æ¥å°±æ›´ä¸å¦‚intellij ideaäº†ï¼Œå› ä¸ºè¿å‡½æ•°éƒ½è·³ä¸è¿›å»ï¼Œåˆ é™¤å’Œå‰ªåˆ‡æ—¶é˜²æ­¢æ‹¬å·åŒ¹é…é”™è¯¯ç­‰ç­‰éƒ½æ²¡æœ‰ï¼Œæ›´æ²¡æœ‰replç¯å¢ƒï¼Œæ€»ä¹‹å¯¹ç¼–è¾‘clojureæ¥è¯´å¤ªæ¬¡~~~æ•ˆç‡ä¹Ÿä¸ä¼šé«˜ã€‚</p><h2 id="ç¼ºé™·è¡¥å……"><a href="#ç¼ºé™·è¡¥å……" class="headerlink" title="ç¼ºé™·è¡¥å……"></a>ç¼ºé™·è¡¥å……</h2><p>ä½†æ˜¯äº‹ç‰©éƒ½æœ‰ä¸¤é¢æ€§ï¼Œæ¯•ç«Ÿèåœç™½èœå„æœ‰æ‰€çˆ±ï¼Œemacsä¹Ÿæœ‰å®ƒä¸è¶³çš„åœ°æ–¹ï¼Œé™¤äº†å¿«æ·é”®æ¯”è¾ƒéº»çƒ¦ä»¥å¤–ï¼Œæœ‰äººè¯´ç¼–å†™äº†ä»£ç å¿…é¡»æŒ‰ä¸‹<code>C+x C+s</code>ä¿å­˜ï¼Œéº»çƒ¦ã€‚<br>å¬çš„æ›´å¤šçš„æ˜¯emacsæ²¡æœ‰æƒ³åˆ«çš„ideä¸€æ ·çš„explorerå¯ä»¥çœ‹æ•´ä¸ªå·¥ç¨‹çš„ç»“æ„ï¼Œå› æ­¤æˆ‘å°†è‡ªå·±çš„å°è¯•å†™ä¸€ä¸‹ï¼Œæ­£åœ¨ä½¿ç”¨æˆ–æœ‰æ„å‘ä½¿ç”¨emacsçš„æƒ³åŠ çš„å¯ä»¥è‡ªå·±åŠ ï¼Œä¹Ÿå¯ä»¥æ‰¾æˆ‘å…è´¹ä¸Šé—¨å®‰è£…ğŸ˜ğŸ˜„ğŸ˜</p><p>æˆ‘ä¹Ÿå®‰è£…çš„æ˜¯å¤§ç¥æ¨èçš„<a href="https://github.com/purcell/emacs.d">purcell/emacs.d</a>çš„é…ç½®ï¼Œä½†æ˜¯åšäº†ä¸¤ç‚¹æ”¹åŠ¨ã€‚</p><h3 id="è‡ªåŠ¨ä¿å­˜æ’ä»¶"><a href="#è‡ªåŠ¨ä¿å­˜æ’ä»¶" class="headerlink" title="è‡ªåŠ¨ä¿å­˜æ’ä»¶"></a>è‡ªåŠ¨ä¿å­˜æ’ä»¶</h3><p>æœ‰äº†è¿™ä¸ªæ’ä»¶å¯ä»¥ä¸ç”¨å†æŒ‰ä¸‹<code>C+x C+s</code>ä¿å­˜äº†ã€‚é»˜è®¤1sé’Ÿä½ ä¸åŠ¨ï¼Œç¨‹åºå°±ä¼šè‡ªå·±ä¿å­˜ï¼Œå¹¶ä¸”ä¸ä¼šå†æœ‰é‚£äº›#æ–‡ä»¶ï¼Œç¨‹åºå¯åŠ¨çš„è¯ä¹Ÿä¼šè‡ªå·±ç¼–è¯‘ï¼Œæˆ‘ä½¿ç”¨çš„æ—¶å€™é™é»˜æ—¶é—´æ”¹æˆ3sã€‚<br>å‚è€ƒæ–‡ç« <a href="https://www.jianshu.com/p/998ceaf522d1">Emacsï¼šæˆ‘å·²ç»åå¹´æ²¡æœ‰æŒ‰è¿‡ä¿å­˜æŒ‰é”®äº†ï¼ˆé™„å¸¦ auto-save.el æºç è§£æï¼‰</a>åšçš„ï¼Œç›¸ä¿¡æœ‰è¿™æƒ³æ³•çš„è¯ï¼Œåº”è¯¥è°éƒ½ä¼šï¼Œæˆ‘è¿™æ¨èä¸‹ç›¸å…³é“¾æ¥ã€‚</p><p>æ’ä»¶ä»£ç ï¼š<a href="https://www.emacswiki.org/emacs/auto-save.el">auto-save.el</a></p><p>éœ€è¦ä¿®æ”¹é™é»˜æ—¶é—´çš„è¯ä¿®æ”¹<code>.el</code>æ–‡ä»¶é‡Œçš„<code>auto-save-idle</code>å‡½æ•°å‚æ•°å³å¯ï¼Œå•ä½æ˜¯ç§’ã€‚</p><h3 id="neotreeæ’ä»¶"><a href="#neotreeæ’ä»¶" class="headerlink" title="neotreeæ’ä»¶"></a>neotreeæ’ä»¶</h3><p>ä»ç½‘ä¸Šæœä¸€ä¸‹çš„è¯ï¼Œè¿™æ ·çš„éœ€æ±‚è¿˜çœŸä¸æ˜¯åªæœ‰æˆ‘ä»¬æƒ³è¦ï¼Œæ¯”å¦‚:<a href="https://stackoverflow.com/questions/843645/a-good-project-tree-browser-for-emacs">A good project tree browser for Emacs?</a>,<br>emacsçœŸæ˜¯åƒäººåƒæ ·ï¼Œæˆ‘ä»å„ä½å¤§ç¥é«˜åº¦çš„è‡ªå®šåˆ¶æ–¹æ¡ˆé‡Œæ‰¾åˆ°äº†<a href="https://github.com/jaypei/emacs-neotree">neotree</a>å’Œ<a href="https://github.com/sebastiencs/sidebar.el">sidebar</a>ä¸¤æ¬¾ï¼Œæˆ‘ä½¿ç”¨çš„å‰è€…ï¼Œå®‰è£…ç®€å•ï¼Œä¹Ÿèƒ½è¾¾åˆ°ç›®çš„ï¼ˆæˆ‘ä¹Ÿæ‹…å¿ƒä¹±ä¸ƒå…«ç³Ÿå®‰è£…å¤šäº†ï¼Œä¼šä¸ä¼šå½±å“eamcså¯åŠ¨è¿è¡Œé€Ÿåº¦ï¼Œæ‰€ä»¥æ¯”é‡å°±è½»ï¼‰ã€‚</p><p>æ¨èF8ä½œä¸ºæ§åˆ¶æ˜¾ç¤ºå’Œéšè—çš„å¿«æ·é”®ï¼Œå†™å¤šäº†ï¼Œä¸€å›¾èƒœåƒè¨€~<br><img src="/loading.gif" data-original="/images/tools/emacs-neotree.png" alt="emacs-neotree"></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> emacs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¥èˆŸç²¾ç›¾T47T1å®‰è£…é»‘è‹¹æœ</title>
      <link href="2019/10/19/shen-zhou-jing-dun-t47t1-an-zhuang-hei-ping-guo/"/>
      <url>2019/10/19/shen-zhou-jing-dun-t47t1-an-zhuang-hei-ping-guo/</url>
      
        <content type="html"><![CDATA[<p>æ–°ä¹°çš„ç¥èˆŸç²¾ç›¾8Gå†…å­˜ï¼Œ1Tå›ºæ€ï¼Œä¹°æ¥å®‰è£…é»‘è‹¹æœçš„æ—¶å€™ä¸€ç‚¹å°é—®é¢˜è®°å½•</p><p><a href="https://www.jianshu.com/p/87da42c638ad">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æœ€è¿‘åœ¨åŒäº‹çš„é¼“åŠ¨ä¸‹ä¸‹æ‰‹äº†ç¥èˆŸç²¾ç›¾UT471è¿™æ¬¾æœ¬å­ï¼Œ14å¯¸è¶…è–„æœ¬ã€‚<br><img src="/loading.gif" data-original="/images/mac/%E7%A5%9E%E8%88%9F%E7%B2%BE%E7%9B%BEUT471.png" alt="ç¥èˆŸç²¾ç›¾UT471é…ç½®"></p><p>åŒäº‹åŠä¸ªå¤šæœˆå‰å°±æ˜¯ä¹°çš„è¿™æ¬¾ï¼Œå·²ç»æŠ˜è…¾å¥½äº†é»‘è‹¹æœï¼Œæ­£æ˜¯åŸºäºè¿™ä¸ªåŸå› ï¼Œæˆ‘çŠ¹è±«ä¸­å¸¦ç€ä¸å®‰è¿˜æ˜¯ä¹°äº†è¿™æ¬¾ï¼ŒæŠ˜è…¾é»‘è‹¹æœç¡®å®æ˜¯ä¸ªå¤´ç–¼çš„äº‹ï¼Œé™¤éèˆå¾—èŠ±é’±ã€‚ã€‚ã€‚</p><p>ä¸ä¹‹å‰ä¸åŒçš„äº‹è¿™æ¬¡è¿™ä¸ªç¬”è®°æœ¬åªæœ‰ä¸€å—å„¿ç¡¬ç›˜ï¼Œæ‰€ä»¥å®‰è£…äºä»¥å‰ä¸åŒäº†ï¼Œè¶ç€æœ‰å°è±¡ï¼Œè®°å½•ä¸‹å’‹å¹²çš„ã€‚</p><p>1ã€é¦–å…ˆï¼Œç³»ç»Ÿåˆ†åŒºå¾—è¦ä¸¤ä¸ªESPåŒºï¼Œä¸€ä¸ªå¼•å¯¼cloverï¼Œä¸€ä¸ªå¼•å¯¼Windowsï¼Œå°±æ˜¯å› ä¸ºæ²¡æœ‰ææ‡‚è¿™ä¸ªï¼Œè€æ˜¯æƒ³åœ¨ä¸€ä¸ªESPä¸ŠæŠŠä¸¤ä¸ªå¼•å¯¼éƒ½åŠ ä¸Šï¼Œæœ€åå¯¼è‡´æ­£ç‰ˆçš„windows10åºŸäº†ï¼Œè£…äº†ä¸ªç›—ç‰ˆçš„ã€‚</p><p>2ã€é»‘è‹¹æœçš„æ— çº¿ç½‘å¡å’Œè“ç‰™æ˜¯é“å®šé©±åŠ¨ä¸äº†çš„ï¼Œå½“æ—¶è”æƒ³æ‹¯æ•‘è€…è¿˜èŠ±150å¤§æ´‹ï¼Œä¹°äº†ä¸ªé»‘è‹¹æœæ— çº¿ç½‘å¡æ¢ä¸Šå»ï¼Œä¸€åˆ‡å®Œç¾äº†ï¼Œä½†æ˜¯è¿™æ¬¡å°±æƒ¨äº†ï¼Œæ®åŒäº‹è¯´ï¼Œå¸‚é¢ä¸Šæ²¡æœ‰æ’å£ä¸ä¹‹èƒ½åŒ¹é…çš„é»‘è‹¹æœæ— çº¿ç½‘å¡ï¼Œä»–ä¹°äº†ä¸€æ¬¡æ‹¿å›æ¥è¯•è¿‡äº†ï¼Œä¸èƒ½ç”¨ã€‚å› æ­¤wifiå’Œè“ç‰™åªèƒ½ç”¨USBé©±åŠ¨äº†ï¼Œè¿™æ ·ä¸€ä¸ªç”µè„‘ä¸Šå°±è¦è‡³å°‘æ’ä¸¤ä¸ªè®¾å¤‡ï¼Œè€Œä¸”å°±ç®—æ’ä¸¤ä¸ªï¼Œairdropè¿™ä¹ˆèµçš„æŠ•å±åŠŸèƒ½ä¹Ÿä¸å±äºä½ äº†ã€‚</p><p>3ã€è¦é©±åŠ¨USBè“ç‰™ï¼Œå°±è¦å…ˆç¦æ­¢æ‰macè‡ªå¸¦çš„è“ç‰™ï¼Œè™½ç„¶è‡ªå¸¦çš„ä¸èƒ½ç”¨ï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯ç«™ç€çŸ›ç›¾ä¸æ‹‰å±ï¼Œä¸ç¦æ­¢æ‰USBçš„é€‚é…å™¨æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œå› æ­¤macOSåªè®¤ä¸€ä¸ªã€‚<br>äºæ˜¯å¯ä»¥å‚è€ƒä¸‹æ–‡è®¾ç½®ç¦æ­¢ä¸€ä¸‹ï¼š<br> <a href="https://www.cnblogs.com/jifeng/p/9126362.html">å°ç±³ç¬”è®°æœ¬è£…MACï¼ˆé»‘è‹¹æœï¼‰ï¼Œå¤–æ¥USBè“ç‰™ï¼Œç¦æ­¢ç¬”è®°æœ¬è‡ªå¸¦çš„è“ç‰™æ–¹æ³•</a></p><p>4ã€ç¦æ­¢ABCè¾“å…¥æ³•<br>å‚è€ƒï¼š<a href="https://www.jianshu.com/p/af85cc5cd771">åˆ é™¤MACç³»ç»Ÿè‡ªå¸¦çš„ABCè¾“å…¥æ³•</a></p><p>5ã€ç¾ä¸­ä¸è¶³çš„åœ°æ–¹ï¼Œç”µè„‘å¯åŠ¨æ—¶è¦å…ˆæ–­å¼€ç”µæºï¼Œå¦åˆ™ä¼šå¯¼è‡´é”®ç›˜æ— æ³•é©±åŠ¨ï¼Œå¼€æœºåå†å……ç”µï¼Œæ­¤æ—¶é”®ç›˜æ¢å¤æ­£å¸¸ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> mac </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mac </tag>
            
            <tag> é»‘è‹¹æœ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojureä¹‹åˆ¶ä½œleinæ¨¡æ¿ï¼ˆä¸€ï¼‰</title>
      <link href="2019/10/09/clojure-zhi-zhi-zuo-lein-mo-ban/"/>
      <url>2019/10/09/clojure-zhi-zhi-zuo-lein-mo-ban/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨å¼€æºluminusæ¨¡æ¿ç­–ç•¥ï¼Œåˆ¶ä½œå±äºè‡ªå·±çš„é¡¹ç›®æ¨¡æ¿</p><p><a href="https://www.jianshu.com/p/39f00b399754">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="ä¼ é€é—¨"><a href="#ä¼ é€é—¨" class="headerlink" title="ä¼ é€é—¨"></a>ä¼ é€é—¨</h2><p><a href="https://github.com/technomancy/leiningen/blob/stable/doc/TEMPLATES.md">Writing Templates</a><br><a href="https://medium.com/@bansaridesai/writing-lein-template-quick-tutorial-f89b463e66a3">Writing Lein template â€” quick tutorial</a></p><h2 id="åˆ¶ä½œç›®æ ‡é¡¹ç›®"><a href="#åˆ¶ä½œç›®æ ‡é¡¹ç›®" class="headerlink" title="åˆ¶ä½œç›®æ ‡é¡¹ç›®"></a>åˆ¶ä½œç›®æ ‡é¡¹ç›®</h2><ol><li>åˆ›å»ºå·¥ç¨‹</li></ol><pre class="line-numbers language-shell"><code class="language-shell">âœ  lein new template hc-template --to-dir hc-templateGenerating a Luminus project.âœ  cd hc-templateâœ  hc-template tree.â”œâ”€â”€ CHANGELOG.mdâ”œâ”€â”€ LICENSEâ”œâ”€â”€ README.mdâ”œâ”€â”€ project.cljâ”œâ”€â”€ resourcesâ”‚&nbsp;&nbsp; â””â”€â”€ leiningenâ”‚&nbsp;&nbsp;     â””â”€â”€ newâ”‚&nbsp;&nbsp;         â””â”€â”€ hc_templateâ”‚&nbsp;&nbsp;             â””â”€â”€ foo.cljâ””â”€â”€ src    â””â”€â”€ leiningen        â””â”€â”€ new            â””â”€â”€ hc_template.clj7 directories, 6 filesâœ  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>æ ¹ç›®å½•æ‰‹åŠ¨å¢åŠ shadow-cljs.ednæ–‡ä»¶</li></ol><pre class="line-numbers language-clojure"><code class="language-clojure">;; This file is generated by lein-shadow, do not manually edit. Instead, edit project.clj shadow-cljs key.{:nrepl {:port 7002}, :builds {:app  {:target :browser,   :output-dir "target/cljsbuild/public/js",   :asset-path "/js",   :modules {:app             {:entries [hc-template.app]}},   :devtools {:watch-dir "resources/public",              :preloads [re-frisk.preload]},   :dev {:closure-defines {"re_frame.trace.trace_enabled_QMARK_" true}}   :release {:output-dir "dist/"             :module-hash-names true             :build-options {:manifest-name "cljs-manifest.json"}}}} ,  :test {:target :node-test,        :output-to "target/test/test.js",        :autorun true}}, :dev-http {8000 {:roots ["resources/public" "target/cljsbuild/public"]}} :lein true}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li>å¼•å…¥antd</li></ol><pre class="line-numbers language-shell"><code class="language-shell">npm install antd --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>package.jsoné…ç½®æ–‡ä»¶</p><pre class="line-numbers language-conf"><code class="language-conf">{  "dependencies": {    "antd": "^3.22.0",    "create-react-class": "15.6.3",    "react": "16.8.6",    "react-dom": "16.8.6",    "shadow-cljs": "2.8.39"  },  "devDependencies": {}}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>4ã€é…ç½®å…¥å£æ–‡ä»¶<br>åœ¨<code>resources/public</code>ç›®å½•ä¸‹æ–°å»ºindex.htmlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>åå°ç®¡ç†ç³»ç»Ÿ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdn.bootcss.com/antd/3.18.0/antd.min.css<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- Our JavaScript will modify the DOM inside this element --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- All our ClojureScript gets compiled into this file --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&lt;script type='text/javascript' src='/js/app.js?v="</span><span class="token operator">+</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"' type='text/javascript'>&lt;\/script>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="5"><li>å¯åŠ¨é¡¹ç›®ï¼ŒéªŒè¯æ˜¯å¦æ­£å¸¸</li></ol><pre class="line-numbers language-shell"><code class="language-shell">âœ  shadow-cljs serverPreparing npm packagesInstalling npm packagesnpm packages successfully installedRunning shadow-cljs...2019-08-25 20:13:00,880 [main] DEBUG org.jboss.logging - Logging Provider: org.jboss.logging.Slf4jLoggerProvider2019-08-25 20:13:02,199 [main] DEBUG io.undertow - starting undertow server io.undertow.Undertow@31ff09472019-08-25 20:13:02,207 [main] INFO  org.xnio - XNIO version 3.7.0.Final2019-08-25 20:13:02,398 [main] INFO  org.jboss.threads - JBoss Threads version 2.3.2.Final2019-08-25 20:13:02,423 [main] DEBUG io.undertow - Configuring listener with protocol HTTP for interface 0.0.0.0 and port 9630shadow-cljs - server version: 2.8.39 running at http://localhost:9630shadow-cljs - nREPL server started on port 7002shadow-cljs - watching build :app[:app] Configuring build.[:app] Compiling ...[:app] Build completed. (345 files, 344 compiled, 0 warnings, 62.36s)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>  clojureç¼–è¯‘å™¨æ¦‚è§ˆ:&nbsp;<a href="http://localhost:9630/">http://localhost:9630</a></li><li>  å®æ—¶å¼€å‘çš„é¢„è§ˆ:&nbsp;<a href="http://localhost:8000/">http://localhost:8000</a></li></ul><h2 id="å‚è€ƒluminus-templateå®ç°æœºåˆ¶ç¼–å†™sourceåŠ è½½ä»£ç "><a href="#å‚è€ƒluminus-templateå®ç°æœºåˆ¶ç¼–å†™sourceåŠ è½½ä»£ç " class="headerlink" title="å‚è€ƒluminus-templateå®ç°æœºåˆ¶ç¼–å†™sourceåŠ è½½ä»£ç "></a>å‚è€ƒ<a href="https://github.com/luminus-framework/luminus-template">luminus-template</a>å®ç°æœºåˆ¶ç¼–å†™sourceåŠ è½½ä»£ç </h2><p>å‚è€ƒleiningençš„åŸå› æ˜¯<a href="https://medium.com/@bansaridesai/writing-lein-template-quick-tutorial-f89b463e66a3">Writing Lein template â€” quick tutorial</a>è¿™æ–‡ä¸­å¦¹å­æ²¡æœ‰è€ƒè™‘clojureæœ¬èº«ä¸¤ä¸ªå¤§æ‹¬å·<code>{{xxx}}</code>è¿™ç§è¯­æ³•æ˜¯å­˜åœ¨çš„ï¼Œæ‰€ä»¥å¦‚æœç”¨å¥¹çš„æ–¹å¼ï¼Œä»£ç ä¸­æœ¬æ¥å°±æ˜¯<code>{{xxx}}</code>çš„è¯­æ³•å°†åˆ›å»ºæ¨¡æ¿ä¸æˆåŠŸï¼Œæˆ‘æƒ³è¿™ä¹Ÿæ˜¯leiningenä½¿ç”¨è¿ä¸ªå°–æ‹¬å·<code>&lt;&lt;name&gt;&gt;</code>æ¥ç»™å˜é‡èµ‹å€¼çš„åŸå› ã€‚</p><p>ä¸Šæ ¸å¿ƒä»£ç ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns leiningen.new.common  (:require   [selmer.parser :as selmer]   [leiningen.new.templates :refer [renderer raw-resourcer ->files]]   [clojure.pprint :refer [code-dispatch pprint with-pprint-dispatch]]   [clojure.string :as string]   [clojure.java.io :as io]))(def template-name "hc-template")(defn render-template [template options]  (selmer/render   (str "<% safe %>" template "<% endsafe %>")   options   {:tag-open \< :tag-close \> :filter-open \< :filter-close \>}))(defn init-render []  (renderer template-name render-template))(defn slurp-resource [path]  (-> (str "leiningen/new/hc_template/" path)      io/resource      slurp))(selmer/add-tag! :include (fn [args context-map]   (-> (slurp-resource (first args))       (render-template context-map)       (string/replace #"^\n+" "")       (string/replace #"\n+$" ""))))(defn render-asset [render options asset]  (if (string? asset)    asset    (let [[target source] asset]      [target (render source options)])))(defn render-assets [assets binary-assets options]  (let [render (init-render)        raw (raw-resourcer template-name)]    (apply ->files options           (into            (map (partial render-asset render options) assets)            (map (fn [[target source]] [target (raw source)]) binary-assets)))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦åŠ è½½çš„èµ„æºæ–‡ä»¶ç›®å½•æ˜¯<code>sources/leiningen/new/hc_template</code>ç›®å½•ä¸‹ï¼ŒåŠ è½½æ–‡ä»¶ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns leiningen.new.hc-template  (:require [leiningen.new.templates :refer [multi-segment sanitize-ns renderer                                              name-to-path ->files project-name year sanitize]]            [leiningen.core.main :as main]            [selmer.parser :as selmer]            [clojure.string :as string]            [leiningen.new.common :refer :all]            [clojure.java.io :as io]))(def timestamp (.format                (java.text.SimpleDateFormat. "yyyyMMddHHmmss")                (java.util.Date.)))(def project-assets  [["dev-config.edn"    "dev-config.edn"]   [".gitignore"        "gitignore" ]   ["Procfile"          "Procfile" ]   ["project.clj"       "project.clj" ]   ["Dockerfile"        "Dockerfile" ]   ["Capstanfile"       "Capstanfile" ]   ["README.md"         "README.md"]   ["shadow-cljs.edn"   "shadow-cljs.edn" ]   ["package.json"      "package.json" ]])(def clj-core-assets  [["{{backend-path}}/{{sanitized}}/core.clj"             "src/clj/core.clj"]   ["{{backend-path}}/{{sanitized}}/nrepl.clj"            "src/clj/nrepl.clj" ]   ["{{backend-path}}/{{sanitized}}/config.clj"           "src/clj/config.clj"]   ["{{backend-path}}/{{sanitized}}/handler.clj"          "src/clj/handler.clj"]   ["{{backend-path}}/{{sanitized}}/middleware.clj"       "src/clj/middleware.clj"]   ["{{backend-path}}/{{sanitized}}/middleware/formats.clj"     "src/clj/middleware/formats.clj"]   ["{{backend-path}}/{{sanitized}}/middleware/exception.clj"   "src/clj/middleware/exception.clj"]   ["{{backend-path}}/{{sanitized}}/db/core.clj"             "src/clj/db/core.clj"]   ["{{backend-path}}/{{sanitized}}/routes/services.clj"     "src/clj/routes/services.clj"]   ["{{backend-path}}/{{sanitized}}/routes/guestbook.clj"     "src/clj/routes/guestbook.clj"]   ;;test   ["{{backend-test-path}}/{{sanitized}}/test/handler.clj"   "test/clj/handler.clj"]   ["{{backend-test-path}}/{{sanitized}}/test/db/core.clj"   "test/clj/db/core.clj"]   ;; hc clj   ["{{backend-path}}/{{sanitized}}/db/redis.clj"            "src/clj/db/redis.clj"]   ["{{backend-path}}/{{sanitized}}/common/result.clj"            "src/clj/common/result.clj"]]);;è¿™é‡Œè¿˜æœ‰å…¶ä»–å¾ˆå¤šä»£ç ã€‚ã€‚ã€‚ã€‚ã€‚(def db-assets  [[(str "{{resource-path}}/migrations/" timestamp "-add-users-table.down.sql")   "resources/migrations/20190831145908-add-users-table.down.sql"]   [(str "{{resource-path}}/migrations/" timestamp "-add-users-table.up.sql")   "resources/migrations/20190831145908-add-users-table.up.sql"]   ["{{resource-path}}/sql/queries.sql"   "resources/sql/queries.sql"]])(def binary-assets  [["{{resource-path}}/public/favicon.ico"  "resources/public/favicon.ico"]   ["{{resource-path}}/public/index.html"   "resources/public/index.html"]   ["{{resource-path}}/public/img/warning_clojure.png"  "resources/public/img/warning_clojure.png"]])(def core-assets  (vec (concat project-assets               clj-core-aeests               environment-assets               db-assets               cljs-core-assets               system-assets)))(def project-relative-paths  {:backend-path      "src/clj"   :backend-test-path "test/clj"   :client-path       "src/cljs"   :client-test-path  "test/cljs"   :resource-path     "resources"   :cljc-path         "src/cljc"   :db-path           "src/clj"   :source-paths      ["src/clj"]   :resource-paths    ["resources"]   :now               (java.util.Date.)})(def render (renderer "hc-template" render-template))(defn generate-project  "Create a new Luminus project"  [options]  (main/info "Generating a hc-template project.")  (main/info "Please read README.md firstly!!!")    (render-assets core-assets binary-assets  options))(defn hc-template  "init function"  [name]  (let [options (merge                 project-relative-paths                 {:name             (project-name name)                  :selmer-renderer  render-template                  :min-lein-version "2.0.0"                  :project-ns       (sanitize-ns name)                  :sanitized        (name-to-path name)                  :year             (year)                  })]    (generate-project options)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ¨¡æ¿å¼€å‘å’Œæµ‹è¯•"><a href="#æ¨¡æ¿å¼€å‘å’Œæµ‹è¯•" class="headerlink" title="æ¨¡æ¿å¼€å‘å’Œæµ‹è¯•"></a>æ¨¡æ¿å¼€å‘å’Œæµ‹è¯•</h2><blockquote><p>æºä»£ç ç›®å½•ï¼š resources/leiningen/new/hc_template/<br>åŠ è½½æ¨¡æ¿æ–‡ä»¶ï¼šsrc/leiningen/new/hc_template.clj</p></blockquote><p><strong>å¼€å‘æ­¥éª¤ï¼š</strong></p><ol><li>å°†è‡ªå·±çš„ä»£ç æ–‡ä»¶ä¿å­˜åœ¨resources/leiningen/new/hc_template/å¯¹åº”çš„ç›®å½•ä¸‹ã€‚</li><li>ä¿®æ”¹æ–‡ä»¶çš„namespaceåç§°ä¸ºå¾…èµ‹å€¼çš„<code>&lt;&lt;project-ns&gt;&gt;</code>,éœ€è¦å¼•å…¥çš„å…¶ä»–å˜é‡ä¹Ÿä¸€æ ·ç”¨å°–æ‹¬å·æ‹¬èµ·æ¥ï¼Œæ¯”å¦‚é¡¹ç›®åç§°&lt;<name>&gt;ã€‚</name></li><li>å°†è‡ªå·±çš„æºä»£ç åœ¨<code>src/leiningen/new/hc_template.clj</code> åŠ å…¥åˆ°renderé˜Ÿåˆ—é‡Œã€‚</li><li>cdåˆ°æ¨¡æ¿é¡¹ç›®rcclojuretemplateï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤<pre class="line-numbers language-shell"><code class="language-shell">lein new hc-template test<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>testing ç›®å½•åˆ™ä¸ºç”¨æ¨¡æ¿åˆ›å»ºçš„ç›®æ ‡å·¥ç¨‹</li><li>è¿è¡Œå‰ç«¯ï¼Œåˆ†åˆ«æ‰§è¡Œ<pre class="line-numbers language-shell"><code class="language-shell">yarn <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>å¯åŠ¨<pre class="line-numbers language-shell"><code class="language-shell">yarn start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>å¯åŠ¨ååœ¨æµè§ˆå™¨æœ¬åœ°9630ç«¯å£æŸ¥çœ‹é¡¹ç›®ç¼–è¯‘æƒ…å†µï¼Œ8000ç«¯å£æŸ¥çœ‹å‰ç«¯é¡µé¢æ˜¯å¦åŠ è½½æ­£å¸¸</li><li>è¿è¡Œåç«¯ï¼šé€šè¿‡ideå¯åŠ¨åå°é¡¹ç›®ï¼ŒæŸ¥çœ‹èƒ½å¦æ­£å¸¸å¯åŠ¨ï¼ŒæŸ¥çœ‹3000ç«¯å£swaggeræ˜¾ç¤ºå¦èƒ½æ­£å¸¸æ˜¾ç¤º</li><li>å‰åå°éƒ½æµ‹è¯•é€šè¿‡åï¼Œåˆ é™¤testingç›®å½•ï¼Œæäº¤æºä»£ç ã€‚</li><li>éƒ¨ç½²æ›´æ–°ï¼šä¿®æ”¹æ ¹ç›®å½•ä¸‹<code>project.clj</code>é‡Œçš„ç‰ˆæœ¬å·ï¼Œæœ€åä¸€ä½+1å³å¯ï¼Œ<br>é€šè¿‡å‘½ä»¤<code>lein deploy</code>éƒ¨ç½²æœ€æ–°ç‰ˆï¼Œè´¦å·å¯†ç ï¼šmarvin/Mw99267@,é¦–æ¬¡éƒ¨ç½²ï¼Œä¼šæœ‰releaseç‰ˆæœ¬æˆæƒé”™è¯¯æç¤ºï¼Œéœ€è¦å®‰è£…gpgï¼Œå…³äºgpgçš„ä½¿ç”¨ï¼Œè¯·å‚è€ƒ</li></ol><ul><li><a href="https://www.leadroyal.cn/?p=502">GPGå…¬ç§é’¥çš„ä½¿ç”¨å’ŒQ&amp;A</a></li><li><a href="https://www.cnblogs.com/wxisme/p/8728008.html">è®°ä¸€æ¬¡å‘mavenä¸­å¤®ä»“åº“æäº¤ä¾èµ–åŒ…</a></li></ul><ol start="10"><li>å¦‚æœæœ¬åœ°æ›´æ–°æµ‹è¯•ä¸å……åˆ†æˆ–è€…ä¸æƒ³é…ç½®gpgï¼Œå¯ä»¥å…ˆpushä»£ç ï¼Œæ‰¾é©¬æµ·å¼ºå‘å¸ƒæ–°ç‰ˆæœ¬ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> clojure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql è‡ªåŠ¨å¤‡ä»½</title>
      <link href="2019/09/30/mysql-zi-dong-bei-fen/"/>
      <url>2019/09/30/mysql-zi-dong-bei-fen/</url>
      
        <content type="html"><![CDATA[<p>åœ¨linuxä¸Šå®‰è£…mysql å®šæ—¶ä»»åŠ¡è¿è¡Œå¤‡ä»½è„šæœ¬<br><a href="https://www.jianshu.com/p/9b889fab0991">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>è„šæœ¬æ–‡ä»¶ä½ç½®ï¼š/opt/chuangke/db/script/mysql_backup.sh<br>dbå¤‡ä»½æ–‡ä»¶ï¼š/opt/chuangke/db/backup<br>å¤‡ä»½è„šæœ¬ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/bash#==============================================================================#TITLE:            mysql_backup.sh#DESCRIPTION:      script for automating the daily mysql backups on development computer#USAGE:            ./mysql_backup.sh#CRON:  # example cron for daily db backup @ 9:15 am  # min  hr mday month wday command  # 15   9  *    *     *    /Users/[your user name]/scripts/mysql_backup.sh#RESTORE FROM BACKUP  #$ gunzip < [backupfile.sql.gz] | mysql -u [uname] -p[pass] [dbname]#==============================================================================# CUSTOM SETTINGS#==============================================================================# directory to put the backup filesBACKUP_DIR=/opt/chuangke/db/backup# MYSQL ParametersMYSQL_UNAME=user2018MYSQL_PWORD=9bJk!mDp@58.# Don't backup databases with these names # Example: starts with mysql (^mysql) or ends with _schema (_schema$)IGNORE_DB="(^mysql|_schema$)"# include mysql and mysqldump binaries for cron bash userPATH=$PATH:/usr/local/mysql/bin# Number of days to keep backupsKEEP_BACKUPS_FOR=30 #days#==============================================================================# METHODS#==============================================================================# YYYY-MM-DDTIMESTAMP=$(date +%F)function delete_old_backups(){  echo "Deleting $BACKUP_DIR/*.sql.gz older than $KEEP_BACKUPS_FOR days"  find $BACKUP_DIR -type f -name "*.sql.gz" -mtime +$KEEP_BACKUPS_FOR -exec rm {} \;}function mysql_login() {  local mysql_login="-u $MYSQL_UNAME"   if [ -n "$MYSQL_PWORD" ]; then    local mysql_login+=" -p$MYSQL_PWORD"   fi  echo $mysql_login}function database_list() {  local show_databases_sql="SHOW DATABASES WHERE \`Database\` NOT REGEXP '$IGNORE_DB'"  echo $(mysql $(mysql_login) -e "$show_databases_sql"|awk -F " " '{if (NR!=1) print $1}')}function echo_status(){  printf '\r';   printf ' %0.s' {0..100}   printf '\r';   printf "$1"'\r'}function backup_database(){    backup_file="$BACKUP_DIR/$TIMESTAMP.$database.sql.gz"     output+="$database => $backup_file\n"    echo_status "...backing up $count of $total databases: $database"    $(mysqldump $(mysql_login) $database | gzip -9 > $backup_file)    printf "path = ${backup_file}"    #scp copy to other server    scp $backup_file haieradmin@10.135.26.78:/opt/chuangke/db/backup/}function backup_databases(){  local databases=$(database_list)  local total=$(echo $databases | wc -w | xargs)  local output=""  local count=1  for database in $databases; do    backup_database    local count=$((count+1))  done  echo -ne $output | column -t}function hr(){  printf '=%.0s' {1..100}  printf "\n"}#==============================================================================# RUN SCRIPT#==============================================================================delete_old_backupshrbackup_databaseshrprintf "All backed up!\n\n"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ·»åŠ å®šæ—¶ä»»åŠ¡</p><pre class="line-numbers language-shell"><code class="language-shell">[root@localhost ~]# crontab [é€‰é¡¹]é€‰é¡¹:    -e:    ç¼–è¾‘crontabå®šæ—¶ä»»åŠ¡    -l:    æŸ¥è¯¢crontabä»»åŠ¡    -r:    åˆ é™¤å½“å‰ç”¨æˆ·æ‰€æœ‰çš„crontabä»»åŠ¡[root@localhost ~]# crontab -e  # ç¼–è¾‘å®šæ—¶ä»»åŠ¡# æ·»åŠ å¦‚ä¸‹å®šæ—¶ä»»åŠ¡ï¼Œä½¿ç”¨è„šæœ¬çš„æ–¹æ³•ï¼Œæ¯æ™š2ç‚¹æ‰§è¡Œ* 2 * * * /opt/chuangke/db/script/mysql_backup.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ant Design Proéƒ¨ç½²åœ¨nginxä¸Šå¸¦äºŒçº§ç›®å½•</title>
      <link href="2019/09/29/ant-design-pro-bu-shu-zai-nginx-shang-dai-er-ji-mu-lu/"/>
      <url>2019/09/29/ant-design-pro-bu-shu-zai-nginx-shang-dai-er-ji-mu-lu/</url>
      
        <content type="html"><![CDATA[<p>ä»¥éƒ¨ç½²antd proç®¡ç†ç³»ç»Ÿä¸ºä¾‹ï¼Œå°†webpacké¡¹ç›®éƒ¨ç½²åœ¨nginxçš„äºŒçº§ç›®å½•ä¸‹ã€‚</p><p><a href="https://www.jianshu.com/p/742d79bb2a64">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ä¸€èˆ¬æˆ‘ä»¬npm buildåçš„æ‰€æœ‰é™æ€æ–‡ä»¶åœ¨disté‡Œï¼Œéƒ¨ç½²åœ¨nginxçš„ç«¯å£æ ¹ç›®å½•æ˜¯ä»€ä¹ˆä¹Ÿä¸éœ€è¦åšä¿®æ”¹çš„ï¼Œä½†æ˜¯ååæœ‰æ—¶å€™å› ä¸ºèµ„æºé—®é¢˜ï¼Œéœ€è¦åœ¨åŒä¸€ä¸ªç«¯å£ä¸‹ç”¨äºŒçº§ç›®å½•æ¥åŒºåˆ†å·¥ç¨‹ã€‚</p><p>æˆ‘ä»¬ç°åœ¨æµè¡Œçš„js projectç¼–è¯‘åéƒ½æ˜¯åœ¨ä¸€ä¸ªdiståç§°çš„ç›®å½•ä¸‹ï¼Œå…¥å£æ–‡ä»¶ä¸€èˆ¬æ˜¯index.htmlï¼ŒAnt design proä¹Ÿæ²¡æœ‰ä¾‹å¤–ã€‚<br>åˆ†ä¸¤ç§æƒ…å†µçœ‹ç°çŠ¶ã€‚</p><h3 id="1ã€-éƒ¨ç½²åœ¨nginxç«¯å£çš„è·Ÿç›®å½•"><a href="#1ã€-éƒ¨ç½²åœ¨nginxç«¯å£çš„è·Ÿç›®å½•" class="headerlink" title="1ã€ éƒ¨ç½²åœ¨nginxç«¯å£çš„è·Ÿç›®å½•"></a>1ã€ éƒ¨ç½²åœ¨nginxç«¯å£çš„è·Ÿç›®å½•</h3><p><code>yarn build</code>å‘½ä»¤åå°†distæ–‡ä»¶å¤¹ä¸‹çš„ç›®å½•copyåˆ°nginxèƒ½è®¿é—®åˆ°çš„æŒ‡å®šç›®å½•ï¼Œæ¯”å¦‚æœ¬æ–‡çš„<code>/opt/site/test/antd-pro</code><br>å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">root@instance-ffkcm2y2:/opt/site/test/antd-pro# pwd/opt/site/test/antd-proroot@instance-ffkcm2y2:/opt/site/test/antd-pro# ls28.614fa0c1.async.js                     p__404.2636ef73.async.js                                   p__profile__advanced__model.ts.53b2cc97.async.js29.e6e2e94a.async.js                     p__account__center__model.ts.e7d2b570.async.js             p__profile__basic__model.ts.666ea347.async.js30.ed953c68.async.js                     p__account__settings__model.ts.18871ae5.async.js           p__user__login.42c71fa9.async.js31.26eb59f0.async.js                     p__dashboard__analysis__model.tsx.d7334d5e.async.js        p__user__login.69c29ea4.chunk.css32.858d1d30.async.js                     p__dashboard__monitor__model.ts.2295eb87.async.js          p__user__login__model.ts.d7f50bee.async.jsasset-manifest.json                      p__dashboard__workplace__model.ts.25c12073.async.js        p__user__register.440437ac.chunk.cssfavicon.png                              p__form__advanced-form__model.ts.83317f1b.async.js         p__user__register.a695f9b3.async.jsicons                                    p__form__basic-form__model.ts.4ec9fad5.async.js            p__user__register__model.ts.474a7318.async.jsindex.html                               p__form__step-form__model.ts.2182323a.async.js             p__user__register-result.3718897d.async.jslayouts__BasicLayout.6bb2089d.chunk.css  p__list__basic-list__model.ts.ee583322.async.js            p__user__register-result.b1bdabda.chunk.csslayouts__BasicLayout.d3a07379.async.js   p__list__card-list__model.ts.a5f25999.async.js             umi.0385b6b1.csslayouts__BlankLayout.17fcb893.async.js   p__list__search__applications__model.ts.05817605.async.js  umi.1ffff763.jslayouts__BlankLayout.6a502b55.chunk.css  p__list__search__articles__model.ts.9b3e67e3.async.js      vendors.1acb639b.chunk.csslayouts__UserLayout.265c2404.async.js    p__list__search__projects__model.ts.b50103cf.async.js      vendors.bda2d737.async.jslayouts__UserLayout.50d9ab78.chunk.css   p__list__table-list__model.ts.7288e948.async.js            viz.40029ece.async.jsroot@instance-ffkcm2y2:/opt/site/test/antd-pro#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>nginxçš„é…ç½®æ–‡ä»¶:</p><pre class="line-numbers language-shell"><code class="language-shell">root@instance-ffkcm2y2:/usr/local/nginx/conf/vhost# cat antd.test.5055.confserver    {        listen       5055;    server_name  182.61.51.177;        index index.html;        root /opt/site/test/antd-pro/;    location / {        try_files $uri $uri/ /doc.html;        }        location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$        {            expires      30d;        }        location ~ .*\.(js|css)?$        {            expires      12h;        }        location ~ /\.        {            deny all;        }    access_log  /opt/nginxlog/antd-pro-access.log;    }root@instance-ffkcm2y2:/usr/local/nginx/conf/vhost#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®çœ‹çœ‹<br><img src="/loading.gif" data-original="/images/fontend/antd-nginx.png" alt="éƒ¨ç½²åœ¨æ ¹ç›®å½•"><br>æ‰€æœ‰jså’Œcssç›´æ¥åœ¨ç«¯å£ä»¥ä¸‹é¦–å±‚ã€‚</p><h3 id="2ã€éƒ¨ç½²æ—¶æºå¸¦äºŒçº§ç›®å½•"><a href="#2ã€éƒ¨ç½²æ—¶æºå¸¦äºŒçº§ç›®å½•" class="headerlink" title="2ã€éƒ¨ç½²æ—¶æºå¸¦äºŒçº§ç›®å½•"></a>2ã€éƒ¨ç½²æ—¶æºå¸¦äºŒçº§ç›®å½•</h3><ul><li>1ã€ä¿®æ”¹å·¥ç¨‹æ ¹ç›®å½•ä¸‹çš„config/config.jsæ–‡ä»¶<br><img src="/loading.gif" data-original="/images/fontend/antd-baseurl.png" alt="diff"><br>ä¸¤å¤„ä¿®æ”¹ï¼Œ<blockquote><p>export defaultä¸‹å¢åŠ <code>base</code>å’Œ<code>publicPath</code>ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«é…ç½®ä¸€æ ·çš„å‚æ•°<code>/children-path</code><br>mainfest ä¸‹ä¿®æ”¹<code>basePath</code>ä»åŸæ¥çš„â€™/â€˜æ”¹ä¸ºâ€™/children-path/â€˜ï¼Œæ³¨æ„ç»“å°¾æœ‰æ–œçº¿ã€‚</p></blockquote></li></ul><p>ä¿®æ”¹ç©åé‡æ–°npm installï¼Œç„¶åæœ¬åœ°å¯åŠ¨ï¼Œæœ¬åœ°å¯åŠ¨æ²¡é—®é¢˜ï¼Œå†è¿›è¡Œä¸‹ä¸€æ­¥ã€‚<br><img src="/loading.gif" data-original="/images/fontend/antd-nginx2.png" alt="éƒ¨ç½²åˆ°äºŒçº§ç›®å½•"></p><ul><li><p>2ã€æ‰“åŒ…dist</p></li><li><p>3ã€å°†distä¸Šä¼ åˆ°ç›®æ ‡æœåŠ¡å™¨</p></li><li><p>4ã€é…ç½®nginx</p><pre class="line-numbers language-conf"><code class="language-conf">server  {      listen       5055;  server_name  182.61.51.177;      index index.html;      root /opt/site/test/antd-pro/;  location / {      try_files $uri $uri/ /doc.html;      }      location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$      {          expires      30d;      }      location ~ .*\.(js|css)?$      {          expires      12h;      }      location ~ /\.      {          deny all;      }  location /children-path {          alias /opt/site/test/antd-pro2;      }  access_log  /opt/nginxlog/antd-pro-access.log;  }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®çœ‹çœ‹æ•ˆæœ</p></li></ul><p>ç´¯èµ˜åˆ°æœ€åå‘ç°ï¼Œè‡ªå·±æ˜¯ä¸ªå¤§å‚»é€¼ï¼Œä¸çœ‹æ–‡æ¡£çš„åæœå¾ˆä¸¥é‡ã€‚</p><p>å¤šçœ‹æ–‡æ¡£ï¼<br>å¤šçœ‹æ–‡æ¡£ï¼ï¼<br>å¤šçœ‹æ–‡æ¡£ï¼ï¼ï¼<br>é‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p><p>æ–‡æ¡£åœ¨å“ªé‡Œï¼Ÿä¸æ˜¯çå­åº”è¯¥å°±èƒ½æ‰¾åˆ°ï¼š<a href="https://pro.ant.design/docs/deploy-cn">https://pro.ant.design/docs/deploy-cn</a></p>]]></content>
      
      
      <categories>
          
          <category> åå°ç®¡ç†ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Antd Pro </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥ä½œä¸­å¸¸ç”¨çš„SQL</title>
      <link href="2019/08/27/mysql-gong-zuo-zhong-chang-yong-de-sql/"/>
      <url>2019/08/27/mysql-gong-zuo-zhong-chang-yong-de-sql/</url>
      
        <content type="html"><![CDATA[<p>å·¥ä½œä¸­å¶å°”ç”¨ä½†æ˜¯åˆå¾ˆå®¹æ˜“å¿˜è®°çš„sql</p><p><a href="https://www.jianshu.com/p/1d3afffe1284">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ç°åœ¨é¡¹ç›®ä¸­ç”¨çš„æœ€å¤šçš„æ˜¯å…è´¹çš„mysqlï¼Œå› æ­¤ä¸‹é¢çš„sqlåªä¿è¯åœ¨mysqlä¸Šå¥æ•ˆã€‚</p><h2 id="1ã€æ—¶é—´æˆ³æ ¼å¼åŒ–-amp-case-when"><a href="#1ã€æ—¶é—´æˆ³æ ¼å¼åŒ–-amp-case-when" class="headerlink" title="1ã€æ—¶é—´æˆ³æ ¼å¼åŒ– &amp; case-when"></a>1ã€æ—¶é—´æˆ³æ ¼å¼åŒ– &amp; case-when</h2><p>æŸ¥è¯¢ç³»ç»Ÿå‘æ”¾çš„çº¢åŒ…çš„æœ‰æ•ˆæ—¶é—´å’ŒçŠ¶æ€ï¼š</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span>    <span class="token number">a</span><span class="token punctuation">.</span>amount çº¢åŒ…é¢é¢<span class="token punctuation">,</span>    <span class="token number">a</span><span class="token punctuation">.</span>member_phone é¢†å–äºº<span class="token punctuation">,</span>    <span class="token number">a</span><span class="token punctuation">.</span>amount_range ä½¿ç”¨é—¨æ§›<span class="token punctuation">,</span>    FROM_UNIXTIME<span class="token punctuation">(</span>        <span class="token keyword">LEFT</span> <span class="token punctuation">(</span> <span class="token number">a</span><span class="token punctuation">.</span>rule_start<span class="token punctuation">,</span> <span class="token number">10</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token string">'%Y-%m-%d %T'</span>     <span class="token punctuation">)</span> ç”Ÿæ•ˆæ—¶é—´<span class="token punctuation">,</span>    FROM_UNIXTIME<span class="token punctuation">(</span>        <span class="token keyword">LEFT</span> <span class="token punctuation">(</span> <span class="token number">a</span><span class="token punctuation">.</span>rule_end<span class="token punctuation">,</span> <span class="token number">10</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token string">'%Y-%m-%d %T'</span>     <span class="token punctuation">)</span> è¿‡æœŸæ—¶é—´<span class="token punctuation">,</span>    <span class="token number">a</span><span class="token punctuation">.</span>send_time å‘é€æ—¶é—´<span class="token punctuation">,</span><span class="token keyword">CASE</span>        <span class="token number">a</span><span class="token punctuation">.</span><span class="token punctuation">`</span><span class="token keyword">status</span><span class="token punctuation">`</span>         <span class="token keyword">WHEN</span> <span class="token string">'10'</span> <span class="token keyword">THEN</span>        <span class="token string">'æœªä½¿ç”¨'</span>         <span class="token keyword">WHEN</span> <span class="token string">'20'</span> <span class="token keyword">THEN</span>        <span class="token string">'å·²ä½¿ç”¨'</span>         <span class="token keyword">WHEN</span> <span class="token string">'30'</span> <span class="token keyword">THEN</span>        <span class="token string">'å°†è¿‡æœŸ'</span>         <span class="token keyword">WHEN</span> <span class="token string">'40'</span> <span class="token keyword">THEN</span>        <span class="token string">'å·²è¿‡æœŸ'</span>         <span class="token keyword">WHEN</span> <span class="token string">'50'</span> <span class="token keyword">THEN</span>        <span class="token string">'å·²å ç”¨'</span> <span class="token keyword">ELSE</span> <span class="token string">'å…¶ä»–'</span>     <span class="token keyword">END</span> <span class="token keyword">AS</span> <span class="token string">'å½“å‰çŠ¶æ€'</span><span class="token punctuation">,</span>    <span class="token number">a</span><span class="token punctuation">.</span>useage_range_name ä½¿ç”¨èŒƒå›´<span class="token punctuation">,</span>    <span class="token number">b</span><span class="token punctuation">.</span>remarks æ´»åŠ¨åç§°<span class="token punctuation">,</span>    <span class="token number">b</span><span class="token punctuation">.</span>rule_start è§„åˆ™å¼€å§‹æ—¶é—´<span class="token punctuation">,</span>    <span class="token number">b</span><span class="token punctuation">.</span>rule_end è§„åˆ™æˆªæ­¢æ—¶é—´<span class="token punctuation">,</span>    <span class="token number">a</span><span class="token punctuation">.</span><span class="token punctuation">`</span>use_date<span class="token punctuation">`</span> <span class="token keyword">AS</span> ä½¿ç”¨æˆ–è¿‡æœŸæ—¶é—´ <span class="token keyword">FROM</span>    <span class="token punctuation">`</span>hl_benefit_redpackage_user<span class="token punctuation">`</span> <span class="token number">a</span>    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> <span class="token punctuation">`</span>hl_benefit_redpackage<span class="token punctuation">`</span> <span class="token number">b</span> <span class="token keyword">ON</span> <span class="token number">a</span><span class="token punctuation">.</span>redpackage_id <span class="token operator">=</span> <span class="token number">b</span><span class="token punctuation">.</span>redpackage_id <span class="token keyword">WHERE</span>    <span class="token number">a</span><span class="token punctuation">.</span>redpackage_id <span class="token operator">!=</span> <span class="token string">''</span>     <span class="token operator">AND</span> <span class="token operator">!</span> ISNULL<span class="token punctuation">(</span> <span class="token number">a</span><span class="token punctuation">.</span>redpackage_id <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2ã€group-byçš„åˆç†ä½¿ç”¨"><a href="#2ã€group-byçš„åˆç†ä½¿ç”¨" class="headerlink" title="2ã€group byçš„åˆç†ä½¿ç”¨"></a>2ã€group byçš„åˆç†ä½¿ç”¨</h2><p>ä¸€èˆ¬åœ°ï¼Œselectåé¢åªèƒ½æ˜¯group by çš„å­—æ®µæˆ–è€…è·Ÿäº›èšåˆå‡½æ•°ï¼Œæ¯”å¦‚æŸ¥è¯¢æŸå¤©ä»¥åæ²¡å¤©æ³¨å†Œç”¨æˆ·æ•°é‡ï¼š</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span>    DATE_FORMAT<span class="token punctuation">(</span> member_regist_time<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'æ—¥æœŸ'</span><span class="token punctuation">,</span>    <span class="token function">COUNT</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'ç”¨æˆ·æ•°'</span> <span class="token keyword">FROM</span>    hl_member <span class="token keyword">WHERE</span>    DATE_FORMAT<span class="token punctuation">(</span> member_regist_time<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span> <span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token string">'2015-08-20'</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span>    DATE_FORMAT<span class="token punctuation">(</span> member_regist_time<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ç§æŸ¥è¯¢èƒ½å‡ºçš„å­—æ®µæœ‰é™ï¼Œé‚£ä¹ˆå¦‚æœè¦æŸ¥å‡ºæ›´å¤šï¼ŒåŒæ—¶groupå‘¢ï¼Ÿ</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id <span class="token operator">in</span><span class="token punctuation">(</span>   <span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'Java3y'</span> <span class="token operator">and</span> pv <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">and</span> time<span class="token operator">=</span><span class="token string">'7-25'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> name<span class="token punctuation">,</span>pv<span class="token punctuation">,</span>time<span class="token punctuation">;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å°†æŸ¥è¯¢åçš„ç»“æœä½œä¸ºå­æŸ¥è¯¢ï¼Œæ”¾åœ¨å¤–éƒ¨æŸ¥è¯¢çš„where å­å¥åï¼Œè¿™æ ·å¤–éƒ¨æŸ¥è¯¢æ˜¯å¯ä»¥select å‡ºå…¶ä»–å­—æ®µçš„ã€‚<br>è¿˜æœ‰ä¸€ä¸ªå¸¸è§åœºæ™¯é‚£å°±æ˜¯æŸ¥è¯¢ä¸€ä¸ªè¡¨æŸäº›å­—æ®µé‡å¤çš„æ•°æ®</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span>    <span class="token operator">*</span> <span class="token keyword">FROM</span>    hl_custom_item <span class="token number">a</span> <span class="token keyword">WHERE</span>    <span class="token punctuation">(</span> <span class="token number">a</span><span class="token punctuation">.</span>custom_item_name<span class="token punctuation">,</span> <span class="token number">a</span><span class="token punctuation">.</span>parent_id <span class="token punctuation">)</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span>    custom_item_name<span class="token punctuation">,</span>    parent_id <span class="token keyword">FROM</span>    hl_custom_item <span class="token keyword">GROUP</span> <span class="token keyword">BY</span>    custom_item_name<span class="token punctuation">,</span>    parent_id <span class="token keyword">HAVING</span>    <span class="token function">COUNT</span><span class="token punctuation">(</span> <span class="token operator">*</span> <span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span>     <span class="token punctuation">)</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span>    custom_item_name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3ã€select-update"><a href="#3ã€select-update" class="headerlink" title="3ã€select update"></a>3ã€select update</h2><p>æ›´æ–°ä¼šå‘˜é¢†å–çº¢åŒ…è¡¨çš„æ‰‹æœºå·ä¸ºä¼šå‘˜è¡¨çš„æ‰‹æœºå· </p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">UPDATE</span> <span class="token punctuation">`</span>hl_benefit_redpackage_user<span class="token punctuation">`</span> <span class="token number">a</span><span class="token keyword">SET</span> <span class="token number">a</span><span class="token punctuation">.</span>member_phone <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token number">b</span><span class="token punctuation">.</span>member_phone_no <span class="token keyword">FROM</span> <span class="token punctuation">`</span>hl_member<span class="token punctuation">`</span> <span class="token number">b</span> <span class="token keyword">where</span> <span class="token number">a</span><span class="token punctuation">.</span>member_id<span class="token operator">=</span><span class="token number">b</span><span class="token punctuation">.</span>member_Id<span class="token punctuation">)</span><span class="token keyword">where</span> <span class="token number">a</span><span class="token punctuation">.</span>member_id <span class="token operator">!=</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4ã€-update-select"><a href="#4ã€-update-select" class="headerlink" title="4ã€ update select"></a>4ã€ update select</h2><p>éƒ¨é—¨è¡¨ç¤ºä¸ªæ ‘ç»“æ„çš„è¡¨ï¼Œé‡Œé¢æœ‰å‡ ä¸‡æ¡æ•°æ®ï¼Œæ›´æ–°æ—¶ä¼šæœ‰æ•ˆç‡é—®é¢˜ï¼ŒåŸSQLå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">UPDATE</span> t_department <span class="token number">d</span> <span class="token keyword">set</span> <span class="token number">d</span><span class="token punctuation">.</span>parent_id<span class="token operator">=</span>dept_id <span class="token punctuation">,</span><span class="token number">d</span><span class="token punctuation">.</span>update_time<span class="token operator">=</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">WHERE</span> <span class="token number">d</span><span class="token punctuation">.</span>dept_code <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>dept_code <span class="token keyword">FROM</span>  t_idm_department t<span class="token keyword">where</span> t<span class="token punctuation">.</span>parent_code<span class="token operator">=</span>NEW<span class="token punctuation">.</span>dept_code<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¼˜åŒ–SQLå¦‚ä¸‹</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">UPDATE</span> t_department <span class="token number">d</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>dept_code <span class="token keyword">FROM</span>  t_idm_department t<span class="token keyword">where</span> t<span class="token punctuation">.</span>parent_code<span class="token operator">=</span>NEW<span class="token punctuation">.</span>dept_code<span class="token punctuation">)</span> <span class="token number">e</span> <span class="token keyword">on</span> <span class="token number">d</span><span class="token punctuation">.</span>dept_code <span class="token operator">=</span> <span class="token number">e</span><span class="token punctuation">.</span>dept_code <span class="token keyword">set</span> <span class="token number">d</span><span class="token punctuation">.</span>parent_id<span class="token operator">=</span>dept_id <span class="token punctuation">,</span><span class="token number">d</span><span class="token punctuation">.</span>update_time<span class="token operator">=</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5ã€insert-select"><a href="#5ã€insert-select" class="headerlink" title="5ã€insert select"></a>5ã€insert select</h2><p>å°†ä»æ‚£è€…è¡¨æŸ¥å‡ºçš„æ•°æ®æŸäº›å­—æ®µæ’å…¥åˆ°ä¸€ä¸ªæ–°çš„è¡¨</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_wx_user <span class="token punctuation">(</span>id<span class="token punctuation">,</span> openid<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> nick_name<span class="token punctuation">,</span> headimgurl<span class="token punctuation">,</span> create_time<span class="token punctuation">)</span><span class="token keyword">SELECT</span> patient_id<span class="token punctuation">,</span> openid<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> nick_name<span class="token punctuation">,</span> headimgurl<span class="token punctuation">,</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">FROM</span> t_patient<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.jianshu.com/p/963428f2abf7">åœ¨å·¥ä½œä¸­å¸¸ç”¨åˆ°çš„SQL</a></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojureScript é›¶é›¶ç¢ç¢</title>
      <link href="2019/08/27/clojurescript-ling-ling-sui-sui/"/>
      <url>2019/08/27/clojurescript-ling-ling-sui-sui/</url>
      
        <content type="html"><![CDATA[<p>clojure script åšå‰ç«¯ç‚¹ç‚¹æ»´æ»´é›¶ç¢çŸ¥è¯†æ€»ç»“</p><p><a href="https://www.jianshu.com/p/976d373a2f95">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="æ§åˆ¶å°æŸ¥çœ‹dbä¿¡æ¯"><a href="#æ§åˆ¶å°æŸ¥çœ‹dbä¿¡æ¯" class="headerlink" title="æ§åˆ¶å°æŸ¥çœ‹dbä¿¡æ¯"></a>æ§åˆ¶å°æŸ¥çœ‹dbä¿¡æ¯</h2><p>åœ¨æµè§ˆå™¨ä¸­å¼€å¯è‡ªå®šä¹‰æ—¥å¿—åå¯ä»¥åœ¨consoleä¸­æŸ¥çœ‹re-frameç®¡ç†çš„dbé‡Œçš„å†…å®¹ï¼ŒåŠ æ ¼å¼åŒ–ã€‚<br>å¼€å¯æ–¹å¼ï¼š<a href="https://github.com/binaryage/cljs-devtools/blob/master/docs/faq.md#why-some-custom-formatters-were-not-rendered">https://github.com/binaryage/cljs-devtools/blob/master/docs/faq.md#why-some-custom-formatters-were-not-rendered</a><br><img src="/loading.gif" data-original="/images/cljs/chrome-setting.png" alt="open chrome setting"><br><img src="/loading.gif" data-original="/images/cljs/chrome-enable-custom-formatters.png" alt="Enable custom formatters"></p><p>åœ¨consoleé‡Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹</p><pre><code>re_frame.db.app_db.state</code></pre><p>æ•ˆæœï¼š<br><img src="/loading.gif" data-original="/images/cljs/re-frame-db-state.png" alt="re_frame.db.app_db.state"></p><h2 id="ç”¨kee-frameå’Œre-frameä¿®æ”¹dbçš„å€¼"><a href="#ç”¨kee-frameå’Œre-frameä¿®æ”¹dbçš„å€¼" class="headerlink" title="ç”¨kee-frameå’Œre-frameä¿®æ”¹dbçš„å€¼"></a>ç”¨kee-frameå’Œre-frameä¿®æ”¹dbçš„å€¼</h2><p>ç›®æ ‡ç»™dbçš„ã€demoã€‘ä¸‹å¢åŠ ä¸€ä¸ªkeyï¼Œå€¼æ˜¯ä¸€ä¸ªajaxçš„è¿”å›ç»“æœ<br>å¼•å…¥ä¸¤ä¸ªåŒ…<code>re-frame</code>å’Œ<code>kee-frame</code></p><ul><li>ä½¿ç”¨<code>re-frame/reg-event-db</code>ä¿®æ”¹db</li></ul><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(require '[kee-frame.core :as kf])(require '[re-frame.core :as rf])(defn- concat-key [keys]  (concat [:demo] keys))(defn- data->db [db keys value]  (assoc-in db (concat-key keys) value))(kf/reg-event-fx ::demo-detail-ajax (fn [{:keys [db]} [id]]   {:http-xhrio {:uri ("http://localhost:3000/api/demo?id=" id)                 :method :get                 :timeout 10000                 :on-failure [:common/ajax-get-failuer]                 :response-format (ajax/json-response-format {:keywords? true})                 :on-success [::set-db-demo-detail]}}))(rf/reg-event-db  ::set-db-demo-detail  (fn [db [_ res]]    (data->db db [:selected :detail] (:data res))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ä¸Šé¢çš„æ“ä½œç”¨kee-frameå®ç°</li></ul><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(kf/reg-chain-named ::demo-detail-ajax (fn [ctx [params]]   {:http-xhrio {:uri ("http://localhost:3000/api/demo?id=" (:id params)                 :method :get                 :timeout 10000                 :on-failure [:common/ajax-get-failuer]                 :response-format (ajax/json-response-format {:keywords? true})}}) :å°†è¿”å›ç»“æœæ•°æ®å­˜å…¥db (fn [{:keys [db]} [_ res]]   {:db (data->db db [:demo-detail] (:data res))}))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒºåˆ«ï¼š</p><ul><li>re-frameé‡Œå‘èµ·è¯·æ±‚å’Œå­˜å‚¨dbéœ€è¦ä¸¤ä¸ªäº‹ä»¶æ¥å®ç°ï¼Œè€Œkee-frameéœ€è¦ä¸€ä¸ªï¼Œç¬¬äºŒä¸ªè¿˜å¯ä»¥èµ·ä¸­æ–‡çš„åå­—ï¼Œä¾¿äºåœ¨æ§åˆ¶å°æŸ¥çœ‹ã€‚</li><li>re-frame/reg-event-dbè¿”å›çš„æ˜¯(assoc db :key value)ï¼Œè€Œkee-frame/reg-chainè¿”å›çš„æ˜¯{:db (assoc db :key value}</li><li>kee-frameçš„è¿™ç§è¿”å›ç±»ä¼¼äºre-frame/reg-event-fxçš„å¦ä¸€ç§å½¢å¼</li></ul><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(defn h                               ;; maybe choose a better name like `delete-item` [coeffects event]                    ;; `coeffects` holds the current state of the world.   (let [item-id (second event)         ;; extract id from event vector       db      (:db coeffects)]       ;; extract the current application state   {:db  (dissoc-in db [:items item-id])})) ;; effect is "change app state to ..."(rf/reg-event-fx   ;; a part of the re-frame API  :delete-item                ;; the kind of event  h)  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™ä¸ªå¤„ç†<a href="https://github.com/Day8/re-frame">github</a>ä¸Šæ˜¯æœ‰çš„ï¼Œè¿™ä¸ªhå‡½æ•°æ¢å¯ä»¥ç®€åŒ–ä¸€ä¸‹</p></blockquote><pre class="line-numbers language-clj"><code class="language-clj">(defn h   [{:keys [db]} [_ item-id]]    ;; <--- new: obtain db and id directly  {:db  (dissoc-in db [:items item-id])}) ;; same as before<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="kee-frame-reg-chainå¤„ç†å¤šæ¬¡æœ‰ä¾èµ–è¯·æ±‚å’Œå‚æ•°ä¼ é€’"><a href="#kee-frame-reg-chainå¤„ç†å¤šæ¬¡æœ‰ä¾èµ–è¯·æ±‚å’Œå‚æ•°ä¼ é€’" class="headerlink" title="kee-frame/reg-chainå¤„ç†å¤šæ¬¡æœ‰ä¾èµ–è¯·æ±‚å’Œå‚æ•°ä¼ é€’"></a>kee-frame/reg-chainå¤„ç†å¤šæ¬¡æœ‰ä¾èµ–è¯·æ±‚å’Œå‚æ•°ä¼ é€’</h2><p>æœ‰ä¸ªè¿™æ ·çš„éœ€æ±‚ï¼Œcontrolleré‡Œstartéœ€è¦è§¦å‘ä¸æ­¢ä¸€ä¸ªajaxè¯·æ±‚æ•°æ®ä¾›é¡µé¢æ¸²æŸ“ï¼Œé€šå¸¸çš„åšæ³•æ˜¯dispatchå¤šä¸ªeventï¼Œè¿™åœ¨starté‡Œå¾ˆå¥½å†™çš„ï¼Œå› ä¸ºstartæœ¬æ¥æ¥å—å‡½æ•°æˆ–è€…eventçš„é›†åˆã€‚<br>ä½†æ˜¯å¦‚æœæˆ‘ä»¬çš„å¤šä¸ªajaxè¯·æ±‚é—´æœ‰ä¾èµ–ï¼Œæ¯”å¦‚ç¬¬äºŒä¸ªajaxéœ€è¦ä½¿ç”¨ç¬¬ä¸€ä¸ªajaxçš„è¯·æ±‚ç»“æœä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”ä¹Ÿè¦ä½¿ç”¨å‘èµ·ç¬¬ä¸€ä¸ªajaxæ—¶ä½¿ç”¨çš„å‚æ•°ï¼Œæ€ä¹ˆæå‘¢ï¼Ÿçœ‹çœ‹å®ç°ï¼š</p><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(defn data->db [db keys values]  (prn "å°†å¤šä¸ªç»“æœå­˜å…¥db"))(kf/reg-chain-named ::demo-detail-ajax1 (fn [ctx [params]]   {:http-xhrio {:uri ("http://ajax-demo1?id="                 :params params                 :method :get                 :timeout 10000                 :on-failure [:common/ajax-get-failuer]                 :response-format (ajax/json-response-format {:keywords? true})}})  ::å‘èµ·ç¬¬äºŒä¸ªè¯·æ±‚  (fn [ctx [params res1]]   {:http-xhrio {:uri ("http://ajax-demo2"                 :params params                 :method :post                 :timeout 10000                 :on-failure [:common/ajax-get-failuer]                 :response-format (ajax/json-response-format {:keywords? true})}}) :å°†ä¸Šä¸¤ä¸ªè¯·æ±‚è¿”å›ç»“æœæ•°æ®å­˜å…¥db (fn [{:keys [db]} [_ res1 res2]]   {:db (data->db db [key1 key2] [res1 res2]}))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯´æ˜ï¼šchainåœ¨reframeä¸Šæ‰©å±•çš„è¿™ä¸ªeventå‚æ•°å’Œç»“æœæ˜¯ä¸€ç›´å¾€ä¸‹ç´¯è®¡çš„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯dispatchæ—¶çš„å‚æ•°ï¼Œå¾€åæ¯ä¸ªå‡½æ•°çš„ç¬¬äºŒç»„å‚æ•°ä¾æ¬¡æ˜¯æ¯ä¸€æ¬¡è¯·æ±‚çš„ç»“æœã€‚</p><h2 id="antdçš„ç»„ä»¶ä¸­ä½¿ç”¨ç»„ä»¶"><a href="#antdçš„ç»„ä»¶ä¸­ä½¿ç”¨ç»„ä»¶" class="headerlink" title="antdçš„ç»„ä»¶ä¸­ä½¿ç”¨ç»„ä»¶"></a>antdçš„ç»„ä»¶ä¸­ä½¿ç”¨ç»„ä»¶</h2><p>ä¸€äº›ç»„ä»¶éœ€è¦çš„å±æ€§çš„å‚æ•°ç±»å‹æ˜¯ReactNodeï¼Œ æ¯”å¦‚Inputçš„prefixå±æ€§<br>è¿™éœ€è¦ <strong>ä½¿ç”¨Reagentçš„<a href="http://reagent-project.github.io/docs/master/reagent.core.html#var-as-element"><code>as-element</code></a>å‡½æ•°</strong></p><blockquote><p>(as-element form) Turns a vector of Hiccup syntax into a React element. Returns form unchanged if it is not a vector.</p></blockquote><pre class="line-numbers language-klipse-reagent"><code class="language-klipse-reagent">(defn page1 []  [:> ant/Input   {:prefix (r/as-element [:> ant/Icon {:type "user"}])}])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä¿®æ”¹é¡µé¢atomå…ƒç´ èµ‹å€¼å’Œä¿®æ”¹"><a href="#ä¿®æ”¹é¡µé¢atomå…ƒç´ èµ‹å€¼å’Œä¿®æ”¹" class="headerlink" title="ä¿®æ”¹é¡µé¢atomå…ƒç´ èµ‹å€¼å’Œä¿®æ”¹"></a>ä¿®æ”¹é¡µé¢atomå…ƒç´ èµ‹å€¼å’Œä¿®æ”¹</h2><p>åˆå­¦è€…åŒ…æ‹¬å°èœé¸¡æˆ‘æ˜¯ä¸æ˜¯ä¼šç¢°åˆ°ä¸ªé—®é¢˜ï¼Œä»dbé‡Œè®¢é˜…çš„æ•°æ®æ¸²æŸ“é¡µé¢æ—¶ç¬¬ä¸€æ¬¡æ²¡æœ‰ï¼Œç¬¬äºŒæ¬¡ä»¥åå°±éƒ½æ­£å¸¸äº†ï¼Œæˆ–è€…ä½ æƒ³ä¿®æ”¹ä¸€ä¸‹è¿™ä¸ªå€¼é‡æ–°æäº¤åˆ°æ¥å£ä¸Šï¼Œå‘ç°å€¼æ”¹ä¸äº†ã€‚</p><p>å¯èƒ½ä½ çš„ä»£ç æ˜¯è¿™æ ·çš„</p><pre class="line-numbers language-klipse-reagent"><code class="language-klipse-reagent">(defn page2 []  (let [ data @(re-frame/subscribe [:db-key])]    (fn []      [:div           [ant/input {:default-value (:name @data)                          :type "text"                          :on-change #(swap! item assoc item-str (-> % .-target .-value))}]])))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>äº¦æˆ–æ˜¯è¿™æ ·çš„:</p><pre class="line-numbers language-klipse-reagent"><code class="language-klipse-reagent">(defn page3 []  (fn []    (let data @(re-frame/subscribe [:db-key])         [:div [ant/input {:default-value (:name @data)                          :type "text"                          :on-change #(swap! item assoc item-str (-> % .-target .-value))}]])))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­å–œï¼Œè¿™ä¸¤ç§æ–¹å¼å®Œç¾è¸©é›·ï¼Œæˆ‘ä»¬å¤§ç¥è¯´å› ä¸ºæˆ‘æ²¡æœ‰çœ‹<a href="https://github.com/reagent-project/reagent">reagent</a><br>çš„Guideä¸€äºŒä¸‰ï¼Œå¥½å§ï¼Œç¡®å®æ²¡çœ‹ã€‚</p><ul><li><p>ç°çŠ¶å’ŒåŸå› </p></li><li><p>ç¬¬ä¸€ç§å†™æ³•çš„ç°çŠ¶ï¼šé¡µé¢çš„inputé‡Œç¬¬ä¸€æ¬¡æ— æ³•èµ‹å€¼</p></li><li><p>ç¬¬ä¸€ç§å†™æ³•çš„åŸå› ï¼šé¡µé¢åŠ è½½ä¸€æ¬¡ï¼Œä½†æ˜¯ç¬¬ä¸€æ¬¡è®¢é˜…ä¸åˆ°dbé‡Œçš„æ•°æ®ï¼Œå› ä¸ºdbé‡Œè¿˜æ²¡æœ‰æ•°æ®</p></li><li><p>ç¬¬äºŒç§å†™æ³•çš„ç°çŠ¶ï¼šé¡µé¢inputä¸Šæœ‰å€¼äº†ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹ï¼Œæç¤ºreactçš„valueä¸èƒ½è¢«ä¿®æ”¹</p></li><li><p>ç¬¬äºŒç§å†™æ³•çš„åŸå› ï¼šä»dbé‡Œè®¢é˜…çš„å€¼dataè®¢é˜…ä¹‹åå°±ä¸è®¢é˜…æ²¡æœ‰å…³ç³»äº†ï¼Œè¯´ç™½äº†ï¼Œä¹Ÿå°±ä¸æ˜¯atomäº†ï¼Œæ‰€ä»¥ä¸èƒ½ä¿®æ”¹ã€‚</p></li><li><p>æ–¹æ¡ˆï¼š</p><pre class="line-numbers language-klipse-reagent"><code class="language-klipse-reagent">(require '[reagent.ratom :as ratom :refer [reaction]])(def db-value (reaction @(re-frame/subscribe [:db-key])))(def change-value (atom nil))(defn page4 [](fn []  (reset! change-value @(if (nil? @db-value)                          (atom (deref (rf/subscribe [:db-key])))                          db-value))  [:div   [ant/input {:default-value (:name @db-value)               :type "text"               :on-change #(swap! item assoc item-str (-> % .-target .-value))}]]))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>å½“ç„¶ï¼Œå¦‚ä½ æ‰€çŸ¥ï¼Œå†™æ³•æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚è¿™ä¸ªchange-valueä½ å¯ä»¥åœ¨fné‡Œç”¨letå®šä¹‰ï¼Œå¹¶ä¸”æ¯”è¾ƒæ¨èã€‚</p><h2 id="kee-frame-reg-controller-æœ‰æ²¡æœ‰å¥½å¥½çœ‹æ–‡æ¡£ï¼Ÿ"><a href="#kee-frame-reg-controller-æœ‰æ²¡æœ‰å¥½å¥½çœ‹æ–‡æ¡£ï¼Ÿ" class="headerlink" title="kee-frame/reg-controller æœ‰æ²¡æœ‰å¥½å¥½çœ‹æ–‡æ¡£ï¼Ÿ"></a>kee-frame/reg-controller æœ‰æ²¡æœ‰å¥½å¥½çœ‹æ–‡æ¡£ï¼Ÿ</h2><pre class="line-numbers language-clojure"><code class="language-clojure">(defn reg-controller  "Put a controller config map into the global controller registry.  Parameters:  `id`: Must be unique in controllere registry. Will appear in logs.  `controller`: A map with the following keys:   `:params`: A function that receives the route data and returns the part that should be sent to the `start` function. A nil  return means that the controller should not run for this route.   `:start`: A function or an event vector. Called when `params` returns a non-nil value different from the previous  invocation. The function receives whatever non-nil value that was returned from `params`,  and returns a re-frame event vector. If the function does nothing but returning the vector, the surrounding function  can be omitted.   `:stop`: Optional. A function or an event vector. Called when previous invocation of `params` returned non-nil and the  current invocation returned nil. If the function does nothing but returning the vector, the surrounding function  can be omitted."  [id controller]  (when-not (s/valid? ::spec/controller controller)    (e/expound ::spec/controller controller)    (throw (ex-info "Invalid controller" (s/explain-data ::spec/controller controller))))  (when (get @state/controllers id)    (console :warn "Overwriting controller with id " id))  (swap! state/controllers update id merge controller))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>kee-frameå¼•å…¥controlleræ¥ä¼˜åŒ–è·¯ç”±è·¯ç”±ç®¡ç†ï¼Œç›‘å¬è·¯ç”±å˜åŒ–ï¼Œæ‰€ä»¥åœ¨è·¯ç”±å‘ç”Ÿ<strong>å˜åŒ–</strong>æ—¶ç¨‹åºé‡Œçš„æ‰€æœ‰controleréƒ½ä¼šç«–èµ·è€³æœµï¼Œå½“ç„¶æœ€å¥½æ˜¯åªæœ‰è¿™ä¸ªå˜åŒ–å’Œè‡ªå·±æœ‰å…³ï¼Œæ‰å»å“åº”ã€‚è¿™å°±è¦åœ¨paramsé‡ŒåŠ handlerçš„åˆ¤æ–­ã€‚</li><li>:params å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°åŒ…å«è·¯ç”±ä¿¡æ¯ï¼Œå°¤å…¶æ˜¯è·å–handleré‡Œçš„è·¯ç”±åœ°å€ï¼Œå½“ç„¶åŒ…å«å‚æ•°ã€‚å¦‚æœè¿”å›nilçš„è¯ï¼Œåé¢startå°±ä¸ä¼šæ‰§è¡Œï¼Œå…¶ä»–æƒ…å†µå°±ä¼šè§¦å‘<code>:start</code>ã€‚</li><li>:start ä¸€ä¸ªå‡½æ•°æˆ–è€…ä¸€ç»„äº‹ä»¶çš„é›†åˆï¼Œå‡½æ•°é‡Œå¯ä»¥å¤„ç†å‚æ•°ç­‰ï¼Œå¦‚æœæ˜¯ä¸€å †eventçš„è¯ï¼Œå¯ä»¥åœ¨å‡½æ•°é‡Œå‘èµ·dispatchæˆ–è€…ç›´æ¥è¿”å›<code>[:event1 ::event2]</code>ç­‰ç­‰ã€‚<br>æ¥ä¸ªåŸºç¡€çš„ä¾‹å­ï¼š</li></ul><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(kf/reg-controller :bind-user-page                  {:params (fn [params]                             (when (= :bind-user-page (get-in params [:data :name])) true))                   :start (fn []                            (prn "?????????===")                            (re-frame/dispatch [:choose-hospital]))})<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æºå¸¦queryå‚æ•°çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">;;è·¯ç”±å¸¦å‚è·³è½¬ä¸åŒé¡µé¢(kf/reg-controller :è·¯ç”±å¸¦å‚è·³è½¬ä¸åŒé¡µé¢ {:params (fn [route-data]            (when (-> route-data :data :name (= :weixin-redirect))              (:query-string route-data)))  :start (fn [_ params]           (re-frame/dispatch [:weixin-redirect                               (reduce-kv (fn [m k v]                                            (assoc m (keyword k) v))                                          {}                                          (into {} (map #(clojure.string/split % #"=") (clojure.string/split params #"&"))))]))})<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæƒ³è¦æ¯æ¬¡è·¯ç”±å˜åŒ–ï¼Œéƒ½è§¦å‘æŸä¸ªcontrollerçš„startï¼Œåªéœ€è¦åœ¨paramsé‡Œè¿”å›<code>identity </code>å³å¯ã€‚</p><h2 id="clojurescript-å’Œ-javascriptäº¤äº’"><a href="#clojurescript-å’Œ-javascriptäº¤äº’" class="headerlink" title="clojurescript å’Œ javascriptäº¤äº’"></a>clojurescript å’Œ javascriptäº¤äº’</h2><p>æœ‰æ—¶å€™æˆ‘ä»¬çš„clojurescriptéœ€è¦å’Œjavascriptäº¤äº’ã€‚<br>æ¯”å¦‚ç”¨jsæ‰“ä¸ªlogï¼Œæ¯”å¦‚ç”¨jsè·å–windowçš„locationæ•°æ®ç­‰ï¼Œä¸¾ä¸ªåˆ—å­</p><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(.log js/console "æ‰“ä¸ªlog")(.-location js/window)(.-search (.-location js/window))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>cljsè¿˜æä¾›äº†cljså’Œjsäº’è½¬çš„å‡½æ•°<code>clj-&gt;js</code>å’Œ<code>js-&gt;clj</code><br>çœ‹çœ‹ä¾‹å­ï¼š</p><pre class="line-numbers language-clj"><code class="language-clj">(def js-object (clj->js  :a 1 :b [1 2 3] :c #{"d" true :e nil}))<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºç»“æœ</p><pre><code>{  "a": 1,  "b": [1, 2, 3],  "c": [null, "d", "e", true]}</code></pre><p>ä¹Ÿå¯ä»¥ç®€åŒ–ç”¨<code>#js</code></p><pre class="line-numbers language-clj"><code class="language-clj">(def js-object #js {:a 1 :b #js [1 2 3] :c #js ["d" true :e nil]})# è¾“å‡º{  "c": {    "e": null,    "d": true  },  "b": [1, 2, 3 ],  "a": 1}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>jsæœ‰æ—¶å€™éœ€è¦è½¬æˆcljsï¼Œç”¨<code>js-&gt;clj</code>å®ç°,æ¯”å¦‚ï¼š</p><pre class="line-numbers language-klipse-cljs"><code class="language-klipse-cljs">(require '[reagent.core :as r])(defn get-form  "è¿”å›åˆFrom.createåˆ›å»ºçš„ `form` è¿™ä¸ªå‡½æ•°åªèƒ½åœ¨formå†…éƒ¨è°ƒç”¨, å› ä¸ºä½¿ç”¨äº†reaget/current-component."  []  (-> (r/current-component)      (r/props)      (js->clj :keywordize-keys true)      (:form)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤§ç¥åœ¨<a href="https://blog.3vyd.com/blog/posts-output/2019-07-20-4clojure/">4clojure</a>åšå®¢ä¸Šä¹Ÿæœ‰jsæ“ä½œDOMå’Œå¼•å…¥highchartsçš„ä½¿ç”¨çš„ä¾‹å­ã€‚<br>æ›´å¤šäº¤äº’çš„æ“ä½œå‚è€ƒ<a href="https://www.spacjer.com/blog/2014/09/12/clojurescript-javascript-interop/">ClojureScript: JavaScript Interop</a> å’Œ<br><a href="https://lwhorton.github.io/2018/10/20/clojurescript-interop-with-javascript.html">Clojurescript interop with javascript</a></p><h2 id="ç”¨figwheelç¼–è¯‘å·¥ç¨‹ï¼Œå¯åŠ¨æœåŠ¡"><a href="#ç”¨figwheelç¼–è¯‘å·¥ç¨‹ï¼Œå¯åŠ¨æœåŠ¡" class="headerlink" title="ç”¨figwheelç¼–è¯‘å·¥ç¨‹ï¼Œå¯åŠ¨æœåŠ¡"></a>ç”¨figwheelç¼–è¯‘å·¥ç¨‹ï¼Œå¯åŠ¨æœåŠ¡</h2><p>ä¸‰æ­¥å¯åŠ¨ figwheelï¼š<a href="https://github.com/bhauman/lein-figwheel/wiki/Using-the-Figwheel-REPL-within-NRepl">Using the Figwheel REPL within nREPL</a><br>åœ¨emacsé‡Œå¯åŠ¨cider-jack-in-cljs<br>é€‰æ‹©figwheel</p><pre class="line-numbers language-shell"><code class="language-shell">(use 'figwheel-sidecar.repl-api)(start-figwheel!)(cljs-repl)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åœ¨alké¡¹ç›®é‡Œçš„ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">user> (use 'figwheel-sidecar.repl-api)niluser> (start-figwheel!)Figwheel: Starting server at http://0.0.0.0:3449Figwheel: Watching build - patient-appCompiling build :patient-app to "target/cljsbuild/public/patientjs/app.js" from ["src/cljs/patient" "src/cljc" "env/dev/cljs/patient"]...Successfully compiled build :patient-app to "target/cljsbuild/public/patientjs/app.js" in 5.142 seconds.Figwheel: Starting CSS Watcher for paths  ["resources/public/css"]Figwheel: Starting nREPL server on port: 7002niluser> (cljs-repl)Launching ClojureScript REPL for build: patient-appFigwheel Controls:          (stop-autobuild)                ;; stops Figwheel autobuilder          (start-autobuild id ...)        ;; starts autobuilder focused on optional ids          (switch-to-build id ...)        ;; switches autobuilder to different build          (reset-autobuild)               ;; stops, cleans, and starts autobuilder          (reload-config)                 ;; reloads build config and resets autobuild          (build-once id ...)             ;; builds source one time          (clean-builds id ..)            ;; deletes compiled cljs target files          (print-config id ...)           ;; prints out build configurations          (fig-status)                    ;; displays current state of system          (figwheel.client/set-autoload false)    ;; will turn autoloading off          (figwheel.client/set-repl-pprint false) ;; will turn pretty printing off  Switch REPL build focus:          :cljs/quit                      ;; allows you to switch REPL to another build    Docs: (doc function-name-here)    Exit: :cljs/quit Results: Stored in vars *1, *2, *3, *e holds last exception objectPrompt will show when Figwheel connects to your applicationTo quit, type: :cljs/quitnil cljs.user> (fig-status) cljs.user> (fig-status) Figwheel System Status----------------------------------------------------Watching builds: [patient-app]Client Connections     patient-app: 1 connection----------------------------------------------------nilcljs.user> (build-once doctor-app)Figwheel: Building once - doctor-appCompiling build :doctor-app to "target/cljsbuild/public/doctorjs/app.js" from ["src/cljs/doctor" "src/cljc" "env/dev/cljs/doctor"]...Successfully compiled build :doctor-app to "target/cljsbuild/public/doctorjs/app.js" in 14.038 seconds.nilcljs.user> (fig-status) Figwheel System Status----------------------------------------------------Watching builds: [patient-app]Client Connections     patient-app: 0 connections     doctor-app: 1 connection----------------------------------------------------nilcljs.user> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”¨æµè§ˆå™¨é“¾æ¥åå¯ä»¥åœ¨replé‡ŒæŸ¥çœ‹çŠ¶æ€</p><pre class="line-numbers language-shell"><code class="language-shell">(fig-status)  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿˜æœ‰å…¶ä»–æ“ä½œï¼Œæ§åˆ¶å°æœ‰æç¤º</p><pre class="line-numbers language-shell"><code class="language-shell">user> (cljs-repl)Launching ClojureScript REPL for build: devFigwheel Controls:          (stop-autobuild)                ;; stops Figwheel autobuilder          (start-autobuild [id ...])      ;; starts autobuilder focused on optional ids          (switch-to-build id ...)        ;; switches autobuilder to different build          (reset-autobuild)               ;; stops, cleans, and starts autobuilder          (reload-config)                 ;; reloads build config and resets autobuild          (build-once [id ...])           ;; builds source one time          (clean-builds [id ..])          ;; deletes compiled cljs target files          (print-config [id ...])         ;; prints out build configurations          (fig-status)                    ;; displays current state of system  Switch REPL build focus:          :cljs/quit                      ;; allows you to switch REPL to another build    Docs: (doc function-name-here)    Exit: Control+C or :cljs/quit Results: Stored in vars *1, *2, *3, *e holds last exception objectPrompt will show when Figwheel connects to your applicationTo quit, type: :cljs/quitcljs.user><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cljs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cljs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jenkins + statistics å®ç°ä»£ç ç»Ÿè®¡</title>
      <link href="2019/08/26/jenkins-statistics-shi-xian-dai-ma-tong-ji/"/>
      <url>2019/08/26/jenkins-statistics-shi-xian-dai-ma-tong-ji/</url>
      
        <content type="html"><![CDATA[<p>git çš„statisticsç»Ÿè®¡åˆ†é¡µï¼Œå¾…é¡µé¢</p><p><a href="https://www.jianshu.com/p/69cb7d0c273e">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ä¸€ä¸ªä¸é”™çš„ä»£ç ç»Ÿè®¡æ’ä»¶<a href="http://gitstats.sourceforge.net/">statistics</a></p><h3 id="å®‰è£…statistics"><a href="#å®‰è£…statistics" class="headerlink" title="å®‰è£…statistics"></a>å®‰è£…statistics</h3><p>éœ€è¦å…ˆåœ¨æ”¶é›†ä»£ç çš„æœåŠ¡å™¨ä¸Šæ­å»ºstatisticsï¼Œå…·ä½“æ­¥éª¤ä¸Šé¢é“¾æ¥æœ‰ã€‚<br>æˆ‘æ˜¯centosç³»ç»Ÿï¼Œå› æ­¤åªéœ€ä¸€å¥å‘½ä»¤ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">yum install gitstats<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="jenkinsé…ç½®"><a href="#jenkinsé…ç½®" class="headerlink" title="jenkinsé…ç½®"></a>jenkinsé…ç½®</h3><pre class="line-numbers language-shell"><code class="language-shell">#æ‰§è¡Œè„šæœ¬echo "git stats start"/opt/auto-deploy-scripts/code_statistics.sh questionnaire masterecho "git stats end"echo "review address:http://10.138.46.76:8888/questionnaire/"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ”¶é›†è„šæœ¬code-statistics-sh"><a href="#æ”¶é›†è„šæœ¬code-statistics-sh" class="headerlink" title="æ”¶é›†è„šæœ¬code_statistics.sh"></a>æ”¶é›†è„šæœ¬code_statistics.sh</h3><pre class="line-numbers language-shell"><code class="language-shell">[root@1169CKT questionnaire]# vi /opt/auto-deploy-scripts/code_statistics.sh#!/bin/bashname=$1branch=$2if [ name == ""  ] ;then    echo "project name is null"    exit 5else    if [ branch == ""  ] ;then    branch = master    fi    echo "Deploy ${branch} of ${name} project !"    cd /opt/chuangke/gitstats/projects/${name}/    git pull    git checkout ${branch}    cd /opt/chuangke/gitstats/gitstats/    rm -rf /opt/chuangke/gitstats/result/${name}/*    ./gitstats /opt/chuangke/gitstats/projects/${name} /opt/chuangke/gitstats/result/${name}/   echo "Deploy success!"fi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å…³äºè„šæœ¬çš„ä¸€ç‚¹è§£é‡Š</p><ul><li>ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯é¡¹ç›®åï¼Œç¬¬äºŒä¸ªæ˜¯åˆ†æ”¯å</li><li><code>/opt/chuangke/gitstats/projects/${name}/</code>ç›®å½•æ˜¯$nameé¡¹ç›®ä»gitåº“pullä¸‹æ¥çš„ç›®å½•ï¼Œä¹Ÿå°±æ˜¯è¦ç»Ÿè®¡çš„ç›®æ ‡é¡¹ç›®ã€‚</li><li><code>/opt/chuangke/gitstats/result/${name}/</code>ç›®å½•æ˜¯$nameé¡¹ç›®ç»Ÿè®¡å®Œä»¥åç”Ÿæˆçš„é™æ€æ–‡ä»¶ç›®å½•ï¼Œä¹Ÿæ˜¯nginxè¦è®¿é—®çš„ç›®å½•ã€‚</li><li>gitstatsé¡¹ç›®çš„ç›®å½•ä¸‹æ‰§è¡Œ<code>gitstats</code>è„šæœ¬çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦ç»Ÿè®¡çš„é¡¹ç›®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç»Ÿè®¡æ–‡ä»¶å­˜æ”¾çš„ç›®å½•</li></ul></blockquote><h3 id="nginx-é…ç½®"><a href="#nginx-é…ç½®" class="headerlink" title="nginx é…ç½®"></a>nginx é…ç½®</h3><pre class="line-numbers language-shell"><code class="language-shell">server {        listen       8888;        server_name  localhost;        #charset koi8-r;        #access_log  logs/host.access.log  main;        #location / {        #    root   html;        #    index  index.html index.htm;        #}        index index.html index.htm;        client_max_body_size    100m;            location /questionnaire {            alias  /opt/chuangke/gitstats/result/questionnaire;        }        location /portal {            alias  /opt/chuangke/gitstats/result/Portal;        }        location /portalmanage {            alias  /opt/chuangke/gitstats/result/portalmanage;        }        error_page  404              /404.html;        # redirect server error pages to the static page /50x.html        #        error_page   500 502 503 504  /50x.html;        location = /50x.html {            root   html;        }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸ªæˆªå›¾<br><img src="/loading.gif" data-original="/images/tools/gitstats1.png" alt="gitstats1"></p><p><img src="/loading.gif" data-original="/images/tools/gitstats2.png" alt="gitstats2"></p><p><img src="/loading.gif" data-original="/images/tools/gitstats3.png" alt="gitstats3"></p><h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><p>é…ç½®çš„nginxè¦èƒ½åœ¨æµè§ˆå™¨è®¿é—®ï¼Œéœ€è¦ä¿è¯centosçš„é˜²ç«å¢™é…ç½®å“Ÿã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">å¼€å¯ç«¯å£[root@centos7 ~]# firewall-cmd --zone=public --add-port=80/tcp --permanentæŸ¥è¯¢ç«¯å£å·80 æ˜¯å¦å¼€å¯ï¼š[root@centos7 ~]# firewall-cmd --query-port=80/tcpé‡å¯é˜²ç«å¢™ï¼š[root@centos7 ~]# firewall-cmd --reloadæŸ¥è¯¢æœ‰å“ªäº›ç«¯å£æ˜¯å¼€å¯çš„:[root@centos7 ~]# firewall-cmd --list-port<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Springboot ä¹‹ åˆ©ç”¨logbackå‘é€å¼‚å¸¸è­¦å‘Šé‚®ä»¶</title>
      <link href="2019/08/24/springboot-zhi-li-yong-logback-fa-song-yi-chang-jing-gao-you-jian/"/>
      <url>2019/08/24/springboot-zhi-li-yong-logback-fa-song-yi-chang-jing-gao-you-jian/</url>
      
        <content type="html"><![CDATA[<p>åˆ©ç”¨logbackè‡ªåŠ¨å°†å¼‚å¸¸é‚®ä»¶å‘é€åˆ°è¿ç»´é‚®ç®±é‡Œã€‚</p><p><a href="https://www.jianshu.com/p/c3858b788378">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>logbackä½œä¸ºé»˜è®¤çš„æ—¥å¿—å®ç°åœ¨springbooté¡¹ç›®é‡Œå¾ˆå¤šï¼Œå°¤å…¶æ˜¯æœ‰äº†lombokã€‚</p><p>logæ‰“åˆ°é…ç½®æ–‡ä»¶é‡Œï¼Œå¹¶ä¸”åˆ†sqlã€infoã€errorè¿™äº›éƒ½å¤ªeasyï¼Œéšåæˆ‘ä¼šé™„ä¸Šæˆ‘çš„é…ç½®ã€‚</p><p>é‚£ä¹ˆæ€ä¹ˆç”¨è¿™ä¸œè¥¿å°†å¼‚å¸¸é‚®ä»¶å‘é€ç»™è¿ç»´äººå‘˜å‘¢ï¼Ÿ</p><h4 id="propertiesé…ç½®"><a href="#propertiesé…ç½®" class="headerlink" title="propertiesé…ç½®"></a>propertiesé…ç½®</h4><pre class="line-numbers language-java"><code class="language-java">logback<span class="token punctuation">.</span>logdir<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>chuangke<span class="token operator">/</span>log<span class="token operator">/</span>pre<span class="token operator">/</span>apilogback<span class="token punctuation">.</span>appname<span class="token operator">=</span>mobileofficespring<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>host<span class="token operator">=</span>smtp<span class="token punctuation">.</span>exmail<span class="token punctuation">.</span>qq<span class="token punctuation">.</span>comspring<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>username<span class="token operator">=</span>mailtest<span class="token annotation punctuation">@3vyd</span><span class="token punctuation">.</span>comspring<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>password<span class="token operator">=</span>xxxspring<span class="token punctuation">.</span>mail<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token operator">-</span>encoding<span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span>spring<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>error<span class="token punctuation">.</span>subject<span class="token operator">=</span><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> in project namespring<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>error<span class="token punctuation">.</span>to<span class="token operator">=</span>marvin<span class="token punctuation">.</span>ma<span class="token annotation punctuation">@3vyd</span><span class="token punctuation">.</span>com<span class="token punctuation">,</span><span class="token number">303764416</span><span class="token annotation punctuation">@qq</span><span class="token punctuation">.</span>com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤šäººæ—¶ï¼Œé‚®ç®±ä¹‹é—´ç”¨è‹±æ–‡é€—å·åˆ†éš”</p><h4 id="logbackæ–‡ä»¶"><a href="#logbackæ–‡ä»¶" class="headerlink" title="logbackæ–‡ä»¶"></a>logbackæ–‡ä»¶</h4><p>è·Ÿå‘é€é‚®ä»¶ç›¸å…³çš„æ—¶è¿™å‡ å¥</p><pre class="line-numbers language-xml"><code class="language-xml">    <span class="token comment" spellcheck="true">&lt;!-- é‚®ä»¶é…ç½® --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>smtpHost<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring.mail.host<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring.mail.username<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring.mail.password<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mailSubject<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring.mail.error.subject<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mailTo<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring.mail.error.to<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MAIL<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.net.SMTPAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>smtpHost</span><span class="token punctuation">></span></span>${smtpHost}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>smtpHost</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>smtpPort</span><span class="token punctuation">></span></span>25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>smtpPort</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>${username}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>${password}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SSL</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SSL</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>asynchronousSending</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>asynchronousSending</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">></span></span>${mailTo}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">></span></span>${username}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>subject</span><span class="token punctuation">></span></span>${mailSubject}: %logger{0} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>subject</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charsetEncoding</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charsetEncoding</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cyclicBufferTracker</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.spi.CyclicBufferTracker<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!-- æ¯ä¸ªç”µå­é‚®ä»¶åªå‘é€ä¸€ä¸ªæ—¥å¿—æ¡ç›® --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bufferSize</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bufferSize</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cyclicBufferTracker</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.html.HTMLLayout<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.hczt<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fileInfoLog<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fileErrorLog<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MAIL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨å“ªä¸ªçº§åˆ«æˆ–è€…åŒ…ä¸Šéœ€è¦å°†å¼‚å¸¸å‘é€é‚®ä»¶ï¼Œå°±appenderä¸ŠMAILå°±å¯ä»¥äº†ã€‚</p><h4 id="å®Œæ•´çš„logback-spring-xmlæ–‡ä»¶"><a href="#å®Œæ•´çš„logback-spring-xmlæ–‡ä»¶" class="headerlink" title="å®Œæ•´çš„logback-spring.xmlæ–‡ä»¶"></a>å®Œæ•´çš„logback-spring.xmlæ–‡ä»¶</h4><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- application.properties ä¼ é€’å‚æ•°ï¼Œä¸èƒ½ä½¿ç”¨logbackè‡ªå¸¦çš„&lt;property>æ ‡ç­¾ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>appname<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logback.appname<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logdir<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logback.logdir<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>contextName</span><span class="token punctuation">></span></span>${appname}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>contextName</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- é‚®ä»¶é…ç½® --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>smtpHost<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring.mail.host<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring.mail.username<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring.mail.password<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mailSubject<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring.mail.error.subject<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProperty</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>context<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mailTo<span class="token punctuation">"</span></span> <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring.mail.error.to<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MAIL<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.net.SMTPAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>smtpHost</span><span class="token punctuation">></span></span>${smtpHost}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>smtpHost</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>smtpPort</span><span class="token punctuation">></span></span>25<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>smtpPort</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>${username}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>${password}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SSL</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SSL</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>asynchronousSending</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>asynchronousSending</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">></span></span>${mailTo}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">></span></span>${username}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>subject</span><span class="token punctuation">></span></span>${mailSubject}: %logger{0} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>subject</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charsetEncoding</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charsetEncoding</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cyclicBufferTracker</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.spi.CyclicBufferTracker<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!-- æ¯ä¸ªç”µå­é‚®ä»¶åªå‘é€ä¸€ä¸ªæ—¥å¿—æ¡ç›® --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bufferSize</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bufferSize</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cyclicBufferTracker</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.html.HTMLLayout<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- å¼€å‘ç¯å¢ƒ å…¨éƒ¨è¾“å‡ºåˆ°æ§åˆ¶å°--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProfile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dev<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- è¾“å‡ºåˆ°æ§åˆ¶å° --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>STDOUT<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æŒ‡å®šæœ€åŸºç¡€çš„æ—¥å¿—è¾“å‡ºçº§åˆ« --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>STDOUT<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>springProfile</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æµ‹è¯•ç¯å¢ƒ+å‡†ç”Ÿäº§ç¯å¢ƒ+ç”Ÿäº§ç¯å¢ƒ è¾“å‡ºåˆ°æ–‡ä»¶ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>springProfile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>test,pre,prod<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- è¾“å‡ºåˆ°æ–‡ä»¶-infoçº§åˆ« --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fileInfoLog<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!-- å¦‚æœåªæ˜¯æƒ³è¦Infoçº§åˆ«çš„æ—¥å¿—ï¼Œåªæ˜¯è¿‡æ»¤infoè¿˜æ˜¯ä¼šè¾“å‡ºErroræ—¥å¿—ï¼Œå› ä¸ºErrorçš„çº§åˆ«é«˜ï¼Œä½¿ç”¨filterï¼Œå¯ä»¥é¿å…è¾“å‡ºErroræ—¥å¿— --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment" spellcheck="true">&lt;!--è¿‡æ»¤ Error--></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>                <span class="token comment" spellcheck="true">&lt;!--åŒ¹é…åˆ°å°±ç¦æ­¢--></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>                <span class="token comment" spellcheck="true">&lt;!--æ²¡æœ‰åŒ¹é…åˆ°å°±å…è®¸--></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>                        <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—åç§°ï¼Œå¦‚æœæ²¡æœ‰Fileå±æ€§ï¼Œé‚£ä¹ˆåªä¼šä½¿ç”¨FileNamePatternçš„æ–‡ä»¶è·¯å¾„è§„åˆ™                 å¦‚æœåŒæ—¶æœ‰&lt;File>å’Œ&lt;FileNamePattern>ï¼Œé‚£ä¹ˆå½“å¤©æ—¥å¿—æ˜¯&lt;File>ï¼Œæ˜å¤©ä¼šè‡ªåŠ¨æŠŠä»Šå¤©çš„æ—¥å¿—æ”¹åä¸ºä»Šå¤©çš„æ—¥æœŸ                 å³ï¼Œ&lt;File>çš„æ—¥å¿—éƒ½æ˜¯å½“å¤©çš„            --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>${logdir}/info.${appname}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>                        <span class="token comment" spellcheck="true">&lt;!-- æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰ç…§æ—¶é—´æ»šåŠ¨ --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment" spellcheck="true">&lt;!-- æ–‡ä»¶è·¯å¾„ï¼Œå®šä¹‰äº†æ—¥å¿—çš„åˆ‡åˆ†æ–¹å¼                     æŠŠæ¯ä¸€å¤©çš„æ—¥å¿—å½’æ¡£åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä»¥é˜²æ­¢æ—¥å¿—å¡«æ»¡æ•´ä¸ªç£ç›˜ç©ºé—´                --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FileNamePattern</span><span class="token punctuation">></span></span>${logdir}/info.${appname}.%d{yyyy-MM-dd}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>                        <span class="token comment" spellcheck="true">&lt;!-- æ—¥å¿—è¾“å‡ºç¼–ç æ ¼å¼åŒ– --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level %logger Line:%-3L [%X{requestId}] - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>                <span class="token comment" spellcheck="true">&lt;!-- è¾“å‡ºåˆ°æ–‡ä»¶-error --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fileErrorLog<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--å¦‚æœåªæ˜¯æƒ³è¦ Error çº§åˆ«çš„æ—¥å¿—ï¼Œé‚£ä¹ˆéœ€è¦è¿‡æ»¤ä¸€ä¸‹ï¼Œé»˜è®¤æ˜¯ info çº§åˆ«çš„ï¼ŒThresholdFilter--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>Error<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--æ—¥å¿—åç§°ï¼Œå¦‚æœæ²¡æœ‰File å±æ€§ï¼Œé‚£ä¹ˆåªä¼šä½¿ç”¨FileNamePatternçš„æ–‡ä»¶è·¯å¾„è§„åˆ™                å¦‚æœåŒæ—¶æœ‰&lt;File>å’Œ&lt;FileNamePattern>ï¼Œé‚£ä¹ˆå½“å¤©æ—¥å¿—æ˜¯&lt;File>ï¼Œæ˜å¤©ä¼šè‡ªåŠ¨æŠŠä»Šå¤©çš„æ—¥å¿—æ”¹åä¸ºä»Šå¤©çš„æ—¥æœŸã€‚                å³ï¼Œ&lt;File> çš„æ—¥å¿—éƒ½æ˜¯å½“å¤©çš„ã€‚            --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>${logdir}/error.${appname}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰ç…§æ—¶é—´æ»šåŠ¨ TimeBasedRollingPolicy--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token comment" spellcheck="true">&lt;!--æ–‡ä»¶è·¯å¾„,å®šä¹‰äº†æ—¥å¿—çš„åˆ‡åˆ†æ–¹å¼â€”â€”æŠŠæ¯ä¸€å¤©çš„æ—¥å¿—å½’æ¡£åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­,ä»¥é˜²æ­¢æ—¥å¿—å¡«æ»¡æ•´ä¸ªç£ç›˜ç©ºé—´--></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FileNamePattern</span><span class="token punctuation">></span></span>${logdir}/error.${appname}.%d{yyyy-MM-dd}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--æ—¥å¿—è¾“å‡ºç¼–ç æ ¼å¼åŒ–--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level %logger Line:%-3L [%X{requestId}] - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sqlLog<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span><span class="token punctuation">></span></span>${logdir}/sql.${appname}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FileNamePattern</span><span class="token punctuation">></span></span>${logdir}/sql.${appname}.%d{yyyy-MM-dd}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FileNamePattern</span><span class="token punctuation">></span></span>                <span class="token comment" spellcheck="true">&lt;!--åªä¿ç•™æœ€è¿‘7å¤©çš„æ—¥å¿—--></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--æ—¥å¿—è¾“å‡ºç¼–ç æ ¼å¼åŒ–--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level %logger Line:%-3L [%X{requestId}] - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.hczt<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fileInfoLog<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fileErrorLog<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MAIL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.haier<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fileInfoLog<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fileErrorLog<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MAIL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ERROR<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fileErrorLog<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MAIL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p6spy<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sqlLog<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ERROR<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fileErrorLog<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MAIL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>springProfile</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é™„ä¸Šæˆªå›¾<br><img src="/loading.gif" data-original="/images/java/logback-error.png" alt="error"></p><p>å®Œç¾ï¼ï¼</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> springboot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Springboot ä¹‹ é…ç½®æ–‡ä»¶å±æ€§åŠ å¯†</title>
      <link href="2019/08/22/springboot-zhi-pei-zhi-wen-jian-shu-xing-jia-mi/"/>
      <url>2019/08/22/springboot-zhi-pei-zhi-wen-jian-shu-xing-jia-mi/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨Jasyptå¯¹springbooté¡¹ç›®çš„é…ç½®å±æ€§åŠ å¯†ã€‚<br><a href="https://www.jianshu.com/p/a3fb025d114f">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å†™è¿™ç¯‡çš„ç›®çš„ä¸æ˜¯ä¸ºäº†åˆ›æ–°ï¼Œè€Œæ˜¯å¤‡å¿˜ï¼Œæœ€è¿‘å­¦ä¹ clojureï¼ŒjavaåŸºæœ¬ä¸Šå·²ç»æ”¾ä¸‹äº†ï¼Œä½†æ˜¯æ›¾ä»Šç”¨è¿‡çš„ä¸œè¥¿å¦‚æœä¸è®°å½•ä¸€ä¸‹ï¼Œä»¥åç”¨èµ·æ¥ä¼°è®¡è¿æŸ¥ä»€ä¹ˆå…³é”®å­—éƒ½ä¸çŸ¥é“äº†ï¼Œå› æ­¤åœ¨ä¸»é¡µä¸Šåšä¸ªç¬”è®°ã€‚</p><p>åŸæ¥æˆ‘ä»¬å†™çš„springbootçš„é…ç½®æ–‡ä»¶å¤§æ¦‚æ˜¯è¿™æ ·çš„</p><pre class="line-numbers language-java"><code class="language-java">spring<span class="token operator">:</span>  datasource<span class="token operator">:</span>    url<span class="token operator">:</span> jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>test<span class="token operator">?</span>useUnicode<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>useSSL<span class="token operator">=</span><span class="token boolean">false</span>    username<span class="token operator">:</span> root    password<span class="token operator">:</span> <span class="token number">123456</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ€ä¹ˆçœ‹ä¹Ÿæ˜¯èµ¤è£¸è£¸çš„ï¼Œå¤§æ¦‚ä½ ä¹Ÿæƒ³è¿‡è¦æ˜¯èƒ½åŠ å¯†å°±å¥½äº†ï¼Œå¦‚æœåªæ˜¯æƒ³æƒ³çš„è¯ï¼Œè‚¯å®šä¸ä¼šè‡ªå·±åŠ å¯†ï¼Œè¿™é‡Œå°±ä»‹ç»ä¸ªéå¸¸æ–¹ä¾¿æ˜“ç”¨çš„åŠ å¯†å·¥å…·jasyptã€‚</p><h3 id="å¸¸è§„ä½¿ç”¨"><a href="#å¸¸è§„ä½¿ç”¨" class="headerlink" title="å¸¸è§„ä½¿ç”¨"></a>å¸¸è§„ä½¿ç”¨</h3><p>åœ¨springbootä¸­å¼•å…¥ä¾èµ–</p><pre class="line-numbers language-java"><code class="language-java"> <span class="token operator">&lt;</span>dependency<span class="token operator">></span>        <span class="token operator">&lt;</span>groupId<span class="token operator">></span>com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>ulisesbocchio<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>        <span class="token operator">&lt;</span>artifactId<span class="token operator">></span>jasypt<span class="token operator">-</span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>        <span class="token operator">&lt;</span>version<span class="token operator">></span><span class="token number">2.1</span><span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹åçš„é…ç½®æ–‡ä»¶</p><pre class="line-numbers language-java"><code class="language-java">spring<span class="token operator">:</span>  datasource<span class="token operator">:</span>    url<span class="token operator">:</span> jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>test<span class="token operator">?</span>useUnicode<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>zeroDateTimeBehavior<span class="token operator">=</span>convertToNull<span class="token operator">&amp;</span>characterEncoding<span class="token operator">=</span>utf<span class="token operator">-</span><span class="token number">8</span><span class="token operator">&amp;</span>useSSL<span class="token operator">=</span><span class="token boolean">false</span><span class="token operator">&amp;</span>serverTimezone<span class="token operator">=</span>GMT<span class="token operator">%</span>2B8<span class="token operator">&amp;</span>tinyInt1isBit<span class="token operator">=</span><span class="token boolean">false</span>    # å¯¹åº”ç”¨æˆ·å root ï¼Œå¯†ç  <span class="token number">123456</span>    username<span class="token operator">:</span> ENC<span class="token punctuation">[</span>KHRM9dKY8KykzzYbt8rRZQ<span class="token operator">==</span><span class="token punctuation">]</span>    password<span class="token operator">:</span> ENC<span class="token punctuation">[</span>RWmQMxlcukotJAb36PrKSA<span class="token operator">==</span><span class="token punctuation">]</span>jasypt<span class="token operator">:</span>  encryptor<span class="token operator">:</span>    # ä»»æ„çš„éšæœºå­—ç¬¦ä¸²å‡å¯    password<span class="token operator">:</span> SBPstLlrFzXW01Okb62R95qvpj4J83Dn    property<span class="token operator">:</span>      # è‡ªå®šä¹‰å±æ€§è§„åˆ™ï¼Œé»˜è®¤å‰ç¼€æ˜¯â€œ<span class="token function">ENC</span><span class="token punctuation">(</span>â€ï¼Œåç¼€ä¸ºâ€œ<span class="token punctuation">)</span>â€      prefix<span class="token operator">:</span> <span class="token string">"ENC["</span>      suffix<span class="token operator">:</span> <span class="token string">"]"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡ŒåªåŠ å¯†äº†ç”¨æˆ·åå’Œå¯†ç ï¼Œå…¶å®æ‰€æœ‰å±æ€§ï¼ŒæŠ¥è¿‡jdbcçš„urlä¹Ÿæ˜¯å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼åŠ å¯†çš„ã€‚<br>ç•™æ„åˆ°ä¸Šé¢è¿™æ®µé…ç½®çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯ ENC[xxx] è¿™ç§æ ¼å¼çš„ï¼Œå…¶ä¸­ ENC[] æ˜¯è‡ªå®šä¹‰é…ç½®çš„ï¼Œè¿™ä¹Ÿæ˜¯ Jasypt èƒ½æ­£å¸¸è¯†åˆ«å¾…è§£å¯†æ•°æ®çš„è§„åˆ™ï¼Œé‚£å…¶ä¸­çš„åŠ å¯†ä¸²åˆæ˜¯ä»å“ªæ¥çš„å‘¢ï¼Ÿ<br>å½“ç„¶æ˜¯è¿ç®—å‡ºæ¥çš„ã€‚æœ€ç®€å•çš„é…ç½®ï¼Œå¼€å‘è€…åªéœ€è¦å†è¡¥å……å®Œ jasypt.encryptor.password=xxx å±æ€§å³å¯ï¼ˆåŒä¸Šï¼Œè¿˜æ”¯æŒä½¿ç”¨ DERã€PEM è¿™ç§è¯ä¹¦çš„ private/public keys åŠ è§£å¯†æ–¹å¼ï¼‰ï¼Œå…·ä½“çš„ç”Ÿæˆä»£ç åœ¨ä¸‹æ–¹ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@SpringBootApplication</span><span class="token annotation punctuation">@EnableEncryptableProperties</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JasyptSpringBootApplication</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ConfigurableApplicationContext context <span class="token operator">=</span>                SpringApplication<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>JasyptSpringBootApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>        JasyptSpringBootApplication application <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>JasyptSpringBootApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è¿™é‡Œå¯ä»¥å°†æ˜æ–‡(ç”¨æˆ·åã€å¯†ç )è½¬æ¢æˆç›¸åº”å¯†æ–‡</span>        application<span class="token punctuation">.</span><span class="token function">jasypt</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        application<span class="token punctuation">.</span><span class="token function">jasypt</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// ä¸è¿‡ç¨‹åºæœ€åè¿˜æ˜¯é€šè¿‡æ˜æ–‡ä¿¡æ¯è¿›è¡Œæ•°æ®åº“è¿æ¥</span>        HikariDataSource hikariDataSource <span class="token operator">=</span> <span class="token punctuation">(</span>HikariDataSource<span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>DataSource<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"DB username: {} , password: {}"</span><span class="token punctuation">,</span> hikariDataSource<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hikariDataSource<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> StringEncryptor stringEncryptor<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">jasypt</span><span class="token punctuation">(</span>String text<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å³ä½¿æ˜¯ç›¸åŒæ˜æ–‡ï¼Œä½†è¿™é‡Œæ¯æ¬¡ç”Ÿæˆçš„éƒ½æ˜¯ä¸åŒçš„å¯†æ–‡</span>        String encryptedText <span class="token operator">=</span> stringEncryptor<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String decryptedText <span class="token operator">=</span> stringEncryptor<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>encryptedText<span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"ORIGINAL: {} ; ENCRYPTED: {} ; DECRYPTED: {}"</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> encryptedText<span class="token punctuation">,</span> decryptedText<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨å¼€å‘ç¯å¢ƒè¦åˆ‡æ¢jdbcï¼Œæˆ–è€…çœ‹çœ‹å¯†ç åˆ°åº•æ˜¯å•¥ï¼Œä¸ºå•¥æŠ¥jdbcé“¾æ¥é”™è¯¯æ—¶ï¼Œå¯ä»¥ç”¨è¿™ä¸ª</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>jasypt<span class="token punctuation">.</span>encryption<span class="token punctuation">.</span>StringEncryptor<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>Test<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span>RunWith<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>SpringBootTest<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>SpringRunner<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Resource<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span>SpringRunner<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token annotation punctuation">@SpringBootTest</span><span class="token punctuation">(</span>classes <span class="token operator">=</span> MobileOfficeApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MobileOfficeApplicationTests</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">te</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userService<span class="token punctuation">.</span><span class="token function">encodePwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> StringEncryptor stringEncryptor<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testEncrypt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"====================================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"key1:"</span> <span class="token operator">+</span> stringEncryptor<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token string">"jdbc:p6spy:mysql://127.0.0.1:3306/chuangke?characterEncoding=utf-8&amp;useSSL=false&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=Hongkong&amp;autoReconnect=true\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"key2:"</span> <span class="token operator">+</span> stringEncryptor<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"key3:"</span> <span class="token operator">+</span> stringEncryptor<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"====================================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h2><p>ä¸Šé¢çš„ä¾‹å­æ˜¯å°†passwordè®¾ç½®åœ¨ä¸å¯†æ–‡ä¸€èµ·çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œè¿™æ ·æ–¹ä¾¿æ˜¯æ–¹ä¾¿ï¼Œä½†æ˜¯æœ‰å¯†ç ï¼Œæœ‰å¯†æ–‡ï¼ŒçŸ¥é“åŠ å¯†ç®—æ³•ï¼Œè°ä¹Ÿå¯ä»¥è§£å¯†å‘€ï¼ˆå®‰å…¨æ˜¯ç›¸å¯¹çš„ï¼Œå…¶å®è¿™ä¸ªå·²ç»å¾ˆä¸é”™äº†ï¼‰ï¼Œé‚£æœ‰ä¹ˆæœ‰æ›´å®‰å…¨çš„æ–¹å¼å‘¢ï¼Ÿ<br>å½“ç„¶æœ‰ï¼ï¼ï¼ï¼<br>æœ‰ä¸¤ç§åŠæ³•:</p><ul><li>éƒ¨ç½²æ—¶è®¾ç½®password<br>ä¸ºäº†é˜²æ­¢salt(ç›)æ³„éœ²,åè§£å‡ºå¯†ç .å¯ä»¥åœ¨é¡¹ç›®éƒ¨ç½²çš„æ—¶å€™ä½¿ç”¨å‘½ä»¤ä¼ å…¥salt(ç›)å€¼</li></ul><pre class="line-numbers language-shell"><code class="language-shell">java -jar -Djasypt.encryptor.password=G0CvDz7oJn6 xxx.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>å°†passwordé…ç½®åˆ°æœåŠ¡å™¨çš„ç¯å¢ƒå˜é‡é‡Œ</li></ul><pre class="line-numbers language-shell"><code class="language-shell"># æ‰“å¼€/etc/profileæ–‡ä»¶vim /etc/profile#æ–‡ä»¶æœ«å°¾æ’å…¥export JASYPT_PASSWORD = G0CvDz7oJn6#ç¼–è¯‘ source /etc/profile#è¿è¡Œ java -jar -Djasypt.encryptor.password=${JASYPT_PASSWORD} xxx.jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://www.jianshu.com/p/cc97187e9a8f">è¿˜å°†å¯†ç æ˜æ–‡å†™åœ¨é…ç½®æ–‡ä»¶ï¼Ÿè¯•è¯• Jasypt Spring Boot</a></p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> springboot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®æ”¹gitlabï¼Œgitosis-adminçš„é»˜è®¤ç«¯å£22å</title>
      <link href="2019/08/19/xiu-gai-gitlab-gitosis-admin-de-mo-ren-duan-kou-22-hou/"/>
      <url>2019/08/19/xiu-gai-gitlab-gitosis-admin-de-mo-ren-duan-kou-22-hou/</url>
      
        <content type="html"><![CDATA[<p>æœ¬åœ°é…ç½®è¿œç«¯serverçš„ç«¯å£ä¾›sshä½¿ç”¨</p><p><a href="https://www.jianshu.com/p/e8b4e57cfb51">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ä»¥<a href="https://old.calculate-linux.org/main/en/gitosis">gitosis-admin</a>ä½œä¸ºgitä»£ç åº“ç®¡ç†å·¥å…·åï¼Œä¿®æ”¹äº†é»˜è®¤çš„22ç«¯å£ï¼Œæ­¤æ—¶sshçš„è¿æ¥è‡ªç„¶æ‹¿ä¸åˆ°ä»£ç ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>åœ¨æœ¬åœ°.sshçš„ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª<code>config</code>æ–‡ä»¶ï¼Œæ²¡æœ‰æ‰©å±•åå“¦ã€‚</p><p>å†…å®¹å¦‚ä¸‹:</p><pre class="line-numbers language-conf"><code class="language-conf">host 106.14.1.1hostname 106.14.1.1port 2093host git.server.comhostname git.server.comport 2093<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™å°±æ˜¯è¿æ¥åˆ°hostnameçš„2093ç«¯å£çš„æ„æ€ã€‚</p><p>æ·»åŠ äº†æœ¬é…ç½®å°±å¯ä»¥è®¿é—®gitæœåŠ¡å™¨äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨serveoä¸€ç§’é’Ÿå®ç°å†…ç½‘ç©¿é€</title>
      <link href="2019/08/09/shi-yong-serveo-yi-miao-zhong-shi-xian-nei-wang-chuan-tou/"/>
      <url>2019/08/09/shi-yong-serveo-yi-miao-zhong-shi-xian-nei-wang-chuan-tou/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ç‚¹ä¸å¤¸å¼ ï¼Œ1ç§’é’Ÿï¼ï¼ï¼ï¼</p><pre class="line-numbers language-shell"><code class="language-shell">ssh -R 80:localhost:3000 serveo.net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://www.jianshu.com/p/57485240708c">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä¸€ç›´ç”¨ngrokï¼Œè‡ªå·±ä¹Ÿæ€»ç»“è¿‡<a href="https://www.jianshu.com/p/4f008e2b7622">ä½¿ç”¨ngrokä¸€åˆ†é’Ÿå®ç°å†…ç½‘ç©¿é€</a>,ç®€å•çš„å°†æœ¬åœ°æœåŠ¡æ˜ å°„æˆå…¬ç½‘è®¿é—®çš„åœ°å€ï¼Œåæ­£æˆ‘æ˜¯ç”¨ä¸äº†1åˆ†é’Ÿã€‚</p><p>ä»Šå¤©å¶ç„¶çœ‹åˆ°ä¸€ç¯‡æ–‡ç« <a href="https://www.jianshu.com/p/33d0a8f77961">å®Œè´¥ngrok?ä¸€é”®å¼€å¯å†…ç½‘ç©¿é€ç¥å™¨serveo</a>ï¼Œè¿™æ¬¡åˆé¢ è¦†äº†æˆ‘çš„è®¤çŸ¥ï¼Œäºæ˜¯å†³å®šèŠ±1ç§’é’Ÿä½“éªŒä¸‹ã€‚</p><p>çœŸçš„æ˜¯1ç§’é’Ÿå“¦ï¼Œçœ‹çœ‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">Last login: Fri Aug  9 08:28:43 on consoleâœ  ~ ssh -R 80:localhost:3000 serveo.netThe authenticity of host 'serveo.net (159.89.214.31)' can't be established.RSA key fingerprint is SHA256:07jcXlJ4SkBnyTmaVnmTpXuBiRx2+Q2adxbttO9gt0M.Are you sure you want to continue connecting (yes/no)? yesWarning: Permanently added 'serveo.net,159.89.214.31' (RSA) to the list of known hosts.Forwarding HTTP traffic from https://vilicus.serveo.netPress g to start a GUI session and ctrl-c to quit.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®è¯•è¯•ï¼š<br><img src="/loading.gif" data-original="/images/tools/serveo.png" alt="serveo"></p><p>æœçœŸå…­å…­å…­~~~~</p><p>ä»¥åå°±ç”¨è¿™ä¸ªäº†ã€‚</p><p>å…¶ä»–é«˜é˜¶ä½¿ç”¨ç”¨çš„æ—¶å€™ä¸Š<a href="https://serveo.net/">å®˜ç½‘</a>æŸ¥è¯¢ï¼Œå¦‚æœæˆ‘ç”¨åˆ°äº†æˆ‘å†å®Œå–„è¿™ç¯‡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
            <tag> server </tag>
            
            <tag> ç½‘ç»œ </tag>
            
            <tag> å†…ç½‘ç©¿é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojureçˆ¬å‘ä¹‹é¡¹ç›®é‡Œå¤„ç†è¿‡çš„å¤æ‚é€»è¾‘</title>
      <link href="2019/07/31/clojure-pa-keng-zhi-xiang-mu-li-chu-li-guo-de-fu-za-luo-ji/"/>
      <url>2019/07/31/clojure-pa-keng-zhi-xiang-mu-li-chu-li-guo-de-fu-za-luo-ji/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/597b88132e0b">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="1ã€ä¸€ä¸ªé«˜é˜¶å‡½æ•°çš„ä½¿ç”¨ï¼šå°†dbæŸ¥è¯¢ç»“æœæ—¥æœŸè¿›è¡Œformatï¼Œå¹¶ä¸”groupå’Œæ±‚sumï¼Œé‡æ–°ç»„ç»‡ç»“æ„"><a href="#1ã€ä¸€ä¸ªé«˜é˜¶å‡½æ•°çš„ä½¿ç”¨ï¼šå°†dbæŸ¥è¯¢ç»“æœæ—¥æœŸè¿›è¡Œformatï¼Œå¹¶ä¸”groupå’Œæ±‚sumï¼Œé‡æ–°ç»„ç»‡ç»“æ„" class="headerlink" title="1ã€ä¸€ä¸ªé«˜é˜¶å‡½æ•°çš„ä½¿ç”¨ï¼šå°†dbæŸ¥è¯¢ç»“æœæ—¥æœŸè¿›è¡Œformatï¼Œå¹¶ä¸”groupå’Œæ±‚sumï¼Œé‡æ–°ç»„ç»‡ç»“æ„"></a>1ã€ä¸€ä¸ªé«˜é˜¶å‡½æ•°çš„ä½¿ç”¨ï¼šå°†dbæŸ¥è¯¢ç»“æœæ—¥æœŸè¿›è¡Œformatï¼Œå¹¶ä¸”groupå’Œæ±‚sumï¼Œé‡æ–°ç»„ç»‡ç»“æ„</h3><p>ä»DBä¸­æŸ¥åˆ°çš„mapç»“æœé›†å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(alk-wxapi.db.db-patient/get-patient-cost  {:page       0,   :size       10,   :patient-id 222})=>({:deleted 0,  :drug-flag 1,  :drug-id 1,  :cost-date #object[java.time.LocalDate 0x2d30b554 "2019-05-07"],  :id "1",  :create-time #object[java.time.LocalDateTime 0x76211aed "2019-06-05T22:42:14"],  :count 2,  :drug-name "å®‰è„±è¾¾",  :patient-id "222",  :sum 58.0} {:deleted 0,  :drug-flag 1,  :drug-id 1,  :cost-date #object[java.time.LocalDate 0x9e55443 "2019-06-05"],  :id "3",  :create-time #object[java.time.LocalDateTime 0x7114ec3c "2019-06-05T22:42:01"],  :count 10,  :drug-name "å®‰è„±è¾¾",  :patient-id "222",  :sum 120.0} {:deleted 0,  :drug-flag 1,  :drug-id 4,  :cost-date #object[java.time.LocalDate 0x59267d5f "2019-05-07"],  :id "2",  :create-time #object[java.time.LocalDateTime 0x27aef2e4 "2019-06-05T22:41:50"],  :count 15,  :drug-name "å¥¥é©¬ç ",  :patient-id "222",  :sum 200.0})<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>jsonä»¥åæ ¼å¼æ˜¯ä¸€æ¡æ¡çš„recordï¼š</p><pre class="line-numbers language-json"><code class="language-json"><span class="token property">"data"</span><span class="token operator">:</span> <span class="token punctuation">[</span>      <span class="token punctuation">{</span>        <span class="token property">"deleted"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>        <span class="token property">"drug-flag"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"drug-id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"cost-date"</span><span class="token operator">:</span> <span class="token string">"2019-05-07"</span><span class="token punctuation">,</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>        <span class="token property">"create-time"</span><span class="token operator">:</span> <span class="token string">"2019-06-05T22:42:14"</span><span class="token punctuation">,</span>        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>        <span class="token property">"drug-name"</span><span class="token operator">:</span> <span class="token string">"å®‰è„±è¾¾"</span><span class="token punctuation">,</span>        <span class="token property">"patient-id"</span><span class="token operator">:</span> <span class="token string">"222"</span><span class="token punctuation">,</span>        <span class="token property">"sum"</span><span class="token operator">:</span> <span class="token number">58</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"deleted"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>        <span class="token property">"drug-flag"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"drug-id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"cost-date"</span><span class="token operator">:</span> <span class="token string">"2019-06-05"</span><span class="token punctuation">,</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>        <span class="token property">"create-time"</span><span class="token operator">:</span> <span class="token string">"2019-06-05T22:42:01"</span><span class="token punctuation">,</span>        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>        <span class="token property">"drug-name"</span><span class="token operator">:</span> <span class="token string">"å®‰è„±è¾¾"</span><span class="token punctuation">,</span>        <span class="token property">"patient-id"</span><span class="token operator">:</span> <span class="token string">"222"</span><span class="token punctuation">,</span>        <span class="token property">"sum"</span><span class="token operator">:</span> <span class="token number">120</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"deleted"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>        <span class="token property">"drug-flag"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"drug-id"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>        <span class="token property">"cost-date"</span><span class="token operator">:</span> <span class="token string">"2019-05-07"</span><span class="token punctuation">,</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>        <span class="token property">"create-time"</span><span class="token operator">:</span> <span class="token string">"2019-06-05T22:41:50"</span><span class="token punctuation">,</span>        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>        <span class="token property">"drug-name"</span><span class="token operator">:</span> <span class="token string">"å¥¥é©¬ç "</span><span class="token punctuation">,</span>        <span class="token property">"patient-id"</span><span class="token operator">:</span> <span class="token string">"222"</span><span class="token punctuation">,</span>        <span class="token property">"sum"</span><span class="token operator">:</span> <span class="token number">200</span>      <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è€Œé¢„æœŸçš„jsonæ˜¯å¹²è¿™ä¹ˆå‡ ä»¶äº‹:</p><blockquote><p>1ã€æ ¹æ®æ—¥æœŸå°†åˆ†ç»„ï¼Œä»¥æŒ‡å®šå­—æ®µä¸ºkeyï¼Œgroupçš„æ—¥æœŸä¸ºvalue<br>2ã€å¯¹æ—¥æœŸè¿›è¡Œæ ¼å¼åŒ–<br>3ã€åŒä¸€æ—¥æœŸä¸‹çš„æ•°æ®ï¼Œä»¥listä¸ºkeyï¼Œrecordä½œä¸ºvalue<br>4ã€å¯¹æ¯ä¸ªlisté‡Œrecordçš„sumå­—æ®µæ±‚å’Œï¼Œä¸liståŒçº§ï¼Œä»¥total-costä¸ºkeyï¼Œå’Œä¸ºvalue<br>5ã€åŒ4ç±»ä¼¼ï¼Œå¯¹listé‡Œçš„recordçš„countæ±‚å’Œï¼Œä¸liståŒçº§ï¼Œä»¥total-countä¸ºkeyï¼Œå’Œä¸ºvalue</p></blockquote><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span><span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">[</span>      <span class="token punctuation">{</span>        <span class="token property">"cost-date"</span><span class="token operator">:</span> <span class="token string">"2019-05-07"</span><span class="token punctuation">,</span>        <span class="token property">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">{</span>            <span class="token property">"deleted"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token property">"drug-flag"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token property">"drug-id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token property">"cost-date"</span><span class="token operator">:</span> <span class="token string">"2019-05-07"</span><span class="token punctuation">,</span>            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>            <span class="token property">"create-time"</span><span class="token operator">:</span> <span class="token string">"2019-06-05T22:42:14"</span><span class="token punctuation">,</span>            <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>            <span class="token property">"drug-name"</span><span class="token operator">:</span> <span class="token string">"å®‰è„±è¾¾"</span><span class="token punctuation">,</span>            <span class="token property">"patient-id"</span><span class="token operator">:</span> <span class="token string">"222"</span><span class="token punctuation">,</span>            <span class="token property">"sum"</span><span class="token operator">:</span> <span class="token number">58</span>          <span class="token punctuation">}</span><span class="token punctuation">,</span>          <span class="token punctuation">{</span>            <span class="token property">"deleted"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token property">"drug-flag"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token property">"drug-id"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>            <span class="token property">"cost-date"</span><span class="token operator">:</span> <span class="token string">"2019-05-07"</span><span class="token punctuation">,</span>            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>            <span class="token property">"create-time"</span><span class="token operator">:</span> <span class="token string">"2019-06-05T22:41:50"</span><span class="token punctuation">,</span>            <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>            <span class="token property">"drug-name"</span><span class="token operator">:</span> <span class="token string">"å¥¥é©¬ç "</span><span class="token punctuation">,</span>            <span class="token property">"patient-id"</span><span class="token operator">:</span> <span class="token string">"222"</span><span class="token punctuation">,</span>            <span class="token property">"sum"</span><span class="token operator">:</span> <span class="token number">200</span>          <span class="token punctuation">}</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"total-cost"</span><span class="token operator">:</span> <span class="token number">258</span><span class="token punctuation">,</span>        <span class="token property">"total-count"</span><span class="token operator">:</span> <span class="token number">17</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"cost-date"</span><span class="token operator">:</span> <span class="token string">"2019-06-05"</span><span class="token punctuation">,</span>        <span class="token property">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">{</span>            <span class="token property">"deleted"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token property">"drug-flag"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token property">"drug-id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token property">"cost-date"</span><span class="token operator">:</span> <span class="token string">"2019-06-05"</span><span class="token punctuation">,</span>            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>            <span class="token property">"create-time"</span><span class="token operator">:</span> <span class="token string">"2019-06-05T22:42:01"</span><span class="token punctuation">,</span>            <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>            <span class="token property">"drug-name"</span><span class="token operator">:</span> <span class="token string">"å®‰è„±è¾¾"</span><span class="token punctuation">,</span>            <span class="token property">"patient-id"</span><span class="token operator">:</span> <span class="token string">"222"</span><span class="token punctuation">,</span>            <span class="token property">"sum"</span><span class="token operator">:</span> <span class="token number">120</span>          <span class="token punctuation">}</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"total-cost"</span><span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>        <span class="token property">"total-count"</span><span class="token operator">:</span> <span class="token number">10</span>      <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆè¿™ä¸ªå¤„ç†å‡½æ•°åº”è¯¥æ€ä¹ˆå†™å‘¢ï¼Ÿ<br>æä¾›ä¸€ä¸ªå·¥å…·ç±»ï¼Œå¤„ç†å°†å…³ç³»æ•°æ®åº“çš„recordææˆtreeçš„å‡½æ•°</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defn group-data-by-keys  "å¯¹ä¸€ç»„æ•°æ®åº“è¿”å›ç»“æœ{data}è¿›è¡Œå¤„ç†, ä½¿ç”¨{group-keys}ä¸­çš„keyè¿›è¡Œgroup-by:  (sut/group-data-by-keys test-dict                                  [:group-code1                                   :group-code2]                                  )  å¯ä»¥å¸¦å¤šç»„é¢å¤–çš„é›†åˆå‡½æ•°ï¼Œå¤šç»„[key reducing-function init-value]çš„æ ¼å¼ï¼š  (sut/group-data-by-keys test-dict                                  [:group-code]                                  :a                                  (fn [v e] (+ v (:id e)))                                  0                                  :b                                  (fn [v e] (+ v (:id e)))                                  0                                  )"  ([data group-keys]   (->> data        (group-by (fn [m] (select-keys m group-keys)))        (reduce-kv (fn [m k v]                     (assoc m k {:list                                 (mapv                                  (fn [e]                                    (apply dissoc e group-keys))                                  v)}))                   {})        (mapv (fn [e] (apply merge e)))))  ([data group-keys key r-func val & krvs]   (->> data        (group-by (fn [m] (select-keys m group-keys)))        (reduce-kv (fn [m k v]                     (assoc m                            k (if (empty? krvs)                                {:list                                 (mapv                                  (fn [e]                                    (apply dissoc e group-keys))                                  v)                                 key (reduce r-func val v)}                                (apply assoc {:list                                              (mapv                                               (fn [e]                                                 (apply dissoc e group-keys))                                               v)                                              key (reduce r-func val v)}                                       (let [krvs-seq (partition 3 krvs)]                                         (mapcat (fn [krv]                                                   (let [[key r-func val] krv]                                                     [key (reduce r-func val v)]))                                                 krvs-seq))))))                   {})        (map (fn [e] (apply merge e))))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨æä¾›ä¸€ä¸ªç›¸åä½œç”¨çš„å‡½æ•°</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defn list-from-group-by "å»é™¤åˆ†ç»„, ä½œç”¨å’Œgroup-data-by-key ç›¸å:  ä¸€å±‚åµŒå¥—: (list-from-group-by {:y 1 :a [{:b 2} {:b 3}]} )))  ->  [{:b 2, :y 1} {:b 3, :y 1}] åŒå±‚åµŒå¥—:  (mapcat sut/list-from-group-by                  (sut/list-from-group-by {:y 1 :a [{:b [{:x 99}]} {:b [{:x 77}]}]} ))           ->           [{:x 99, :y 1} {:x 77, :y 1}] " [m] (reduce-kv (fn [r k v]             (if (vector? v)              (->> (apply conj r v)                   (map #(merge % (dissoc m k))))              r))            []            m))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2ã€ä¸€äº›æœ‰ç”¨çš„utils"><a href="#2ã€ä¸€äº›æœ‰ç”¨çš„utils" class="headerlink" title="2ã€ä¸€äº›æœ‰ç”¨çš„utils"></a>2ã€ä¸€äº›æœ‰ç”¨çš„utils</h3><pre class="line-numbers language-clojure"><code class="language-clojure">(defn lower-case-keywrod "æŠŠè¾“å…¥çš„å­—ç¬¦ä¸²å˜æˆkeywrokd \"ABC\" -> :abc " [s] (keyword (clojure.string/lower-case s)))(defn parse-int  "string è½¬ int"  [s]  (Integer/parseInt (re-find #"\A-?\d+" s)))(defn parse-double  "string è½¬ doule"  [s]  (Double/parseDouble (re-find #"\A-?\d+" s)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3ã€ç­›é€‰å’Œåˆ¤æ–­ä¸€ç»„æ•°æ®ä¸­ä¸ä¸ºnilçš„"><a href="#3ã€ç­›é€‰å’Œåˆ¤æ–­ä¸€ç»„æ•°æ®ä¸­ä¸ä¸ºnilçš„" class="headerlink" title="3ã€ç­›é€‰å’Œåˆ¤æ–­ä¸€ç»„æ•°æ®ä¸­ä¸ä¸ºnilçš„"></a>3ã€ç­›é€‰å’Œåˆ¤æ–­ä¸€ç»„æ•°æ®ä¸­ä¸ä¸ºnilçš„</h3><p>æœ‰è¿™ä¹ˆä¸€ç»„æ•°ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(def x '[(nil nil nil nil nil) (nil nil nil nil nil) ({:drug-id "300", :drug-name "è¥¿æ›¿åˆ©å—ªï¼Œå·¦è¥¿æ›¿åˆ©å—ªï¼ˆä»™ç‰¹æœ—ï¼Œä¼˜æ³½ï¼‰", :checked true, :dosage "1111", :dosage-unit "æ»´/å¤©"} nil {:drug-id "302", :drug-name "è°ˆè¯´æ–¯æ±€ï¼ˆUPDATEï¼‰", :checked true, :dosage "1111", :dosage-unit "æ»´/å¤©"} nil) ()])<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰¾å‡ºä¸ä¸ºnilçš„</p><pre class="line-numbers language-clojure"><code class="language-clojure">(filter (complement nil?) (mapcat identity x))<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4ã€ä¸¤ä¸ªæ•°ä¸­æ‰¾åˆ°ä¸ä¸ºnilçš„ç¬¬ä¸€ä¸ªæ•°"><a href="#4ã€ä¸¤ä¸ªæ•°ä¸­æ‰¾åˆ°ä¸ä¸ºnilçš„ç¬¬ä¸€ä¸ªæ•°" class="headerlink" title="4ã€ä¸¤ä¸ªæ•°ä¸­æ‰¾åˆ°ä¸ä¸ºnilçš„ç¬¬ä¸€ä¸ªæ•°"></a>4ã€ä¸¤ä¸ªæ•°ä¸­æ‰¾åˆ°ä¸ä¸ºnilçš„ç¬¬ä¸€ä¸ªæ•°</h3><pre class="line-numbers language-clojure"><code class="language-clojure">(first (filter (complement nil?)        [a b]))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> clojure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojure web(luminus)æ¥å£å¼€å‘</title>
      <link href="2019/07/31/clojure-web-luminus-jie-kou-kai-fa/"/>
      <url>2019/07/31/clojure-web-luminus-jie-kou-kai-fa/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/996e20539aac">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="é¡¹ç›®æ¡†æ¶"><a href="#é¡¹ç›®æ¡†æ¶" class="headerlink" title="é¡¹ç›®æ¡†æ¶"></a>é¡¹ç›®æ¡†æ¶</h2><p>æœ¬é¡¹ç›®ä½¿ç”¨<a href="http://www.luminusweb.net/">luminus</a>åšæ¨¡æ¿ï¼Œå‚è€ƒ<a href="https://github.com/luminus-framework/luminus-template">luminus-template</a>,æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤initå·¥ç¨‹:</p><pre class="line-numbers language-shell"><code class="language-shell">lein new luminus alk-wxapi +mysql +service<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="ç›¸å…³æ–‡æ¡£"><a href="#ç›¸å…³æ–‡æ¡£" class="headerlink" title="ç›¸å…³æ–‡æ¡£"></a>ç›¸å…³æ–‡æ¡£</h3><ul><li><a href="http://www.luminusweb.net/docs">åå°åŸºç¡€æ¡†æ¶luminus</a></li><li><a href="https://www.hugsql.org/">åå°sqlæ”¯æŒHugSQL</a></li><li><a href="https://github.com/ring-clojure/ring">åå°webæ¡†æ¶</a></li><li><a href="https://github.com/metosin/reitit">å‰åç«¯è·¯ç”±æ¡†æ¶</a></li><li><a href="https://github.com/Day8/re-frame">å‰ç«¯çŠ¶æ€ç®¡ç†æ¡†æ¶</a></li><li><a href="https://github.com/priornix/antizer">å‰ç«¯PCç‰ˆUIæ¡†æ¶-antizer</a></li><li><a href="https://clojuredocs.org/">clojure å‡½æ•°å®šä¹‰åŠdemoæŸ¥è¯¢</a></li><li><a href="https://github.com/geekerzp/clojure-style-guide/blob/master/README-zhCN.md">clojureç¼–ç¨‹é£æ ¼æŒ‡å—</a></li><li><a href="https://clojure.org/guides/spec">spec guide</a></li><li><a href="https://cursive-ide.com/userguide/testing.html">å•å…ƒæµ‹è¯•</a></li></ul><h3 id="é¡¹ç›®è¿è¡Œ"><a href="#é¡¹ç›®è¿è¡Œ" class="headerlink" title="é¡¹ç›®è¿è¡Œ"></a>é¡¹ç›®è¿è¡Œ</h3><p>åœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­å¯åŠ¨ç”¨leinå¯åŠ¨ä¸€ä¸ªreplï¼Œleinæ²¡æœ‰å®‰è£…çš„éœ€è¦è‡ªè¡Œç™¾åº¦ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">âœ  ~ cd git/redcreation/alk-wxapiâœ  alk-wxapi git:(master) lein replnREPL server started on port 50529 on host 127.0.0.1 - nrepl://127.0.0.1:50529REPL-y 0.4.3, nREPL 0.6.0Clojure 1.10.0Java HotSpot(TM) 64-Bit Server VM 1.8.0_192-b12    Docs: (doc function-name-here)          (find-doc "part-of-name-here")  Source: (source function-name-here) Javadoc: (javadoc java-object-or-class-here)    Exit: Control+D or (exit) or (quit) Results: Stored in vars *1, *2, *3, an exception in *euser=><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶ååœ¨Intellij Ideaä¸­è¿œç¨‹è¿æ¥</p><p><img src="/loading.gif" data-original="/images/clojure/ideaconfig.png" alt="ideaconfig"></p><p>runè¿™ä¸ªé…ç½®ï¼Œç„¶ååœ¨ä¸‹é¢çš„replç¯å¢ƒä¸­æ‰§è¡Œ<code>(start)</code>å³å¯åŠ¨serverã€‚</p><h3 id="å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"><a href="#å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ" class="headerlink" title="å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"></a>å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h3><h4 id="1ã€å¤„ç†request"><a href="#1ã€å¤„ç†request" class="headerlink" title="1ã€å¤„ç†request"></a>1ã€å¤„ç†request</h4><p>å®é™…é¡¹ç›®å¼€å‘ä¸­ç»å¸¸éœ€è¦æ‰“å°requestå†…å®¹ï¼Œè¿™éƒ¨åˆ†åœ¨springMVCä¸­ä¸€èˆ¬ç”¨aopæ¥è§£å†³ã€‚<br>clojureä¸­æ²¡æœ‰å¯¹è±¡ï¼Œæ›´åˆ«æaopäº†ï¼Œä½†æ˜¯æ²¡æœ‰æ¡†æ¶çš„æŸç¼šï¼Œå¤„ç†èµ·requestå’Œresponseåè€Œæ›´åŠ çµæ´»ï¼Œæ˜¯ç”¨clojureçš„<a href="http://clojure-doc.org/articles/cookbooks/middleware.html">middleware</a><br>å¤„ç†çš„ï¼Œæ¯”å¦‚ä¸€ä¸ªæ‰“å°å‡ºå…¥å‚çš„middlewareå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(require '[clojure.tools.logging :as log])(defn log-wrap [handler]  (fn [request]    (if-not (:dev env)      (let [request-id (java.util.UUID/randomUUID)]        (log/info (str "\n================================ REQUEST START ================================"                       "\n request-id:" request-id                       "\n request-uri: " (:uri request)                       "\n request-method: " (:request-method request)                       "\n request-query: " (:query (:parameters request))                       "\n request-body: " (:body (:parameters request))))        (let [res (handler request)]          (log/info (str "response: " (:body res)                         "\n request-id:" request-id))          (log/info (str "\n================================ response END ================================"))          res))      (handler request))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†æ­¤swapé…ç½®åœ¨å…¨å±€è·¯ç”±ä¸­å³å¯,ä¸€èˆ¬æ˜¯æœ‰ä¸ªç»Ÿä¸€é…ç½®formatçš„middlewareçš„ï¼Œæ”¾åœ¨ä¸€èµ·å³å¯ã€‚</p><h4 id="2ã€åœ¨handlerä¸­ä½¿ç”¨requesté‡Œè‡ªå®šä¹‰çš„å¯¹è±¡"><a href="#2ã€åœ¨handlerä¸­ä½¿ç”¨requesté‡Œè‡ªå®šä¹‰çš„å¯¹è±¡" class="headerlink" title="2ã€åœ¨handlerä¸­ä½¿ç”¨requesté‡Œè‡ªå®šä¹‰çš„å¯¹è±¡"></a>2ã€åœ¨handlerä¸­ä½¿ç”¨requesté‡Œè‡ªå®šä¹‰çš„å¯¹è±¡</h4><p>æœ‰äº†ä¸Šé¢è¯´çš„middlewareèƒ½å¤„ç†requestï¼Œé‚£ä¹ˆå¾€requesté‡Œæ”¾ä¸ªå¯¹è±¡ï¼Œè‡ªç„¶ä¸åœ¨è¯ä¸‹ï¼Œæ¯”å¦‚è®²headeré‡Œçš„tokenè½¬æ¢æˆuserå¯¹è±¡ç½®äºrequestä¸­ï¼Œåœ¨åé¢handlerä¸­ç›´æ¥æ˜¯ç”¨ã€‚</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defn token-wrap [handler]  (fn [request]    (let [token (get-in request [:headers "token"])          user (-> token                   str->jwt                   :claims)]      (log/info (str "è§£æåçš„userï¼š" (-> token                                      str->jwt                                      :claims)))      (log/info (str "******* the current user is " (:iss user)))      (handler (assoc request :current-user (:iss user))))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3ã€hendlerè·å–bodyï¼Œpathï¼Œqueryçš„å‚æ•°"><a href="#3ã€hendlerè·å–bodyï¼Œpathï¼Œqueryçš„å‚æ•°" class="headerlink" title="3ã€hendlerè·å–bodyï¼Œpathï¼Œqueryçš„å‚æ•°"></a>3ã€hendlerè·å–bodyï¼Œpathï¼Œqueryçš„å‚æ•°</h4><p>åœ¨handleå‰åï¼Œå¯ä»¥ç”¨<code>(keys request)</code>æŸ¥çœ‹requesté‡Œè‡ªå·±ä¼ å…¥çš„å‚æ•°ï¼Œé‚£ä¹ˆåœ¨handleré‡Œæ€ä¹ˆè·å–è¿™äº›å‚æ•°å‘¢,åœ¨Luminusä¸­å®šä¹‰äº†ä¸‰ç§ä¸springMVCç±»ä¼¼çš„å‚æ•°å…³é”®è¯ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="center">mvc</th><th align="center">request</th><th align="center">luminus</th><th align="center">å«ä¹‰</th></tr></thead><tbody><tr><td align="center">@RequestParam</td><td align="center">query-params</td><td align="center">parameters -&gt; query</td><td align="center">queryå‚æ•°ï¼ŒURLåé¢é—®å·çš„å‚æ•°ï¼Œæˆ–formçš„å‚æ•°</td></tr><tr><td align="center">@PathVariable</td><td align="center">path-params</td><td align="center">parameters -&gt; path</td><td align="center">pathå‚æ•°ï¼ŒURLä¸­<code>/</code>çš„å‚æ•°</td></tr><tr><td align="center">@RequestBody</td><td align="center">body-params</td><td align="center">parameters -&gt;body</td><td align="center">post/putæ–¹æ³•é‡Œçš„bodyå‚æ•°</td></tr></tbody></table><p>è¿™ä¸‰ä¸ªkeywordæ˜¯ringè‡ªèº«çš„å¤„ç†ï¼Œæ˜¯åŸå§‹requesté‡Œçš„å‚æ•°ï¼Œä½†æ˜¯query-paramså‚æ•°è¢«å¤„ç†æˆmapçš„keyä¸æ˜¯keywordsï¼Œæ˜¯æ™®é€šçš„stringï¼Œå¾—ç”¨(query-params â€œidâ€)è¿™æ ·æ¥å–å€¼ã€‚å› æ­¤æ¨èå¦‚ä¸‹ç¤ºä¾‹ä½¿ç”¨ï¼š<br>æ¨èä»requestçš„parametersä¸­è·å–ï¼Œå…³é”®å­—åˆ†åˆ«æ˜¯queryï¼Œpathï¼Œ bodyã€‚<br>è·å–çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">  ["/path/bad/:id"   {:post {:summary    "è·¯å¾„ä¸Šä¼ å‚--ä¸æ¨èæ­¤æ–¹æ³•è·å–--queryå‚æ•°keyå˜æˆäº†str"           :parameters {:path  {:id int?}                        :query {:name string?}                        :body  {:message string?}}           :handler    (fn [{:keys [path-params query-params body-params]}]                        {:status 200                         :body   {:data (str "path params: " path-params                                             "\n query params: " query-params                                             "\n body params: " body-params)}})}}]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>åŸå› åˆ†æ</strong></p><p>æˆ‘ä»¬åœ¨handler.cljçš„<code>ring/router</code>åé¢ä½¿ç”¨<code>[reitit.ring.middleware.dev :as dev]</code>çš„<code>{:reitit.middleware/transform dev/print-request-diffs}</code>æ–¹æ³•æ‰“å°å‡ºä¸­é—´ä»¶çš„å¤„ç†é€»è¾‘ï¼Œ</p><p><img src="/loading.gif" data-original="/images/clojure/handler.png" alt="handler"></p><p>ç»“æœå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">--- Middleware ---  {:body #<io.undertow.io.UndertowInputStream@39931c66>,   :character-encoding "ISO-8859-1",   :content-length 21,   :content-type "application/json",   :context "",   :cookies {"JSESSIONID" {:value "GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU"},             "_ga" {:value "GA1.1.521496834.1555489511"},             "_gid" {:value "GA1.1.947080805.1561170619"}},   :flash nil,   :form-params {},   :handler-type :undertow,   :headers {"accept" "application/json",             "accept-encoding" "gzip, deflate, br",             "accept-language" "zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7",             "connection" "keep-alive",             "content-length" "21",             "content-type" "application/json",             "cookie" "_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619",             "host" "localhost:3000",             "origin" "http://localhost:3000",             "referer" "http://localhost:3000/api/api-docs/index.html",             "user-agent" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"},   :multipart-params {},   :params {:name "2"},   :path-info "/api/guestbooks/path/good-all-params/1",   :path-params {:id "1"},   :query-params {"name" "2"},   :query-string "name=2",   :remote-addr "0:0:0:0:0:0:0:1",   :request-method :post,   :scheme :http,   :server-exchange #<io.undertow.server.HttpServerExchange@78f2e776 HttpServerExchange{ POST /api/guestbooks/path/good-all-params/1 request {Accept=[application/json], Accept-Language=[zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7], Accept-Encoding=[gzip, deflate, br], Origin=[http://localhost:3000], User-Agent=[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36], Connection=[keep-alive], Content-Length=[21], Content-Type=[application/json], Cookie=[_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619], Referer=[http://localhost:3000/api/api-docs/index.html], Host=[localhost:3000]} response {Server=[undertow]}}>,   :server-name "localhost",   :server-port 3000,   :session nil,   :ssl-client-cert nil,   :uri "/api/guestbooks/path/good-all-params/1"}--- Middleware :reitit.ring.middleware.parameters/parameters ---  {:body #<io.undertow.io.UndertowInputStream@39931c66>,   :character-encoding "ISO-8859-1",   :content-length 21,   :content-type "application/json",   :context "",   :cookies {"JSESSIONID" {:value "GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU"},             "_ga" {:value "GA1.1.521496834.1555489511"},             "_gid" {:value "GA1.1.947080805.1561170619"}},   :flash nil,   :form-params {},   :handler-type :undertow,   :headers {"accept" "application/json",             "accept-encoding" "gzip, deflate, br",             "accept-language" "zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7",             "connection" "keep-alive",             "content-length" "21",             "content-type" "application/json",             "cookie" "_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619",             "host" "localhost:3000",             "origin" "http://localhost:3000",             "referer" "http://localhost:3000/api/api-docs/index.html",             "user-agent" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"},   :multipart-params {},   :params {:name "2"},   :path-info "/api/guestbooks/path/good-all-params/1",   :path-params {:id "1"},   :query-params {"name" "2"},   :query-string "name=2",   :remote-addr "0:0:0:0:0:0:0:1",   :request-method :post,   :scheme :http,   :server-exchange #<io.undertow.server.HttpServerExchange@78f2e776 HttpServerExchange{ POST /api/guestbooks/path/good-all-params/1 request {Accept=[application/json], Accept-Language=[zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7], Accept-Encoding=[gzip, deflate, br], Origin=[http://localhost:3000], User-Agent=[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36], Connection=[keep-alive], Content-Length=[21], Content-Type=[application/json], Cookie=[_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619], Referer=[http://localhost:3000/api/api-docs/index.html], Host=[localhost:3000]} response {Server=[undertow]}}>,   :server-name "localhost",   :server-port 3000,   :session nil,   :ssl-client-cert nil,   :uri "/api/guestbooks/path/good-all-params/1"}--- Middleware :reitit.ring.middleware.muuntaja/format-negotiate ---  {:body #<io.undertow.io.UndertowInputStream@39931c66>,   :character-encoding "ISO-8859-1",   :content-length 21,   :content-type "application/json",   :context "",   :cookies {"JSESSIONID" {:value "GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU"},             "_ga" {:value "GA1.1.521496834.1555489511"},             "_gid" {:value "GA1.1.947080805.1561170619"}},   :flash nil,   :form-params {},   :handler-type :undertow,   :headers {"accept" "application/json",             "accept-encoding" "gzip, deflate, br",             "accept-language" "zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7",             "connection" "keep-alive",             "content-length" "21",             "content-type" "application/json",             "cookie" "_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619",             "host" "localhost:3000",             "origin" "http://localhost:3000",             "referer" "http://localhost:3000/api/api-docs/index.html",             "user-agent" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"},   :multipart-params {},   :params {:name "2"},   :path-info "/api/guestbooks/path/good-all-params/1",   :path-params {:id "1"},   :query-params {"name" "2"},   :query-string "name=2",   :remote-addr "0:0:0:0:0:0:0:1",   :request-method :post,   :scheme :http,   :server-exchange #<io.undertow.server.HttpServerExchange@78f2e776 HttpServerExchange{ POST /api/guestbooks/path/good-all-params/1 request {Accept=[application/json], Accept-Language=[zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7], Accept-Encoding=[gzip, deflate, br], Origin=[http://localhost:3000], User-Agent=[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36], Connection=[keep-alive], Content-Length=[21], Content-Type=[application/json], Cookie=[_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619], Referer=[http://localhost:3000/api/api-docs/index.html], Host=[localhost:3000]} response {Server=[undertow]}}>,   :server-name "localhost",   :server-port 3000,   :session nil,   :ssl-client-cert nil,   :uri "/api/guestbooks/path/good-all-params/1",   +:muuntaja/request #muuntaja.core.FormatAndCharset   {:charset "utf-8",    :format "application/json",    :raw-format "application/json"},   +:muuntaja/response #muuntaja.core.FormatAndCharset   {:charset "utf-8",    :format "application/json",    :raw-format "application/json"}}--- Middleware :reitit.ring.middleware.muuntaja/format-response ---  {:body #<io.undertow.io.UndertowInputStream@39931c66>,   :character-encoding "ISO-8859-1",   :content-length 21,   :content-type "application/json",   :context "",   :cookies {"JSESSIONID" {:value "GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU"},             "_ga" {:value "GA1.1.521496834.1555489511"},             "_gid" {:value "GA1.1.947080805.1561170619"}},   :flash nil,   :form-params {},   :handler-type :undertow,   :headers {"accept" "application/json",             "accept-encoding" "gzip, deflate, br",             "accept-language" "zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7",             "connection" "keep-alive",             "content-length" "21",             "content-type" "application/json",             "cookie" "_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619",             "host" "localhost:3000",             "origin" "http://localhost:3000",             "referer" "http://localhost:3000/api/api-docs/index.html",             "user-agent" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"},   :multipart-params {},   :params {:name "2"},   :path-info "/api/guestbooks/path/good-all-params/1",   :path-params {:id "1"},   :query-params {"name" "2"},   :query-string "name=2",   :remote-addr "0:0:0:0:0:0:0:1",   :request-method :post,   :scheme :http,   :server-exchange #<io.undertow.server.HttpServerExchange@78f2e776 HttpServerExchange{ POST /api/guestbooks/path/good-all-params/1 request {Accept=[application/json], Accept-Language=[zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7], Accept-Encoding=[gzip, deflate, br], Origin=[http://localhost:3000], User-Agent=[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36], Connection=[keep-alive], Content-Length=[21], Content-Type=[application/json], Cookie=[_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619], Referer=[http://localhost:3000/api/api-docs/index.html], Host=[localhost:3000]} response {Server=[undertow]}}>,   :server-name "localhost",   :server-port 3000,   :session nil,   :ssl-client-cert nil,   :uri "/api/guestbooks/path/good-all-params/1",   :muuntaja/request {:charset "utf-8",                      :format "application/json",                      :raw-format "application/json"},   :muuntaja/response {:charset "utf-8",                       :format "application/json",                       :raw-format "application/json"}}--- Middleware :reitit.ring.middleware.exception/exception ---  {:body #<io.undertow.io.UndertowInputStream@39931c66>,   :character-encoding "ISO-8859-1",   :content-length 21,   :content-type "application/json",   :context "",   :cookies {"JSESSIONID" {:value "GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU"},             "_ga" {:value "GA1.1.521496834.1555489511"},             "_gid" {:value "GA1.1.947080805.1561170619"}},   :flash nil,   :form-params {},   :handler-type :undertow,   :headers {"accept" "application/json",             "accept-encoding" "gzip, deflate, br",             "accept-language" "zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7",             "connection" "keep-alive",             "content-length" "21",             "content-type" "application/json",             "cookie" "_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619",             "host" "localhost:3000",             "origin" "http://localhost:3000",             "referer" "http://localhost:3000/api/api-docs/index.html",             "user-agent" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"},   :multipart-params {},   :params {:name "2"},   :path-info "/api/guestbooks/path/good-all-params/1",   :path-params {:id "1"},   :query-params {"name" "2"},   :query-string "name=2",   :remote-addr "0:0:0:0:0:0:0:1",   :request-method :post,   :scheme :http,   :server-exchange #<io.undertow.server.HttpServerExchange@78f2e776 HttpServerExchange{ POST /api/guestbooks/path/good-all-params/1 request {Accept=[application/json], Accept-Language=[zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7], Accept-Encoding=[gzip, deflate, br], Origin=[http://localhost:3000], User-Agent=[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36], Connection=[keep-alive], Content-Length=[21], Content-Type=[application/json], Cookie=[_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619], Referer=[http://localhost:3000/api/api-docs/index.html], Host=[localhost:3000]} response {Server=[undertow]}}>,   :server-name "localhost",   :server-port 3000,   :session nil,   :ssl-client-cert nil,   :uri "/api/guestbooks/path/good-all-params/1",   :muuntaja/request {:charset "utf-8",                      :format "application/json",                      :raw-format "application/json"},   :muuntaja/response {:charset "utf-8",                       :format "application/json",                       :raw-format "application/json"}}--- Middleware :reitit.ring.middleware.muuntaja/format-request ---  {:body #<io.undertow.io.UndertowInputStream@39931c66>,   :character-encoding "ISO-8859-1",   :content-length 21,   :content-type "application/json",   :context "",   :cookies {"JSESSIONID" {:value "GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU"},             "_ga" {:value "GA1.1.521496834.1555489511"},             "_gid" {:value "GA1.1.947080805.1561170619"}},   :flash nil,   :form-params {},   :handler-type :undertow,   :headers {"accept" "application/json",             "accept-encoding" "gzip, deflate, br",             "accept-language" "zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7",             "connection" "keep-alive",             "content-length" "21",             "content-type" "application/json",             "cookie" "_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619",             "host" "localhost:3000",             "origin" "http://localhost:3000",             "referer" "http://localhost:3000/api/api-docs/index.html",             "user-agent" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"},   :multipart-params {},   :params {:name "2"},   :path-info "/api/guestbooks/path/good-all-params/1",   :path-params {:id "1"},   :query-params {"name" "2"},   :query-string "name=2",   :remote-addr "0:0:0:0:0:0:0:1",   :request-method :post,   :scheme :http,   :server-exchange #<io.undertow.server.HttpServerExchange@78f2e776 HttpServerExchange{ POST /api/guestbooks/path/good-all-params/1 request {Accept=[application/json], Accept-Language=[zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7], Accept-Encoding=[gzip, deflate, br], Origin=[http://localhost:3000], User-Agent=[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36], Connection=[keep-alive], Content-Length=[21], Content-Type=[application/json], Cookie=[_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619], Referer=[http://localhost:3000/api/api-docs/index.html], Host=[localhost:3000]} response {Server=[undertow]}}>,   :server-name "localhost",   :server-port 3000,   :session nil,   :ssl-client-cert nil,   :uri "/api/guestbooks/path/good-all-params/1",   :muuntaja/request {:charset "utf-8",                      :format "application/json",                      :raw-format "application/json"},   :muuntaja/response {:charset "utf-8",                       :format "application/json",                       :raw-format "application/json"},   +:body-params {:message "22"}}--- Middleware :reitit.ring.coercion/coerce-request ---  {:body #<io.undertow.io.UndertowInputStream@39931c66>,   :body-params {:message "22"},   :character-encoding "ISO-8859-1",   :content-length 21,   :content-type "application/json",   :context "",   :cookies {"JSESSIONID" {:value "GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU"},             "_ga" {:value "GA1.1.521496834.1555489511"},             "_gid" {:value "GA1.1.947080805.1561170619"}},   :flash nil,   :form-params {},   :handler-type :undertow,   :headers {"accept" "application/json",             "accept-encoding" "gzip, deflate, br",             "accept-language" "zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7",             "connection" "keep-alive",             "content-length" "21",             "content-type" "application/json",             "cookie" "_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619",             "host" "localhost:3000",             "origin" "http://localhost:3000",             "referer" "http://localhost:3000/api/api-docs/index.html",             "user-agent" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"},   :multipart-params {},   :params {:name "2"},   :path-info "/api/guestbooks/path/good-all-params/1",   :path-params {:id "1"},   :query-params {"name" "2"},   :query-string "name=2",   :remote-addr "0:0:0:0:0:0:0:1",   :request-method :post,   :scheme :http,   :server-exchange #<io.undertow.server.HttpServerExchange@78f2e776 HttpServerExchange{ POST /api/guestbooks/path/good-all-params/1 request {Accept=[application/json], Accept-Language=[zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7], Accept-Encoding=[gzip, deflate, br], Origin=[http://localhost:3000], User-Agent=[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36], Connection=[keep-alive], Content-Length=[21], Content-Type=[application/json], Cookie=[_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619], Referer=[http://localhost:3000/api/api-docs/index.html], Host=[localhost:3000]} response {Server=[undertow]}}>,   :server-name "localhost",   :server-port 3000,   :session nil,   :ssl-client-cert nil,   :uri "/api/guestbooks/path/good-all-params/1",   :muuntaja/request {:charset "utf-8",                      :format "application/json",                      :raw-format "application/json"},   :muuntaja/response {:charset "utf-8",                       :format "application/json",                       :raw-format "application/json"},   +:parameters {:body {:message "22"},                 :path {:id 1},                 :query {:name "2"}}}2019-06-22 11:09:16,537 [XNIO-2 task-2] INFO  alk-wxapi.middleware.log-interceptor - ================================ REQUEST START ================================ request-id:8ddb3169-e72f-4b90-8811-d500c50d3057 request-uri: /api/guestbooks/path/good-all-params/1 request-method: :post request-query: {:name "2"} request-body: {:message "22"} --- Middleware ---  {:body #<io.undertow.io.UndertowInputStream@39931c66>,   :body-params {:message "22"},   :character-encoding "ISO-8859-1",   :content-length 21,   :content-type "application/json",   :context "",   :cookies {"JSESSIONID" {:value "GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU"},             "_ga" {:value "GA1.1.521496834.1555489511"},             "_gid" {:value "GA1.1.947080805.1561170619"}},   :flash nil,   :form-params {},   :handler-type :undertow,   :headers {"accept" "application/json",             "accept-encoding" "gzip, deflate, br",             "accept-language" "zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7",             "connection" "keep-alive",             "content-length" "21",             "content-type" "application/json",             "cookie" "_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619",             "host" "localhost:3000",             "origin" "http://localhost:3000",             "referer" "http://localhost:3000/api/api-docs/index.html",             "user-agent" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36"},   :multipart-params {},   :parameters {:body {:message "22"},                :path {:id 1},                :query {:name "2"}},   :params {:name "2"},   :path-info "/api/guestbooks/path/good-all-params/1",   :path-params {:id "1"},   :query-params {"name" "2"},   :query-string "name=2",   :remote-addr "0:0:0:0:0:0:0:1",   :request-method :post,   :scheme :http,   :server-exchange #<io.undertow.server.HttpServerExchange@78f2e776 HttpServerExchange{ POST /api/guestbooks/path/good-all-params/1 request {Accept=[application/json], Accept-Language=[zh-CN,zh;q=0.9,zh-TW;q=0.8,en;q=0.7], Accept-Encoding=[gzip, deflate, br], Origin=[http://localhost:3000], User-Agent=[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36], Connection=[keep-alive], Content-Length=[21], Content-Type=[application/json], Cookie=[_ga=GA1.1.521496834.1555489511; JSESSIONID=GpSiQENkmzM7qQwqWdYxjehYKvNKoEGMG6MIwqwU; _gid=GA1.1.947080805.1561170619], Referer=[http://localhost:3000/api/api-docs/index.html], Host=[localhost:3000]} response {Server=[undertow]}}>,   :server-name "localhost",   :server-port 3000,   :session nil,   :ssl-client-cert nil,   :uri "/api/guestbooks/path/good-all-params/1",   :muuntaja/request {:charset "utf-8",                      :format "application/json",                      :raw-format "application/json"},   :muuntaja/response {:charset "utf-8",                       :format "application/json",                       :raw-format "application/json"}}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°åœ¨<code>reitit.ring.coercion/coerce-request</code>ä¸­é—´ä»¶å¤„ç†årequesté‡Œå¢åŠ äº†<br><code>:parameters {  :body {:message "22"},  :path {:id 1},  :query {:name "2"}}</code><br>3ç§ç±»å‹ä¸€è‡´çš„mapï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨çš„åŸå› ã€‚</p><blockquote><p>handleré‡Œè·å–requestè‡ªå®šä¹‰çš„å¯¹è±¡ï¼š</p></blockquote><p>é‚£ä¹ˆï¼Œåœ¨ä¸Šä¸€æ­¥handleä¸­åŠ å…¥åˆ°requestä¸­äº†ä¸€ä¸ªcurrent-useræ€ä¹ˆè·å–å’Œä½¿ç”¨å‘¢ï¼Ÿå…¶å®ï¼Œbody-paramsï¼Œquery-paramsè¿™äº›ä¹Ÿåªæ˜¯ä»requestä¸­è·å–åˆ°çš„è€Œå·²ï¼Œæ—¢ç„¶èƒ½ä»requestä¸­è·å–è¿™äº›ï¼Œé‚£ä¹ˆrequesté‡Œçš„å…¶ä»–æ‰€æœ‰è‡ªç„¶ä¹Ÿèƒ½åœ¨handlerä¸­è·å–ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">["/reset/pwd"    {:post {:summary    "ä¿®æ”¹å¯†ç "            :parameters {:body (s/keys :req-un [::old-pwd ::new-pwd])}            :handler    (fn [{{{:keys [old-pwd new-pwd]} :body} :parameters :as request}]                          (let [current-id (-> request :current-user :user-id)                                db-user (db/get-user-id                                         {:user-id current-id})]                            (if (check-old-pwd old-pwd (:password db-user))                              (do (conman.core/with-transaction                                    [*db*]                                    (db/update-pwd! {:password  (d/sha-256 new-pwd)                                                         :user-id current-id}))                                  {:status 200                                   :body   {:code    1                                            :message "ä¿®æ”¹æˆåŠŸï¼Œè¯·ç”¨æ–°å¯†ç ç™»å½•"}})                              {:status 400                               :body   {:code    0                                        :message "å¯†ç é”™è¯¯ï¼Œè¯·è¾“å…¥æ­£ç¡®çš„å¯†ç ï¼"}})))}}]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>:as request</code>çš„æ„æ€æ˜¯åŒ…å«å‰é¢æŒ‡å®šè·å–çš„å‚æ•°çš„æ‰€æœ‰ã€‚</p><h4 id="4ã€åˆ†é¡µï¼ŒåŠ¨æ€hugsql"><a href="#4ã€åˆ†é¡µï¼ŒåŠ¨æ€hugsql" class="headerlink" title="4ã€åˆ†é¡µï¼ŒåŠ¨æ€hugsql"></a>4ã€åˆ†é¡µï¼ŒåŠ¨æ€hugsql</h4><p>åœ¨springbooté‡Œä¹ æƒ¯ä½¿ç”¨spring data jpaï¼Œåˆ†é¡µä½¿ç”¨Pageableã€PageRequestï¼Œè¿˜èƒ½æºå¸¦Sortï¼Œæ”¾å›ç»“æœè‡ªåŠ¨åˆ†é¡µï¼Œç¡®å®æ–¹ä¾¿ã€‚åœ¨<a href="http://www.luminusweb.net/">luminusweb</a>é‡Œæ²¡æœ‰çœ‹åˆ°åˆ†é¡µçš„è¯´æ˜ï¼Œäºæ˜¯åœ¨åº•å±‚çš„<a href="https://www.hugsql.org/">HugSQL</a>é‡Œæ‰¾åˆ°çš„æ–¹æ¡ˆ,ä¸¾ä¸ªåŠ¨æ€sqlï¼Œå¹¶ä¸”ä½¿ç”¨likeæ¨¡ç³ŠæŸ¥è¯¢çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- :name get-patient-like :? :*</span><span class="token comment" spellcheck="true">-- :doc æ¨¡ç³ŠæŸ¥è¯¢æ‚£è€…åˆ—è¡¨</span><span class="token keyword">SELECT</span><span class="token comment" spellcheck="true">/*~ (if (:count params) */</span>  <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'total-elements'</span><span class="token comment" spellcheck="true">/*~*/</span>    p<span class="token punctuation">.</span><span class="token punctuation">`</span>patient_id<span class="token punctuation">`</span><span class="token punctuation">,</span>    p<span class="token punctuation">.</span><span class="token punctuation">`</span>name<span class="token punctuation">`</span><span class="token punctuation">,</span>    p<span class="token punctuation">.</span><span class="token punctuation">`</span>headimgurl<span class="token punctuation">`</span><span class="token punctuation">,</span>    p<span class="token punctuation">.</span><span class="token punctuation">`</span>patient_no<span class="token punctuation">`</span><span class="token comment" spellcheck="true">/*~ ) ~*/</span><span class="token keyword">FROM</span>    <span class="token punctuation">`</span>t_patient<span class="token punctuation">`</span> p<span class="token keyword">WHERE</span>    p<span class="token punctuation">.</span>deleted <span class="token operator">=</span> <span class="token boolean">FALSE</span>    <span class="token operator">AND</span> p<span class="token punctuation">.</span><span class="token punctuation">`</span>hospital_id<span class="token punctuation">`</span> <span class="token operator">=</span> :hospital<span class="token operator">-</span>id<span class="token comment" spellcheck="true">/*~ (if (= nil (:keywords params)) */</span>  <span class="token operator">AND</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment" spellcheck="true">/*~*/</span>  <span class="token operator">AND</span> <span class="token punctuation">(</span>        p<span class="token punctuation">.</span><span class="token punctuation">`</span>name<span class="token punctuation">`</span> <span class="token operator">LIKE</span> :keywords        <span class="token operator">OR</span> p<span class="token punctuation">.</span>mobile <span class="token operator">LIKE</span> :keywords      <span class="token operator">OR</span> p<span class="token punctuation">.</span>patient_no <span class="token operator">LIKE</span> :keywords    <span class="token punctuation">)</span><span class="token comment" spellcheck="true">/*~ ) ~*/</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> p<span class="token punctuation">.</span><span class="token punctuation">`</span>create_time<span class="token punctuation">`</span> <span class="token keyword">DESC</span><span class="token comment" spellcheck="true">--~ (if (:count params) ";" "LIMIT :page, :size ;")</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">["/patient/search"    {:get {:summary    "åŒ»ç”Ÿæ¨¡ç³Šæ£€ç´¢æ‚£è€…åˆ—è¡¨"           :parameters {:query (s/keys :req-un [:base/page :base/size]                                       :opt-un [::keywords])}           :handler    (fn [{{{:keys [page size keywords]} :query} :parameters :as request}]                         (let [hospital-id (-> request :doctor :hospital-id)]                           {:status                             200                            :body                               {:code 1                             :data {:total-elements                                     (->> (db-pat/get-patient-like                                           {:count       true                                            :keywords    (str "%" keywords "%")                                            :hospital-id hospital-id})                                         (map :total-elements)                                         (first))                                    :content                                    (db-pat/get-patient-like                                      {:page        page                                       :size        size                                       :hospital-id hospital-id                                       :keywords    (str "%" keywords "%")})}}}))}}]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯´æ˜ï¼šæ¥å£çš„page,sizeä¸ºå¿…é¡»å‚æ•°ï¼Œkeywordsæ˜¯éå¿…é¡»å‚æ•°ï¼Œsqlä¸­æ ¹æ®countçš„booleanå€¼åˆ¤æ–­æ˜¯ä¸æ˜¯æ±‚countï¼Œæ ¹æ®keywordsæ˜¯å¦æœ‰å€¼åˆ¤æ–­æ˜¯å¦åŠ æ¨¡ç³ŠæŸ¥è¯¢æ¡ä»¶ï¼Œå®ç°åŠ¨æ€sqlè°ƒç”¨ã€‚<br>æ›´å¤šhugSQLçš„é«˜é˜¶ä½¿ç”¨ï¼Œä½¿ç”¨æ—¶å‚è€ƒ<a href="https://www.hugsql.org/">å®˜ç½‘</a><br>è¾¹ç”¨è¾¹å­¦å§ã€‚</p><ul><li>ä¸€ä¸ªinæŸ¥è¯¢çš„ä¾‹å­ï¼Œä¸‹ä¾‹ä¸­çš„typeç”¨é€—å·éš”å¼€ä¼ å…¥:</li></ul><pre class="line-numbers language-clojure"><code class="language-clojure">:get    {:summary    "åˆ†é¡µè·å–æ‚£è€…æ£€æŸ¥æŠ¥å‘Šåˆ—è¡¨"              :parameters {:query (s/keys :req-un [:base/patient-id ::type])}              :handler    (fn [{{{:keys [type, patient-id]} :query} :parameters}]                            {:status 200                             :body   {:code 1                                      :data (db/get-examine-reports                                              {:patient-id patient-id                                               :types      (str/split type #",")})}})}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>sqlï¼š</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- :name get-reports :? :*</span><span class="token comment" spellcheck="true">-- :doc æŸ¥è¯¢åˆ—è¡¨</span><span class="token keyword">SELECT</span><span class="token operator">*</span><span class="token keyword">FROM</span> <span class="token punctuation">`</span>t_report<span class="token punctuation">`</span><span class="token keyword">WHERE</span> <span class="token punctuation">`</span>deleted<span class="token punctuation">`</span> <span class="token operator">=</span> <span class="token boolean">FALSE</span> <span class="token operator">AND</span> <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token operator">=</span>:id <span class="token operator">AND</span> <span class="token punctuation">`</span><span class="token keyword">type</span><span class="token punctuation">`</span> <span class="token operator">in</span> <span class="token punctuation">(</span>:v<span class="token operator">*</span>:<span class="token keyword">types</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨å¤„ä¿è¯typesæ˜¯ä¸ªarrayå°±è¡Œï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">:get    {:summary    "è·å–æŠ¥å‘Šåˆ—è¡¨"              :parameters {:query (s/keys :req-un [:base/id ::type])}              :handler    (fn [{{{:keys [type, id]} :query} :parameters}]                            {:status 200                             :body   {:code 1                                      :data (db/get-reports                                              {:id id                                               :types      (str/split type #",")})}})}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ‰¹é‡æ“ä½œ,hugsqlæ”¯æŒæ‰¹é‡æ“ä½œï¼Œè¯­æ³•æ˜¯<code>:t*</code>ï¼Œçœ‹çœ‹sql</li></ul><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- :name batch-create-cure-reaction-detail! :! :n</span><span class="token comment" spellcheck="true">-- :doc: æ–°å»º</span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>t_cure_reaction_detail<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>main_id<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span><span class="token keyword">type</span><span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>dict_key_id<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>dict_key_name<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>dict_value_id<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>dict_value_name<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span>    :t<span class="token operator">*</span>:reaction<span class="token operator">-</span>detail<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€ä¸ªUTï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns alk-wxapi.routes.service.cure-reaction-service-test  (:require [clojure.test :as t]            [alk-wxapi.routes.service.cure-reaction-service :as sut]            [alk-wxapi.db.db-patient-cure :as db]            [alk-wxapi.db.core :refer [*db*]]            [luminus-migrations.core :as migrations]            [clojure.java.jdbc :as jdbc]            [alk-wxapi.config :refer [env]]            [mount.core :as mount]))(t/use-fixtures  :once  (fn [f]    (mount/start      #'alk-wxapi.config/env      #'alk-wxapi.db.core/*db*)    (migrations/migrate ["migrate"] (select-keys env [:database-url]))    (f)))(def test-batch-create-cure-reaction-detail-data  '[[1     "REACTION"     62     "å“®å–˜ç—‡çŠ¶"     68     "æ°”é—­"]    [1     "REACTION"     58     "å…¨èº«éç‰¹å¼‚æ€§ååº”"     59     "å‘çƒ­"]    [1     "DISPOSE"     86     "å¤„ç†æ–¹å¼"     89     "å±€éƒ¨å¤„ç†(å†°æ•·)"]])(t/deftest test-batch-create-cure-reaction-detail  (jdbc/with-db-transaction    [t-conn *db*]    (jdbc/db-set-rollback-only! t-conn)    (t/is (= 2 (db/batch-create-cure-reaction-detail-data!                 {:reaction-detail test-batch-create-cure-reaction-detail-data})))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œç»“æœï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(alk-wxapi.db.db-patient-cure/batch-create-cure-reaction-detail!  {:reaction-detail [[1                      "REACTION"                      62                      "å“®å–˜ç—‡çŠ¶"                      68                      "æ°”é—­"]                     [1                      "REACTION"                      58                      "å…¨èº«éç‰¹å¼‚æ€§ååº”"                      59                      "å‘çƒ­"]                     [1                      "DISPOSE"                      86                      "å¤„ç†æ–¹å¼"                      89                      "å±€éƒ¨å¤„ç†(å†°æ•·)"]]})=> 32019-06-15 15:16:06,929 [nRepl-session-353b6f60-9fd8-415c-9baa-19f7eb4a97f9] INFO  jdbc.sqlonly - batching 1 statements: 1: INSERT INTO `t_cure_reaction_detail` (`main_id`, `type`, `dict_key_id`, `dict_key_name`, `dict_value_id`, `dict_value_name`) VALUES (1,'REACTION',62,'å“®å–˜ç—‡çŠ¶',68,'æ°”é—­'),(1,'REACTION',58,'å…¨èº«éç‰¹å¼‚æ€§ååº”',59,'å‘çƒ­'),(1,'DISPOSE',86,'å¤„ç†æ–¹å¼',89,'å±€éƒ¨å¤„ç†(å†°æ•·)')  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦<strong>æ³¨æ„</strong>çš„æ˜¯ä¼ å…¥çš„vectorï¼Œé‡Œé¢ä¹Ÿæ˜¯vectorï¼ŒæŒ‰ç…§sqlä¸­çš„é¡ºåºï¼Œä¸æ˜¯mapç»“æ„ã€‚</p><h4 id="5ã€mysqlä¸­çš„å­—æ®µè¡¨åå’Œå­—æ®µä¸‹åˆ’çº¿åœ¨clojureä¸­ç”¨ä¸­çº¿è¿æ¥çš„ç»Ÿä¸€é€‚é…"><a href="#5ã€mysqlä¸­çš„å­—æ®µè¡¨åå’Œå­—æ®µä¸‹åˆ’çº¿åœ¨clojureä¸­ç”¨ä¸­çº¿è¿æ¥çš„ç»Ÿä¸€é€‚é…" class="headerlink" title="5ã€mysqlä¸­çš„å­—æ®µè¡¨åå’Œå­—æ®µä¸‹åˆ’çº¿åœ¨clojureä¸­ç”¨ä¸­çº¿è¿æ¥çš„ç»Ÿä¸€é€‚é…"></a>5ã€mysqlä¸­çš„å­—æ®µè¡¨åå’Œå­—æ®µä¸‹åˆ’çº¿åœ¨clojureä¸­ç”¨ä¸­çº¿è¿æ¥çš„ç»Ÿä¸€é€‚é…</h4><p><a href="https://github.com/druids/hugsql-adapter-case">druids</a>æä¾›äº†å‡ ä¸ªadapterï¼Œç”¨æ¥å¤„ç†è½¬æ¢å…³ç³»ï¼Œæ¯”å¦‚æœ‰é©¼å³°ï¼Œä¸­çº¿ç­‰ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿æ¥ç¬¦è½¬æ¢ï¼Œå³åˆ›å»ºconnectionæ—¶åŠ å…¥kebab-caseï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defstate ^:dynamic *db*          :start (do (Class/forName "net.sf.log4jdbc.DriverSpy")                     (if-let [jdbc-url (env :database-url)]                       (conman/connect! {:jdbc-url jdbc-url})                       (do                         (log/warn "database connection URL was not found, please set :database-url in your config, e.g: dev-config.edn")                         *db*)))          :stop (conman/disconnect! *db*))(conman/bind-connection *db* {:adapter (kebab-adapter)} "sql/queries.sql")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªadapteråœ¨inité¡¹ç›®æ—¶å·²ç»å¼•å…¥äº†ï¼Œå°±çœ‹ä½¿ç”¨ä¸ä½¿ç”¨ã€‚</p><h4 id="6ã€è·å–ç¯å¢ƒå˜é‡çš„å€¼"><a href="#6ã€è·å–ç¯å¢ƒå˜é‡çš„å€¼" class="headerlink" title="6ã€è·å–ç¯å¢ƒå˜é‡çš„å€¼"></a>6ã€è·å–ç¯å¢ƒå˜é‡çš„å€¼</h4><p>ç¯å¢ƒå˜é‡æ¯”è¾ƒå¥½è·å–ï¼Œæ¯”å¦‚å¾®ä¿¡çš„é…ç½®å’Œè·å–</p><pre class="line-numbers language-clojure"><code class="language-clojure">{:weixin           {:app-id "wx9258d165932dad73"                    :secret "my-secret"}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åœ¨dev/test/prodä¸­é…ç½®ç»“æ„ç›¸åŒï¼Œ</p><pre class="line-numbers language-clojure"><code class="language-clojure">(require '[alk-wxapi.config :refer [env]])(defn get-weixin-access-token [code]  (let [url (format "https://api.weixin.qq.com/sns/oauth2/access_token?appid=%s&secret=%s&code=%s&grant_type=authorization_code"                    (-> env                        :weixin                        :app-id)                    (-> env                        :weixin                        :secret)                    code)]    (log/info "è¯·æ±‚å¾®ä¿¡access-token, url: %s" url) url))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœé…ç½®æ˜¯ä¸€å±‚ï¼Œä½¿ç”¨ä¹Ÿåªéœ€å†™ä¸€å±‚keyã€‚<br><strong>ç‰¹åˆ«è¯´æ˜</strong>ï¼š<br>åœ¨å°†redisçš„connetionä»cljä¿®æ”¹æˆä»ç¯å¢ƒå˜é‡ä¸­è·å–æ—¶ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„é…ç½®å’Œè·å–ï¼Œä½†æ˜¯ç¢°åˆ°äº†é—®é¢˜ï¼Œåœ¨requesté‡ŒæŸ¥çœ‹envä¸­çš„redisçš„å„é¡¹éƒ½æœ‰å€¼ï¼Œä½†æ˜¯è°ƒç”¨redisçš„åœ°æ–¹å´æç¤ºæ— æ³•åˆ›å»ºconnectionï¼Œ</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns alk-wxapi.db.redis  (:require [taoensso.carmine :as car :refer (wcar)]            [alk-wxapi.config :refer [env]]            [mount.core :refer [defstate]]))(def server1-conn          :start          {:pool {}           :spec {:host       (-> env :redis-host)                  :port       (-> env :redis-port)                  :password   (-> env :redis-password)                  :timeout-ms (-> env :redis-timeout-ms)                  :db         (-> env :redis-db)}})(defmacro wcar* [& body] `(car/wcar server1-conn ~@body))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åå¾—çŸ¥æ˜¯å› ä¸ºenvè¢«å®šä¹‰äº†ä¸ªstateï¼Œ</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns alk-wxapi.config  (:require [cprop.core :refer [load-config]]            [cprop.source :as source]            [mount.core :refer [args defstate]]))(defstate env  :start  (load-config    :merge    [(args)     (source/from-system-props)     (source/from-env)]))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯æŒ‰ç…§<a href="https://github.com/ptaoussanis/carmine">è¯´æ˜æ–‡æ¡£</a>redisçš„connæ˜¯ä¸ªå¸¸è§„çš„defå®šä¹‰çš„å‡½æ•°ï¼Œä½†æ˜¯å®ƒä¸‹é¢çš„ä½¿ç”¨æ˜¯ä¸ªå®<code>defmacro </code>ï¼Œå®æ˜¯åœ¨ç¼–è¯‘çš„æ‰§è¡Œçš„ï¼Œå› æ­¤åœ¨åˆå§‹åŒ–æ—¶evnç¯æ²¡æœ‰readyï¼Œæ‰€ä»¥æ— æ³•åˆ›å»ºå‡ºconnectionã€‚éœ€è¦å°†server1-connæ”¹æˆä¸€ä¸ªstateï¼Œstateæœ‰ä¾èµ–çŠ¶æ€ï¼Œä¼šç­‰åˆ°envå®Œæˆåæ‰äº§ç”Ÿã€‚</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defstate server1-conn  ...)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="7ã€jarå¼•å…¥åŠä¾èµ–å†²çªè§£å†³ï¼š"><a href="#7ã€jarå¼•å…¥åŠä¾èµ–å†²çªè§£å†³ï¼š" class="headerlink" title="7ã€jarå¼•å…¥åŠä¾èµ–å†²çªè§£å†³ï¼š"></a>7ã€jarå¼•å…¥åŠä¾èµ–å†²çªè§£å†³ï¼š</h4><ul><li>lein deps :tree  æŸ¥çœ‹åŒ…ä¾èµ–ã€‚</li><li>å¼•å…¥æ–°çš„jaræ—¶åœ¨<code>project.clj</code>çš„<code>:dependencies</code>æŒ‰è¯´æ˜å¼•å…¥ï¼Œè·Ÿmavenä¸€æ ·ï¼Œåˆ†groupIdã€artifactIdã€versionã€‚</li><li>æ’é™¤æŸsdké‡Œçš„æŸäº›å†²çªåŒ…</li></ul><pre class="line-numbers language-clojure"><code class="language-clojure">[com.baidu.aip/java-sdk "4.11.0" :exclusions [org.slf4j/slf4j-simple]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="8ã€specä½¿ç”¨"><a href="#8ã€specä½¿ç”¨" class="headerlink" title="8ã€specä½¿ç”¨"></a>8ã€specä½¿ç”¨</h4><p>specçš„ä½¿ç”¨éœ€è¦å¼•å…¥<code>[clojure.spec.alpha :as s]</code>å’Œ<code>[spec-tools.core :as st]</code>ï¼Œçœ‹ä¸ªspecçš„å®šä¹‰ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(s/def ::page  (st/spec    {:spec            int?     :description     "é¡µç ï¼Œä»0å¼€å§‹"     :swagger/default "0"     :reason          "é¡µç å‚æ•°ä¸èƒ½ä¸ºç©º"}))(s/def ::size  (st/spec    {:spec            int?     :description     "æ¯é¡µæ¡æ•°"     :swagger/default 10     :reason          "æ¡æ•°å‚æ•°ä¸èƒ½ä¸ºç©º"}))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">["/page"    {:get {:summary    "åˆ†é¡µè·å–å­—å…¸æ•°æ®"           :parameters {:query (s/keys :req-un [::page ::size])                        :handler (s/keys :req-un [page]                                         :opt-un [size])}           :handler    (fn [{{{:keys [page, size]} :query} :parameters :as request}]                         {:status 200                          :body   {:code 10                                   :data {:total-elements (->> (db/get-dicts-page {:count true})                                                               (map :total-elements)                                                               (first))                                          :content        (db/get-dicts-page {:page page                                                                              :size size})}}})}}]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>specçš„å‚æ•°ä¹Ÿå¯ä»¥å®šä¹‰åœ¨å…¶ä»–namespaceé‡Œï¼Œä½¿ç”¨æ—¶åŠ ä¸Šnamespaceçš„åå­—å³å¯ï¼Œæ¯”å¦‚ä¸€ä¸ªå«baseçš„namespaceé‡Œå®šä¹‰å‚æ•°å¦‚ä¸‹ï¼š</li></ul><pre class="line-numbers language-clojure"><code class="language-clojure">(s/def :base/role  (st/spec    {:spec        #{"PATIENT", "DOCTOR"}     :description "è§’è‰²"     :reason      "è§’è‰²ä¸èƒ½ä¸ºç©º"}))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªæšä¸¾ç±»å‹çš„specåœ¨å¦ä¸€ä¸ªnamespaceé‡Œä½¿ç”¨æ—¶<strong>ä¸éœ€è¦</strong>åœ¨requireé‡Œå¼•å…¥è¿™ä¸ªbaseï¼Œè€Œç›´æ¥åœ¨specé‡ŒåŠ namespaceçš„åå­—ï¼Œæ˜¯è¿™æ ·çš„ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">:parameters {:header (s/keys :req-un [:base/role])}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ç”¨coll-ofå®šä¹‰å‡ºä¸€ä¸ªlist</li></ul><pre class="line-numbers language-clojure"><code class="language-clojure">(s/def ::head-id id?)(s/def ::url string?)(s/def ::unmatched-head  (s/keys :req [::head-id ::url]))(s/def ::unmatched-head-result  (st/spec   {:spec (s/coll-of ::unmatched-head)}))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†æ¯”å®šä¹‰ä¸€ä¸ªä¸‹é¢çš„postçš„bodyä½“ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">{  "patient-id": "string",  "patient-ext-list": [    {      "dict-id": 0,      "dict-type": "string",      "dict-value": "string",      "other-value": "string"    }  ]}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>specå®šä¹‰</p><pre class="line-numbers language-clojure"><code class="language-clojure">(s/def ::dict-id int?)(s/def ::dict-value string?)(s/def ::dict-type string?)(s/def ::other-value string?)(s/def ::patient-ext-list (s/coll-of (s/keys :req-un [::dict-id ::dict-type ::dict-value ::other-value])))(s/def ::ext-body (s/keys :req-un [:base/patient-id ::patient-ext-list]))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>coll-ofå‡½æ•°è¿˜æ¥æ”¶å¯é€‰çš„å‚æ•°ï¼Œç”¨æ¥å¯¹æ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œé™åˆ¶ï¼Œå¯é€‰å‚æ•°æœ‰å¦‚ä¸‹ï¼š</p><p>â€ƒâ€ƒâ€ƒï¼ˆ1ï¼‰:kind- - - -å¯ä»¥æŒ‡å®šæ•°ç»„çš„ç±»å‹ï¼Œvectorï¼Œsetï¼Œlistç­‰ï¼›</p><p>â€ƒâ€ƒâ€ƒï¼ˆ2ï¼‰:count- - - -å¯ä»¥é™å®šæ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼›</p><p>â€ƒâ€ƒâ€ƒï¼ˆ3ï¼‰:min-count- - - -é™å®šæ•°ç»„ä¸­å…ƒç´ ä¸ªæ•°çš„æœ€å°å€¼</p><p>â€ƒâ€ƒâ€ƒï¼ˆ4ï¼‰:max-count- - - -é™å®šæ•°ç»„ä¸­å…ƒç´ ä¸ªæ•°çš„æœ€å¤§å€¼</p><p>â€ƒâ€ƒâ€ƒï¼ˆ5ï¼‰:distinct- - - -æ•°ç»„æ²¡æœ‰é‡å¤çš„å…ƒç´ </p><p>â€ƒâ€ƒâ€ƒï¼ˆ6ï¼‰:into- - - -å¯ä»¥å°†æ•°ç»„çš„å…ƒç´ æ’å…¥åˆ°[],(),{},#{}è¿™äº›å…¶ä¸­ä¹‹ä¸€ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ”¹å˜conformå‡½æ•°çš„è¿”å›ç»“æœ</p><ul><li>å®šä¹‰ä¸€ä¸ªæŒ‡å®šé•¿åº¦çš„</li></ul><pre class="line-numbers language-clojure"><code class="language-clojure">(s/def ::id  (st/spec   {:spec (s/and string? #(= (count %) 6))    :description "ä¸€ä¸ªé•¿åº¦ä¸º6å­—ç¬¦ä¸²"    :swagger/default "666666"    :reason "å¿…é¡»æ˜¯é•¿åº¦ä¸º6çš„å­—ç¬¦ä¸²"}))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ä½¿ç”¨å‡½æ•°éªŒè¯å‚æ•°åˆæ³•æ€§<pre class="line-numbers language-clojure"><code class="language-clojure">(s/def ::head-body-id(st/spec {:spec (s/and string? (fn [s]                         (let [[head-id body-id] (clojure.string/split s #"-")]                           (and (s/valid? ::head-id head-id)                                (s/valid? ::body-id body-id)))))  :description "ä¸€ä¸ªé•¿åº¦ä¸º13å­—ç¬¦ä¸², head-id å’Œ body-id ç”¨â€˜-â€™ è¿èµ·æ¥"  :swagger/default "666666-999999"  :reason "å¿…é¡»æ˜¯é•¿åº¦ä¸º13çš„å­—ç¬¦ä¸²ï¼Œç”¨-æŠŠbody-idå’Œhead-idè¿èµ·æ¥"}))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>å®šä¹‰æ•°ç»„<pre class="line-numbers language-clojure"><code class="language-clojure">(s/def ::dict-id [string?])    ;Good(s/def ::dict-id vector?)      ;Bad<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ul><p>æ›´å¤šä½¿ç”¨å‚è€ƒï¼š<br><a href="https://www.cnblogs.com/zyfd/p/9962221.html">clojure.specåº“å…¥é—¨å­¦ä¹ </a></p><h4 id="9ã€æ–°å¢æ¥å£åŠ å…¥route"><a href="#9ã€æ–°å¢æ¥å£åŠ å…¥route" class="headerlink" title="9ã€æ–°å¢æ¥å£åŠ å…¥route"></a>9ã€æ–°å¢æ¥å£åŠ å…¥route</h4><p>åˆ›å»ºä¸€ä¸ªæ–°çš„namespaceï¼Œå‚è€ƒ<a href="http://www.luminusweb.net/docs">å®˜ç½‘è¯´æ˜</a>å®šä¹‰å‡ºä¸€ä¸ªrouteså‡½æ•°ï¼Œç„¶åå°†å…¶åŠ å…¥åˆ°handle.cljä¸­å³å¯ï¼Œåƒä¸‹é¢è¿™æ ·ä¸€ç›´conjå³å¯ï¼š<br><img src="/loading.gif" data-original="/images/clojure/%E6%B7%BB%E5%8A%A0route.png" alt="æ·»åŠ route"></p><h4 id="10ã€æ–‡ä»¶ä¸Šä¼ æ¥å£"><a href="#10ã€æ–‡ä»¶ä¸Šä¼ æ¥å£" class="headerlink" title="10ã€æ–‡ä»¶ä¸Šä¼ æ¥å£"></a>10ã€æ–‡ä»¶ä¸Šä¼ æ¥å£</h4><p>æ¥å£å®šä¹‰</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defn format-date-time [timestamp]  (-> "yyyyMMddHHmmss"      (java.text.SimpleDateFormat.)      (.format timestamp)));;ä¸Šä¼ åˆ°æœ¬åœ°(defn upload-file-local [type file]  (let [file-path (str (-> env :file-path) type                       "/" (format-date-time (java.util.Date.))                       "/" (:filename file))]    (io/make-parents file-path)    (with-open [writer (io/output-stream file-path)]      (io/copy (:tempfile file) writer))    (get-image-data file-path)    file-path))(defn common-routes []  ["/common"   {:swagger    {:tags ["æ–‡ä»¶æ¥å£"]}    :parameters {:header (s/keys :req-un [::token ::role])}    :middleware [token-wrap]}   ["/files"    {:post {:summary    "é™„ä»¶ä¸Šä¼ æ¥å£"            :parameters {:multipart {:file multipart/temp-file-part                                     :type (st/spec                                             {:spec        string?                                              :description "ç±»å‹"                                              :reason      "ç±»å‹å¿…å¡«"})}}            :responses  {200 {:body {:code int?, :data {:file-url string?}}}}            :handler    (fn [{{{:keys [type file]} :multipart} :parameters}]                          {:status 200                           :body   {:code    1                                    :message "ä¸Šä¼ æˆåŠŸ"                                    :data    {:file-url (:url (upload-file-local type file))}}})}}]])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœè¦å°†å›¾ç‰‡ä¸Šä¼ è‡³ä¸ƒç‰›ç­‰æœ‰CDNèƒ½åŠ›çš„äº‘å­˜å‚¨ç©ºé—´ï¼Œå¯ä»¥ä½¿ç”¨åˆ«äººçš„è½®å­ï¼Œæˆ–è€…è‡ªå·±éœ€è¦é€ è½®å­ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ª<a href="https://github.com/killme2008/clj.qiniu">åˆ«äººé€ çš„ä¸Šä¼ ä¸ƒç‰›çš„è½®å­</a>,å…ˆåœ¨:dependenciesé‡ŒåŠ å…¥ä¾èµ–</p><pre><code>[clj.qiniu "0.2.1"]</code></pre><p>è°ƒç”¨api</p><pre class="line-numbers language-clojure"><code class="language-clojure">(require '[clj.qiniu :as qiniu]);;ä¸Šä¼ åˆ°ä¸ƒç‰›é…ç½®(defn set-qiniu-config []  (qiniu/set-config! :access-key "my-key"                     :secret-key "my-secret"))(def qiniu-config  {:bucket "medical"   :domain "http://prfmkg8tt.bkt.clouddn.com/"   :prefix "alk/weixin/"})(defn qiniu-upload-path [type filename]  (str (-> qiniu-config :prefix)       type "/"       (utils/format-date-time (java.util.Date.))       "/"       filename));;ä¸ƒç‰›äº‘ä¸Šä¼ ï¼Œè¿”å›ä¸Šä¼ ååœ°å€(defn upload-file-qiniu [type file]  (set-qiniu-config)  (let [filename (:filename file)        bucket (-> qiniu-config :bucket)        key (qiniu-upload-path type filename)        res (qiniu/upload-bucket bucket                                 key                                 (:tempfile file))]    (log/info "ä¸Šä¼ ä¸ƒç‰›äº‘ç»“æœï¼š" res)    (if-not (= 200 (-> res :status))      (throw (Exception. " é™„ä»¶ä¸Šä¼ å¤±è´¥ ")))    (str (-> qiniu-config :domain) key)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨çš„æ—¶å€™å°†ä¸Šä¼ localæ”¹æˆupload-file-qiniuå³å¯ã€‚</p><h4 id="11ã€å…¨å±€è·¨åŸŸé…ç½®"><a href="#11ã€å…¨å±€è·¨åŸŸé…ç½®" class="headerlink" title="11ã€å…¨å±€è·¨åŸŸé…ç½®"></a>11ã€å…¨å±€è·¨åŸŸé…ç½®</h4><p>åœ¨middlewareçš„<code>wrap-base</code>ä¸­åŠ å…¥è·¨åŸŸä¿¡æ¯ï¼Œå…ˆé…ç½®ä¸ª*çš„</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns alk-wxapi.middleware  (:require   [alk-wxapi.env :refer [defaults]]   [alk-wxapi.config :refer [env]]   [ring.middleware.flash :refer [wrap-flash]]   [immutant.web.middleware :refer [wrap-session]]   [ring.middleware.cors :refer [wrap-cors]]   [ring.middleware.defaults :refer [site-defaults wrap-defaults]]))(defn wrap-base [handler]  (-> ((:middleware defaults) handler)      wrap-flash      (wrap-session {:cookie-attrs {:http-only true}})      (wrap-cors :access-control-allow-origin [#".*"]                 :access-control-allow-methods [:get :put :post :delete])      (wrap-defaults       (-> site-defaults           (assoc-in [:security :anti-forgery] false)           (dissoc :session)))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="12ã€å¢åŠ æ‰“åŒ…ç¯å¢ƒ"><a href="#12ã€å¢åŠ æ‰“åŒ…ç¯å¢ƒ" class="headerlink" title="12ã€å¢åŠ æ‰“åŒ…ç¯å¢ƒ"></a>12ã€å¢åŠ æ‰“åŒ…ç¯å¢ƒ</h4><p>æ¯”å¦‚å¢åŠ preç¯å¢ƒï¼Œåœ¨project.cljä¸­é…ç½®uberjarå³å¯ï¼Œåœ¨:profilesé‡Œå¢åŠ ,å¯ä»¥å‚è€ƒtestç¯å¢ƒï¼Œæ¯”å¦‚å¢åŠ çš„uberjar-testç¯å¢ƒï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">   :uberjar-test  {:omit-source    true                   :aot            :all                   :uberjar-name   "alk-wxapi-test.jar"                   :source-paths   ["env/test/clj"]                   :resource-paths ["env/test/resources"]                   :jvm-opts       ["-Dconf=test-config.edn"]}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“åŒ…:</p><pre class="line-numbers language-shell"><code class="language-shell">âœ  alk-wxapi git:(master) âœ— lein with-profiles uberjar-test uberjarCompiling alk-wxapi.common.utilsCompiling alk-wxapi.configCompiling alk-wxapi.coreCompiling alk-wxapi.db.coreCompiling alk-wxapi.db.db-dictsCompiling alk-wxapi.db.db-doctorCompiling alk-wxapi.db.db-guestbookCompiling alk-wxapi.db.db-hospitalCompiling alk-wxapi.db.db-patientCompiling alk-wxapi.db.redisCompiling alk-wxapi.envCompiling alk-wxapi.handlerCompiling alk-wxapi.middlewareCompiling alk-wxapi.middleware.exceptionCompiling alk-wxapi.middleware.formatsCompiling alk-wxapi.middleware.interceptorCompiling alk-wxapi.middleware.log-interceptorCompiling alk-wxapi.middleware.token-interceptorCompiling alk-wxapi.nreplCompiling alk-wxapi.routes.baseCompiling alk-wxapi.routes.dictsCompiling alk-wxapi.routes.doctorCompiling alk-wxapi.routes.fileCompiling alk-wxapi.routes.guestbookCompiling alk-wxapi.routes.hospitalCompiling alk-wxapi.routes.patientCompiling alk-wxapi.routes.patient-costCompiling alk-wxapi.routes.patient-examineCompiling alk-wxapi.routes.publicCompiling alk-wxapi.routes.userCompiling alk-wxapi.routes.weixinCompiling alk-wxapi.validationWarning: skipped duplicate file: config.ednWarning: skipped duplicate file: logback.xmlCreated /Users/mahaiqiang/git/redcreation/alk-wxapi/target/uberjar+uberjar-test/alk-wxapi-0.1.0-SNAPSHOT.jarCreated /Users/mahaiqiang/git/redcreation/alk-wxapi/target/uberjar/alk-wxapi-test.jarâœ  alk-wxapi git:(master) âœ—<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="13ã€äº‹åŠ¡"><a href="#13ã€äº‹åŠ¡" class="headerlink" title="13ã€äº‹åŠ¡"></a>13ã€äº‹åŠ¡</h4><p>å‘èµ·äº‹åŠ¡ä½¿ç”¨<code>conman.core/with-transaction</code>ï¼Œä¸€ä¸ªä¾‹å­ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(let [timestamp (java.util.Date.)      id (utils/generate-db-id)]  (conman.core/with-transaction     [*db*]    (db/create-guestbook! (assoc body-params                            :timestamp timestamp                            :id id))    (db/get-guestbook {:id id})    (throw (ex-info (str "å¼‚å¸¸ï¼Œäº‹åŠ¡å›æ»šï¼Œåˆ—è¡¨ä¸­æŸ¥çœ‹è¯¥idçš„æ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œid:" id) {}))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼šåªæœ‰åœ¨transactionä¸­çš„exceptionå‘ç”Ÿï¼Œäº‹åŠ¡çš„æœºåˆ¶æ‰ä¼šç”Ÿæ•ˆï¼Œæˆ‘æµ‹è¯•æ—¶å°±æ­£å¥½ç¨€é‡Œç³Šæ¶‚æŠŠthrowæ”¾åˆ°äº†with-transactioné‡Œé¢ï¼Œå¯¼è‡´æ€»æ˜¯ä¸ä¼šå›æ»šã€‚</p><h4 id="14ã€å·¥å…·ç±»"><a href="#14ã€å·¥å…·ç±»" class="headerlink" title="14ã€å·¥å…·ç±»"></a>14ã€å·¥å…·ç±»</h4><p>å·¥å…·ç±»Utilså•ç‹¬ä¸€ä¸ªnamespaceï¼Œç›®å‰æ”¶çº³</p><ul><li>è·å–uuid</li></ul><pre class="line-numbers language-clojure"><code class="language-clojure">(defn generate-db-id []  (clojure.string/replace (str (java.util.UUID/randomUUID)) "-" ""))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>æ—¥æœŸæ—¶é—´æ ¼å¼åŒ–</li></ul><pre class="line-numbers language-clojure"><code class="language-clojure">(defn format-time [timestamp]  (-> "yyyy-MM-dd HH:mm:ss"      (java.text.SimpleDateFormat.)      (.format timestamp)))(defn format-date-time [timestamp]  (-> "yyyyMMddHHmmss"      (java.text.SimpleDateFormat.)      (.format timestamp)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="15ã€å®šæ—¶ä»»åŠ¡"><a href="#15ã€å®šæ—¶ä»»åŠ¡" class="headerlink" title="15ã€å®šæ—¶ä»»åŠ¡"></a>15ã€å®šæ—¶ä»»åŠ¡</h4><p>æœ‰ä¸ªæ¯”è¾ƒé‡é‡çº§çš„<a href="http://clojurequartz.info/articles/guides.html">http://clojurequartz.info/articles/guides.html</a>åº“ï¼Œquartzä¸åœ¨javaé‡Œçš„ä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯clojureçš„å®ç°ã€‚<br>æˆ‘ä»¬é¡¹ç›®é‡Œæ²¡æœ‰å¾ˆå¤æ‚çš„éœ€è¦åŠ¨æ€ä¿®æ”¹çš„å®šæ—¶ä»»åŠ¡ï¼Œå› æ­¤é€‰æ‹©äº†ä¸€ä¸ªè½»é‡çº§çš„åº“:<a href="https://github.com/jarohen/chime">chime</a>ï¼Œapiå‚è€ƒgithubã€‚ä¸‹é¢æ˜¯é¡¹ç›®ä¸­çš„ä¸€ä¸ªdemo</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns alk-wxapi.common.scheduler  (:require [chime :refer [chime-ch]]            [clj-time.core :as t]            [clj-time.periodic :refer [periodic-seq]]            [clojure.core.async :as a :refer [<! go-loop]]            [clojure.tools.logging :as log])  (:import org.joda.time.DateTimeZone));; FIXME å®šæ—¶åŠŸèƒ½åº”è¯¥è¿˜æ²¡æœ‰åš    (^_^)(defn times []  (rest (periodic-seq (.. (t/now)                          (withZone (DateTimeZone/getDefault))                          #_(withTime 0 0 0 0))                      (t/minutes 10))))(defn channel []  (a/chan))(defn chime []  (chime-ch (times) {:ch (channel)}))(defn start-scheduler []  (let [chime-channle (chime)]    (go-loop []      (when-let [msg (<! chime-channle)]        (log/error (format "äº²çˆ±çš„ %s, Clojure replæä¸€ä¸ªå°æ—¶äº†ï¼Œä¼‘æ¯ä¸€ä¸‹ï¼Ÿ"                           (System/getProperty "user.name")))        (recur)))    chime-channle))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥å®šæ—¶ä»»åŠ¡é¡¹ç›®å¯åŠ¨åä¸€ä¸ªå°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰§è¡Œåªæ˜¯ç®€å•æ‰“ä¸ªlogï¼Œæ•ˆæœå¦‚ä¸‹ï¼š<br><img src="/loading.gif" data-original="/images/clojure/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1log.png" alt="å®šæ—¶ä»»åŠ¡log"></p><h4 id="16ã€ä¼˜é›…åœ°æ‰“å°jdbcçš„æ‰§è¡Œsql"><a href="#16ã€ä¼˜é›…åœ°æ‰“å°jdbcçš„æ‰§è¡Œsql" class="headerlink" title="16ã€ä¼˜é›…åœ°æ‰“å°jdbcçš„æ‰§è¡Œsql"></a>16ã€ä¼˜é›…åœ°æ‰“å°jdbcçš„æ‰§è¡Œsql</h4><p>é¡¹ç›®ä¸­é»˜è®¤çš„jdbcé©±åŠ¨æ˜¯mysqlè‡ªèº«çš„å¯åŠ¨ï¼Œæ‰€ä»¥é»˜è®¤çš„databaseurlä¹Ÿè®¸æ˜¯è¿™æ ·çš„</p><pre class="line-numbers language-clojure"><code class="language-clojure">:database-url "mysql://localhost:3306/demo?user=root&password=password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶è€Œï¼Œè¿™æ ·çš„é…ç½®æ˜¯ä¸ä¼šæ‰“å°å‡ºjdbcæ‰§è¡Œçš„çœŸæ­£sqlçš„ï¼Œè€Œæˆ‘ä»¬æœ‰æ—¶å€™å¾ˆéœ€è¦è¿™äº›sqlï¼Œå› ä¸ºä»–ä»¬ä»£è¡¨ç€é€»è¾‘ï¼Œæœ‰æ—¶å€™debugä¹Ÿä¼šéœ€è¦ã€‚<br>é‚£ä¹ˆæ€ä¹ˆé…ç½®æ‰èƒ½è¾¾åˆ°ç›®çš„å‘¢ï¼Ÿ<br>æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯log4jdbcï¼Œå› æ­¤éœ€è¦åœ¨project.cljä¸­å¼•å…¥è¯¥åº“ï¼Œ</p><pre class="line-numbers language-clojure"><code class="language-clojure">[com.googlecode.log4jdbc/log4jdbc "1.2"]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¼•å…¥ä»¥åä¿®æ”¹éœ€è¦æŸ¥çœ‹sqlçš„profileé‡Œçš„edné…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚æœ¬åœ°dev-config.edn</p><pre class="line-numbers language-clojure"><code class="language-clojure">:database-url "jdbc:log4jdbc:mysql://localhost:3306/demo?user=root&password=password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åjdbcè¿æ¥å¤„è‡ªç„¶ä¹Ÿå¾—å˜,routes/db/core.clj</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defstate ^:dynamic *db*          :start (do (Class/forName "net.sf.log4jdbc.DriverSpy")                     (if-let [jdbc-url (env :database-url)]                       (conman/connect! {:jdbc-url jdbc-url})                       (do                         (log/warn "database connection URL was not found, please set :database-url in your config, e.g: dev-config.edn")                         *db*)))          :stop (conman/disconnect! *db*))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é»˜è®¤çš„logé…ç½®ï¼Œä½¿ç”¨logbackæ˜¯é…ç½®çš„æ–¹å¼ã€‚<br>è¿™æ ·ä¼šåœ¨logæ§åˆ¶å°çœ‹åˆ°å¾ˆå¤šjdbcçš„logï¼Œå› ä¸ºé»˜è®¤è¿™äº›æ—¥å¿—éƒ½æ˜¯infoçš„ï¼Œéœ€è¦è°ƒæ•´logbacké‡Œæ—¥å¿—çº§åˆ«ã€‚<br>ä¸ºäº†åˆ†å¼€æ‰“å°logã€errorã€sqlçš„logï¼Œé™„ä¸Šæˆ‘æœ¬åœ°çš„logbacké…ç½®æ–‡ä»¶</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">scan</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">scanPeriod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10 seconds<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>statusListener</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.status.NopStatusListener<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>FILE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- å¦‚æœåªæ˜¯æƒ³è¦Infoçº§åˆ«çš„æ—¥å¿—ï¼Œåªæ˜¯è¿‡æ»¤infoè¿˜æ˜¯ä¼šè¾“å‡ºErroræ—¥å¿—ï¼Œå› ä¸ºErrorçš„çº§åˆ«é«˜ï¼Œä½¿ç”¨filterï¼Œå¯ä»¥é¿å…è¾“å‡ºErroræ—¥å¿— --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--è¿‡æ»¤ Error--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--åŒ¹é…åˆ°å°±ç¦æ­¢--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">></span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!--æ²¡æœ‰åŒ¹é…åˆ°å°±å…è®¸--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">></span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>log/info-wxapi.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>log/info-wxapi.%d{yyyy-MM-dd}.%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>100MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!-- keep 30 days of history --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date{ISO8601} [%thread] %-5level %logger{36} - %msg %n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ERRORFILE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!--å¦‚æœåªæ˜¯æƒ³è¦ Error çº§åˆ«çš„æ—¥å¿—ï¼Œé‚£ä¹ˆéœ€è¦è¿‡æ»¤ä¸€ä¸‹ï¼Œé»˜è®¤æ˜¯ info çº§åˆ«çš„ï¼ŒThresholdFilter--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>Error<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>log/error-wxapi.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>log/error-wxapi.%d{yyyy-MM-dd}.%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>100MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!-- keep 30 days of history --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date{ISO8601} [%thread] %-5level %logger{36} - %msg %n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SQLFILE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">></span></span>log/sql-wxapi.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">></span></span>log/sql-wxapi.%d{yyyy-MM-dd}.%i.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeBasedFileNamingAndTriggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxFileSize</span><span class="token punctuation">></span></span>100MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxFileSize</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeBasedFileNamingAndTriggeringPolicy</span><span class="token punctuation">></span></span>            <span class="token comment" spellcheck="true">&lt;!-- keep 30 days of history --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">></span></span>10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">></span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%date{ISO8601} [%thread] %-5level %logger{36} - %msg %n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.apache.http<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.xnio.nio<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.zaxxer.hikari<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>io.undertow.session<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>io.undertow.request<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbc.audit<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbc.sqltiming<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbc.connection<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbc.resultset<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>wxapi<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>FILE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ERRORFILE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbc.sqlonly<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span> <span class="token attr-name">additivity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SQLFILE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ERROR<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ERRORFILE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>FILE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>:as request</code>çš„æ„æ€æ˜¯åŒ…å«å‰é¢æŒ‡å®šè·å–çš„å‚æ•°çš„æ‰€æœ‰ã€‚<br>å½“ç„¶ï¼Œå¦‚ä½ æ‰€çŸ¥ï¼Œclojureç¡®å®è¶³å¤Ÿçµæ´»ï¼Œå–å‚æ–¹å¼ä¹Ÿè¿˜æœ‰æ–¹å¼ï¼Œæ¯”å¦‚</p><pre class="line-numbers language-clojure"><code class="language-clojure">["/path/good-all-params/:id"   {:post {:summary    "æ›´å¤šæ–¹å¼"           :parameters {:path  {:id int?}                        :query {:name string?}                        :body  {:message string?}}           :handler    (fn [{{data :body} :parameters                             {{:keys [id]} :path}    :parameters]                        (ok (format " body params: %s " data)))}}]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œå‚æ•°åç§°<code>data</code>å¯ä»¥å®šä¹‰æˆä»»ä½•ä½ æƒ³å«çš„åå­—ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> clojure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlä¸­å­˜å‚¨å¸¦ç‰¹æ®Šç¬¦å·çš„å¾®ä¿¡æ˜µç§°</title>
      <link href="2019/07/20/mysql-zhong-cun-chu-dai-te-shu-fu-hao-de-wei-xin-ni-cheng/"/>
      <url>2019/07/20/mysql-zhong-cun-chu-dai-te-shu-fu-hao-de-wei-xin-ni-cheng/</url>
      
        <content type="html"><![CDATA[<p>å¾®ä¿¡æ˜µç§°ä¸­æœ‰è¡¨æƒ…ç¬¦å·ï¼Œåœ¨è·å–åˆ°å¾®ä¿¡ä¸ªäººä¿¡æ¯ä¿å­˜åˆ°mysqlæ—¶ï¼Œæ ¼å¼ä¸æ”¯æŒå¯¼è‡´ä¿å­˜å¤±è´¥ï¼Œæ€ä¹ˆè§£å†³ï¼Ÿ</p><p><a href="https://www.jianshu.com/p/3bbf19cd29da">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>é—®é¢˜ï¼š<br>å¾®ä¿¡æ˜µç§°ä¸­æœ‰è¡¨æƒ…ç¬¦å·ï¼Œåœ¨è·å–åˆ°å¾®ä¿¡ä¸ªäººä¿¡æ¯ä¿å­˜åˆ°mysqlæ—¶ï¼Œæ ¼å¼ä¸æ”¯æŒå¯¼è‡´ä¿å­˜å¤±è´¥ã€‚</p><p>ç°è±¡ï¼š<br><img src="/loading.gif" data-original="/images/mysql/mysql-emojo.png" alt="å¾®ä¿¡æ˜µç§°å¸¦è¡¨æƒ…"></p><p>é”™è¯¯ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">Caused by: java.sql.SQLException: Incorrect string value: '\xF0\x9F\x8C\xB2\xE6\x97...' for column 'nick_name' at row 1        at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:129) ~[alk-wxapi.jar:na]        at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97) ~[alk-wxapi.jar:na]        at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[alk-wxapi.jar:na]        at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:975) ~[alk-wxapi.jar:na]        at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1114) ~[alk-wxapi.jar:na]        at com.mysql.cj.jdbc.ClientPreparedStatement.executeBatchSerially(ClientPreparedStatement.java:854) ~[alk-wxapi.jar:na]        ... 82 common frames omitted<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£å†³æ€è·¯ï¼š<br>1ã€ä¿®æ”¹mysqlçš„é…ç½®ï¼Œä¸å¤–ä¹serverç«¯ï¼Œå®¢æˆ·ç«¯ï¼ŒDB<br>2ã€æ•°æ®åº“å­˜base64ï¼Œbase64è¿å›¾ç‰‡éƒ½èƒ½æï¼Œä¸€ä¸ªè¡¨æ¸…åº”è¯¥æ˜¯okçš„ï¼Œåªä¸è¿‡éœ€è¦å­˜å‚¨çš„æ—¶å€™encodeï¼Œæ‹¿å‡ºæ¥å†decode</p><p>è§£å†³æ–¹æ¡ˆï¼š<br>æœæ–­é‡‡ç”¨ç¬¬ä¸€ç§å•Šï¼Œå¹¶å®è·µè¯æ˜ï¼Œæ˜¯ç§‘å­¦+åˆç†+å¿«æ·çš„æ–¹å¼ã€‚<br>ä¿®æ”¹mysqlçš„é…ç½®ï¼Œé…ç½®æ–‡ä»¶ä½ç½®å„ä¸ç›¸åŒï¼Œä¸å†ç´¯èµ˜ã€‚</p><p><img src="/loading.gif" data-original="/images/mysql/mysqld-utf8.png" alt="mysqld-utf8"></p><p>ä¿®æ”¹ç‚¹å°±ä¸€ä¸ªï¼Œmysqldä¸ŠåŠ ä¸ª<code>character-set-server = utf8mb4</code>ï¼Œå°±è¿™ä¸€ä¸ªè€Œå·²ã€‚</p><p>ç„¶åä¿®æ”¹æ•°æ®åº“ã€è¿™ä¸ªè¡¨ã€è¿™ä¸ªå­—æ®µçš„å­—ç¬¦é›†ç±»å‹ä¸º<code>utf8mb4</code>ï¼Œokäº†ã€‚</p><p>éªŒè¯ï¼š<br><img src="/loading.gif" data-original="/images/mysql/mysql-column-utf8.png" alt="å­—æ®µè®¾ç½®"></p><p><img src="/loading.gif" data-original="/images/mysql/mysql-data-emojo.png" alt="å­˜å‚¨"></p><blockquote><p>ç¬¬äºŒç§æ–¹å¼ä¹Ÿç§°åº”ç”¨å±‚è§£å†³æ–¹æ¡ˆ</p></blockquote><p>base64å¯ä»¥ç”¨java.util.Base64ï¼Œä¹Ÿå¯ä»¥ç”¨apacheæä¾›çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ant Design Proæˆ–è€…å…¶ä»–npmç®¡ç†çš„é¡¹ç›®ä¸€é”®è¿œç¨‹éƒ¨ç½²</title>
      <link href="2019/07/17/ant-design-pro-huo-zhe-qi-ta-npm-guan-li-de-xiang-mu-yi-jian-yuan-cheng-bu-shu/"/>
      <url>2019/07/17/ant-design-pro-huo-zhe-qi-ta-npm-guan-li-de-xiang-mu-yi-jian-yuan-cheng-bu-shu/</url>
      
        <content type="html"><![CDATA[<p>npmé¡¹ç›®æ²¡æœ‰jenkinsè¿™æ ·çš„è‡ªåŠ¨æ‰“åŒ…å·¥å…·çš„è¯ï¼Œæœ¬åœ°é…ç½®å¥½å…å¯†ç™»å½•ï¼Œä¸€å¥å‘½ä»¤å®ç°è‡ªåŠ¨éƒ¨ç½²ï¼Œè¿˜æ˜¯æŒºç¾æ»‹æ»‹çš„ã€‚</p><p><a href="https://www.jianshu.com/p/fab7bcc93a12">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å¬èµ·æ¥titleæœ‰ç‚¹ç»•ï¼Œå…¶å®ç›®çš„å¾ˆç®€å•ï¼Œå°±æ˜¯æœ¬åœ°ä¸€æ¡ç®€å•å‘½ä»¤ï¼Œå®ç°å°†é¡¹ç›®æ‰“åŒ…å¹¶ä¸Šä¼ åˆ°æœåŠ¡å™¨è¿™ä¹ˆä¸ªåŠŸèƒ½ã€‚</p><p>å…·ä½“å®ç°</p><p>åœ¨é¡¹ç›®æ ¹ç›®å½•çš„<code>package.json</code>æ–‡ä»¶ä¸­æ‰¾åˆ°scriptsï¼Œç›¸ä¿¡ä½ èƒ½çœ‹åˆ°ä¸å°‘å‘½ä»¤ï¼Œstartã€buildç­‰ç­‰ï¼Œåœ¨æ­¤å¤„å¢åŠ ä¸€æ¡å‘½ä»¤ï¼Œå†…å®¹å¤§æ¦‚å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-json"><code class="language-json"> <span class="token property">"dist"</span><span class="token operator">:</span> <span class="token string">"npm run build &amp;&amp; rsync -p22 -avz --delete-after dist/ root@x.x.x.x:/opt/site/test/antd-pro"</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…¶ä»–æ›´å¤šå‘½ä»¤ï¼Œåœ¨åé¢æ‹¼æ¥ å¤šä¸ª&amp;&amp;å°±å¯ä»¥ã€‚</p><p>è¿è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">yarn dist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…</p><pre class="line-numbers language-shell"><code class="language-shell">npm run dist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£é‡Šï¼š<br>è¿™å¥è¯ä¼šå…ˆæ‰§è¡Œ<code>npm run build </code>ç„¶åå†å°†distç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå½“ç„¶éœ€è¦æ‚¨é…å¥½æœ¬åœ°åˆ°æœåŠ¡å™¨çš„å…å¯†ç™»å½•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åå°ç®¡ç†ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Antd Pro </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macä¸Šå°†mysqlåŠ å…¥ç¯å¢ƒå˜é‡classpath</title>
      <link href="2019/07/16/mac-shang-jiang-mysql-jia-ru-huan-jing-bian-liang-classpath/"/>
      <url>2019/07/16/mac-shang-jiang-mysql-jia-ru-huan-jing-bian-liang-classpath/</url>
      
        <content type="html"><![CDATA[<p>macç³»ç»Ÿä¸Šå®‰è£…äº†mysql serverä»¥åï¼Œå‘½ä»¤è¡Œé‡Œæ²¡æœ‰ï¼Œæç¤º command not found: mysql<br><a href="https://www.jianshu.com/p/8bb66316eb12">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>macä¸Šç©å¼€å‘çš„åŒå¿—å¤šåœ¨ä½¿ç”¨itemsçš„<code>oh-my-zsh</code>è¿™ä¸ªç¥å¥‡ï¼Œä¸çŸ¥é“çš„å¯ä»¥çœ‹çœ‹<a href="https://www.jianshu.com/p/d1c0efe37a43">è¿™ç¯‡æ–‡ç« </a>ã€‚</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜:"></a>é—®é¢˜:</h2><p>æˆ‘æœ¬åœ°å®‰è£…çš„mysqlæœåŠ¡å·²ç»ç”¨äº†å¤§åŠå¹´äº†ï¼Œä»Šå¤©ä¸€ç”¨å‘½ä»¤è¡Œï¼Œå‘ç°å±…ç„¶æ²¡æœ‰</p><pre class="line-numbers language-shell"><code class="language-shell">âœ  ~ which mysqlmysql not foundâœ  ~ whereis mysqlâœ  ~ mysqlzsh: command not found: mysql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è™½ç„¶æˆ‘åŸºæœ¬ä¸ä¼šç”¨ï¼Œä½†æ˜¯æ—¢ç„¶çŸ¥é“äº†ï¼Œå²‚èƒ½ä¸æŠŠå®ƒæå¥½ï¼Œä¸‡ä¸€ç”¨å‘¢ï¼ˆå…¶å®ä¸å¤§å¯èƒ½ï¼‰ã€‚</p><p>è¿˜æ˜¯stackoverflowå¥½ä½¿ï¼Œåœ¨<a href="https://stackoverflow.com/questions/35858052/zsh-command-not-found-mysql">è¿™ç¯‡æ–‡ç« </a>ä¸­å¾ˆå¿«å°±æ‰¾åˆ°äº†ç­”æ¡ˆï¼Œè€Œä¸”é…ç½®ä¹Ÿéå¸¸easyï¼Œä½†æ˜¯æ¯•ç«Ÿä¸æ˜¯è‡ªå·±çš„ï¼Œäºæ˜¯å°±ç®€å•è®°å½•ä¸€ä¸‹ã€‚</p><p>æˆ‘æœ¬åœ°çš„.bash_profileæ–‡ä»¶é‡Œé¢æœ€åé¢å·²ç»åŠ äº†ä¸‹é¢çš„å†…å®¹äº†</p><pre class="line-numbers language-shell"><code class="language-shell">export PATH=${PATH}:/usr/local/mysql/bin/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯ä¾ç„¶æ²¡æœ‰ï¼Œè¿™æ˜¯å‰æã€‚</p><h2 id="æ–¹æ¡ˆï¼š"><a href="#æ–¹æ¡ˆï¼š" class="headerlink" title="æ–¹æ¡ˆï¼š"></a>æ–¹æ¡ˆï¼š</h2><p>ä¿®æ”¹<code>~/.zshrc</code>æ–‡ä»¶ï¼Œåœ¨æœ€ååŠ å…¥</p><pre class="line-numbers language-shell"><code class="language-shell">export PATH=${PATH}:/usr/local/mysql/bin/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶å</p><pre class="line-numbers language-shell"><code class="language-shell">source ~/.zshrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å†æŸ¥çœ‹</p><pre class="line-numbers language-shell"><code class="language-shell">âœ  ~ mysql --versionmysql  Ver 14.14 Distrib 5.7.25, for macos10.14 (x86_64) using  EditLine wrapperâœ  ~ mysql -root -pEnter password:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å®Œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Macä¸Šå®‰è£…å’Œä½¿ç”¨nginx</title>
      <link href="2019/07/10/mac-shang-an-zhuang-he-shi-yong-nginx/"/>
      <url>2019/07/10/mac-shang-an-zhuang-he-shi-yong-nginx/</url>
      
        <content type="html"><![CDATA[<p>macç³»ç»Ÿä¸Šå®‰è£…å’Œé…ç½®nginxä¾›å¼€å‘ä½¿ç”¨</p><p><a href="https://www.jianshu.com/p/a23a634400b0">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="nginxå®‰è£…"><a href="#nginxå®‰è£…" class="headerlink" title="nginxå®‰è£…"></a>nginxå®‰è£…</h2><p>åœ¨macç³»ç»Ÿä¸Šï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰è½¯ä»¶éƒ½å¯ä»¥ç”¨brew(brew åˆå«Homebrewï¼Œbrewç±»ä¼¼CentOSç³»ç»Ÿä¸‹çš„Yumè½¯ä»¶åŒ…ç®¡ç†å·¥å…·ï¼Œèƒ½åœ¨Macä¸­æ–¹ä¾¿çš„å®‰è£…è½¯ä»¶æˆ–è€…å¸è½½è½¯ä»¶ )è¿™ä¸ªç¥å™¨æå®šï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä¸€æšç©·å±Œä¸ä¸ºå•¥éè¦èˆå¼ƒå›½æ°‘é’ççš„windowsç³»ç»Ÿï¼Œè€Œè´¹åŠ²å·´æ‹‰çš„éè¦ç©é»‘è‹¹æœçš„åŸå› ã€‚<br>è¨€å½’æ­£ä¼ ï¼Œ</p><pre class="line-numbers language-shell"><code class="language-shell">brew search nginx             # brew æŸ¥è¯¢Nginxbrew install nginx            # brew å®‰è£…Nginx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å®‰è£…å®Œæˆåï¼Œå¯åœ¨ç»ˆç«¯è¾“é€šè¿‡ brew list nginx æ¥æ˜¾ç¤ºnginxå®‰è£…è·¯å¾„ï¼š</p><ul><li>é€šè¿‡brew installå®‰è£…åº”ç”¨ä¼šåœ¨/usr/local/Cellar/ç›®å½•ä¸‹ï¼›</li><li>æŸäº›åº”ç”¨ä¼šè‡ªåŠ¨åˆ›å»ºè½¯é“¾æ¥æ”¾åœ¨ /usr/bin æˆ–è€… /usr/sbinï¼ŒåŒæ—¶ä¹Ÿå¯èƒ½å°†æ•´ä¸ªæ–‡ä»¶å¤¹æ”¾åœ¨/usr/local</li><li>å¯ä»¥ä½¿ç”¨ brew list è½¯ä»¶å (æ¯”å¦‚ brew list Nginx)ç¡®å®šNginxå®‰è£…ä½ç½®ã€‚</li></ul><pre class="line-numbers language-shell"><code class="language-shell">âœ  ~ brew list nginx/usr/local/Cellar/nginx/1.17.1/.bottle/etc/ (15 files)/usr/local/Cellar/nginx/1.17.1/bin/nginx/usr/local/Cellar/nginx/1.17.1/homebrew.mxcl.nginx.plist/usr/local/Cellar/nginx/1.17.1/html -> ../../../var/www/usr/local/Cellar/nginx/1.17.1/share/man/man8/nginx.8/usr/local/Cellar/nginx/1.17.1/share/nginx/ (2 files)âœ  ~ ll /usr/local/Cellar/nginx/1.17.1total 624-rw-r--r--  1 mahaiqiang  staff   290K  6 25 20:19 CHANGES-rw-r--r--  1 mahaiqiang  staff   678B  7 10 18:57 INSTALL_RECEIPT.json-rw-r--r--  1 mahaiqiang  staff   1.4K  6 25 20:19 LICENSE-rw-r--r--  1 mahaiqiang  staff    49B  6 25 20:19 READMEdrwxr-xr-x  3 mahaiqiang  staff   102B  6 25 20:19 bin-rw-r--r--  1 mahaiqiang  staff   571B  7 10 18:57 homebrew.mxcl.nginx.plistlrwxr-xr-x  1 mahaiqiang  staff    16B  7 10 18:57 html -> ../../../var/wwwdrwxr-xr-x  4 mahaiqiang  staff   136B  6 25 20:19 shareâœ  ~# Nginx wwwç›®å½•âœ  ~ cd /usr/local/Cellar/nginx/1.17.1âœ  1.17.1 ll ../../../var/wwwtotal 16-rw-r--r--  1 mahaiqiang  staff   494B  6 25 20:19 50x.html-rw-r--r--  1 mahaiqiang  staff   612B  6 25 20:19 index.htmlâœ  1.17.1 pwd/usr/local/Cellar/nginx/1.17.1âœ# å¯»æ‰¾Nginx é…ç½®æ–‡ä»¶âœ  ~ find /usr/ -name "nginx.conf"/usr//local/Cellar/nginx/1.17.1/.bottle/etc/nginx/nginx.conf/usr//local/etc/nginx/nginx.conffind: /usr//local/mysql-5.7.25-macos10.14-x86_64/data: Permission deniedfind: /usr//local/mysql-5.7.25-macos10.14-x86_64/keyring: Permission deniedfind: /usr//sbin/authserver: Permission deniedâœ  ~<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œ<code>nginx</code>å‘½ä»¤å¯åŠ¨<br><img src="/loading.gif" data-original="/images/nginx/nginx-8080.png" alt="nginx"></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>ä¸€ä¸‹æŒ‡åé…ç½®æ–‡ä»¶ä½ç½®ä¿¡æ¯ï¼Œæ›´å¤šä½¿ç”¨å‚è€ƒ<a href="https://www.jianshu.com/p/a6472181e6be">Linux ä¸Šæˆ‘å¸¸ç”¨çš„å‡ ç§nginxé…ç½®</a></p><h4 id="1ã€é…ç½®æ–‡ä»¶ä½ç½®"><a href="#1ã€é…ç½®æ–‡ä»¶ä½ç½®" class="headerlink" title="1ã€é…ç½®æ–‡ä»¶ä½ç½®"></a>1ã€é…ç½®æ–‡ä»¶ä½ç½®</h4><pre class="line-numbers language-shell"><code class="language-shell">/usr/local/etc/nginx/nginx.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2ã€è½¯è¿æ¥"><a href="#2ã€è½¯è¿æ¥" class="headerlink" title="2ã€è½¯è¿æ¥"></a>2ã€è½¯è¿æ¥</h4><pre class="line-numbers language-shell"><code class="language-shell">$ which nginx/usr/local/bin/nginx # /usr/bin/nginx æç¤ºæ²¡æƒé™ï¼Œç›´æ¥ç”¨ /usr/local/bin/nginx$ ln -s  /usr/local/sbin/nginx /usr/local/bin/nginx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3ã€Nginx-éšè—ç‰ˆæœ¬å·"><a href="#3ã€Nginx-éšè—ç‰ˆæœ¬å·" class="headerlink" title="3ã€Nginx éšè—ç‰ˆæœ¬å·"></a>3ã€Nginx éšè—ç‰ˆæœ¬å·</h4><p>nginx é…ç½®æ–‡ä»¶é‡Œå¢åŠ &nbsp;server_tokens off;<br>server_tokensä½œç”¨åŸŸæ˜¯http server locationè¯­å¥å—<br>server_tokensé»˜è®¤å€¼æ˜¯onï¼Œè¡¨ç¤ºæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼Œè®¾ç½®server_tokenså€¼æ˜¯offï¼Œå°±å¯ä»¥åœ¨æ‰€æœ‰åœ°æ–¹éšè—nginxçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚<br>éšè—äº† Nginx ç‰ˆæœ¬å·åï¼Œé‡å¯Nginxå³å¯</p><h4 id="4ã€å¤šæ–‡ä»¶é…ç½®"><a href="#4ã€å¤šæ–‡ä»¶é…ç½®" class="headerlink" title="4ã€å¤šæ–‡ä»¶é…ç½®"></a>4ã€å¤šæ–‡ä»¶é…ç½®</h4><p>ç»†å¿ƒçš„ä½ æ‰“å¼€nginx.configä¼šå‘ç°æ–‡ä»¶æœ€åä¸€è¡Œæ˜¯è¿™å¥</p><blockquote><p>include servers/*;</p></blockquote><p>æ²¡é”™ï¼Œè¿™å¥çš„æ„æ€ä½ å¯ä»¥åœ¨è¿™ä¸ªç›®å½•ä¸‹æ”¾è‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œæ¯ä¸ªserverç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ä¼šè¢«åŠ å…¥åˆ°ä¸»é…ç½®æ–‡ä»¶ä¸­ã€‚</p><p>å‰©ä¸‹çš„ç©æ³•è¯·å‚è€ƒ<a href="https://www.jianshu.com/p/a6472181e6be">Linux ä¸Šæˆ‘å¸¸ç”¨çš„å‡ ç§nginxé…ç½®</a>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è·å–å¾®ä¿¡å…¬ä¼—å·çš„openidå¹¶å‘é€æ¨¡æ¿æ¶ˆæ¯ä¹‹å‰åç«¯</title>
      <link href="2019/06/22/huo-qu-wei-xin-gong-zhong-hao-de-openid-bing-fa-song-mo-ban-xiao-xi-zhi-qian-hou-duan/"/>
      <url>2019/06/22/huo-qu-wei-xin-gong-zhong-hao-de-openid-bing-fa-song-mo-ban-xiao-xi-zhi-qian-hou-duan/</url>
      
        <content type="html"><![CDATA[<p>å¾®ä¿¡å…¬ä¼—å·è·å–æˆæƒï¼Œè·å–å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶ä¸”å‘é€æ¨¡æ¿æ¶ˆæ¯ã€‚</p><p><a href="https://www.jianshu.com/p/12b57fc2e95b">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å¦‚ä»Šçš„å¼€å‘æ„Ÿè§‰å·²ç»ç¦»ä¸å¼€å¾®ä¿¡äº†ï¼Œè™½ç„¶ç›¸å…³çš„æ–‡ç« å·²ç»æ¯”å¾®ä¿¡å®˜ç½‘è¿˜è¦å¤šäº†ï¼Œä½†æ˜¯åˆ«äººå®¶çš„å†å¥½ä¹Ÿæ˜¯åˆ«äººå®¶çš„ï¼Œè‡ªå·±èµ°ä¸€éè¿˜æ˜¯æŒºæœ‰æ„ä¹‰çš„ã€‚</p><p>å¦‚æœæ˜¯å¼€å‘ç¯å¢ƒï¼Œè¿˜æ²¡æœ‰å®¡æ ¸çš„å¾®ä¿¡å…¬ä¼—å·ï¼Œé‚£è‡ªç„¶æ˜¯ä¸èƒ½å‘é€æ¨¡æ¿æ¶ˆæ¯çš„ï¼Œåªèƒ½è·å–åˆ°å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯ã€‚éœ€è¦ç”³è¯·ä¸ªæµ‹è¯•çš„å…¬ä¼—å·ï¼Œ<a href="http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login&amp;token=1447200436&amp;lang=zh_CN">å®˜ç½‘</a>å…è´¹ç”³è¯·ã€‚ç”³è¯·å¥½ä»¥åï¼Œéœ€è¦åœ¨â€ç½‘é¡µæœåŠ¡â€-&gt;â€ç½‘é¡µè´¦å·â€é‡Œé…ç½®ä¸€ä¸‹oauth2.0çš„æˆæƒå›è°ƒåœ°å€ã€‚</p><p><img src="/loading.gif" data-original="/images/fontend/weixin-mp-test.png" alt="æµ‹è¯•å·"></p><p>åé¢çš„æ“ä½œå°±è·Ÿä¸‹é¢æˆ‘æ­£å¼çš„å¼€å‘è€…å¹³å°ä¸€æ ·äº†ã€‚</p><p>ä½œä¸ºå‰ç«¯å°ç™½ï¼Œæœ‰æœºä¼šä»é›¶å¼€å§‹ç”³è¯·å…¬ä¼—å·ï¼Œå¼€å‘å…¬ä¼—å·ï¼Œè‡ªç„¶è¦å­¦åˆ°ä»€ä¹ˆè®°å½•ä»€ä¹ˆã€‚<br>æœ¬ç¯‡è®°å½•ä¸‹å¼€å‘ç¯å¢ƒæ€ä¹ˆè·å–openidå¹¶ä¸”å‘é€æ¨¡æ¿æ¶ˆæ¯çš„ã€‚</p><p>å‚è€ƒ<br><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421140842">å¾®ä¿¡ç½‘é¡µå¼€å‘æˆæƒå®˜æ–¹æ–‡æ¡£</a><br><a href="https://www.cnblogs.com/jilu/p/6123447.html">å¾®ä¿¡å…¬ä¼—å¹³å°ï¼Œå¾®ä¿¡ç½‘é¡µæˆæƒï¼Œredirect_uriå‚æ•°é”™è¯¯ï¼Œè§£å†³æ–¹æ³•</a></p><h2 id="è·å–å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯"><a href="#è·å–å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="è·å–å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯"></a>è·å–å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯</h2><p>1ã€å…³æ³¨å¾®ä¿¡å…¬ä¼—å·<br>2ã€ç»‘å®šå¾®ä¿¡å·ç§°ä¸ºç½‘é¡µå¼€å‘è€…<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-setting.png" alt="è®¾ç½®å¼€å‘è€…"><br> 3ã€ä¿®æ”¹å¾®ä¿¡ç½‘é¡µæˆæƒ<br>å…³äºç½‘é¡µæˆæƒå›è°ƒåŸŸåçš„è¯´æ˜</p><ul><li><p>åœ¨å¾®ä¿¡å…¬ä¼—å·è¯·æ±‚ç”¨æˆ·ç½‘é¡µæˆæƒä¹‹å‰ï¼Œå¼€å‘è€…éœ€è¦å…ˆåˆ°å…¬ä¼—å¹³å°å®˜ç½‘ä¸­çš„â€œå¼€å‘ - æ¥å£æƒé™ - ç½‘é¡µæœåŠ¡ - ç½‘é¡µå¸å· - ç½‘é¡µæˆæƒè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯â€çš„é…ç½®é€‰é¡¹ä¸­ï¼Œä¿®æ”¹æˆæƒå›è°ƒåŸŸåã€‚è¯·æ³¨æ„ï¼Œè¿™é‡Œå¡«å†™çš„æ˜¯åŸŸåï¼ˆæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰ï¼Œè€Œä¸æ˜¯URLï¼Œå› æ­¤è¯·å‹¿åŠ  http:// ç­‰åè®®å¤´ï¼› </p></li><li><p>æˆæƒå›è°ƒåŸŸåé…ç½®è§„èŒƒä¸ºå…¨åŸŸåï¼Œæ¯”å¦‚éœ€è¦ç½‘é¡µæˆæƒçš„åŸŸåä¸ºï¼š<a href="http://www.qq.com,é…ç½®ä»¥åæ­¤åŸŸåä¸‹é¢çš„é¡µé¢http//www.qq.com/music.html">www.qq.comï¼Œé…ç½®ä»¥åæ­¤åŸŸåä¸‹é¢çš„é¡µé¢http://www.qq.com/music.html</a> ã€ <a href="http://www.qq.com/login.html">http://www.qq.com/login.html</a> éƒ½å¯ä»¥è¿›è¡ŒOAuth2.0é‰´æƒã€‚ä½†<a href="http://pay.qq.com/">http://pay.qq.com</a> ã€ <a href="http://music.qq.com/">http://music.qq.com</a> ã€ <a href="http://qq.comæ— æ³•è¿›è¡Œoauth2.0é‰´æƒ/">http://qq.comæ— æ³•è¿›è¡ŒOAuth2.0é‰´æƒ</a> </p></li><li><p>å¦‚æœå…¬ä¼—å·ç™»å½•æˆæƒç»™äº†ç¬¬ä¸‰æ–¹å¼€å‘è€…æ¥è¿›è¡Œç®¡ç†ï¼Œåˆ™ä¸å¿…åšä»»ä½•è®¾ç½®ï¼Œç”±ç¬¬ä¸‰æ–¹ä»£æ›¿å…¬ä¼—å·å®ç°ç½‘é¡µæˆæƒå³å¯ã€‚</p></li></ul><p>å…ˆé…ç½®æœåŠ¡å™¨ï¼Œä¿è¯æ ¹åŸŸåä¸‹å¯ä»¥è®¿é—®åˆ°å¾®ä¿¡æä¾›çš„æµ‹è¯•æ–‡ä»¶ã€‚<br>å¦‚æœæ‚¨æ²¡æœ‰å¯ç”¨çš„åŸŸåï¼Œæˆ–è®¸<a href="https://www.jianshu.com/p/4f008e2b7622">è¿™ç¯‡æ–‡ç« </a>å¯ä»¥ç¥æ‚¨ä¸€è‡‚ä¹‹åŠ›ã€‚<br>é…ç½®å¥½ä»¥åæ˜¯è¿™æ ·çš„ï¼š<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-success.png" alt="é…ç½®å¥½æˆæƒå"><br>é…ç½®æˆæƒåŸŸå<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-set-host.png" alt="è®¾ç½®æˆæƒåŸŸå"></p><p><img src="/loading.gif" data-original="/images/fontend/weixin-mp-set-host-ok.png" alt="è®¾ç½®å¥½æˆæƒåŸŸå"></p><ul><li>æ³¨æ„ï¼šè¿™ä¸€æ­¥å¦‚æœæ˜¯tomcatåšçš„å®¹å™¨ï¼Œå°†txtæ–‡ä»¶æ”¾åœ¨tomcat/webapps/ROOT/ä¸‹å³å¯ã€‚<br>  å¦‚æœç”¨çš„nginxè½¬å‘çš„ï¼Œå°†æ–‡ä»¶æ”¾åœ¨æ ¹ç›®å½•å³å¯ã€‚<br>æ¯”å¦‚ï¼šnginxå¦‚ä¸‹ï¼š<pre class="line-numbers language-nginx"><code class="language-nginx">  <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>      <span class="token keyword">root</span>   <span class="token operator">/</span>opt<span class="token operator">/</span>site<span class="token operator">/</span>alk<span class="token operator">-</span>patient<span class="token punctuation">;</span>      <span class="token keyword">index</span>  <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm<span class="token punctuation">;</span>      <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/loading.gif" data-original="/images/fontend/nginx-site-dir.png" alt="nginxä»£ç†ç½‘ç«™ç›®å½•"></li></ul><p><img src="/loading.gif" data-original="/images/fontend/weixin-mp-host-set-ok.png" alt="åŸŸåè®¿é—®è®¾ç½®æˆåŠŸ"></p><p>å¦‚æœè¿™ä¸€æ­¥æ²¡æœ‰é…ç½®ï¼ŒåŸŸåæ˜¯åŠ ä¸ä¸Šå»çš„ã€‚<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-set-host-error.png" alt="æ— æ³•é…ç½®æˆæƒåŸŸå"></p><blockquote><p>è¿™ä¸€æ­¥è¦æ˜¯æœ‰é—®é¢˜ä¸ä¼šé…ï¼Œåªèƒ½è¯´è¿™ä½åå°é€‚åˆå»ä¹°åº†ä¸°åŒ…å­ã€‚</p></blockquote><p>4ã€è·å–code<br>å›è°ƒurlè¦ç”¨urlencodeå¤„ç†ï¼Œæ¯”å¦‚æˆ‘çš„å›è°ƒåœ°å€æ˜¯https%3a%2f%2fxhapp.3vyd.com%2fMP_verify_5J1FbKvfyqtzU26N.txt<br>è®¾ç½®åœ¨å¾®ä¿¡apié‡Œå¦‚ä¸‹<br><code>https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=https%3a%2f%2fxhapp.3vyd.com%2fMP_verify_5J1FbKvfyqtzU26N.txt&amp;response_type=code&amp;scope=snsapi_userinfo&amp;state=123#wechat_redirect</code></p><p>å°†è¯¥URLç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·è®¿é—®å<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-devtool.png" alt="å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€æˆæƒé¡µé¢"></p><p>åŒæ„æˆæƒï¼Œè·³è½¬æˆåŠŸåï¼Œæƒ³è¦çš„codeåœ¨urlé‡Œ<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-redirect-url.png" alt="æˆæƒå®Œæˆ"></p><p>5ã€è·å–å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯<br>è·å–åˆ°äº†codeä»¥åï¼Œè°ƒç”¨æœåŠ¡ç«¯çš„æ¥å£ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯ï¼š</p><p><img src="/loading.gif" data-original="/images/fontend/weixin-mp-get-user-info.png" alt="è·å–åˆ°å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯"><br>æœåŠ¡ç«¯çœ‹<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1433747234">å¾®ä¿¡å®˜ç½‘API</a>ï¼Œå‡ºé—®é¢˜æ¦‚ç‡å¤ªå°ï¼Œä¸å†è´´ä»£ç ã€‚ç²˜ä¸€ä¸‹æœåŠ¡ç«¯æ‰“å‡ºæ¥çš„logï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">=============== REQUEST START =============== request-id:d0ae146d-86fa-4dfb-8224-f0f90b234e4a request-uri: /api/public/weixin/authorized/001g4LGs0ns6xf1qaPGs0kS1Hs0g4LG4 request-method: :get request-query:  request-body:  2019-06-22 15:54:16,796 [XNIO-1 task-2] INFO  alk-wxapi.routes.weixin - è¯·æ±‚å¾®ä¿¡access-tokençš„ url: %s https://api.weixin.qq.com/sns/oauth2/access_token?appid=APPID&secret=SECRET&code=001g4LGs0ns6xf1qaPGs0kS1Hs0g4LG4&grant_type=authorization_code 2019-06-22 15:54:17,056 [XNIO-1 task-2] INFO  alk-wxapi.routes.weixin - ====== è¯·æ±‚å¾®ä¿¡access-tokenè¿”å›ç»“æœ ===== :  {:access_token 22_laqOVUrxrg5URkqS18gzDqdvgsHlkl5tXxBU6pbaqI9kIqdAdDVMk7zw0gMmoUlR2F1uQnhyzfdlmyixsP3qLA, :expires_in 7200, :refresh_token 22_eHVuzmK9VGxgQsxQV0qwCx9eNoECv7506YXsaXQH9LxEMifD5KwXkTRKAG2WxdlIkj9ZthbSC2wFbtaYGfNClg, :openid oIzsW5sck7l9kmtwDb66_RAvdepY, :scope snsapi_userinfo} 2019-06-22 15:54:17,057 [XNIO-1 task-2] INFO  alk-wxapi.routes.weixin - è¯·æ±‚å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯çš„ url: %s https://api.weixin.qq.com/sns/userinfo?access_token=22_laqOVUrxrg5URkqS18gzDqdvgsHlkl5tXxBU6pbaqI9kIqdAdDVMk7zw0gMmoUlR2F1uQnhyzfdlmyixsP3qLA&openid=oIzsW5sck7l9kmtwDb66_RAvdepYlang=zh_CN 2019-06-22 15:54:17,256 [XNIO-1 task-2] INFO  alk-wxapi.routes.weixin - ====== è¯·æ±‚å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯user-infoè¿”å›ç»“æœ ===== :  {:sex 1, :nickname é©¬æµ·å¼º, :city Qingdao, :headimgurl http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLqxGWwK3lTGAffuGickR7V1VjAiawaAicIsoxGGAD0yWf2toLUZGAiaFHwS8QDMvZ2vLW3QJloKTnIPQ/132, :openid oIzsW5sck7l9kmtwDb66_RAvdepY, :language zh_CN, :province Shandong, :country CN, :privilege []} 2019-06-22 15:54:38,673 [XNIO-1 task-2] INFO  jdbc.sqlonly - SELECT * FROM `t_patient` p WHERE p.`deleted` = FALSE AND p.`openid` = 'oIzsW5sck7l9kmtwDb66_RAvdepY';  2019-06-22 15:54:38,834 [XNIO-1 task-2] INFO  jdbc.sqlonly - batching 1 statements: 1: INSERT INTO `t_patient`(`patient_id`, `nick_name`, `gender`, `openid`, `province`, `city`, `country`, `headimgurl`, `unionid`, `create_time`, `status`) values ('a8dfb64eb45549b0b109e7170ac131e0', 'é©¬æµ·å¼º', 'ç”·', 'oIzsW5sck7l9kmtwDb66_RAvdepY', 'Shandong', 'Qingdao', 'CN', 'http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLqxGWwK3lTGAffuGickR7V1VjAiawaAicIsoxGGAD0yWf2toLUZGAiaFHwS8QDMvZ2vLW3QJloKTnIPQ/132', NULL, NOW(), 20);  2019-06-22 15:54:38,841 [XNIO-1 task-2] INFO  alk-wxapi.routes.weixin - å¾®ä¿¡å…¬ä¼—å·æ³¨å†Œæ–°ç”¨æˆ·ï¼Œç”¨æˆ·ä¿¡æ¯ï¼š%s  {:sex 1, :nickname é©¬æµ·å¼º, :city Qingdao, :headimgurl http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLqxGWwK3lTGAffuGickR7V1VjAiawaAicIsoxGGAD0yWf2toLUZGAiaFHwS8QDMvZ2vLW3QJloKTnIPQ/132, :openid oIzsW5sck7l9kmtwDb66_RAvdepY, :language zh_CN, :province Shandong, :country CN, :privilege []} 2019-06-22 15:54:38,843 [XNIO-1 task-2] INFO  alk-wxapi.middleware.log-interceptor - response: {:code 1, :message "æ“ä½œæˆåŠŸ", :data {:sex 1, :nickname "é©¬æµ·å¼º", :city "Qingdao", :headimgurl "http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLqxGWwK3lTGAffuGickR7V1VjAiawaAicIsoxGGAD0yWf2toLUZGAiaFHwS8QDMvZ2vLW3QJloKTnIPQ/132", :openid "oIzsW5sck7l9kmtwDb66_RAvdepY", :language "zh_CN", :province "Shandong", :country "CN", :privilege []}} request-id:d0ae146d-86fa-4dfb-8224-f0f90b234e4a 2019-06-22 15:54:38,853 [XNIO-1 task-2] INFO  alk-wxapi.middleware.log-interceptor - =============== response END ===============<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ°æ­¤ï¼Œè·å¾—ç”¨æˆ·ä¿¡æ¯ã€‚</p><h2 id="å…¬ä¼—å¹³å°é…ç½®æ¨¡æ¿æ¶ˆæ¯"><a href="#å…¬ä¼—å¹³å°é…ç½®æ¨¡æ¿æ¶ˆæ¯" class="headerlink" title="å…¬ä¼—å¹³å°é…ç½®æ¨¡æ¿æ¶ˆæ¯"></a>å…¬ä¼—å¹³å°é…ç½®æ¨¡æ¿æ¶ˆæ¯</h2><p><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1433751277">å®˜æ–¹æ–‡æ¡£</a></p><p>1ã€ä»æ¨¡æ¿åº“ä¸­é€‰æ‹©é€‚åˆè‡ªå·±çš„æ¨¡æ¿ï¼Œæ·»åŠ ç§°ä¸ºè‡ªå·±çš„æ¨¡æ¿ï¼Œè·å–çš„æ¨¡æ¿id<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-template-message1.png" alt="æ¨¡æ¿"></p><p>2ã€æŸ¥çœ‹æ¨¡æ¿æ¶ˆæ¯è¯¦æƒ…ï¼Œç¡®è®¤å­—æ®µå†…å®¹<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-template-message2.png" alt="æ¨¡æ¿è¯¦æƒ…"></p><p>3ã€å…¬ä¼—å·é‡ŒåŸºæœ¬é…ç½®-&gt;IPç™½åå•é…ç½®<a href="https://ip.cn/">å½“å‰ç½‘ç»œå¤–ç½‘åœ°å€</a>IP<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-template-message3.png" alt="è®¾ç½®ipç™½åå•"></p><p>4ã€postmanè°ƒç”¨å‘æ¶ˆæ¯</p><ul><li><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421140183">è·å–access_token</a></li></ul><p><img src="/loading.gif" data-original="/images/fontend/weixin-mp-template-message-gettoken.png" alt="è·å–access token"></p><ul><li>å‘é€æ¨¡æ¿æ¶ˆæ¯<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-template-message5.png" alt="å‘é€æ¨¡æ¿æ¶ˆæ¯"></li></ul><p>æ”¶åˆ°çš„æ¶ˆæ¯<br><img src="/loading.gif" data-original="/images/fontend/weixin-mp-template-message6.png" alt="æ”¶åˆ°æ¶ˆæ¯"></p><p>å®Œç¾ï¼<br>æ”¶å…³ï¼</p>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾®ä¿¡ </tag>
            
            <tag> å…¬ä¼—å· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojureä¸Šä¸€ä¸ªstartæœ€å¤šçš„é›†åˆæ•°æ®å¤„ç†åº“-specter</title>
      <link href="2019/06/21/clojure-shang-yi-ge-start-zui-duo-de-ji-he-shu-ju-chu-li-ku-specter/"/>
      <url>2019/06/21/clojure-shang-yi-ge-start-zui-duo-de-ji-he-shu-ju-chu-li-ku-specter/</url>
      
        <content type="html"><![CDATA[<p>æ­£å¦‚<a href="https://github.com/nathanmarz/specter">ç«™ç‚¹</a>ä»‹ç»<strong>Clojure(Script)â€™s missing piece</strong></p><p><a href="https://www.jianshu.com/p/72c9211f8443">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æ­£å¦‚<a href="https://github.com/nathanmarz/specter">ç«™ç‚¹</a>ä»‹ç»<strong>Clojure(Script)â€™s missing piece</strong></p><p>ä½¿ç”¨ç¤ºä¾‹</p><pre class="line-numbers language-clojure"><code class="language-clojure">(require '[com.rpl.specter :refer :all])      ;;; 1.1 clojure(map inc [1 2 3 4])(into #{} (map inc #{1 2 3 4}))      ;;; 1.2 specter(transform ALL inc #{1 2 3 4} )(transform ALL inc '(1 2 3 4))      ;;; 2 æ–¹ä¾¿çš„æ“ä½œåµŒå¥—æ•°æ®ç»“æ„      ;;; 2.1 Clojure(defn apply-fn-to-map [f m]  (into {}        (for [[k v] m]          [k (f v)]) ))(apply-fn-to-map inc {:a 1 :b 2})(map #(apply-fn-to-map inc %) [{:a 1 :b 1} {:c 1 :d 1}])      ;;; 2.2 Specter(transform [MAP-VALS] inc {:a 1 :b 2})(transform [ALL MAP-VALS] inc [{:a 1 :b 1} {:c 1 :d 1}] )(transform [ALL MAP-VALS even?] inc [{:a 1 :b 2} {:c 3 :d 4}] )      ;;; å·¥ä½œåŸç†[{:a 1 :b 2} {:c 3 :d 4}]      ;;; ALL{:a 1 :b 2}{:c 3 :d 4}      ;;; MAP-VAL1234      ;;; even?24      ;;; inc35      ;;; é‡å»º      ;;; reverse even?1335      ;;; reverse MAP-VAL{:a 1 :b 3}{:c 3 :d 5}      ;;; reverse ALL[{:a 1 :b 3} {:c 3 :d 5}]      ;;; å…·ä½“ä½¿ç”¨(def data {:result [{:hy-x                 45,                     :ft-y                 36,                     :immed-other-dispose  "æ¶‚æŠ¹è¯æ°´2",                     :later-other-reaction nil,                     :cure-id              "1",                     :reaction-time        "2019-05-28T14:01:00",                     :ft-x                 34,                     :immed-other-reaction "èƒ³è†Šçº¢è‚¿3",                     :list                     [{:type          "REACTION",                       :main-id       "1",                       :dict-key-name "å±€éƒ¨ååº”",                       :list                       [{:dict-value-name "æ‰‹è‡‚è‚¿èƒ€",                         :create-time     "2019-05-01T14:02:25",                         :id-2            230,                         :dict-value-id   53,                         :show            true}                        {:dict-value-name "ç–¼ç—›",                         :create-time     "2019-05-01T14:02:25",                         :id-2            231,                         :dict-value-id   55,                         :show            true}                        {:dict-value-name "æ´»åŠ¨å—é™",                         :create-time     "2019-05-01T14:02:25",                         :id-2            232,                         :dict-value-id   57,                         :show            true}                        {:dict-value-name "çƒ­",                         :create-time     "2019-05-01T14:02:25",                         :id-2            247,                         :dict-value-id   54,                         :show            true}                        {:dict-value-name "ç˜™ç—’",                         :create-time     "2019-05-01T14:02:25",                         :id-2            248,                         :dict-value-id   56,                         :show            true}                        {:dict-value-name "æ´»åŠ¨å—é™",                         :dict-value-code "HUODONGSHOUXIAN",                         :parent-id       52,                         :group-code      "REACTION",                         :dict-value-sort 5,                         :dict-value-id   57,                         :show            true}],                       :dict-key-id   52}                      {:type          "REACTION",                       :main-id       "1",                       :dict-key-name "å…¨èº«éç‰¹å¼‚æ€§ååº”",                       :list                       [{:dict-value-name "å‘çƒ­",                         :create-time     "2019-05-01T14:02:25",                         :id-2            233,                         :dict-value-id   59,                         :show            true}                        {:dict-value-name "ç–²å€¦",                         :create-time     "2019-05-01T14:02:25",                         :id-2            234,                         :dict-value-id   60,                         :show            true}                        {:dict-value-name "å…³èŠ‚ç—›",                         :create-time     "2019-05-01T14:02:25",                         :id-2            235,                         :dict-value-id   61,                         :show            true}                        {:dict-value-name "å…³èŠ‚ç—›",                         :dict-value-code "GUANJIETONG",                         :parent-id       58,                         :group-code      "REACTION",                         :dict-value-sort 3,                         :dict-value-id   61,                         :show            true}],                       :dict-key-id   58}                      {:type          "REACTION",                       :main-id       "1",                       :dict-key-name "è¿‡æ•æ€§ç»“è†œç‚ç—‡çŠ¶",                       :list                       [{:dict-value-name "çœ¼ç—’",                         :create-time     "2019-05-01T14:02:25",                         :id-2            256,                         :dict-value-id   75,                         :show            true}                        {:dict-value-name "çœ¼è‚¿",                         :create-time     "2019-05-01T14:02:25",                         :id-2            237,                         :dict-value-id   79,                         :show            true}                        {:dict-value-name "ç»“è†œå……è¡€",                         :create-time     "2019-05-01T14:02:25",                         :id-2            257,                         :dict-value-id   77,                         :show            true}                        {:dict-value-name "ç•å…‰",                         :create-time     "2019-05-01T14:02:25",                         :id-2            258,                         :dict-value-id   78,                         :show            true}                        {:dict-value-name "çœ¼è‚¿",                         :dict-value-code "YANZHONG",                         :parent-id       74,                         :group-code      "REACTION",                         :dict-value-sort 5,                         :dict-value-id   79,                         :show            true}],                       :dict-key-id   74}                      {:type          "DISPOSE",                       :main-id       "1",                       :dict-key-name "å¤„ç†æ–¹å¼",                       :list                       [{:dict-value-name "æŠ—ç»„èƒºè¯",                         :create-time     "2019-05-01T14:02:25",                         :id-2            238,                         :dict-value-id   87,                         :show            true}                        {:dict-value-name "Î²å—ä½“æ¿€åŠ¨å‰‚(é›¾åŒ–)",                         :create-time     "2019-05-01T14:02:25",                         :id-2            239,                         :dict-value-id   90,                         :show            true}                        {:dict-value-name "ç³–çš®è´¨æ¿€ç´ ",                         :create-time     "2019-05-01T14:02:25",                         :id-2            263,                         :dict-value-id   88,                         :show            true}                        {:dict-value-name "å±€éƒ¨å¤„ç†(å†°æ•·)",                         :create-time     "2019-05-01T14:02:25",                         :id-2            264,                         :dict-value-id   89,                         :show            true}],                       :dict-key-id   86}                      {:type          "REACTION",                       :main-id       "1",                       :dict-key-name "å“®å–˜ç—‡çŠ¶",                       :list                       [{:dict-value-name "å’³å—½",                         :create-time     "2019-05-01T14:02:25",                         :id-2            249,                         :dict-value-id   64,                         :show            true}                        {:dict-value-name "èƒ¸é—·",                         :create-time     "2019-05-01T14:02:25",                         :id-2            250,                         :dict-value-id   65,                         :show            true}                        {:dict-value-name "å’½ç—’ä¸é€‚",                         :dict-value-code "YANYANGBUSHI",                         :parent-id       62,                         :group-code      "REACTION",                         :dict-value-sort 5,                         :dict-value-id   67,                         :show            true}],                       :dict-key-id   62}                      {:type          "REACTION",                       :main-id       "1",                       :dict-key-name "é¼»ç‚ç—‡çŠ¶",                       :list                       [{:dict-value-name "é¼»ç—’",                         :create-time     "2019-05-01T14:02:25",                         :id-2            251,                         :dict-value-id   69,                         :show            true}                        {:dict-value-name "å–·åš",                         :create-time     "2019-05-01T14:02:25",                         :id-2            252,                         :dict-value-id   70,                         :show            true}                        {:dict-value-name "æµæ¶•",                         :create-time     "2019-05-01T14:02:25",                         :id-2            253,                         :dict-value-id   71,                         :show            true}                        {:dict-value-name "é¼»å¡",                         :create-time     "2019-05-01T14:02:25",                         :id-2            254,                         :dict-value-id   72,                         :show            true}                        {:dict-value-name "é¼»å¹²",                         :create-time     "2019-05-01T14:02:25",                         :id-2            255,                         :dict-value-id   73,                         :show            true}                        {:dict-value-name "é¼»å¹²",                         :dict-value-code "BIGAN",                         :parent-id       68,                         :group-code      "REACTION",                         :dict-value-sort 6,                         :dict-value-id   73,                         :show            true}],                       :dict-key-id   68}                      {:type          "REACTION",                       :main-id       "1",                       :dict-key-name "è¿‡æ•æ€§çš®è‚¤ç—‡çŠ¶",                       :list                       [{:dict-value-name "è¨éº»ç–¹",                         :create-time     "2019-05-01T14:02:25",                         :id-2            259,                         :dict-value-id   81,                         :show            true}                        {:dict-value-name "æ¹¿ç–¹",                         :create-time     "2019-05-01T14:02:25",                         :id-2            260,                         :dict-value-id   82,                         :show            true}                        {:dict-value-name "çš®è‚¤ç˜™ç—’",                         :create-time     "2019-05-01T14:02:25",                         :id-2            261,                         :dict-value-id   83,                         :show            true}                        {:dict-value-name "è¡€ç®¡æ€§æ°´è‚¿",                         :create-time     "2019-05-01T14:02:25",                         :id-2            262,                         :dict-value-id   84,                         :show            true}                        {:dict-value-name "è¡€ç®¡æ€§æ°´è‚¿",                         :dict-value-code "XUEGUANIXINGSHUIZHONG",                         :parent-id       80,                         :group-code      "REACTION",                         :dict-value-sort 4,                         :dict-value-id   84,                         :show            true}],                       :dict-key-id   80}],                     :id                   1,                     :later-other-dispose  nil,                     :hy-y                 33,                     :reaction-type        "IMMED"}                    {:hy-x                 66,                     :ft-y                 33,                     :immed-other-dispose  "",                     :later-other-reaction "å¤§é¢ç§¯çº¢ç‚¹",                     :cure-id              "1",                     :reaction-time        "2019-05-21T10:03:00",                     :ft-x                 22,                     :immed-other-reaction "",                     :list                     [{:type          "REACTION",                       :main-id       "2",                       :dict-key-name "å…¨èº«éç‰¹å¼‚æ€§ååº”",                       :list                       [{:dict-value-name "å‘çƒ­",                         :create-time     "2019-05-03T14:03:56",                         :id-2            240,                         :dict-value-id   59,                         :show            true}                        {:dict-value-name "å…³èŠ‚ç—›",                         :create-time     "2019-05-03T14:03:56",                         :id-2            241,                         :dict-value-id   61,                         :show            true}                        {:dict-value-name "å…³èŠ‚ç—›",                         :dict-value-code "GUANJIETONG",                         :parent-id       58,                         :group-code      "REACTION",                         :dict-value-sort 3,                         :dict-value-id   61}],                       :dict-key-id   58}                      {:type          "REACTION",                       :main-id       "2",                       :dict-key-name "å“®å–˜ç—‡çŠ¶",                       :list                       [{:dict-value-name "å–˜æ¯",                         :create-time     "2019-05-03T14:03:56",                         :id-2            242,                         :dict-value-id   63,                         :show            true}                        {:dict-value-name "æ°”é—­",                         :create-time     "2019-05-03T14:03:56",                         :id-2            243,                         :dict-value-id   66,                         :show            true}                        {:dict-value-name "å’½ç—’ä¸é€‚",                         :create-time     "2019-05-03T14:03:56",                         :id-2            244,                         :dict-value-id   67,                         :show            true}                        {:dict-value-name "å’½ç—’ä¸é€‚",                         :dict-value-code "YANYANGBUSHI",                         :parent-id       62,                         :group-code      "REACTION",                         :dict-value-sort 5,                         :dict-value-id   67}],                       :dict-key-id   62}                      {:type          "DISPOSE",                       :main-id       "2",                       :dict-key-name "å¤„ç†æ–¹å¼",                       :list                       [{:dict-value-name "ç³–çš®è´¨æ¿€ç´ ",                         :create-time     "2019-05-03T14:03:56",                         :id-2            245,                         :dict-value-id   88,                         :show            true}                        {:dict-value-name "å±€éƒ¨å¤„ç†(å†°æ•·)",                         :create-time     "2019-05-03T14:03:56",                         :id-2            246,                         :dict-value-id   89,                         :show            true}],                       :dict-key-id   86}],                     :id                   2,                     :later-other-dispose  "æŠ¹è¯",                     :hy-y                 88,                     :reaction-type        "LATER"}]})      ;;; 2.2.1 select(select [:result ALL :list ALL :list ALL :show ] data)      ;;; æ‰¾åˆ°:dict-value-name(select [:result ALL :list ALL :list ALL (submap [:dict-value-name :show]) ] data)      ;;; ä½¿ç”¨transformåšæ•°æ®æ›´æ–°(transform [:result ALL :list ALL :list]           (constantly "sdsdsdsdsdd")           data)      ;;; ä½¿ç”¨setvalåšæ•°æ®æ›´æ–°      ;;; æ›¿æ¢ä¸€ä¸ªå€¼(setval [:result  FIRST :hy-x ] "------" data)      ;;; æ›¿æ¢ä¸€ä¸ªcollectionçš„å€¼(setval [:result ALL :list ALL ] "------" data)      ;;; æ’å…¥ä¸€ä¸ªæ–°å€¼(setval [:result FIRST :list FIRST :list (nthpath 1)  ] "------" data)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> clojure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
            <tag> specter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojureç¼–ç¨‹åˆä½“éªŒ</title>
      <link href="2019/06/10/clojure-bian-cheng-chu-ti-yan/"/>
      <url>2019/06/10/clojure-bian-cheng-chu-ti-yan/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨clojureå¼€å‘webæ¥å£å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</p><p><a href="https://www.jianshu.com/p/12b63627fc56">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h4 id="æ”¶è—çš„å­¦ä¹ åœ°å€ï¼š"><a href="#æ”¶è—çš„å­¦ä¹ åœ°å€ï¼š" class="headerlink" title="æ”¶è—çš„å­¦ä¹ åœ°å€ï¼š"></a>æ”¶è—çš„å­¦ä¹ åœ°å€ï¼š</h4><p><a href="http://wiki.fnil.net/index.php?title=Leiningen_tutorial%E4%B8%AD%E6%96%87%E7%89%88">Leiningenä¸­æ–‡æ•™ç¨‹</a><br><a href="http://www.luminusweb.net/docs">luminuswebå®˜æ–¹æ–‡æ¡£</a><br><a href="https://www.cern.cc/post/2016-06-17-clojure-libraries.html">Clojureå¸¸ç”¨åŒ…</a><br><a href="https://cljdoc.org/d/leiningen/leiningen/2.9.1/doc/readme">leiningen  API</a></p><h4 id="å­¦ä¹ ä¸­å‘½ä»¤è¡Œé‡Œæ•²è¿‡çš„"><a href="#å­¦ä¹ ä¸­å‘½ä»¤è¡Œé‡Œæ•²è¿‡çš„" class="headerlink" title="å­¦ä¹ ä¸­å‘½ä»¤è¡Œé‡Œæ•²è¿‡çš„"></a>å­¦ä¹ ä¸­å‘½ä»¤è¡Œé‡Œæ•²è¿‡çš„</h4><pre class="line-numbers language-clojure"><code class="language-clojure">(+ 11 11 1111)(/ 1 2)(doc /)(Take 5 (repeat 10))(1 2 3) => error'(1 2 3) => (1 2 3)(doc if)(def a-array [1 2 3])(def b-array [1 2 3])(idertical? a-array b-array)(def a-list (1 2 3))(def b-list [1 2 3])(type a-list)(type b-list)(conj a-list 9)(conj b-list 9)(def my-add (fn [x y] (+ x y)))(my-add 4 2)`#{1 2 3}`(type #{1 2 3})(type {:a a})(filter even? [1 2 3 ])(map inc [1 2 3])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å¸¸ç”¨çš„ä¸€äº›å‡½æ•°çš„ä½¿ç”¨ä½“ä¼š"><a href="#å¸¸ç”¨çš„ä¸€äº›å‡½æ•°çš„ä½¿ç”¨ä½“ä¼š" class="headerlink" title="å¸¸ç”¨çš„ä¸€äº›å‡½æ•°çš„ä½¿ç”¨ä½“ä¼š"></a>å¸¸ç”¨çš„ä¸€äº›å‡½æ•°çš„ä½¿ç”¨ä½“ä¼š</h4><ol><li>map</li></ol><pre class="line-numbers language-clojure"><code class="language-clojure">;;map  éå†listï¼Œæ ¼å¼åŒ–listé‡Œmapçš„keyå¯¹åº”çš„value(require '[clj-time.format :as f])=> nil(def custom-formatter (f/formatter "yyyyMMdd"))=> #'user/custom-formatter(defn convert-format [d] (f/unparse custom-formatter (f/parse (f/formatter :date-hour-minute-second ) d)))=> #'user/convert-format(map (fn [m] (assoc m :create-time (convert-format (:create-time m))) )     [{:id 1       :create-time "2019-04-17T14:47:24"}      {       :id 2       :create-time "2019-04-17T14:47:44"}])=> ({:id 1, :create-time "20190417"} {:id 2, :create-time "20190417"});;å†å†™ä¸€ä¸ª```clojure(map (fn [m] (assoc m               :office-name (format "%s-%s" (:office-id m) (:office-name m))))       [{   :office-id "1",   :office-name "è€³é¼»å–‰ç§‘",   :hospital-id "1",   :create-time "2019-04-17T14:47:24",   :deleted 0   },  {   :office-id "2",   :office-name "å˜æ€ååº”ç§‘",   :hospital-id "1",   :create-time "2019-04-17T14:47:44",   :deleted 0   }])=>({:office-id "1", :office-name "1-è€³é¼»å–‰ç§‘", :hospital-id "1", :create-time "2019-04-17T14:47:24", :deleted 0} {:office-id "2", :office-name "2-å˜æ€ååº”ç§‘", :hospital-id "1", :create-time "2019-04-17T14:47:44", :deleted 0})<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>dateã€timestampã€string</li></ol><pre class="line-numbers language-clojure"><code class="language-clojure">(import '[java.text SimpleDateFormat]) (import '[java.sql Timestamp]) ;; timelong is the long int time seconds (defn timestamp2date [timelong] (.toString (Timestamp. timelong))) ;; date is date string 04/16/2012 (defn date2timestamp [date] (.getTime (.parse (SimpleDateFormat. "MM/dd/yyyy") date)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li>conj</li><li>seq</li><li>when-let</li><li>comp<br>å°±æ˜¯å¯¹å‚æ•°ä»å³åˆ°å·¦ç»„åˆæ‰§è¡Œæ‰€æœ‰å‡½æ•°ï¼Œå¦‚ä¸‹é¢çš„å‡½æ•°ï¼š <pre class="line-numbers language-clojure"><code class="language-clojure">((comp f1 f2 .. fn) arg1 arg2 .. argn)  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>å¯ä»¥è½¬å˜ä¸ºï¼š<pre class="line-numbers language-clojure"><code class="language-clojure">(f1 (f2 (.. (fn arg1 arg2 .. argn))))  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>ä¸¾ä¾‹<pre class="line-numbers language-clojure"><code class="language-clojure">((comp str +) 8 8 8)   ;;=> "24"(filter (comp not zero?) [0 1 0 2 0 3 0 4]);;=> (1 2 3 4)(map(comp - (partial + 3) (partial * 2))    [1 2 3 4]);;=>  (-5 -7 -9 -11)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>partial<br>å½¢å¦‚ï¼š<code>((partial  f  arg1 arg2 .. argn)  arga argb .. argz)  </code><br>å°±æ˜¯æ‰§è¡Œï¼š<br>(f  arg1 arg2 .. argn  arga argb .. argz)<br>æ³¨æ„ï¼šåå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåé¢è‡³å°‘æœ‰1ä¸ªå…¶ä»–å‚æ•°<br>partialå‡½æ•°ç§°ä¸ºâ€œåå‡½æ•°â€æˆ–è€…â€œéƒ¨åˆ†å®Œæ•´å‡½æ•°â€ï¼Œå› ä¸ºå®ƒæ˜¯ä¸å®Œæ•´çš„ï¼Œå®šä¹‰ä¹Ÿç”¨defè€Œä¸æ˜¯defnã€‚ </li></ol><pre class="line-numbers language-clojure"><code class="language-clojure">user=> (def hundred-times (partial * 100))#'user/hundred-timesuser=> (hundred-times 5)500user=> (hundred-times 4 5 6)12000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="8"><li>reduce</li><li>apply</li></ol><h4 id="å‡½æ•°é—´å¯¹æ¯”ä½¿ç”¨"><a href="#å‡½æ•°é—´å¯¹æ¯”ä½¿ç”¨" class="headerlink" title="å‡½æ•°é—´å¯¹æ¯”ä½¿ç”¨"></a>å‡½æ•°é—´å¯¹æ¯”ä½¿ç”¨</h4><ol><li>assoc vs update-in vs assoc-in<br>è¯´æ³•ä¸ä¸€ï¼Œè¯¦æƒ…å‚è€ƒ<a href="http://www.bertschneider.de/2011/01/11/Assoc-vs-Update/">Assoc-vs-Update/</a><br>assocï¼Œåªå…è®¸æ›´æ–°æ•°æ®ç»“æ„çš„ç¬¬ä¸€å±‚ã€‚å¤„ç†æ•°æ®çš„æ€§èƒ½æœ€é«˜ï¼Œå‡ ä¹æ˜¯assoc-inçš„ä¸¤å€ã€‚<br>assoc-in å’Œupdate-in å¯ä»¥ä½¿ç”¨è·¯å¾„è¡¨è¾¾å¼æ”¹å˜æ•°æ®ç»“æ„çš„å†…å±‚ã€‚<br>å¦‚æœæ–°çš„å€¼ä¸ä¾èµ–æ—§å€¼ï¼Œassoc-inå°±å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œä¸éœ€è¦ä½¿ç”¨update-in;åœ¨æœ‰ä¾èµ–å…³ç³»æ—¶ï¼Œä½¿ç”¨update-in</li></ol><pre class="line-numbers language-clojure"><code class="language-clojure">(defrecord Person [fname lname address]ï¼‰(defrecourd Address [street city state zip])(def stu (Person. "Stu" "Halloway" (Address. "200 N Mangum" "Durham" "NC" 27707)))(assoc stu :fname "Stuart")(upate-in stu [:address :zip] inc)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æœ‰ç”¨çš„ä»£ç æ®µ"><a href="#æœ‰ç”¨çš„ä»£ç æ®µ" class="headerlink" title="æœ‰ç”¨çš„ä»£ç æ®µ"></a>æœ‰ç”¨çš„ä»£ç æ®µ</h4><p>1ã€è®°å½•æ¥å£å“åº”æ—¶é—´middleware</p><pre class="line-numbers language-clojure"><code class="language-clojure">(defn record-response-time [handler]  (fn [req]    (let [start-date (System/currentTimeMillis)]      (handler req)      (let [res-time (- (System/currentTimeMillis) start-date)]        (println (format  "%s took %d ms" (:uri req) res-time))))))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ record-response-time éœ€è¦æ”¾åœ¨ middleware æœ€å¤–å±‚ï¼Œè¿™æ ·å®ƒæ‰èƒ½çºªå½•ä¸€ä¸ªè¯·æ±‚ç»è¿‡æ‰€æœ‰ middleware + handler å¤„ç†çš„æ—¶é—´ã€‚<br><img src="/loading.gif" data-original="/images/clojure/handle-liu.png" alt="ä¸€ä¸ªè¯·æ±‚æµç¨‹"></p><p>2ã€ç§»é™¤mapä¸­å€¼ä¸ºnilçš„key<br>å‚è€ƒ<a href="https://code.i-harness.com/en/q/3c157d">clojure nil? - Remove nil values from a map?</a><br>æˆ‘ä½¿ç”¨çš„ä¸¤ä¸ª</p><pre class="line-numbers language-clojure"><code class="language-clojure">(into {} (filter #(not (nil? (val %))) {:a true :b false :c nil}))<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-clojure"><code class="language-clojure">(into {} (remove #(nil? (val %)) {:a true :b false :c nil}))<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> clojure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot ä¹‹Servletå¯åŠ¨å‰å’Œé…ç½®çƒ­æ›´æ–°</title>
      <link href="2019/06/09/springboot-zhi-servlet-qi-dong-qian-he-pei-zhi-re-geng-xin/"/>
      <url>2019/06/09/springboot-zhi-servlet-qi-dong-qian-he-pei-zhi-re-geng-xin/</url>
      
        <content type="html"><![CDATA[<p>éœ€è¦åœ¨servletå¯åŠ¨åå’Œé”€æ¯å‰åšç‚¹å•¥ï¼Ÿéœ€è¦çƒ­æ›´æ–°é…ç½®æ–‡ä»¶ï¼Ÿæœ¬æ–‡è®°å½•è¿™ä¸¤ä¸ªæ“ä½œ</p><p><a href="https://www.jianshu.com/p/26cace225b5e">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æœ‰ä¸ªé¡¹ç›®é‡Œç”²æ–¹ç²‘ç²‘æäº†ä¸ªéœ€æ±‚ï¼šç»™æ‰€æœ‰æ‰‹æœºå·é»˜è®¤æ²¡å¤©æœ€å¤šå‘é€50æ¡çŸ­ä¿¡ï¼Œä½†æ˜¯å¯ä»¥æ”¹ï¼Œä¿®æ”¹æˆ51çš„è¯ï¼Œé‚£å°±æ¯å¤©å†å¤šå‘ä¸€æ¡å‘—ã€‚</p><p>éœ€æ±‚å¬èµ·æ¥å¾ˆç®€å•ï¼ŒæŠŠ50å­˜åœ¨æ•°æ®åº“çš„system_configè¡¨ä¸­ï¼Œæ¯æ¬¡å‘é€æ—¶ï¼ŒæŸ¥è¯¢ç„¶ååˆ¤æ–­ä¸‹ã€‚</p><p>é…ç½®åœ¨é…ç½®æ–‡ä»¶ä¸­çƒ­æ›´æ–°å¯ä»¥ä½¿é…ç½®ç”Ÿæ•ˆï¼Œä½†æ˜¯æ˜¯ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œå› ä¸ºä¿®æ”¹åçš„å€¼æ²¡æœ‰ä¿å­˜å®¹å™¨é‡å¯åå°±å¤±æ•ˆã€‚</p><p>ä½†æ˜¯èªæ˜å¦‚ä½ ï¼Œè¿™ä¸€å®šä¸æ˜¯æœ€ä¼˜çš„ã€‚</p><p>è¿™ä¸ªéœ€æ±‚ä¸æ˜¯æˆ‘å®ç°çš„ï¼Œä½†æ˜¯æˆ‘å‚ä¸äº†æ–¹æ¡ˆè®¨è®ºï¼Œç°åœ¨å·²ç»å®ç°ï¼Œåœ¨æ­¤è®°å½•ä¸‹æ–¹æ¡ˆå’Œæ–¹å¼ï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚</p><p><strong>æ–¹æ¡ˆä¸€ï¼š</strong></p><blockquote><p>1ã€é»˜è®¤é…ç½®å­˜å‚¨åœ¨DBä¸­<br>   2ã€å®¹å™¨å¯åŠ¨åä»DBä¸­è¯»å–é…ç½®æ•°æ®ï¼Œå¹¶å­˜å…¥Redisï¼Œåé¢ä½¿ç”¨æ—¶ä»¥redisä¸ºå‡†ï¼Œå¦‚æœredisä¸¢å¤±äº†ï¼Œä»DBé‡æ–°è·å–ã€‚<br>3ã€ä¿®æ”¹é…ç½®æ—¶ä¿®æ”¹redisä¸­çš„é…ç½®æ•°æ®ï¼Œå¹¶åŒæ­¥ä¿®æ”¹DBé‡Œçš„æ•°æ®ã€‚</p></blockquote><p>å¼•å…¥redisçš„å¥½å¤„æ—¶æ¯æ¬¡å‘é€æ—¶æ— éœ€è¿›è¡ŒDBçº§çš„æŸ¥è¯¢ï¼Œæé«˜ç›¸åº”æ•ˆç‡ã€‚<br><strong>æ–¹æ¡ˆäºŒï¼š</strong></p><blockquote><p>1ã€é»˜è®¤é…ç½®å­˜å‚¨åœ¨DBä¸­<br>2ã€å®¹å™¨å¯åŠ¨åï¼Œå°†ä»DBä¸­æŸ¥è¯¢åˆ°çš„æ•°æ®ï¼Œåˆ›å»ºå‡ºä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚<br>3ã€ä¿®æ”¹é…ç½®æ—¶ä¿®æ”¹DBä¸­çš„æ•°æ®ï¼ŒåŒæ—¶ä½¿ç”¨é…ç½®çƒ­æ›´æ–°ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„å€¼ã€‚</p></blockquote><p>å¾ˆæ˜æ˜¾é‡ç‚¹æ˜¯<code>å®¹å™¨å¯åŠ¨åè¯»å–DBä¸­çš„æ•°æ®</code>ï¼Œæœ¬æ–‡ä½¿ç”¨æ–¹æ¡ˆäºŒï¼Œä¸Šæºç ï¼š</p><h4 id="ç³»ç»Ÿå±æ€§table"><a href="#ç³»ç»Ÿå±æ€§table" class="headerlink" title="ç³»ç»Ÿå±æ€§table"></a>ç³»ç»Ÿå±æ€§table</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>Entity<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>GeneratedValue<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>Id<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>Inheritance<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>InheritanceType<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>Table<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>GenericGenerator<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>ToString<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * é…ç½®æ–‡ä»¶æ•°æ®è¡¨ * */</span><span class="token annotation punctuation">@ToString</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Entity</span><span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"t_sys_config"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Inheritance</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> InheritanceType<span class="token punctuation">.</span>SINGLE_TABLE<span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysConfig</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">/**     * ä¸»é”®     */</span>    <span class="token annotation punctuation">@Id</span>    <span class="token annotation punctuation">@GenericGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"snowFlakeId"</span><span class="token punctuation">,</span> strategy <span class="token operator">=</span> <span class="token string">"com.hczt.haier.commoncenter.jpa.SnowflakeIdentifierGenerator"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>generator <span class="token operator">=</span> <span class="token string">"snowFlakeId"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> Long id<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">/**     * å±æ€§ç¼–ç      */</span>    <span class="token keyword">private</span> String code<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * å±æ€§å€¼     */</span>    <span class="token keyword">private</span> String value<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * å±æ€§åç§°     */</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * å±æ€§æè¿°     */</span>    <span class="token keyword">private</span> String description<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="åŠ è½½SystemConfig"><a href="#åŠ è½½SystemConfig" class="headerlink" title="åŠ è½½SystemConfig"></a>åŠ è½½SystemConfig</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>regex<span class="token punctuation">.</span>Pattern<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>Collectors<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>PostConstruct<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ConfigurableEnvironment<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>env<span class="token punctuation">.</span>MutablePropertySources<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>env<span class="token punctuation">.</span>PropertiesPropertySource<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>env<span class="token punctuation">.</span>PropertySource<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>hczt<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>smscenter<span class="token punctuation">.</span>db<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>SysConfig<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>hczt<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>smscenter<span class="token punctuation">.</span>service<span class="token punctuation">.</span>SysConfigService<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç³»ç»Ÿå±æ€§é…ç½® * */</span><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SystemConfig</span> <span class="token punctuation">{</span>        <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> ConfigurableEnvironment environment<span class="token punctuation">;</span>        <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> SysConfigService sysConfigService<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">/**     * ä»æ•°æ®åº“åŠ è½½é…ç½®æ–‡ä»¶ä¿¡æ¯     */</span>    <span class="token annotation punctuation">@PostConstruct</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initDbPropertySourceUsage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"ä»æ•°æ®åº“ä¸­åŠ è½½å±æ€§é…ç½®æ–‡ä»¶å¼€å§‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è·å–ç³»ç»Ÿå±æ€§é›†åˆ</span>        MutablePropertySources propertySources <span class="token operator">=</span> environment<span class="token punctuation">.</span><span class="token function">getPropertySources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// ä»æ•°æ®åº“ä¸­è·å–è‡ªå®šä¹‰å˜é‡è¡¨</span>        Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">></span> collect <span class="token operator">=</span> sysConfigService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span>SysConfig<span class="token operator">:</span><span class="token operator">:</span>getCode<span class="token punctuation">,</span> SysConfig<span class="token operator">:</span><span class="token operator">:</span>getValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"ä»æ•°æ®åº“ä¸­è·å–è‡ªå®šä¹‰å˜é‡è¡¨å®Œæˆï¼Œè·å–åˆ°çš„æ•°æ®ä¸ºã€{}ã€‘"</span><span class="token punctuation">,</span> collect<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// å°†è½¬æ¢åçš„åˆ—è¡¨åŠ å…¥å±æ€§ä¸­</span>        Properties properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        properties<span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span>collect<span class="token punctuation">)</span><span class="token punctuation">;</span>                PropertiesPropertySource constants <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertiesPropertySource</span><span class="token punctuation">(</span><span class="token string">"system-config"</span><span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// å®šä¹‰å¯»æ‰¾å±æ€§çš„æ­£åˆ™ï¼Œè¯¥æ­£åˆ™ä¸ºç³»ç»Ÿé»˜è®¤å±æ€§é›†åˆçš„å‰ç¼€</span>        Pattern pattern <span class="token operator">=</span> Pattern<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"^application*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// æ¥æ”¶ç³»ç»Ÿé»˜è®¤å±æ€§é›†åˆçš„åç§°</span>        String name <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// æ¥æ”¶æ˜¯å¦æ‰¾åˆ°ç³»ç»Ÿé»˜è®¤å±æ€§é›†åˆ</span>        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// éå†å±æ€§é›†åˆ</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>PropertySource<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> source <span class="token operator">:</span> propertySources<span class="token punctuation">)</span> <span class="token punctuation">{</span>                            <span class="token comment" spellcheck="true">// æ­£åˆ™åŒ¹é…</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>source<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token comment" spellcheck="true">// æ¥æ”¶åç§°</span>                    name <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">// å˜æ›´æ ‡è¯†</span>                    flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                                        <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>        <span class="token punctuation">}</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// æ‰¾åˆ°åˆ™å°†è‡ªå®šä¹‰å±æ€§æ·»åŠ åˆ°è¯¥å±æ€§å‰</span>                propertySources<span class="token punctuation">.</span><span class="token function">addBefore</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> constants<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// æœªæ‰¾åˆ°åˆ™é»˜è®¤æ·»åŠ åˆ°ç¬¬ä¸€ä½</span>                propertySources<span class="token punctuation">.</span><span class="token function">addFirst</span><span class="token punctuation">(</span>constants<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>                log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"ä»æ•°æ®åº“ä¸­åŠ è½½å±æ€§é…ç½®æ–‡ä»¶ç»“æŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡Œé¢çš„SysConfigServiceåŠä¸æ‰“äº†ï¼Œç›´æ¥è°ƒç”¨äº†Jpaçš„Repositoryè€Œå·²ã€‚</p><p><code>@PostConstruct</code>æ³¨è§£æ­£æ˜¯ä¸ºè§£å†³<code>å®¹å™¨å¯åŠ¨åå¹²å•¥</code>è€Œç”Ÿï¼Œä¸å…¶ç›¸é…çš„æ˜¯<code>@PreDestroy</code>å®¹å™¨é”€æ¯å‰å¹²ç‚¹å•¥ã€‚<br>è¢«@PostConstructä¿®é¥°çš„æ–¹æ³•ä¼šåœ¨æœåŠ¡å™¨åŠ è½½Servletçš„æ—¶å€™è¿è¡Œï¼Œå¹¶ä¸”åªä¼šè¢«æœåŠ¡å™¨æ‰§è¡Œä¸€æ¬¡ã€‚PostConstructåœ¨æ„é€ å‡½æ•°ä¹‹åæ‰§è¡Œï¼Œinitï¼ˆï¼‰æ–¹æ³•ä¹‹å‰æ‰§è¡Œã€‚PreDestroyï¼ˆï¼‰æ–¹æ³•åœ¨destroyï¼ˆï¼‰æ–¹æ³•çŸ¥æ€§ä¹‹åæ‰§è¡Œ<br><img src="/loading.gif" data-original="/images/java/servlet.png" alt="postconstruct"><br>å¦å¤–ï¼Œspringä¸­Constructorã€@Autowiredã€@PostConstructçš„é¡ºåºå…¶å®ä»ä¾èµ–æ³¨å…¥çš„å­—é¢æ„æ€å°±å¯ä»¥çŸ¥é“ï¼Œè¦å°†å¯¹è±¡pæ³¨å…¥åˆ°å¯¹è±¡aï¼Œé‚£ä¹ˆé¦–å…ˆå°±å¿…é¡»å¾—ç”Ÿæˆå¯¹è±¡aå’Œå¯¹è±¡pï¼Œæ‰èƒ½æ‰§è¡Œæ³¨å…¥ã€‚<br>æ‰€ä»¥ï¼Œå¦‚æœä¸€ä¸ªç±»Aä¸­æœ‰ä¸ªæˆå‘˜å˜é‡pè¢«@Autowriedæ³¨è§£ï¼Œé‚£ä¹ˆ@Autowiredæ³¨å…¥æ˜¯å‘ç”Ÿåœ¨Açš„æ„é€ æ–¹æ³•æ‰§è¡Œå®Œä¹‹åçš„ã€‚å¦‚æœæƒ³åœ¨ç”Ÿæˆå¯¹è±¡æ—¶å®ŒæˆæŸäº›åˆå§‹åŒ–æ“ä½œï¼Œè€Œååè¿™äº›åˆå§‹åŒ–æ“ä½œåˆä¾èµ–äºä¾èµ–æ³¨å…¥ï¼Œé‚£ä¹ˆä¹…æ— æ³•åœ¨æ„é€ å‡½æ•°ä¸­å®ç°ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥ä½¿ç”¨@PostConstructæ³¨è§£ä¸€ä¸ªæ–¹æ³•æ¥å®Œæˆåˆå§‹åŒ–ï¼Œ@PostConstructæ³¨è§£çš„æ–¹æ³•å°†ä¼šåœ¨ä¾èµ–æ³¨å…¥å®Œæˆåè¢«è‡ªåŠ¨è°ƒç”¨ã€‚</p><h4 id="å®šä¹‰å±æ€§åˆ·æ–°ç›‘å¬å™¨"><a href="#å®šä¹‰å±æ€§åˆ·æ–°ç›‘å¬å™¨" class="headerlink" title="å®šä¹‰å±æ€§åˆ·æ–°ç›‘å¬å™¨"></a>å®šä¹‰å±æ€§åˆ·æ–°ç›‘å¬å™¨</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>context<span class="token punctuation">.</span>scope<span class="token punctuation">.</span>refresh<span class="token punctuation">.</span>RefreshScopeRefreshedEvent<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>event<span class="token punctuation">.</span>EventListener<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * è‡ªå®šä¹‰å±æ€§åˆ·æ–°ç›‘å¬å™¨ * å½“è°ƒç”¨/actuator/refreshæ¥å£æ—¶ä¼šè°ƒç”¨onRefreshæ–¹æ³• * */</span><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PropertiesRefreshEventListener</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> SystemConfig systemConfig<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">/**     * å±æ€§åˆ·æ–°äº‹ä»¶ç›‘å¬æ–¹æ³•     * å½“æ­¤æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè¡¨ç¤º/actuator/refreshæ–¹æ³•è¢«è°ƒç”¨     * @param event     */</span>    <span class="token annotation punctuation">@EventListener</span><span class="token punctuation">(</span>RefreshScopeRefreshedEvent<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onRefresh</span><span class="token punctuation">(</span>RefreshScopeRefreshedEvent event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"é‡æ–°ä»æ•°æ®åº“è£…è½½å±æ€§"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        systemConfig<span class="token punctuation">.</span><span class="token function">initDbPropertySourceUsage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯åŠ¨é…ç½®çƒ­æ›´æ–°</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**     * çŸ­ä¿¡å‘é€æ¥å£ï¼ˆé‡‡ç”¨redis channel å®ç° pub/sub æ¨¡å¼ï¼‰     * @param ipInfo  å®¢æˆ·ç«¯ipä¿¡æ¯     * @param appInfo è¯·æ±‚åº”ç”¨ä¿¡æ¯     * @param msgInfo çŸ­ä¿¡å‘é€ä¿¡æ¯     * @return     */</span>    <span class="token annotation punctuation">@RefreshScope</span>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/send"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> RtnResult<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token function">sendSmsCodeChannel</span><span class="token punctuation">(</span>IpInfo ipInfo<span class="token punctuation">,</span>                                                AppInfo appInfo<span class="token punctuation">,</span>                                                <span class="token annotation punctuation">@Validated</span> <span class="token annotation punctuation">@RequestBody</span> MsgInfo msgInfo<span class="token punctuation">,</span>                                                <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${smsCode.limitCount}"</span><span class="token punctuation">)</span> Long smsLimitCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"åº”ç”¨ã€{}ã€‘IPåœ°å€ã€{}ã€‘é‡‡ç”¨Redis Channelæ–¹å¼è¯·æ±‚çŸ­ä¿¡å‘é€æ¥å£ï¼Œè¯·æ±‚å‚æ•°ä¸ºã€{}ã€‘"</span><span class="token punctuation">,</span>                appInfo<span class="token punctuation">.</span><span class="token function">getAppId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ipInfo<span class="token punctuation">.</span><span class="token function">getIpAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msgInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// åˆ¤æ–­çŸ­ä¿¡å‘é€æ¬¡æ•°æ˜¯å¦è¶…é™ï¼ˆæ¯åº”ç”¨æ¯å¤©æ¯æ‰‹æœºå·ï¼‰</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">checkSmsCountOver</span><span class="token punctuation">(</span>appInfo<span class="token punctuation">,</span> msgInfo<span class="token punctuation">,</span>smsLimitCount<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> RtnResult<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>SmsCodeMsg<span class="token punctuation">.</span>SMS_COUNT_OVER<span class="token punctuation">.</span><span class="token function">fillArgs</span><span class="token punctuation">(</span>msgInfo<span class="token punctuation">.</span><span class="token function">getMobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// ç»„è£…å‘é€é˜Ÿåˆ—æ¡ä»¶</span>        AsyncSmsInfo asyncSmsInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AsyncSmsInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        asyncSmsInfo<span class="token punctuation">.</span><span class="token function">setAppId</span><span class="token punctuation">(</span>appInfo<span class="token punctuation">.</span><span class="token function">getAppId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        asyncSmsInfo<span class="token punctuation">.</span><span class="token function">setAppName</span><span class="token punctuation">(</span>appInfo<span class="token punctuation">.</span><span class="token function">getAppName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        asyncSmsInfo<span class="token punctuation">.</span><span class="token function">setMobileSign</span><span class="token punctuation">(</span>appInfo<span class="token punctuation">.</span><span class="token function">getMobileSign</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        asyncSmsInfo<span class="token punctuation">.</span><span class="token function">setSmsCodeExpire</span><span class="token punctuation">(</span>appInfo<span class="token punctuation">.</span><span class="token function">getSmsCodeExpire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        asyncSmsInfo<span class="token punctuation">.</span><span class="token function">setSmsCodeLength</span><span class="token punctuation">(</span>appInfo<span class="token punctuation">.</span><span class="token function">getSmsCodeLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        asyncSmsInfo<span class="token punctuation">.</span><span class="token function">setMobile</span><span class="token punctuation">(</span>msgInfo<span class="token punctuation">.</span><span class="token function">getMobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        asyncSmsInfo<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span>msgInfo<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        asyncSmsInfo<span class="token punctuation">.</span><span class="token function">setIpAddress</span><span class="token punctuation">(</span>ipInfo<span class="token punctuation">.</span><span class="token function">getIpAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        asyncSmsInfo<span class="token punctuation">.</span><span class="token function">setInvokeTime</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// å¼‚æ­¥å‘é€çŸ­ä¿¡ï¼Œå°†ä¿¡æ¯æ¨é€åˆ°Redisæ¶ˆæ¯æœåŠ¡é˜Ÿåˆ—</span>            publisherService<span class="token punctuation">.</span><span class="token function">pushSms</span><span class="token punctuation">(</span>asyncSmsInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BizException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> RtnResult<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>SmsCodeMsg<span class="token punctuation">.</span>SMS_PUBLISH_ERROR<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>                <span class="token keyword">long</span> end <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"åº”ç”¨ã€{}ã€‘IPåœ°å€ã€{}ã€‘é‡‡ç”¨Redis Channelæ–¹å¼è¯·æ±‚çŸ­ä¿¡å‘é€æ¥å£ï¼Œè¯·æ±‚å‚æ•°ä¸ºã€{}ã€‘å®Œæˆï¼Œæ‰§è¡Œæ—¶é—´ä¸ºã€{}ã€‘ms"</span><span class="token punctuation">,</span> appInfo<span class="token punctuation">.</span><span class="token function">getAppId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ipInfo<span class="token punctuation">.</span><span class="token function">getIpAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msgInfo<span class="token punctuation">,</span> end<span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> RtnResult<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span>EMPTY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ–‡ä¸­æåˆ°çš„redis channelå‘é€æ¶ˆæ¯æ¨¡å¼ä¸æ˜¯é‡ç‚¹ï¼Œä¸åœ¨è®²è§£ä½¿ç”¨çš„æ˜¯redisTemplateçš„convertAndSendæ–¹æ³•ï¼Œæœ‰éœ€è¦æ—¶è‡ªè¡ŒæŸ¥é˜…ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.jianshu.com/p/98cf7d8b9ec3">@PostConstruct</a><br><a href="https://blog.csdn.net/zzzgd_666/article/details/84322947">SpringCloudé…ç½®çƒ­æ›´æ–°@RefreshScope,ä»¥åŠæ²¡æœ‰å‡ºç°/refreshçš„åŠ¨æ€åˆ·æ–°åœ°å€,è®¿é—®404çš„è§£å†³åŠæ³•</a></p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> springboot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jenkinsä¸Šä½¿ç”¨shellè„šæœ¬nohupéƒ¨ç½²jaræœåŠ¡åˆ°remoteæœåŠ¡å™¨</title>
      <link href="2019/06/03/jenkins-shang-shi-yong-shell-jiao-ben-nohup-bu-shu-jar-fu-wu-dao-remote-fu-wu-qi/"/>
      <url>2019/06/03/jenkins-shang-shi-yong-shell-jiao-ben-nohup-bu-shu-jar-fu-wu-dao-remote-fu-wu-qi/</url>
      
        <content type="html"><![CDATA[<p>jenkinsä¸Šä½¿ç”¨shellç”¨nohup java -jaréƒ¨ç½²æœåŠ¡åˆ°è¿œç¨‹æœåŠ¡å™¨é‡åˆ°çš„å‘</p><p><a href="https://www.jianshu.com/p/34708c0fde16">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å…ˆè´´ä¸€ä¸‹ï¼Œæˆ‘çš„jenkinsé‡Œæœ€åæ ¸å¿ƒé…ç½®</p><pre class="line-numbers language-shell"><code class="language-shell">#åœæ­¢æœåŠ¡ï¼Œå¤‡ä»½jarssh -p 22 root@0.0.0.0 'bash -s ' < /opt/auto-deploy-scripts/remove_jar.sh /opt/jar/ alk-wxapi-test.jar#copy jarscp -P22 /mnt/jenkins/workspace/alk_api_test_auto_deploy/target/uberjar/alk-wxapi-test.jar root@0.0.0.0:/opt/jar/#é‡å¯æœåŠ¡ssh -p 22 root@0.0.0.0 'bash -s' < /opt/auto-deploy-scripts/start_jar.sh /usr/local/jdk1.8.0_212 /opt/jar/ alk-wxapi-test.jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>remove_jar.shè„šæœ¬ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/bash#è·å–ç¬¬ä¸€ä¸ªå‚æ•°,jaråŒ…è·¯å¾„,å…ˆå¤‡ä»½,å†å‘å¸ƒjar_path=$1#!ç¼–è¯‘å¥½çš„jaråŒ…åç§°jar_name=$2file=$jar_path$jar_namebak_file=`date +%Y%m%d%H%M%S`.$jar_namebak_path="bak/"if [ $jar_name == ""  ] ;thenecho " jar name is null"exit 5elseecho "================== service stop start======================="pid=`ps -aux | grep $jar_name | grep -v bash |grep -v grep | awk '{print $2}'`if [ -n "${pid}" ]then#!kill -9 å¼ºåˆ¶ç»ˆæ­¢   echo "kill -9 çš„pid:" $pid   kill -9 $pidfiecho "================== service stop end ======================="echo "service stop successed!"echo "================== jar backup start ======================="#!å°†ç°æœ‰çš„jarå¤‡ä»½åï¼Œå°†æ–°çš„jaråŒ…æ›¿æ¢cd $jar_pathecho "file origin is: $file"echo "backup jar is: $jar_path$bak_path"if [ -f "$file" ]thenrm -rf $jar_path$bak_path/*mv $jar_name $bak_filecp $bak_file $jar_path$bak_pathrm -rf $bak_filefiecho "================== jar backup end ======================="fi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>start_jar.shè„šæœ¬å†…å®¹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">#!å¯åŠ¨åº”ç”¨#!stop.sh#!/bin/bashecho "================== startup start ======================="#è·å–ç¬¬1ä¸ªå‚æ•°ï¼Œjdkçš„å®‰è£…è·¯å¾„jdk_path=$1#è·å–ç¬¬2ä¸ªå‚æ•°,jaråŒ…è·¯å¾„,å…ˆå¤‡ä»½,å†å‘å¸ƒjar_path=$2#ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç¼–è¯‘å¥½çš„jaråŒ…åç§°jar_name=$3file=$jar_path$jar_name#è¿œç¨‹æ‰§è¡Œè¯¥è„šæœ¬æ—¶æ”¹å˜äº†ç¯å¢ƒå˜é‡ï¼Œæ‰¾ä¸åˆ°javaçš„ç¯å¢ƒå˜é‡ï¼Œæç¤ºï¼šnohup: failed to run command â€˜javaâ€™: No such file or directory#æ‰€ä»¥éœ€è¦åŠ ä¸Šä»¥ä¸‹javaçš„ç¯å¢ƒå˜é‡ï¼Œå…¶ä¸­JAVA_HOMEçš„å€¼ï¼Œå¯ä»¥é€šè¿‡æ‰§è¡Œå‘½ä»¤echo $JAVA_HOMEå¾—åˆ°ï¼Œæ¯ä¸ªäººçš„javaç¯å¢ƒå˜é‡è®¾ç½®ä¸ä¸€æ ·#è¯¥é—®é¢˜å‚è€ƒè‡ªï¼šhttps://stackoverflow.com/questions/20791846/zookeeper-not-starting-nohup-errorexport JAVA_HOME=${jdk_path}export PATH=$JAVA_HOME/bin:$PATHecho "æˆäºˆå½“å‰ç”¨æˆ·æƒé™"#chmod 777 $fileecho "æ‰§è¡Œ....."cd $jar_pathnohup java -jar $file > ${jar_path}/log/nohup.log 2>&1 &echo "å¯åŠ¨jarçš„å‘½ä»¤: nohup java -jar $file > ${jar_path}log/nohup.log 2>&1 & "echo "================== startup end ======================="<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>remove_jar.sh</code>å’Œ<code>start_jar.sh</code>åœ¨jenkinsæœåŠ¡å™¨ä¸Šï¼Œéœ€è¦å°†è¿™ä¸¤ä¸ªshellåœ¨0.0.0.0ï¼ˆä¸èƒ½æš´éœ²ï¼‰çš„è¿œç«¯å»æ‰§è¡Œ<br>æ²¡é”™ï¼Œå®¢å®˜æ‚¨ä¸€çœ¼å°±çœ‹å‡ºæ¥äº†ï¼Œè§‰å¾—ç®€å•çš„ä¸å€¼ä¸€æå§ï¼Œå…ˆåˆ«ç€æ€¥ï¼Œå¯¹æœè¿™ä¸ªé—®é¢˜çš„å°èœé¸¡æ¥è¯´è¿™é‡Œé¢ä¹Ÿæ˜¯å¤§æœ‰æ–‡ç« ï¼Œå¬æˆ‘ä¸€ä¸€é“æ¥ã€‚</p><p>1ã€ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šps -ef|grep xxx.jaræŸ¥åˆ°å¤šä½™çš„pid<br>ç°è±¡ï¼šåœ¨0.0.0.0ä¸Šè¡Œ<code>ps -ef | grep alk-wxapi-test.jar | grep -v grep | awk '{print $2}'</code>åªèƒ½æŸ¥åˆ°ä¸€ä¸ªpidï¼Œä½†æ˜¯æŠŠè¿™å¥è¯æ”¾åˆ°shellè„šæœ¬é‡Œï¼Œåœ¨æœ¬åœ°ä½¿ç”¨å‘½ä»¤ä¸Šè¿œç«¯æ‰§è¡Œï¼Œå°±ä¼šæ‰¾åˆ°3ä¸ªpidï¼Œè€Œä¸”kill æ—¶æç¤ºå¤±è´¥çš„é”™è¯¯ã€‚<br>ç°åœ¨å·²ç»çŸ¥é“åŸå› äº†ï¼Œä½†æ˜¯å½“æ—¶ç¡®å®æ˜¯ä¸ªé—®é¢˜ã€‚<br>å·²ç»è§£å†³ä¸æ–¹ä¾¿å¤ç°äº†ï¼Œå› æ­¤å°±æè¿°ä¸€ä¸‹å°±è¡Œäº†ã€‚<br>åŸå› ï¼šshellé‡Œçš„è¿™ä¸ªå‘½ä»¤ä¹Ÿæ˜¯é€šè¿‡bashåœ¨è¿œç¨‹æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æ‰¾åˆ°çš„åˆ«çš„<em>æ— å…³ç´§è¦</em>çš„pidå…¶å®æ˜¯bashï¼Œå› æ­¤åœ¨grepæ˜¯é™¤äº†æ’é™¤grepæœ¬èº«(<code>grep -v grep</code>)å¤–è¿˜è¦æ’é™¤bashï¼ˆ<code>grep -v bash</code>ï¼‰<br>æœ€åå‘½ä»¤æ˜¯ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">pid=`ps -aux | grep $jar_name | grep -v bash |grep -v grep | awk '{print $2}'`<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ã€è¿œç¨‹æ‰§è¡Œè„šæœ¬ï¼Œé‡Œé¢æœ‰nohup java -jar,å‘ç”Ÿé”™è¯¯ï¼š<code>nohup: failed to run command â€˜javaâ€™: No such file or directory</code><br>è¿™æ˜¯å› ä¸ºnohupæ—¶javaç¯å¢ƒå˜é‡æ²¡æœ‰è¯»åˆ°ï¼Œå¤„ç†æ–¹å¼å°±æ˜¯åœ¨nohupæ‰§è¡Œå‰åŠ å…¥</p><pre class="line-numbers language-shell"><code class="language-shell">export JAVA_HOME=/usr/local/java/jdk1.8.0_151export PATH=$JAVA_HOME/bin:$PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>3ã€å…¶ä»–æ€è·¯</p><ul><li>å°†jarçš„æœåŠ¡é…ç½®æˆæœåŠ¡å™¨çš„ä¸€ä¸ªserviceï¼Œä½¿ç”¨systemctlåœæ­¢ã€å¯åŠ¨ç­‰ã€‚</li><li>ä½¿ç”¨dockeréƒ¨ç½²æœåŠ¡ã€‚</li></ul><h3 id="2019-12-11-è¡¥å……"><a href="#2019-12-11-è¡¥å……" class="headerlink" title="2019-12-11 è¡¥å……"></a>2019-12-11 è¡¥å……</h3><p>4ã€ç¬¬äºŒæ¡è¯´jdkçš„è·¯å¾„å› ä¸ºæ¯ä¸ªæœåŠ¡ä¼ä¸šéƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨ä¼ æ”¹ï¼Œè¿™ä¸€ç‚¹å·²ç»åœ¨è„šæœ¬ä¸Šåšäº†ä¿®æ”¹ï¼Œå¯åŠ¨è„šæœ¬ä¸Šæºå¸¦çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯jdkçš„å®‰è£…è·¯å¾„</p><p>è¿™ä¸¤ä¸ªä¹Ÿéƒ½æ˜¯æ¯”è¾ƒå¥½çš„æ€è·¯ï¼Œä»¥åè‚¯å®šæœ‰æœºä¼šä½“éªŒçš„ï¼Œæœ¬ç¯‡åˆ°æ­¤ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ:"></a>å‚è€ƒ:</h2><p><a href="https://www.cnblogs.com/FlyAway2013/p/10858028.html">ps -ef |grep -v åœ¨shell sh è„šæœ¬ä¸­è²Œä¼¼æ— æ•ˆï¼Ÿ</a><br><a href="https://www.jianshu.com/p/5cd618ad381e">linuxä¸‹æ­å»ºzookeeperé›†ç¾¤é‡åˆ°çš„å‘</a><br><a href="http://www.chepoo.com/nohup-cannot-run-command-error-solved.html">nohup: cannot run commandå¼‚å¸¸è§£å†³</a><br><a href="https://stackoverflow.com/questions/20791846/zookeeper-not-starting-nohup-error">Zookeeper not starting, nohup error</a></p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> java </tag>
            
            <tag> jenkins </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>clojure java interop,ä¾èµ–å†²çªè§£å†³</title>
      <link href="2019/06/02/2019-06-02-clojure-java-interop-extend/"/>
      <url>2019/06/02/2019-06-02-clojure-java-interop-extend/</url>
      
        <content type="html"><![CDATA[<p>clojureä¸­è°ƒç”¨java,è§£å†³jaråŒ…ä¾èµ–å†²çª</p><p><a href="https://www.jianshu.com/p/b03473115fb0">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ä»Šå¤©åœ¨clojureä¸­ä½¿ç”¨<a href="https://ai.baidu.com/docs#/OCR-Java-SDK/f76eb9f8">ç™¾åº¦OCRçš„java api</a>ï¼Œä½†æ˜¯å‘ç°å¼•å…¥javaçš„sdkåï¼Œé¡¹ç›®ä¸­é…ç½®çš„logbackçš„é…ç½®ä¸sdké‡Œçš„slf4jå†²çªï¼Œå¹¶ä¸”ä¸å·§çš„æ˜¯slf4jå†²æ‰äº†åŸæœ‰çš„logbackçš„é…ç½®ï¼Œè¿™è¿˜äº†å¾—ï¼Œåªèƒ½ä¿®æ”¹åå†ä½¿ç”¨å•¦ã€‚<br>1ã€å…ˆä»¥ä¸€ä¸ªåŒ…çš„logé…ç½®å’Œç°çŠ¶æ¥çœ‹çœ‹ç°çŠ¶ã€‚<br>logbacké…ç½®</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbc.audit<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>warn<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>jdbc.auditçš„çº§åˆ«æ˜¯warnï¼ŒåŸæ¥å¯åŠ¨é¡¹ç›®æ—¶è‡ªç„¶æ˜¯ä¸ä¼šæ‰“å°jdbc.auditçš„æ—¥å¿—çš„ï¼Œå¼•å…¥ç¬¬ä¸‰æ–¹sdkç„¶åå¯åŠ¨replï¼Œlogä¸­æœ‰å¦‚ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">SLF4J: Class path contains multiple SLF4J bindings.SLF4J: Found binding in [jar:file:/Users/mahaiqiang/.m2/repository/org/slf4j/slf4j-simple/1.7.25/slf4j-simple-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]SLF4J: Found binding in [jar:file:/Users/mahaiqiang/.m2/repository/ch/qos/logback/logback-classic/1.1.3/logback-classic-1.1.3.jar!/org/slf4j/impl/StaticLoggerBinder.class]SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æç¤ºå†²çªï¼Œå†starté¡¹ç›®<br><img src="/loading.gif" data-original="/images/clojure/2019-06-02-clojure-java-interop-extend/jar-extend.png" alt="log"><br>æ‰“å‡ºä¸€å †æ— ç”¨çš„logï¼Œç°çŠ¶æ¼”ç¤ºå®Œæ¯•ã€‚<br>2ã€ä¿®æ”¹jarå†…å®¹<br>å‚è€ƒçš„<a href="https://blog.csdn.net/CHX_W/article/details/78261161">JAVAä¸­jaråŒ…åç¼–è¯‘å†é‡æ–°ç”Ÿæˆjaræ–‡ä»¶å®Œæ•´æµç¨‹</a>ï¼Œå…ˆçœ‹çœ‹SDKçš„pomé‡Œå¼•ç”¨çš„logä¾èµ–ï¼Œè¯å®ä¸€ä¸‹ï¼š<br><img src="/loading.gif" data-original="/images/clojure/2019-06-02-clojure-java-interop-extend/jar-extend-pom.png" alt="pom dependency"></p><p>å¦å­˜ä¸ºpomæ–‡ä»¶ï¼Œåˆ é™¤æ‰è¿™ä¸ªdependencyï¼Œç„¶åå°†pomå¤åˆ¶åˆ°è¿™ä¸ªjaræ‰€åœ¨çš„ç›®å½•<br><img src="/loading.gif" data-original="/images/clojure/2019-06-02-clojure-java-interop-extend/jar-extend-rep.webp" alt="åˆ é™¤pomé‡Œçš„ä¾èµ–"></p><p>ç„¶åæ‰§è¡Œä»¥ä¸‹æ“ä½œ</p><pre class="line-numbers language-shell"><code class="language-shell">//è¯¥å‘½ä»¤åˆ›å»ºpomæ–‡ä»¶ä¸åŸjaråŒ…è·¯å¾„ä¸€æ ·çš„æ–‡ä»¶å¤¹(å³classæ–‡ä»¶åœ¨jaråŒ…ä¸­çš„åŒ…å)mkdir -p META-INF/maven/com.baidu.aip/java-sdk//ä»å½“å‰ç›®å½•æ‹·è´ä¸€ä»½ä¿®æ”¹åçš„pom.xmlæ–‡ä»¶åˆ°java-sdkæ–‡ä»¶å¤¹ä¸‹cp pom.xml META-INF/maven/com.baidu.aip/java-sdk//å°†æ–‡ä»¶pom.xmlæ·»åŠ /æ›´æ–°åˆ°ç°æœ‰çš„jaræ–‡ä»¶java-sdk-4.11.0.jarä¸­jar uf java-sdk-4.11.0.jar META-INF/maven/com.baidu.aip/java-sdk/pom.xml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†çœ‹jarçš„å†…å®¹<br><img src="/loading.gif" data-original="/images/clojure/2019-06-02-clojure-java-interop-extend/jar-extend-pom2.webp" alt="image.png"><br>ç„¶åå¯åŠ¨é¡¹ç›®ï¼š<br>å‘ç°è¿˜æ˜¯æç¤ºå†²çªï¼Œä¸ä¹‹å‰ä¸€æ ·ï¼Œäºæ˜¯æ‰‹åŠ¨åˆ é™¤slf4jçš„slf4j-simpleçš„jar<br><img src="/loading.gif" data-original="/images/clojure/2019-06-02-clojure-java-interop-extend/jar-extend-slf4j.webp" alt="image.png"><br>ç„¶åå†å¯åŠ¨ï¼Œè¿˜æ˜¯ä¸€æ ·ï¼Œæœäº†ä¸€ä¸‹slf4j<br><img src="/loading.gif" data-original="/images/clojure/2019-06-02-clojure-java-interop-extend/jar-extend-slf4g-2.webp" alt="image.png"><br>æœæ–­è¯¥æ‰ï¼Œå†è¯•ä¸€æŠŠå‘—ï¼Œæœç„¶å¹²å‡€äº†ã€‚<br><img src="/loading.gif" data-original="/images/clojure/2019-06-02-clojure-java-interop-extend/jar-extend-success.webp" alt="image.png"></p><p>ä»¥åæ€ä¹ˆå‡ºæ¥ï¼Œæ€ä¹ˆè§£å†³ã€‚å†ç»­å§ï¼Œå…ˆå¹²æ´»è¦ç´§ã€‚<br>2ã€ä½¿ç”¨SDK<br>ä¸€èˆ¬æœç´¢clojure java interopå°±ä¼šæœ‰ç»“æœï¼Œæˆ‘ä¸»è¦çœ‹äº†<a href="https://clojure.org/reference/java_interop">https://clojure.org/reference/java_interop</a>å’Œ</p><blockquote><p>This was a good chance to get familiar with a few of the interop features:<br>Importing with (import java.io.FileReader)<br>Instantiating an object, where new FileReader(path) becomes (FileReader. path)<br>Accessing a class attribute/method, where CSVFormat.DEFAULT becomes CSVFormat/DEFAULT, and<br>Calling an instance method, where record.get(â€œgreetingâ€) becomes (.get record â€œgreetingâ€).<br>I particularly like that the Clojure notation clearly distinguishes class attributes/methods from instance methods eg. CSVFormat/DEFAULT vs. (.get record â€œgreetingâ€).<br>Iâ€™ll still be reaching for Python when a CSV file comes my way, but I was pleasantly surprised at how neat the Clojure version of this code ended up.</p></blockquote><p>è¿™æ®µå¯ç¤ºä½¿ç”¨çš„,åœ¨replé‡Œçš„ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(import com.baidu.aip.ocr.AipOcr)=> com.baidu.aip.ocr.AipOcr(def ocr-client  (AipOcr. "16321634"           "ppiRhvR7VQLqhaiMH7svO7G9"           "my-secret"))=> #'user/ocr-client(.receipt ocr-client "upload/files/81558580941_.pic_1.jpg" (new java.util.HashMap))=>#object[org.json.JSONObject        0x7a4e1225        "{\"log_id\":7285098450024979673,\"words_result\":[{\"words\":\"å±±ä¸œçœè€³é¼»å–‰åŒ»é™¢é¼»å˜æ€ååº”-å—…è§‰é—¨è¯Š\",\"location\":{\"top\":29,\"left\":232,\"width\":606,\"height\":63}},{\"words\":\"å˜åº”åŸç‚¹åˆºè¯•éªŒæŠ¥å‘Šå•\",\"location\":{\"top\":104,\"left\":318,\"width\":419,\"height\":45}},{\"words\":\"å§“å:\",\"location\":{\"top\":218,\"left\":63,\"width\":58,\"height\":25}},{\"words\":\"æ€§åˆ«:å¹´é¾„:å²ç”µè¯\",\"location\":{\"top\":212,\"left\":205,\"width\":287,\"height\":30}},{\"words\":\"æ£€æŸ¥æ—¥æœŸ:\",\"location\":{\"top\":207,\"left\":697,\"width\":103,\"height\":25}},{\"words\":\"å¹´æœˆæ—¥\",\"location\":{\"top\":199,\"left\":876,\"width\":120,\"height\":29}},{\"words\":\"åç§°\",\"location\":{\"top\":302,\"left\":106,\"width\":40,\"height\":21}},{\"words\":\"æ ‡æœ¬é£å›¢ç›´å¾„ç»“æœ\",\"location\":{\"top\":296,\"left\":220,\"width\":268,\"height\":26}},{\"words\":\"åç§°\",\"location\":{\"top\":295,\"left\":572,\"width\":40,\"height\":21}},{\"words\":\"æ ‡æœ¬é£å›¢ç›´å¾„ç»“æœ\",\"location\":{\"top\":286,\"left\":694,\"width\":276,\"height\":29}},{\"words\":\" (mm)\",\"location\":{\"top\":328,\"left\":330,\"width\":55,\"height\":17}},{\"words\":\" mm)\",\"location\":{\"top\":321,\"left\":806,\"width\":43,\"height\":14}},{\"words\":\"9\",\"location\":{\"top\":370,\"left\":586,\"width\":12,\"height\":14}},{\"words\":\"ç²‰å°˜è¨\",\"location\":{\"top\":408,\"left\":98,\"width\":62,\"height\":22}},{\"words\":\"å¤§ç±½è’¿èŠ±ç²‰\",\"location\":{\"top\":401,\"left\":543,\"width\":100,\"height\":23}},{\"words\":\"2\",\"location\":{\"top\":477,\"left\":126,\"width\":12,\"height\":14}},{\"words\":\"10\",\"location\":{\"top\":470,\"left\":582,\"width\":23,\"height\":16}},{\"words\":\"å±‹å°˜è¨\",\"location\":{\"top\":509,\"left\":102,\"width\":60,\"height\":21}},{\"words\":\"æ¨æ ‘èŠ±ç²‰\",\"location\":{\"top\":503,\"left\":553,\"width\":80,\"height\":22}},{\"words\":\"ç‹—æ¯›\",\"location\":{\"top\":607,\"left\":113,\"width\":42,\"height\":21}},{\"words\":\"æŸ³æ ‘èŠ±ç²‰\",\"location\":{\"top\":603,\"left\":554,\"width\":79,\"height\":23}},{\"words\":\"12\",\"location\":{\"top\":670,\"left\":583,\"width\":22,\"height\":17}},{\"words\":\"çŒ«æ¯›\",\"location\":{\"top\":706,\"left\":116,\"width\":40,\"height\":21}},{\"words\":\"æ¢§æ¡èŠ±ç²‰\",\"location\":{\"top\":702,\"left\":554,\"width\":79,\"height\":21}},{\"words\":\"5\",\"location\":{\"top\":773,\"left\":131,\"width\":13,\"height\":14}},{\"words\":\"13\",\"location\":{\"top\":768,\"left\":585,\"width\":21,\"height\":16}},{\"words\":\"é¸­æ¯›ç»’\",\"location\":{\"top\":804,\"left\":106,\"width\":62,\"height\":22}},{\"words\":\"äº§é»„é’éœ‰\",\"location\":{\"top\":801,\"left\":554,\"width\":81,\"height\":21}},{\"words\":\"14\",\"location\":{\"top\":868,\"left\":586,\"width\":22,\"height\":14}},{\"words\":\"è‘è‰\",\"location\":{\"top\":903,\"left\":119,\"width\":40,\"height\":19}},{\"words\":\"é“¾æ ¼å­¢éœ‰\",\"location\":{\"top\":900,\"left\":557,\"width\":80,\"height\":23}},{\"words\":\"15\",\"location\":{\"top\":955,\"left\":587,\"width\":21,\"height\":16}},{\"words\":\"è—œå±èŠ±ç²‰\",\"location\":{\"top\":990,\"left\":98,\"width\":83,\"height\":24}},{\"words\":\"é˜´æ€§å¯¹ç…§\",\"location\":{\"top\":987,\"left\":558,\"width\":79,\"height\":23}},{\"words\":\"8\",\"location\":{\"top\":1058,\"left\":133,\"width\":14,\"height\":14}},{\"words\":\"16\",\"location\":{\"top\":1053,\"left\":588,\"width\":22,\"height\":16}},{\"words\":\"è±šè‰\",\"location\":{\"top\":1088,\"left\":119,\"width\":42,\"height\":23}},{\"words\":\"é˜³æ€§å¯¹ç…§\",\"location\":{\"top\":1085,\"left\":558,\"width\":80,\"height\":21}},{\"words\":\"æ³¨:1ã€çš®è¯•å‰åº”åœç”¨å£æœæŠ—ç»„èƒºè¯ç‰©3å¤©\",\"location\":{\"top\":1178,\"left\":46,\"width\":372,\"height\":41}},{\"words\":\"2ã€æœ‰ä¸¥é‡çš®è‚¤ç—…å’Œçš®è‚¤æºƒçƒ‚è€…ä¸å¾—åšçš®è‚¤è¯•éªŒ\",\"location\":{\"top\":1217,\"left\":121,\"width\":405,\"height\":29}},{\"words\":\"3ã€ä»¥ä¸Šç»“æœä¸åšè¯æ˜ç”¨\",\"location\":{\"top\":1248,\"left\":120,\"width\":214,\"height\":40}}],\"words_result_num\":41}"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†è€…ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://coldnew.github.io/a9b87aa3/">ä½¿ç”¨ lein ä¾†ç®¡ç†ä½ æœ¬åœ°çš„ maven repo</a>æ¥è®²jaråšæˆæœ¬åœ°èµ„æºï¼Œå¯¼å…¥åˆ°mavenä»“åº“ï¼Œä¸å†å¤šå†™äº†ã€‚</p><p>3ã€è¿›é˜¶<br>ä¸Šé¢çš„åŠæ³•æ˜¾ç„¶æ˜¯æ¯”è¾ƒlowçš„ï¼Œä¸åˆ©äºæŒç»­åŒ–ï¼Œæ›´é«˜é˜¶çš„æ–¹å¼æ˜¯åœ¨:dependenciesä¸­ä½¿ç”¨<code>:exclusions</code>å…³é”®å­—ï¼Œå¿½ç•¥æŸäº›ä¾èµ–ï¼Œæ¯”å¦‚ä¸Šé¢çš„sdkåº”è¯¥è¿™ä¹ˆç”¨ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">[com.baidu.aip/java-sdk "4.11.0"                  :exclusions [org.slf4j/slf4j-simple]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>4ã€å…³äºdependenciesçš„å…¶ä»–<br>åœ¨å‘½ä»¤è¡Œé‡Œæ‰§è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">#æŸ¥çœ‹ä¾èµ–å…³ç³»lein deps :tree#åŠ è½½ä¾èµ–lein deps<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä»–æ›´å¤šè¯·å‚ç…§ï¼š<a href="https://cljdoc.org/d/leiningen/leiningen/2.9.1/api/leiningen.deps">https://cljdoc.org/d/leiningen/leiningen/2.9.1/api/leiningen.deps</a></p><p>5ã€clojureé‡Œä½¿ç”¨java</p><pre class="line-numbers language-clojure"><code class="language-clojure">;;md5åŠ å¯†(defn get-str-md5 [s]  (apply str         (map (partial format "%02x")              (.digest (doto (java.security.MessageDigest/getInstance "MD5")                         .reset                         (.update (.getBytes s)))))));;ä¿®æ”¹æ—¶é—´æ ¼å¼(defn format-date-time [timestamp]  (-> "yyyyMMddHHmmss"      (java.text.SimpleDateFormat.)      (.format timestamp)));;è·å–UUID(defn generate-db-id []  (clojure.string/replace (str (java.util.UUID/randomUUID)) "-" ""))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ›´å¤šclojureå’Œjavaçš„äº¤äº’ä½¿ç”¨å‚çœ‹ï¼š<a href="https://clojure.org/reference/java_interop">https://clojure.org/reference/java_interop</a></p>]]></content>
      
      
      <categories>
          
          <category> clojure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·å°”åˆ›å®¢æ±‡ç¬”è®°----å®‰å“ç«¯ç¼–è¯‘å’Œè¿è¡Œ</title>
      <link href="2019/05/24/hai-er-chuang-ke-hui-bi-ji-an-zhuo-duan-bian-yi-he-yun-xing/"/>
      <url>2019/05/24/hai-er-chuang-ke-hui-bi-ji-an-zhuo-duan-bian-yi-he-yun-xing/</url>
      
        <content type="html"><![CDATA[<p>åˆ›å®¢æ±‡appåœ¨android studioé‡Œé…ç½®å’Œç¼–è¯‘è¿è¡Œï¼ŒåŠå®‰å“æŠ•å±å·¥å…·æ¨è</p><p><a href="https://www.jianshu.com/p/6bceb554394e">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="å¼€å‘ç¯å¢ƒå‡†å¤‡"><a href="#å¼€å‘ç¯å¢ƒå‡†å¤‡" class="headerlink" title="å¼€å‘ç¯å¢ƒå‡†å¤‡"></a>å¼€å‘ç¯å¢ƒå‡†å¤‡</h3><ol><li>ä¸‹è½½å®‰è£…android studio</li><li>å¯åŠ¨è¿è¡Œ<br><img src="/loading.gif" data-original="/images/android/start-android-studio.png" alt="start studio"></li><li>é…ç½®ä»£ç†<br>å¦‚æœèƒ½ç¿»å¢™æœ€å¥½äº†ï¼Œå› ä¸ºä¸€äº›èµ„æºéƒ½éœ€è¦çˆ¬å¢™ï¼Œå®åœ¨æ²¡æœ‰å—ï¼Œåªèƒ½é€‰æ‹©ä¸ä»£ç†ã€‚<br><img src="/loading.gif" data-original="/images/android/set-proxy.png" alt="è®¾ç½®ä»£ç†"></li></ol><p>é€‰æ‹©æ ‡å‡†å®‰è£…ï¼Œä¸‹ä¸€æ­¥ï¼Œç­‰å¾…ä¸‹è½½<br><img src="/loading.gif" data-original="/images/android/download-components.png" alt="ä¸‹è½½"><br><img src="/loading.gif" data-original="/images/android/download-components-suc.png" alt="ä¸‹è½½ç»“æŸ"></p><p>importåˆ°Portalçš„androidç›®å½•ï¼Œå¯¼å…¥é¡¹ç›®<br><img src="/loading.gif" data-original="/images/android/import-project.png" alt="å¯¼å…¥å·¥ç¨‹"></p><p><img src="/loading.gif" data-original="/images/android/gradle-download.png" alt="gradleä¸‹è½½"></p><ol start="4"><li><p>buildå®Œæˆä»¥ååœ¨å‘½ä»¤çª—å£å¯åŠ¨æ‰“åŒ…jsbundle<br>æ‰“åŒ…æˆjsbundleæ–‡ä»¶çš„æ–¹å¼å¯ä»¥å‚ç…§å¦ä¸€ç¯‡-<a href="https://www.jianshu.com/p/cb25e817ba36">æµ·å°”åˆ›å®¢æ±‡ç¬”è®°â€”-å®‰å“ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…é…ç½®</a>ã€‚<br>ä¸»è¦æ˜¯ä¸‹é¢è¿™ä¸ªå‘½ä»¤<br>æ‰“åŒ…IOSï¼š</p><pre class="line-numbers language-json"><code class="language-json"><span class="token property">"bundle-ios"</span><span class="token operator">:</span> <span class="token string">"react-native bundle --entry-file index.js --platform ios --dev false --bundle-output ./ios/main.jsbundle --assets-dest ./ios"</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰“åŒ…å®‰å“ï¼š</p><pre class="line-numbers language-json"><code class="language-json"><span class="token property">"bundle-android"</span><span class="token operator">:</span> <span class="token string">"react-native bundle --entry-file index.js --bundle-output ./android/app/src/main/assets/index.android.bundle --platform android --assets-dest ./android/app/src/main/res/ --dev false"</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¯¥é¡¹ç›®æœ‰ä¸ªæ²¡æœ‰é…ç½®å¥½çš„åœ°æ–¹ï¼Œä¼šå¯¼è‡´ç”Ÿæˆ.htmlæ–‡ä»¶ï¼Œéœ€è¦åˆ é™¤åï¼Œå†è¿›è¡Œåé¢çš„æ“ä½œã€‚</p><h3 id="å¯åŠ¨é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›®</h3></li><li><p>yarn</p><pre class="line-numbers language-shell"><code class="language-shell">Portal git:(master) yarnyarn install v1.15.2[1/4] ğŸ”  Resolving packages...[2/4] ğŸšš  Fetching packages...[3/4] ğŸ”—  Linking dependencies...warning " > react-native-doc-viewer@2.7.8" has incorrect peer dependency "react@^16.3.0-alpha.1".warning " > react-native-doc-viewer@2.7.8" has incorrect peer dependency "react-native@0.54.3".warning " > react-native-fs@2.9.12" has incorrect peer dependency "react@^16.2.0".warning " > react-native-fs@2.9.12" has incorrect peer dependency "react-native@^0.51.0".warning " > react-native-fs@2.9.12" has unmet peer dependency "prop-types@15.6.0".warning " > react-native-fs@2.9.12" has unmet peer dependency "create-react-class@^15.6.2".warning " > react-native-pdf@5.0.8" has incorrect peer dependency "rn-fetch-blob@^0.10.13".warning " > react-native-svg@6.5.2" has unmet peer dependency "prop-types@^15.5.7".warning " > react-native-svg-uri@1.2.3" has incorrect peer dependency "react-native-svg@^5.3.0".warning " > babel-jest@22.0.4" has unmet peer dependency "babel-core@^6.0.0 || ^7.0.0-0".[4/4] ğŸ”¨  Building fresh packages...warning Your current version of Yarn is out of date. The latest version is "1.16.0", while you're on "1.15.2".info To upgrade, run the following command:$ curl --compressed -o- -L https://yarnpkg.com/install.sh | bashâœ¨  Done in 169.93s.âœ  Portal git:(master)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p> å¯åŠ¨js<br><img src="/loading.gif" data-original="/images/android/yarn-start.png" alt="yarn start"></p></li><li><p>è¿è¡Œapp<br>å› ä¸ºé¡¹ç›®åŠ å…¥äº†IMçš„ä¸€äº›ä¸œè¥¿å¯¼è‡´ä¸èƒ½ç”¨æ¨¡æ‹Ÿå™¨è¿è¡Œï¼ŒçœŸæœºè¿æ¥åé€‰æ‹©USBè°ƒè¯•ï¼Œç„¶åè¿è¡Œé¡¹ç›®<br><img src="/loading.gif" data-original="/images/android/project-run.png" alt="è¿è¡Œå·¥ç¨‹"><br>é€‰æ‹©ä¸ä½¿ç”¨instant<br><img src="/loading.gif" data-original="/images/android/%E4%B8%8D%E4%BD%BF%E7%94%A8instant.png" alt="ä¸ä½¿ç”¨instant"><br>æŸ¥çœ‹æ—¥å¿—ï¼š<br><img src="/loading.gif" data-original="/images/android/logcat.png" alt="logcat"></p></li></ol><h3 id="é…ç½®JSè°ƒè¯•æ¨¡å¼"><a href="#é…ç½®JSè°ƒè¯•æ¨¡å¼" class="headerlink" title="é…ç½®JSè°ƒè¯•æ¨¡å¼"></a>é…ç½®JSè°ƒè¯•æ¨¡å¼</h3><ol start="8"><li><p>é…ç½®ç«¯å£æ˜ å°„ï¼Œè®©æ‰‹æœºç«¯è¿æ¥åˆ°PCçš„js serverä¸Š<br>é¦–å…ˆï¼Œç”µè„‘è¦æœ‰ADBï¼Œä½œä¸ºä¸€åAndroidç»ˆç«¯å¼€å‘ï¼Œè¿™ä¸ªæ˜¯å¿…å¤‡çš„ã€‚ä½†æ˜¯ä¸å·§æˆ‘æ˜¯å®¢ä¸²çš„ï¼Œæ‰€ä»¥æ‰‹åŠ¨å®‰è£…äº†ä¸€ä¸‹ï¼ŒMACä¸Šé€šè¿‡homebrewå®‰è£…å¾ˆç®€å•ï¼Œä¸€å¥å‘½ä»¤ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">brew cask install android-platform-tools<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰‹åŠ¨å®‰è£…é…ç½®classpathçš„å¯ä»¥å‚è€ƒ<a href="https://www.jianshu.com/p/1b3fb1f27b67">åœ¨ MAC OS X å®‰è£… ADB (Androidè°ƒè¯•æ¡¥)</a>ã€‚<br>å®‰è£…æˆåŠŸï¼Œå¹¶ä¸”çœŸæœºè®¾ç½®å¥½äº†å¼€å‘è€…æ¨¡å¼ï¼Œå…è®¸è°ƒè¯•çš„è¯ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤çœ‹åˆ°è®¾å¤‡ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">âœ  ~ adb devicesList of devices attachedc752c893    deviceâœ  ~<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æœ‰äº†adbä»¥åï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤è®¾ç½®æ˜ å°„å…³ç³»,å°†æœ¬åœ°çš„8081æ˜ å°„åˆ°clientçš„8081</p><pre class="line-numbers language-shell"><code class="language-shell">âœ  ~ adb reverse tcp:8081 tcp:8081<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœadbæ²¡æœ‰é…ç½®åˆ°classpathé‡Œï¼Œå¯ä»¥è¿™æ ·</p><pre class="line-numbers language-shell"><code class="language-shell">âœ  ~ cd ~/Library/Android/sdk/platform-tools/âœ  ~ ./adb reverse tcp:8081 tcp:8081<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ›´å¤šadbå‘½ä»¤å¯ä»¥å‚è€ƒ<a href="https://www.cnblogs.com/bravesnail/articles/5850335.html">Androidå¸¸ç”¨çš„adbå‘½ä»¤æ€»ç»“</a></p></li><li><p>é…ç½®åˆ°ä»¥ä¸Šæ˜ å°„ï¼Œä¸€èˆ¬çœŸæœºä¸Šä¼šè‡ªåŠ¨å¯åŠ¨åº”ç”¨ï¼Œå¯åŠ¨åæ‘‡ä¸€æ‘‡ï¼Œå¼¹å‡ºèœå•ï¼ŒæŸ¥çœ‹æœ€æ–°çš„ä¿®æ”¹ã€‚<br><img src="/loading.gif" data-original="/images/android/rn-reload.png" alt="æ‰‹æœºæ‘‡ä¸€æ‘‡"></p></li></ol><p>å¯ä»¥å…ˆæ¥ä¸ªreloadè¯•è¯•ã€‚<br>å¯ä»¥çœ‹åˆ°æ‰‹æœºä¸Šå¼€å§‹reload<br><img src="/loading.gif" data-original="/images/android/rn-reloading.png" alt="rn-reloading"></p><p>å†çœ‹çœ‹æœåŠ¡ç«¯ï¼š<br><img src="/loading.gif" data-original="/images/android/rn-reloading-server.png" alt="æœåŠ¡ç«¯reload"></p><ol start="10"><li>å¼€å§‹è°ƒè¯•<br>åœ¨åˆšæ‰æ‰‹æœºæ‘‡ä¸€æ‘‡å‡ºæ¥çš„èœå•ä¸­é€‰æ‹©<code>Debug JS Remotely</code>ï¼Œåº”ç”¨é‡å¯ï¼ŒåŒæ—¶çœ‹åˆ°serverç«¯å¯åŠ¨çš„Dev Tools<br><img src="/loading.gif" data-original="/images/android/rn-debug.png" alt="debug"><br>é»˜è®¤çš„æµè§ˆå™¨ä¹Ÿæ‰“å¼€äº†ä¸€ä¸ªæ–°çš„tabï¼Œå¦‚ä¸‹ï¼š<br><img src="/loading.gif" data-original="/images/android/rn-debugger-ui.png" alt="debugger ui"></li></ol><p>é»˜è®¤ä¸ä¼šæ‰“å¼€å¼€å‘è€…æ¨¡å¼ï¼Œéœ€è¦æ‰‹åŠ¨æ‰“å¼€ã€‚æˆ‘ä»¬æ¸…é™¤ä¸€ä¸‹é»˜è®¤çš„logï¼ŒåŠ è½½ä¸‹é¦–é¡µï¼Œçœ‹åˆ°å¦‚ä¸‹æ•ˆæœï¼š<br><img src="/loading.gif" data-original="/images/android/rn-debugger-ui2.png" alt="debug ui"></p><p><img src="/loading.gif" data-original="/images/android/rn-debugger-ui-console.png" alt="debug log"><br>è°ƒè¯•é…ç½®æˆåŠŸã€‚</p><ol start="11"><li>æœ‰æ—¶å€™ä¸€è¾¹æ’¸ä»£ç ï¼Œæ”¹ä¸¤è¡Œè¿˜è¦æ‹¿èµ·æ‰‹æœºçœ‹çœ‹æ•ˆæœï¼Œç¡®å®ä¸ä¾¿ï¼Œäºæ˜¯æœ‰äº†å®‰å“æ‰‹æœºæŠ•å±è¿™ç§ç¥ä¸€æ ·çš„å·¥å…·ã€‚ä¹Ÿè®¸å·¥å…·å¾ˆå¤šï¼Œä¸è¿‡æˆ‘è¿™é‡Œå°±ç”¨è¿‡ä¸€ç§<a href="http://www.vysor.io/">vysor</a>ï¼Œæˆ‘ç”¨äº†è°·æ­Œæµè§ˆå™¨çš„vysoræ’ä»¶ã€‚<br>æ‰‹æœºUSBè°ƒè¯•è®¾ç½®å¥½ä»¥åä¼šè‡ªå·±æ£€æµ‹<br><img src="/loading.gif" data-original="/images/android/vysor.png" alt="vysorè®¾ç½®"><br>åŒæ—¶ç¬¬ä¸€æ¬¡ä¼šæç¤ºæ‰‹æœºå®‰è£…è¯¥è½¯ä»¶ï¼Œå®‰è£…å®Œæˆåæ‰“å¼€ï¼Œæ•ˆæœå¦‚ä¸‹ï¼Œä¸æ‰‹æœºåŒæ­¥ã€‚<br><img src="/loading.gif" data-original="/images/android/vysor2.png" alt="vysoræˆåŠŸ"></li></ol><p>æ•ˆæœè¿˜æ˜¯ä¸é”™çš„ï¼Œå°±æ˜¯æ²¡æœ‰[æ‘‡ä¸€æ‘‡]è¿™ä¸ªåŠŸèƒ½ï¼Œç¾ä¸­ä¸è¶³äº¦ã€‚</p><ol start="12"><li>æ¨¡æ‹Ÿå™¨æ“ä½œ<br>å¦‚æœåœ¨æ¨¡æ‹Ÿå™¨ä¸Šè°ƒè¯•react nativeä»£ç ï¼Œä¹Ÿå¯ä»¥æœ‰æ‘‡ä¸€æ‘‡ï¼Œæˆ–è€…é…ç½®hot loadingè¿™äº›ï¼Œå¦‚ä¸‹ï¼š</li></ol><ul><li>shift + r è¿ç»­2 æ¬¡ æ¨¡æ‹Ÿå™¨reload ç•Œé¢</li><li>CommandâŒ˜ + Må¿«æ·é”®æ¥å¿«é€Ÿæ‰“å¼€Developer Menuã€‚ä¹Ÿå¯ä»¥é€šè¿‡æ¨¡æ‹Ÿå™¨ä¸Šçš„èœå•é”®æ¥æ‰“å¼€ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
            <tag> android </tag>
            
            <tag> package </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ant Design Pro å­¦ä¹ ä¹‹tableä½¿ç”¨</title>
      <link href="2019/04/24/ant-design-pro-xue-xi-zhi-table-shi-yong/"/>
      <url>2019/04/24/ant-design-pro-xue-xi-zhi-table-shi-yong/</url>
      
        <content type="html"><![CDATA[<p>é˜¿é‡Œç²‘ç²‘å¼€æºçš„ç®¡ç†æ¡†æ¶<a href="https://pro.ant.design/index-cn">Ant Design Pro</a>ä½¿ç”¨è®°å½•ä¹‹åˆ—è¡¨çš„çµæ´»ä½¿ç”¨ã€‚</p><p><a href="https://www.jianshu.com/p/181773ed614d">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="åœ¨tableçš„è¡Œrenderæ—¶å¸¸ç”¨çš„æ“ä½œ"><a href="#åœ¨tableçš„è¡Œrenderæ—¶å¸¸ç”¨çš„æ“ä½œ" class="headerlink" title="åœ¨tableçš„è¡Œrenderæ—¶å¸¸ç”¨çš„æ“ä½œ"></a>åœ¨tableçš„è¡Œrenderæ—¶å¸¸ç”¨çš„æ“ä½œ</h2><h4 id="1ã€æ—¶é—´æ ¼å¼åŒ–ï¼ŒæŒ‡å®šæ—¶åŒº"><a href="#1ã€æ—¶é—´æ ¼å¼åŒ–ï¼ŒæŒ‡å®šæ—¶åŒº" class="headerlink" title="1ã€æ—¶é—´æ ¼å¼åŒ–ï¼ŒæŒ‡å®šæ—¶åŒº"></a>1ã€æ—¶é—´æ ¼å¼åŒ–ï¼ŒæŒ‡å®šæ—¶åŒº</h4><pre class="line-numbers language-js"><code class="language-js"> <span class="token punctuation">{</span>â€‹      title<span class="token punctuation">:</span> <span class="token string">'æ›´æ–°æ—¶é—´'</span><span class="token punctuation">,</span>â€‹      dataIndex<span class="token punctuation">:</span> <span class="token string">'updateTime'</span><span class="token punctuation">,</span>â€‹      sorter<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>â€‹      render<span class="token punctuation">:</span> val <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>span<span class="token operator">></span><span class="token punctuation">{</span><span class="token function">moment</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">utc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'YYYY-MM-DD HH:mm:ss'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">,</span>â€‹    <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2ã€åˆ—è¡¨ä¸Šæ˜¾ç¤ºå›¾ç‰‡"><a href="#2ã€åˆ—è¡¨ä¸Šæ˜¾ç¤ºå›¾ç‰‡" class="headerlink" title="2ã€åˆ—è¡¨ä¸Šæ˜¾ç¤ºå›¾ç‰‡"></a>2ã€åˆ—è¡¨ä¸Šæ˜¾ç¤ºå›¾ç‰‡</h4><pre class="line-numbers language-js"><code class="language-js">    <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token string">'è‚ºåŠŸèƒ½æŠ¥å‘Š'</span><span class="token punctuation">,</span>      dataIndex<span class="token punctuation">:</span> <span class="token string">'url'</span><span class="token punctuation">,</span>      render<span class="token punctuation">:</span> text <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>img alt<span class="token operator">=</span><span class="token string">"å•†å“å›¾ç‰‡"</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> src<span class="token operator">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/antd-table-render.png" alt="è¡¨å¤´æ—¶é—´æ ¼å¼åŒ–"><br>è¿™ä¸ªå›¾ç‰‡ä¸èƒ½åœ¨å½“å‰é¡µæ”¾å¤§ï¼Œæˆ–è€…ç›´æ¥åœ¨æµè§ˆå™¨è®¿é—®ã€‚<br>å¦‚æœéœ€è¦ç‚¹å‡»ååœ¨å½“å‰é¡µé¢æ”¾å¤§ï¼Œè¿™æ ·çš„æ•ˆæœ<br><img src="/loading.gif" data-original="/images/fontend/antd-table-pic.png" alt="æ”¾å¤§"><br>å¯ä»¥è¿™ä¹ˆå¹²ï¼Œå…ˆæ’¸ä¸€ä¸ªimageViewç»„ä»¶æ”¾åœ¨src/pages/Commonä¸‹</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> PureComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> Spin<span class="token punctuation">,</span> Modal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span><span class="token keyword">const</span> defaultStyle <span class="token operator">=</span> <span class="token punctuation">{</span>  borderRadius<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>  borderWidth<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  borderStyle<span class="token punctuation">:</span> <span class="token string">'solid'</span><span class="token punctuation">,</span>  borderColor<span class="token punctuation">:</span> <span class="token string">'#d9d9d9'</span><span class="token punctuation">,</span>  width<span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span>  height<span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span>  padding<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>  cursor<span class="token punctuation">:</span> <span class="token string">'pointer'</span><span class="token punctuation">,</span>  display<span class="token punctuation">:</span> <span class="token string">'inline-flex'</span><span class="token punctuation">,</span>  justifyContent<span class="token punctuation">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>  alignItems<span class="token punctuation">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ImageView</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    loading<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    visible<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>    imgWidth<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    imgHeight<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> url <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">!==</span> nextProps<span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  init <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> url <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      image<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>image<span class="token punctuation">.</span>complete<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> size <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getImageSize</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>width<span class="token punctuation">,</span> image<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> imgWidth<span class="token punctuation">:</span> size<span class="token punctuation">.</span>width<span class="token punctuation">,</span> imgHeight<span class="token punctuation">:</span> size<span class="token punctuation">.</span>height <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        image<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          <span class="token keyword">const</span> size <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getImageSize</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>width<span class="token punctuation">,</span> image<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> imgWidth<span class="token punctuation">:</span> size<span class="token punctuation">.</span>width<span class="token punctuation">,</span> imgHeight<span class="token punctuation">:</span> size<span class="token punctuation">.</span>height <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  getImageSize <span class="token operator">=</span> <span class="token punctuation">(</span>originImgWidth<span class="token punctuation">,</span> originImgHeight<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> width<span class="token punctuation">,</span> height <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">const</span> divWidth <span class="token operator">=</span> <span class="token punctuation">(</span>width <span class="token operator">||</span> defaultStyle<span class="token punctuation">.</span>width<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> defaultStyle<span class="token punctuation">.</span>padding<span class="token punctuation">;</span>    <span class="token keyword">const</span> divHeight <span class="token operator">=</span> <span class="token punctuation">(</span>height <span class="token operator">||</span> defaultStyle<span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> defaultStyle<span class="token punctuation">.</span>padding<span class="token punctuation">;</span>    <span class="token keyword">const</span> ratio <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRatio</span><span class="token punctuation">(</span>originImgWidth<span class="token punctuation">,</span> originImgHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> imgWidth <span class="token operator">=</span> originImgWidth <span class="token operator">></span> originImgHeight <span class="token operator">?</span> divWidth <span class="token punctuation">:</span> divWidth <span class="token operator">*</span> ratio<span class="token punctuation">;</span>    <span class="token keyword">const</span> imgHeight <span class="token operator">=</span> originImgHeight <span class="token operator">></span> originImgWidth <span class="token operator">?</span> divHeight <span class="token punctuation">:</span> divHeight <span class="token operator">*</span> ratio<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">{</span> width<span class="token punctuation">:</span> imgWidth<span class="token punctuation">,</span> height<span class="token punctuation">:</span> imgHeight <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  getRatio <span class="token operator">=</span> <span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>width <span class="token operator">&lt;</span> height <span class="token operator">?</span> width <span class="token operator">/</span> height <span class="token punctuation">:</span> height <span class="token operator">/</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> url<span class="token punctuation">,</span> style <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> visible<span class="token punctuation">,</span> imgWidth<span class="token punctuation">,</span> imgHeight <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>span<span class="token operator">></span>        <span class="token punctuation">{</span>url <span class="token operator">?</span> <span class="token punctuation">(</span>          <span class="token operator">&lt;</span>span style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token operator">...</span>defaultStyle<span class="token punctuation">,</span> <span class="token operator">...</span>style <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>            <span class="token punctuation">{</span>loading <span class="token operator">?</span> <span class="token punctuation">(</span>              <span class="token operator">&lt;</span>Spin <span class="token operator">/</span><span class="token operator">></span>            <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>              <span class="token operator">&lt;</span>img                style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> imgWidth<span class="token punctuation">,</span> height<span class="token punctuation">:</span> imgHeight <span class="token punctuation">}</span><span class="token punctuation">}</span>                alt<span class="token operator">=</span><span class="token string">"ç‚¹å‡»é¢„è§ˆå›¾ç‰‡"</span>                src<span class="token operator">=</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span>                onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> visible<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token punctuation">}</span>              <span class="token operator">/</span><span class="token operator">></span>            <span class="token punctuation">)</span><span class="token punctuation">}</span>            <span class="token operator">&lt;</span>Modal              style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> top<span class="token punctuation">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>              visible<span class="token operator">=</span><span class="token punctuation">{</span>visible<span class="token punctuation">}</span>              footer<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">null</span><span class="token punctuation">}</span>              onCancel<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> visible<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">}</span><span class="token punctuation">}</span>            <span class="token operator">></span>              <span class="token operator">&lt;</span>img alt<span class="token operator">=</span><span class="token string">""</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token string">'100%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> src<span class="token operator">=</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>Modal<span class="token operator">></span>          <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>        <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>          <span class="token string">'æ— '</span>        <span class="token punctuation">)</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> ImageView<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åtableä¸Šè¿™ä¹ˆç”¨</p><pre class="line-numbers language-js"><code class="language-js">    <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token string">'å›¾ç‰‡'</span><span class="token punctuation">,</span>      dataIndex<span class="token punctuation">:</span> <span class="token string">'itemImage'</span><span class="token punctuation">,</span>      key<span class="token punctuation">:</span> <span class="token string">'itemImage'</span><span class="token punctuation">,</span>      render<span class="token punctuation">:</span> <span class="token punctuation">(</span>text<span class="token punctuation">,</span> record<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>ImageView alt<span class="token operator">=</span><span class="token punctuation">{</span>record<span class="token punctuation">.</span>title<span class="token punctuation">}</span> url<span class="token operator">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3ã€é•¿æ–‡æœ¬ä½¿ç”¨çœç•¥å·"><a href="#3ã€é•¿æ–‡æœ¬ä½¿ç”¨çœç•¥å·" class="headerlink" title="3ã€é•¿æ–‡æœ¬ä½¿ç”¨çœç•¥å·"></a>3ã€é•¿æ–‡æœ¬ä½¿ç”¨çœç•¥å·</h4><p><img src="/loading.gif" data-original="/images/fontend/Ellipsis.png" alt="Ellipsis"></p><pre class="line-numbers language-js"><code class="language-js">    <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token string">'æ¥æ”¶è¯¦æƒ…'</span><span class="token punctuation">,</span>      dataIndex<span class="token punctuation">:</span> <span class="token string">'receiveDesc'</span><span class="token punctuation">,</span>      render<span class="token punctuation">:</span> value <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>        <span class="token operator">&lt;</span>Ellipsis length<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">}</span> tooltip<span class="token operator">></span>          <span class="token punctuation">{</span>value<span class="token punctuation">}</span>        <span class="token operator">&lt;</span><span class="token operator">/</span>Ellipsis<span class="token operator">></span>      <span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”¨åˆ°çš„Ellipsisæ˜¯å®˜ç½‘åœ¨componentsæä¾›çš„é€šç”¨ç»„ä»¶ã€‚</p><h4 id="4ã€å¯æŠ˜å table"><a href="#4ã€å¯æŠ˜å table" class="headerlink" title="4ã€å¯æŠ˜å table"></a>4ã€å¯æŠ˜å table</h4><p><img src="/loading.gif" data-original="/images/fontend/DescriptionList.png" alt="å¯æŠ˜å table"></p><pre class="line-numbers language-js"><code class="language-js">  handleTableExpand <span class="token operator">=</span> record <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> toTags <span class="token operator">=</span> items <span class="token operator">=</span><span class="token operator">></span> items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>Tag key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Tag<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>DescriptionList size<span class="token operator">=</span><span class="token string">"small"</span> col<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Description term<span class="token operator">=</span><span class="token string">"èµ„æºIDS"</span><span class="token operator">></span><span class="token punctuation">{</span><span class="token function">toTags</span><span class="token punctuation">(</span><span class="token function">getResources</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>resourceIds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Description<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>DescriptionList<span class="token operator">></span>        <span class="token operator">&lt;</span>DescriptionList style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> marginTop<span class="token punctuation">:</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> size<span class="token operator">=</span><span class="token string">"small"</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Description term<span class="token operator">=</span><span class="token string">"çŸ­ä¿¡éªŒè¯ç é•¿åº¦"</span><span class="token operator">></span><span class="token punctuation">{</span>record<span class="token punctuation">.</span>smsCodeLength<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Description<span class="token operator">></span>          <span class="token operator">&lt;</span>Description term<span class="token operator">=</span><span class="token string">"çŸ­ä¿¡éªŒè¯ç æœ‰æ•ˆæœŸ"</span><span class="token operator">></span>            <span class="token punctuation">{</span>record<span class="token punctuation">.</span>smsCodeLength <span class="token operator">?</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>record<span class="token punctuation">.</span>smsCodeExpire<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">åˆ†é’Ÿ`</span></span> <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">}</span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Description<span class="token operator">></span>          <span class="token operator">&lt;</span>Description term<span class="token operator">=</span><span class="token string">"çŸ­ä¿¡éªŒè¯ç ç­¾å"</span><span class="token operator">></span><span class="token punctuation">{</span>record<span class="token punctuation">.</span>smsCodeSign<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Description<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>DescriptionList<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶ååœ¨tableä¸ŠæŒ‡å®š<code>expandedRowRender={this.handleTableExpand}</code>å³å¯ã€‚</p><h4 id="5ã€tableæ˜¾ç¤ºæ€»æ¡æ•°"><a href="#5ã€tableæ˜¾ç¤ºæ€»æ¡æ•°" class="headerlink" title="5ã€tableæ˜¾ç¤ºæ€»æ¡æ•°"></a>5ã€tableæ˜¾ç¤ºæ€»æ¡æ•°</h4><p><img src="/loading.gif" data-original="/images/fontend/antd-table-total.png" alt="total"></p><pre class="line-numbers language-js"><code class="language-js">  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>    query<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>defaultQuery <span class="token punctuation">}</span><span class="token punctuation">,</span>    list<span class="token punctuation">:</span> <span class="token punctuation">{</span>      data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      pagination<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    exporting<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  effects<span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token operator">*</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> call<span class="token punctuation">,</span> put<span class="token punctuation">,</span> select <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'query'</span><span class="token punctuation">,</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">select</span><span class="token punctuation">(</span>state <span class="token operator">=</span><span class="token operator">></span> state<span class="token punctuation">.</span>smsLog<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        type<span class="token punctuation">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>        payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>          data<span class="token punctuation">:</span> data<span class="token punctuation">.</span>content<span class="token punctuation">,</span>          pagination<span class="token punctuation">:</span> <span class="token punctuation">{</span>            current<span class="token punctuation">:</span> data<span class="token punctuation">.</span>number <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>            pageSize<span class="token punctuation">:</span> data<span class="token punctuation">.</span>size<span class="token punctuation">,</span>            total<span class="token punctuation">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>totalElements<span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¸²æŸ“æ—¶æŒ‡å®špaginationçš„åŒ…æ‹¬äº†totalå­—æ®µï¼Œæ‰€ä»¥å°±ä¼šæ˜¾ç¤ºå‡ºæ€»æ¡æ•°ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>PageTable            columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>columns<span class="token punctuation">}</span>              loading<span class="token operator">=</span><span class="token punctuation">{</span>loading<span class="token punctuation">}</span>              dataSource<span class="token operator">=</span><span class="token punctuation">{</span>list<span class="token punctuation">.</span>data<span class="token punctuation">}</span>              pagination<span class="token operator">=</span><span class="token punctuation">{</span>list<span class="token punctuation">.</span>pagination<span class="token punctuation">}</span>              onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleTableChange<span class="token punctuation">}</span>            <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>listå°±æ˜¯ä»æ¥å£è·å–çš„æ•°æ®ï¼Œ</p><h4 id="6ã€è¡¨å¤´æ”¯æŒç­›é€‰"><a href="#6ã€è¡¨å¤´æ”¯æŒç­›é€‰" class="headerlink" title="6ã€è¡¨å¤´æ”¯æŒç­›é€‰"></a>6ã€è¡¨å¤´æ”¯æŒç­›é€‰</h4><p><img src="/loading.gif" data-original="/images/fontend/antd-table-head-search.png" alt="ç­›é€‰"></p><pre class="line-numbers language-js"><code class="language-js"><span class="token punctuation">{</span>       title<span class="token punctuation">:</span> <span class="token string">'äººå‘˜çŠ¶æ€'</span><span class="token punctuation">,</span>       dataIndex<span class="token punctuation">:</span> <span class="token string">'jobStatus'</span><span class="token punctuation">,</span>       render<span class="token punctuation">:</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>           <span class="token keyword">const</span> filters <span class="token operator">=</span> options<span class="token punctuation">.</span>jobStatus<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>s <span class="token operator">=</span><span class="token operator">></span> s<span class="token punctuation">.</span>value <span class="token operator">===</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">return</span> filters<span class="token punctuation">.</span>length <span class="token operator">?</span> filters<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>       filters<span class="token punctuation">:</span> options<span class="token punctuation">.</span>jobStatus<span class="token punctuation">,</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¡µé¢åŠ è½½æ—¶åŠ è½½ä¸ªæ•°æ®å­—å…¸çš„å€¼</p><pre class="line-numbers language-js"><code class="language-js">    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'rwUserOption/init'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'rwUserList/reload'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯·æ±‚å­—å…¸æ•°æ®ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> dict <span class="token keyword">from</span> <span class="token string">'../../services/api-dict'</span><span class="token keyword">const</span> optionKeys <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">"RWGH-USER-XIAOWEI"</span><span class="token punctuation">,</span>    <span class="token string">"RWGH-USER-STATUS"</span><span class="token punctuation">,</span>    <span class="token string">'RWGH-TRAIN-ATTENDANCE'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>    namespace<span class="token punctuation">:</span> <span class="token string">'rwUserOption'</span><span class="token punctuation">,</span>    state<span class="token punctuation">:</span> <span class="token punctuation">{</span>        sex<span class="token punctuation">:</span><span class="token punctuation">[</span>            <span class="token punctuation">{</span>text<span class="token punctuation">:</span> <span class="token string">'ç”·'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'0'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token punctuation">{</span>text<span class="token punctuation">:</span> <span class="token string">'å¥³'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">}</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment" spellcheck="true">//å°å¾®</span>        xiaowei<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment" spellcheck="true">//å·¥ä½œçŠ¶æ€</span>        jobStatus<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        attendances<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    effects<span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token operator">*</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>payload<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>put<span class="token punctuation">,</span> call<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">const</span> <span class="token punctuation">[</span>xiaowei<span class="token punctuation">,</span> jobStatus<span class="token punctuation">,</span> attendances<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span>many<span class="token punctuation">,</span> optionKeys<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">const</span> mapper <span class="token operator">=</span> <span class="token punctuation">(</span>items<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                    <span class="token keyword">const</span> <span class="token punctuation">{</span>dictValueName<span class="token punctuation">,</span> dictValueCode<span class="token punctuation">}</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>                    <span class="token keyword">return</span> <span class="token punctuation">{</span>text<span class="token punctuation">:</span> dictValueName<span class="token punctuation">,</span> value<span class="token punctuation">:</span> dictValueCode<span class="token punctuation">}</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span>            <span class="token punctuation">}</span><span class="token punctuation">;</span>            <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'changeXiaoWei'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> <span class="token function">mapper</span><span class="token punctuation">(</span>xiaowei<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'changeJobStatus'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> <span class="token function">mapper</span><span class="token punctuation">(</span>jobStatus<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'changeAttendances'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> <span class="token function">mapper</span><span class="token punctuation">(</span>attendances<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    reducers<span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token function">changeXiaoWei</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span>payload<span class="token punctuation">:</span> xiaowei<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">...</span>state<span class="token punctuation">,</span> xiaowei<span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token function">changeJobStatus</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span>payload<span class="token punctuation">:</span> jobStatus<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">...</span>state<span class="token punctuation">,</span> jobStatus<span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token function">changeAttendances</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span>payload<span class="token punctuation">:</span> attendances<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">...</span>state<span class="token punctuation">,</span> attendances<span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>dict.manyæ˜¯è¿™æ ·å®šä¹‰çš„ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> req <span class="token keyword">from</span> <span class="token string">'./api-base'</span><span class="token punctuation">;</span><span class="token keyword">const</span> dict <span class="token operator">=</span> <span class="token punctuation">{</span>    one<span class="token punctuation">:</span> <span class="token punctuation">(</span>indexCode<span class="token punctuation">,</span> cache <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span>resolve <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">const</span> dict <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>indexCode<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cache <span class="token operator">&amp;&amp;</span> dict<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">resolve</span><span class="token punctuation">(</span>dict<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                req<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"/questionnaire/admin/sys/dict/values"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>indexCode<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>data <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                    sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>dict<span class="token punctuation">,</span> data<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">)</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    many<span class="token punctuation">:</span> <span class="token punctuation">(</span>indexCodes<span class="token punctuation">,</span> cache <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>indexCodes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>code <span class="token operator">=</span><span class="token operator">></span> dict<span class="token punctuation">.</span><span class="token function">one</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> dict<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­äººå‘˜çŠ¶æ€çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token punctuation">{</span>    <span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"æ“ä½œæˆåŠŸ"</span><span class="token punctuation">,</span>    <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">{</span>            <span class="token string">"dictValueId"</span><span class="token punctuation">:</span> <span class="token number">162</span><span class="token punctuation">,</span>            <span class="token string">"dictIndexId"</span><span class="token punctuation">:</span> <span class="token number">148</span><span class="token punctuation">,</span>            <span class="token string">"dictValueCode"</span><span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueName"</span><span class="token punctuation">:</span> <span class="token string">"åœ¨èŒ"</span><span class="token punctuation">,</span>            <span class="token string">"deleteFlag"</span><span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueSort"</span><span class="token punctuation">:</span> <span class="token number">0</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token string">"dictValueId"</span><span class="token punctuation">:</span> <span class="token number">163</span><span class="token punctuation">,</span>            <span class="token string">"dictIndexId"</span><span class="token punctuation">:</span> <span class="token number">148</span><span class="token punctuation">,</span>            <span class="token string">"dictValueCode"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueName"</span><span class="token punctuation">:</span> <span class="token string">"äº§å‡"</span><span class="token punctuation">,</span>            <span class="token string">"deleteFlag"</span><span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueSort"</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token string">"dictValueId"</span><span class="token punctuation">:</span> <span class="token number">164</span><span class="token punctuation">,</span>            <span class="token string">"dictIndexId"</span><span class="token punctuation">:</span> <span class="token number">148</span><span class="token punctuation">,</span>            <span class="token string">"dictValueCode"</span><span class="token punctuation">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueName"</span><span class="token punctuation">:</span> <span class="token string">"ç¦»èŒ"</span><span class="token punctuation">,</span>            <span class="token string">"deleteFlag"</span><span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueSort"</span><span class="token punctuation">:</span> <span class="token number">2</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token string">"dictValueId"</span><span class="token punctuation">:</span> <span class="token number">165</span><span class="token punctuation">,</span>            <span class="token string">"dictIndexId"</span><span class="token punctuation">:</span> <span class="token number">148</span><span class="token punctuation">,</span>            <span class="token string">"dictValueCode"</span><span class="token punctuation">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueName"</span><span class="token punctuation">:</span> <span class="token string">"é€€ä¼‘"</span><span class="token punctuation">,</span>            <span class="token string">"deleteFlag"</span><span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueSort"</span><span class="token punctuation">:</span> <span class="token number">3</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token string">"dictValueId"</span><span class="token punctuation">:</span> <span class="token number">167</span><span class="token punctuation">,</span>            <span class="token string">"dictIndexId"</span><span class="token punctuation">:</span> <span class="token number">148</span><span class="token punctuation">,</span>            <span class="token string">"dictValueCode"</span><span class="token punctuation">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueName"</span><span class="token punctuation">:</span> <span class="token string">"è½¬å²—"</span><span class="token punctuation">,</span>            <span class="token string">"deleteFlag"</span><span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueSort"</span><span class="token punctuation">:</span> <span class="token number">4</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token string">"dictValueId"</span><span class="token punctuation">:</span> <span class="token number">168</span><span class="token punctuation">,</span>            <span class="token string">"dictIndexId"</span><span class="token punctuation">:</span> <span class="token number">148</span><span class="token punctuation">,</span>            <span class="token string">"dictValueCode"</span><span class="token punctuation">:</span> <span class="token string">"5"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueName"</span><span class="token punctuation">:</span> <span class="token string">"ç—…å‡"</span><span class="token punctuation">,</span>            <span class="token string">"deleteFlag"</span><span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>            <span class="token string">"dictValueSort"</span><span class="token punctuation">:</span> <span class="token number">5</span>        <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªç­›é€‰æ˜¯å¤šé€‰çš„ï¼Œé€‰ä¸­åç‚¹å‡»ç¡®å®šä¼šè§¦å‘æŸ¥è¯¢ï¼Œå‚æ•°ä¼šxiaoweis=XSJDXW%2CXHYXWåƒè¿™æ ·æ‹¼æ¥åˆ°urlé‡Œã€‚</p><h4 id="7ã€ç»“æœè½¬enumæ˜¾ç¤ºæ–‡æœ¬ï¼Œå¦‚è®¢å•çŠ¶æ€ç­‰ã€‚"><a href="#7ã€ç»“æœè½¬enumæ˜¾ç¤ºæ–‡æœ¬ï¼Œå¦‚è®¢å•çŠ¶æ€ç­‰ã€‚" class="headerlink" title="7ã€ç»“æœè½¬enumæ˜¾ç¤ºæ–‡æœ¬ï¼Œå¦‚è®¢å•çŠ¶æ€ç­‰ã€‚"></a>7ã€ç»“æœè½¬enumæ˜¾ç¤ºæ–‡æœ¬ï¼Œå¦‚è®¢å•çŠ¶æ€ç­‰ã€‚</h4><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">const</span> sendResultDom <span class="token operator">=</span> <span class="token punctuation">{</span>  success<span class="token punctuation">:</span> <span class="token operator">&lt;</span>Badge status<span class="token operator">=</span><span class="token string">"success"</span> text<span class="token operator">=</span><span class="token string">"æˆåŠŸ"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span>  error<span class="token punctuation">:</span> <span class="token operator">&lt;</span>Badge status<span class="token operator">=</span><span class="token string">"error"</span> text<span class="token operator">=</span><span class="token string">"å¤±è´¥"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-js"><code class="language-js">    <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token string">'å‘é€ç»“æœ'</span><span class="token punctuation">,</span>      dataIndex<span class="token punctuation">:</span> <span class="token string">'sendResult'</span><span class="token punctuation">,</span>      render<span class="token punctuation">:</span> test <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>test <span class="token operator">===</span> <span class="token string">'0'</span> <span class="token operator">?</span> sendResultDom<span class="token punctuation">.</span>success <span class="token punctuation">:</span> sendResultDom<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ç§é€‚åˆäºè¿™ä¸ªå¯¹åº”å€¼æ¯”è¾ƒç¨³å®šå˜åŠ¨è¾ƒå°çš„æƒ…å†µï¼Œå¦‚æœæ˜¯ç»å¸¸ä¿®æ”¹æˆ–è€…é€‚é…æ–°å¢ï¼Œåˆä¸æ”¹ä»£ç çš„è¯ï¼Œå°±éœ€è¦ä»¥æ•°æ®å­—å…¸çš„å½¢å¼æä¾›ç»™é¡µé¢å­—å…¸æ•°æ®ï¼Œç„¶åç”¨ç»„ä»¶å»é€‚é…æ˜¾ç¤ºå†…å®¹ã€‚</p><p>æ¯”å¦‚æ•°æ®å­—å…¸çš„sysDict/value/code/list?indexCode=sms_receive_resultæ•°æ®ç»“æ„å¦‚ä¸‹:</p><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>    <span class="token property">"code"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token property">"message"</span><span class="token operator">:</span> <span class="token string">"æ“ä½œæˆåŠŸ"</span><span class="token punctuation">,</span>    <span class="token property">"data"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">{</span>            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"88685502718279680"</span><span class="token punctuation">,</span>            <span class="token property">"isDelete"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token property">"createTime"</span><span class="token operator">:</span> <span class="token number">1553756821000</span><span class="token punctuation">,</span>            <span class="token property">"updateTime"</span><span class="token operator">:</span> <span class="token number">1553756821000</span><span class="token punctuation">,</span>            <span class="token property">"parentId"</span><span class="token operator">:</span> <span class="token string">"88685399781670912"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"æˆåŠŸ"</span><span class="token punctuation">,</span>            <span class="token property">"code"</span><span class="token operator">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>            <span class="token property">"sort"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token property">"remark"</span><span class="token operator">:</span> <span class="token string">""</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"88685542446727168"</span><span class="token punctuation">,</span>            <span class="token property">"isDelete"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token property">"createTime"</span><span class="token operator">:</span> <span class="token number">1553756830000</span><span class="token punctuation">,</span>            <span class="token property">"updateTime"</span><span class="token operator">:</span> <span class="token number">1553756830000</span><span class="token punctuation">,</span>            <span class="token property">"parentId"</span><span class="token operator">:</span> <span class="token string">"88685399781670912"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"å¤±è´¥"</span><span class="token punctuation">,</span>            <span class="token property">"code"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>            <span class="token property">"sort"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token property">"remark"</span><span class="token operator">:</span> <span class="token string">""</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"88685595827634176"</span><span class="token punctuation">,</span>            <span class="token property">"isDelete"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token property">"createTime"</span><span class="token operator">:</span> <span class="token number">1553756843000</span><span class="token punctuation">,</span>            <span class="token property">"updateTime"</span><span class="token operator">:</span> <span class="token number">1553756843000</span><span class="token punctuation">,</span>            <span class="token property">"parentId"</span><span class="token operator">:</span> <span class="token string">"88685399781670912"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ç­‰å¾…"</span><span class="token punctuation">,</span>            <span class="token property">"code"</span><span class="token operator">:</span> <span class="token string">"-1"</span><span class="token punctuation">,</span>            <span class="token property">"sort"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token property">"remark"</span><span class="token operator">:</span> <span class="token string">""</span>        <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå†™ä¸€ä¸ªDictValueçš„ç»„ä»¶ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token comment" spellcheck="true">/* eslint-disable */</span><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> PureComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> Spin<span class="token punctuation">,</span> Select <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span><span class="token keyword">import</span> memoizeOne <span class="token keyword">from</span> <span class="token string">'memoize-one'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> valueListByIndexCode <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/services/dict'</span><span class="token punctuation">;</span><span class="token keyword">const</span> dictCache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">const</span> filterValue <span class="token operator">=</span> <span class="token punctuation">(</span>dicts<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> _<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>dicts<span class="token punctuation">,</span> d <span class="token operator">=</span><span class="token operator">></span> d<span class="token punctuation">.</span>code <span class="token operator">===</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> memoizeGetValue <span class="token operator">=</span> <span class="token function">memoizeOne</span><span class="token punctuation">(</span>filterValue<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getIndexValues</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> values <span class="token operator">=</span> dictCache<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token keyword">return</span> values<span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">valueListByIndexCode</span><span class="token punctuation">(</span><span class="token punctuation">{</span> indexCode<span class="token punctuation">:</span> index <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> newValues <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>d <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> d<span class="token punctuation">.</span>name<span class="token punctuation">,</span> code<span class="token punctuation">:</span> d<span class="token punctuation">.</span>code<span class="token punctuation">,</span> remark<span class="token punctuation">:</span> d<span class="token punctuation">.</span>remark <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  dictCache<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> newValues<span class="token punctuation">;</span>  <span class="token keyword">return</span> newValues<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> indexValues <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getIndexValues</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">memoizeGetValue</span><span class="token punctuation">(</span>indexValues<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getValueName</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> indexValue <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getValue</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> indexValue <span class="token operator">?</span> indexValue<span class="token punctuation">.</span>name <span class="token punctuation">:</span> value<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DictValue</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    loading<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>    text<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> index<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadDate</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> index<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> nextProps<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>index <span class="token operator">!==</span> index <span class="token operator">||</span> props<span class="token punctuation">.</span>value <span class="token operator">!==</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadDate</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  loadDate <span class="token operator">=</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> loading<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">getValueName</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>text <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> text<span class="token punctuation">,</span> loading<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> text <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>span<span class="token operator">></span><span class="token punctuation">{</span>loading <span class="token operator">?</span> <span class="token operator">&lt;</span>Spin size<span class="token operator">=</span><span class="token string">"small"</span> <span class="token operator">/</span><span class="token operator">></span> <span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">const</span> <span class="token punctuation">{</span> Option <span class="token punctuation">}</span> <span class="token operator">=</span> Select<span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DictSelect</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> index <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token function">getIndexValues</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>data <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>Select placeholder<span class="token operator">=</span><span class="token string">"è¯·é€‰æ‹©"</span> <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span><span class="token operator">></span>        <span class="token punctuation">{</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>          <span class="token operator">&lt;</span>Option key<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>code<span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>code<span class="token punctuation">}</span><span class="token operator">></span>            <span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">></span>        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>Select<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­<code>valueListByIndexCode</code>å°±æ˜¯è·å–åˆ°ä¸Šé¢ç»“æ„æ•°æ®çš„apiï¼Œä¸ç”¨ç‰¹æ®Šè¯´æ˜äº†ã€‚<br>è¿™ä¸ªç±»åŒ…å«äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯DictValueï¼Œç”¨æ¥ä»keyè·å–valueï¼Œä¸€ä¸ªæ˜¯DictSelectæä¾›ä¸€ä¸‹è¯¥å­—å…¸å€¼å¾—ä¸‹æ‹‰é€‰é¡¹ã€‚<br>DictValueçš„ç”¨æ³•:</p><pre class="line-numbers language-js"><code class="language-js"><span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token string">'æ¥æ”¶ç»“æœ'</span><span class="token punctuation">,</span>      dataIndex<span class="token punctuation">:</span> <span class="token string">'receiveResult'</span><span class="token punctuation">,</span>      render<span class="token punctuation">:</span> value <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>DictValue index<span class="token operator">=</span><span class="token string">"sms_receive_result"</span> value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>DictSelectçš„ç”¨æ³•:</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"æ¥æ”¶ç»“æœ"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>DictSelect       allowClear       index<span class="token operator">=</span><span class="token string">"sms_receive_result"</span>       value<span class="token operator">=</span><span class="token punctuation">{</span>query<span class="token punctuation">.</span>receiveResult<span class="token punctuation">}</span>       onChange<span class="token operator">=</span><span class="token punctuation">{</span>receiveResult <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleSearch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> receiveResult <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>    <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>8ã€ç­‰å¾…ã€‚ã€‚ã€‚</p><h2 id="å®˜æ–¹API"><a href="#å®˜æ–¹API" class="headerlink" title="å®˜æ–¹API"></a><a href="https://ant.design/components/table-cn/">å®˜æ–¹API</a></h2>]]></content>
      
      
      <categories>
          
          <category> åå°ç®¡ç†ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Antd Pro </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ant Design Pro ä½¿ç”¨ç‚¹ç‚¹æ»´æ»´</title>
      <link href="2019/04/09/ant-design-pro-shi-yong-dian-dian-di-di/"/>
      <url>2019/04/09/ant-design-pro-shi-yong-dian-dian-di-di/</url>
      
        <content type="html"><![CDATA[<p>é˜¿é‡Œç²‘ç²‘å¼€æºçš„ç®¡ç†æ¡†æ¶<a href="https://pro.ant.design/index-cn">Ant Design Pro</a>ä½¿ç”¨è®°å½•ä¹‹mockã€‚</p><p><a href="https://www.jianshu.com/p/bc2e95e05cc9">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="1ã€æœ‰ç”¨çš„Mock"><a href="#1ã€æœ‰ç”¨çš„Mock" class="headerlink" title="1ã€æœ‰ç”¨çš„Mock"></a>1ã€æœ‰ç”¨çš„Mock</h3><p>antd proåœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸‹startæ—¶å°±æä¾›äº†mockç¯å¢ƒäº†ï¼Œåœ¨æ ¹ç›®å½•çš„mocké‡Œå¯ä»¥å®šä¹‰è‡ªå·±éœ€è¦mockçš„æ–¹æ³•å’Œå‡ºå…¥å‚æ•°ï¼Œéå¸¸çš„æ–¹ä¾¿ã€‚</p><blockquote><p>2019-06-03è¡¥å……ï¼š<br>åœ¨æˆ‘çš„å°è¯•ä¹‹å‰æ¨èä¸‹<a href="https://github.com/typicode/json-server">json-server</a>ï¼Œæˆ‘ä¸‹é¢æ²¡æœ‰ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨åˆ«çš„åœ°æ–¹ç”¨è¿‡ï¼Œç¡®å®è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚</p></blockquote><p>æ¥ä¸‹æ¥ä»‹ç»ä¸‹æˆ‘æ€ä¹ˆä¹‹å‰æ€ä¹ˆç”¨çš„ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> Mock <span class="token keyword">from</span> <span class="token string">'mockjs'</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token punctuation">{</span> Random <span class="token punctuation">}</span> <span class="token operator">=</span> Mock<span class="token punctuation">;</span><span class="token keyword">const</span> userListLength <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> userList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ç”Ÿæˆè¡¨æ ¼mockæ•°æ®</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> userListLength<span class="token punctuation">;</span> i <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  userList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    id<span class="token punctuation">:</span> i<span class="token punctuation">,</span>    love<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.5</span><span class="token punctuation">,</span>    taxNo<span class="token punctuation">:</span> Random<span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token number">4e14</span><span class="token punctuation">,</span> <span class="token number">5e14</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    taxtype<span class="token punctuation">:</span> i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">'small'</span> <span class="token punctuation">:</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">'personal'</span> <span class="token punctuation">:</span> <span class="token string">'normal'</span><span class="token punctuation">,</span>    name<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`æ·±åœ³å¸‚ä¸æ‚¦åŒ–å¦†å“æœ‰é™å…¬å¸</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>    no<span class="token punctuation">:</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token template-string"><span class="token string">`B</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span> <span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`T</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>    taxZone<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.5</span> <span class="token operator">?</span> <span class="token string">'å¹¿ä¸œ'</span> <span class="token punctuation">:</span> <span class="token string">'æ·±åœ³'</span><span class="token punctuation">,</span>    key<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.5</span><span class="token punctuation">,</span>    sysVerify<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.5</span><span class="token punctuation">,</span>    taxManager<span class="token punctuation">:</span> <span class="token string">'lane'</span><span class="token punctuation">,</span>    accountManager<span class="token punctuation">:</span> <span class="token string">'lane'</span><span class="token punctuation">,</span>    date<span class="token punctuation">:</span> Random<span class="token punctuation">.</span><span class="token function">datetime</span><span class="token punctuation">(</span><span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>  <span class="token punctuation">[</span><span class="token template-string"><span class="token string">`POST /api/biz/md/bizMdClient/search`</span></span><span class="token punctuation">]</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> u<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// åˆ†é¡µæŸ¥è¯¢å¤„ç†</span>    <span class="token keyword">const</span> body <span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">&amp;&amp;</span> b<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> skip<span class="token punctuation">,</span> limit <span class="token punctuation">}</span> <span class="token operator">=</span> body<span class="token punctuation">;</span>    <span class="token keyword">const</span> start <span class="token operator">=</span> skip <span class="token operator">*</span> limit<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ•°æ®å¼€å§‹ç´¢å¼•</span>    <span class="token keyword">const</span> end <span class="token operator">=</span> start <span class="token operator">+</span> <span class="token punctuation">(</span>limit <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ•°æ®ç»“æŸç´¢å¼•</span>    <span class="token keyword">const</span> dataSource <span class="token operator">=</span> userList<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è¦è¿”å›çš„æ•°æ®</span>    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">{</span>      code<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>      data<span class="token punctuation">:</span> dataSource<span class="token punctuation">,</span>      <span class="token comment" spellcheck="true">// åˆ†é¡µä¿¡æ¯</span>      pageinfo<span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token string">"total"</span><span class="token punctuation">:</span> userList<span class="token punctuation">.</span>length<span class="token punctuation">,</span>        <span class="token string">"pageindex"</span><span class="token punctuation">:</span> skip<span class="token punctuation">,</span>        <span class="token string">"pagesize"</span><span class="token punctuation">:</span> limit<span class="token punctuation">,</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span>json<span class="token punctuation">)</span> <span class="token punctuation">{</span>      res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">[</span><span class="token template-string"><span class="token string">`POST /api/biz/md/bizMdClient/love`</span></span><span class="token punctuation">]</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> client <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> length <span class="token operator">=</span> userList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>client<span class="token punctuation">.</span>id <span class="token operator">===</span> userList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>        userList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>love <span class="token operator">=</span> <span class="token operator">!</span>userList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>love<span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> code<span class="token punctuation">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">[</span><span class="token template-string"><span class="token string">`POST /api/biz/md/bizMdClient/queryFilterOptions`</span></span><span class="token punctuation">]</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> dataSource <span class="token operator">=</span> <span class="token punctuation">[</span>      <span class="token punctuation">{</span>        title<span class="token punctuation">:</span> <span class="token string">'å…¨éƒ¨'</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        title<span class="token punctuation">:</span> <span class="token string">'ä¸€èˆ¬'</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        title<span class="token punctuation">:</span> <span class="token string">'å°è§„æ¨¡'</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        title<span class="token punctuation">:</span> <span class="token string">'ç¨åŠ¡å¾…åˆ†é…'</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        title<span class="token punctuation">:</span> <span class="token string">'è´¦åŠ¡å¾…åˆ†é…'</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        title<span class="token punctuation">:</span> <span class="token string">'æˆ‘çš„å…³æ³¨'</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">{</span>      code<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>      data<span class="token punctuation">:</span> dataSource<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span>json<span class="token punctuation">)</span> <span class="token punctuation">{</span>      res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢çš„mockæ˜¯åŸºäºæœ¬åœ°<code>npm start</code> æ—¶å¯åŠ¨çš„mockæœåŠ¡è¯´çš„ï¼Œä½†æ˜¯ä»£ç æ’¸å®Œäº†ï¼Œæ€»è¦åœ¨æœåŠ¡å™¨ä¸Šæä¾›æœåŠ¡ï¼Œä¸èƒ½å†æœ¬åœ°è‡ªå·±ç©å§ï¼Œä¹Ÿå°±æ˜¯è¯´npm buildåï¼Œç”Ÿæˆçš„distçš„ç›®å½•çš„æ–‡ä»¶è¦åœ¨æœåŠ¡å™¨ä¸Šè·‘çš„ï¼Œä¸€èˆ¬æ˜¯ç”¨nginxä½œä¸ºæœåŠ¡å™¨ã€‚æµ‹è¯•mockå°±æ²¡æœ‰äº†ï¼Œè¿™æ—¶å€™æ€ä¹ˆåŠï¼Œæœ‰ä¸¤ç§åŠæ³•è§£å†³ï¼Œå…¶å®å°±ç®—æ˜¯æœ¬åœ°æˆ‘ä¸ªäººä¹Ÿæ¯”è¾ƒæ¨èä¸‹é¢è¿™ç§æ–¹å¼ã€‚<br>å°†ä¸€ä¸ªjsonæ ¼å¼çš„æ–‡æœ¬å¤åˆ¶åˆ°æ¯”å¦‚test.jsonä¸­ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>    <span class="token property">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">{</span>            <span class="token property">"callNo"</span><span class="token operator">:</span> <span class="token string">"11101"</span><span class="token punctuation">,</span>            <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"20ml"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"1å·è„±æ•é’ˆ"</span><span class="token punctuation">,</span>            <span class="token property">"updatedAt"</span><span class="token operator">:</span> <span class="token string">"2019-04-12T14:00:00.000Z"</span><span class="token punctuation">,</span>            <span class="token property">"pingHao"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token property">"fenZhen"</span><span class="token operator">:</span> <span class="token string">"æ˜¯"</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token property">"callNo"</span><span class="token operator">:</span> <span class="token string">"11102"</span><span class="token punctuation">,</span>            <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"20ml"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"2å·è„±æ•é’ˆ"</span><span class="token punctuation">,</span>            <span class="token property">"updatedAt"</span><span class="token operator">:</span> <span class="token string">"2019-04-12T14:00:00.000Z"</span><span class="token punctuation">,</span>            <span class="token property">"pingHao"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>            <span class="token property">"fenZhen"</span><span class="token operator">:</span> <span class="token string">"æ˜¯"</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token property">"callNo"</span><span class="token operator">:</span> <span class="token string">"11103"</span><span class="token punctuation">,</span>            <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"30ml"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"3å·è„±æ•é’ˆ"</span><span class="token punctuation">,</span>            <span class="token property">"updatedAt"</span><span class="token operator">:</span> <span class="token string">"2019-04-12T14:00:00.000Z"</span><span class="token punctuation">,</span>            <span class="token property">"pingHao"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>            <span class="token property">"fenZhen"</span><span class="token operator">:</span> <span class="token string">"æ˜¯"</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token property">"callNo"</span><span class="token operator">:</span> <span class="token string">"11104"</span><span class="token punctuation">,</span>            <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"30ml"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"4å·è„±æ•é’ˆ"</span><span class="token punctuation">,</span>            <span class="token property">"updatedAt"</span><span class="token operator">:</span> <span class="token string">"2019-04-12T14:00:00.000Z"</span><span class="token punctuation">,</span>            <span class="token property">"pingHao"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>            <span class="token property">"fenZhen"</span><span class="token operator">:</span> <span class="token string">"æ˜¯"</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token property">"callNo"</span><span class="token operator">:</span> <span class="token string">"11105"</span><span class="token punctuation">,</span>            <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"40ml"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"5å·è„±æ•é’ˆ"</span><span class="token punctuation">,</span>            <span class="token property">"updatedAt"</span><span class="token operator">:</span> <span class="token string">"2019-04-12T14:00:00.000Z"</span><span class="token punctuation">,</span>            <span class="token property">"pingHao"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>            <span class="token property">"fenZhen"</span><span class="token operator">:</span> <span class="token string">"æ˜¯"</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token property">"callNo"</span><span class="token operator">:</span> <span class="token string">"11106"</span><span class="token punctuation">,</span>            <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"40ml"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"6å·è„±æ•é’ˆ"</span><span class="token punctuation">,</span>            <span class="token property">"updatedAt"</span><span class="token operator">:</span> <span class="token string">"2019-04-12T14:00:00.000Z"</span><span class="token punctuation">,</span>            <span class="token property">"pingHao"</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>            <span class="token property">"fenZhen"</span><span class="token operator">:</span> <span class="token string">"æ˜¯"</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token property">"callNo"</span><span class="token operator">:</span> <span class="token string">"111017"</span><span class="token punctuation">,</span>            <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"60ml"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"7å·è„±æ•é’ˆ"</span><span class="token punctuation">,</span>            <span class="token property">"updatedAt"</span><span class="token operator">:</span> <span class="token string">"2019-04-12T14:00:00.000Z"</span><span class="token punctuation">,</span>            <span class="token property">"pingHao"</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>            <span class="token property">"fenZhen"</span><span class="token operator">:</span> <span class="token string">"æ˜¯"</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span>            <span class="token property">"callNo"</span><span class="token operator">:</span> <span class="token string">"11108"</span><span class="token punctuation">,</span>            <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"60ml"</span><span class="token punctuation">,</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"8å·è„±æ•é’ˆ"</span><span class="token punctuation">,</span>            <span class="token property">"updatedAt"</span><span class="token operator">:</span> <span class="token string">"2019-04-12T14:00:00.000Z"</span><span class="token punctuation">,</span>            <span class="token property">"pingHao"</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>            <span class="token property">"fenZhen"</span><span class="token operator">:</span> <span class="token string">"æ˜¯"</span>        <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"pagination"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"total"</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>        <span class="token property">"pageSize"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>        <span class="token property">"current"</span><span class="token operator">:</span> <span class="token number">1</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæŠŠè¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°ä»»ä½•ä¸€ä¸ªæœ‰ç½‘å°±å¯ä»¥ä¸‹è½½çš„æœåŠ¡å™¨ä¸Šï¼Œæ¯”å¦‚ä¸ƒç‰›å•Šï¼Œç™¾åº¦å•Šï¼Œä»€ä¹ˆçš„æä¾›å­˜å‚¨çš„åœ°æ–¹ï¼Œæ¯”å¦‚<a href="http://cdn.imgs.3vyd.com/xh/admin/test.json">æˆ‘çš„</a></p><p>modelsé‡Œè¿˜æ˜¯ä¸€æ ·çš„è°ƒç”¨servicesçš„jsæ–‡ä»¶é‡Œæä¾›çš„æ¥å£</p><pre class="line-numbers language-js"><code class="language-js">    <span class="token operator">*</span><span class="token function">fetchTuoMinZhen</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> call<span class="token punctuation">,</span> put <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>queryTuoMinZhen<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        type<span class="token punctuation">:</span> <span class="token string">'save'</span><span class="token punctuation">,</span>        payload<span class="token punctuation">:</span> response<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡ç‚¹æ¥äº†ï¼Œæœ¬æ¥servicesé‡Œçš„æ¥å£æ˜¯è¿™æ ·çš„:</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">queryTuoMinZhen</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`/api/tuominzhen?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">stringify</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå®‰è£…mock-serverä¸“é—¨æä¾›æœåŠ¡ï¼Œå…·ä½“å¯ä»¥googleè¯•è¯•ã€‚</p><h3 id="2ã€åœ¨tableçš„è¡Œrenderæ—¶å¸¸ç”¨çš„æ“ä½œ"><a href="#2ã€åœ¨tableçš„è¡Œrenderæ—¶å¸¸ç”¨çš„æ“ä½œ" class="headerlink" title="2ã€åœ¨tableçš„è¡Œrenderæ—¶å¸¸ç”¨çš„æ“ä½œ"></a>2ã€åœ¨tableçš„è¡Œrenderæ—¶å¸¸ç”¨çš„æ“ä½œ</h3><p>1ã€æ—¶é—´æ ¼å¼åŒ–ï¼ŒæŒ‡å®šæ—¶åŒº</p><pre class="line-numbers language-js"><code class="language-js"> <span class="token punctuation">{</span>â€‹      title<span class="token punctuation">:</span> <span class="token string">'æ›´æ–°æ—¶é—´'</span><span class="token punctuation">,</span>â€‹      dataIndex<span class="token punctuation">:</span> <span class="token string">'updateTime'</span><span class="token punctuation">,</span>â€‹      sorter<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>â€‹      render<span class="token punctuation">:</span> val <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>span<span class="token operator">></span><span class="token punctuation">{</span><span class="token function">moment</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">utc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'YYYY-MM-DD HH:mm:ss'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">,</span>â€‹    <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2ã€æ˜¾ç¤ºå›¾ç‰‡<br>3ã€é•¿æ–‡æœ¬ä½¿ç”¨çœç•¥å·<br>4ã€å¯æŠ˜å table<br>5ã€æ˜¾ç¤ºæ€»æ¡æ•°<br>6ã€è¡¨å¤´æ”¯æŒç­›é€‰å’Œæ’åº</p><h3 id="3ã€ä¿®æ”¹antdé»˜è®¤çš„æ ·å¼"><a href="#3ã€ä¿®æ”¹antdé»˜è®¤çš„æ ·å¼" class="headerlink" title="3ã€ä¿®æ”¹antdé»˜è®¤çš„æ ·å¼"></a>3ã€ä¿®æ”¹antdé»˜è®¤çš„æ ·å¼</h3><p>åœ¨è‡ªå®šä¹‰çš„classä¸­åŠ å…¥<code>:global</code>å…³é”®å­—çš„æ ·å¼:</p><pre><code></code></pre><p><a href="https://www.jianshu.com/p/b8d45314a495">æ€ä¹ˆä¿®æ”¹antdé»˜è®¤æ ·å¼åŠé‡åˆ°çš„é—®é¢˜</a></p><h3 id="æ¨èç½‘ç«™"><a href="#æ¨èç½‘ç«™" class="headerlink" title="æ¨èç½‘ç«™"></a>æ¨èç½‘ç«™</h3><p><a href="https://www.colabug.com/4550241.html">Ant Design Proæ€»ç»“ç¯‡</a><br><a href="https://www.jianshu.com/p/4c54ae2bc925">ç»å…¸ â€“  Ant Design Pro å­¦ä¹ ç¬”è®°</a><br><a href="http://javascript.ruanyifeng.com/nodejs/packagejson.html">package.jsoné…ç½®æ–‡ä»¶</a></p>]]></content>
      
      
      <categories>
          
          <category> åå°ç®¡ç†ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Antd Pro </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ant Design Proå­¦ä¹ ä¹‹ç»„ä»¶åŒ–</title>
      <link href="2019/03/28/ant-design-pro-xue-xi-zhi-zu-jian-hua/"/>
      <url>2019/03/28/ant-design-pro-xue-xi-zhi-zu-jian-hua/</url>
      
        <content type="html"><![CDATA[<p>é˜¿é‡Œç²‘ç²‘å¼€æºçš„ç®¡ç†æ¡†æ¶<a href="https://pro.ant.design/index-cn">Ant Design Pro</a>ä½¿ç”¨è®°å½•ä¹‹è§„èŒƒå­¦ä¹ ï¼Œç»„ä»¶åŒ–ã€‚</p><p><a href="https://www.jianshu.com/p/cd656c78b293">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>åŒäº‹å†™äº†ä¸€ä¸ªæˆ‘ç›®å‰çœ‹ç€æ¯”è¾ƒæ­£è§„åŒ–çš„ç»„ä»¶å¼é¡µé¢ï¼Œåœ¨æ­¤ä½œä¸ºå­¦ä¹ æ ‡å‡†è´´ä¸€ä¸‹ï¼Œå…ˆçœ‹ä¸ªæ•ˆæœå›¾ï¼š<br><img src="/loading.gif" data-original="/images/fontend/antd-table2.png" alt="åˆ—è¡¨"></p><p><img src="/loading.gif" data-original="/images/fontend/antd-table-edit1.png" alt="ç¼–è¾‘1"></p><p><img src="/loading.gif" data-original="/images/fontend/antd-table-edit2.png" alt="ç¼–è¾‘2"></p><p>è¿™æ˜¯ä¸€ä¸ªoauthçš„clientç®¡ç†çš„é¡µé¢ï¼Œä¸»è¦ä»£ç å¦‚ä¸‹ï¼š<br>apiåˆ—è¡¨æ•°æ®ç»“æ„</p><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>    <span class="token property">"code"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token property">"message"</span><span class="token operator">:</span> <span class="token string">"æ“ä½œæˆåŠŸ"</span><span class="token punctuation">,</span>    <span class="token property">"data"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token punctuation">{</span>                <span class="token property">"clientId"</span><span class="token operator">:</span> <span class="token string">"usercenter-manage"</span><span class="token punctuation">,</span>                <span class="token property">"clientName"</span><span class="token operator">:</span> <span class="token string">"æµ‹è¯•app"</span><span class="token punctuation">,</span>                <span class="token property">"resourceIds"</span><span class="token operator">:</span> <span class="token string">"usercenter/manage,smscenter/api"</span><span class="token punctuation">,</span>                <span class="token property">"clientSecret"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>                <span class="token property">"scope"</span><span class="token operator">:</span> <span class="token string">"read,write,trust"</span><span class="token punctuation">,</span>                <span class="token property">"authorizedGrantTypes"</span><span class="token operator">:</span> <span class="token string">"password,refresh_token"</span><span class="token punctuation">,</span>                <span class="token property">"webServerRedirectUri"</span><span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>                <span class="token property">"authorities"</span><span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>                <span class="token property">"accessTokenValidity"</span><span class="token operator">:</span> <span class="token number">7200</span><span class="token punctuation">,</span>                <span class="token property">"refreshTokenValidity"</span><span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>                <span class="token property">"additionalInformation"</span><span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>                <span class="token property">"autoapprove"</span><span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>                <span class="token property">"smsCodeLength"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>                <span class="token property">"smsCodeExpire"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>                <span class="token property">"smsCodeSign"</span><span class="token operator">:</span> <span class="token string">"ã€xxxxxxã€‘"</span><span class="token punctuation">,</span>                <span class="token property">"platformCode"</span><span class="token operator">:</span> <span class="token null">null</span><span class="token punctuation">,</span>                <span class="token property">"updateTime"</span><span class="token operator">:</span> <span class="token string">"2019-03-25T14:27:26.000+0000"</span><span class="token punctuation">,</span>                <span class="token property">"createTime"</span><span class="token operator">:</span> <span class="token null">null</span>            <span class="token punctuation">}</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"pageable"</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">"sort"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                <span class="token property">"sorted"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                <span class="token property">"unsorted"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>                <span class="token property">"empty"</span><span class="token operator">:</span> <span class="token boolean">false</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token property">"offset"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token property">"pageSize"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>            <span class="token property">"pageNumber"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token property">"paged"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token property">"unpaged"</span><span class="token operator">:</span> <span class="token boolean">false</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token property">"totalPages"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"totalElements"</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>        <span class="token property">"last"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token property">"size"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>        <span class="token property">"number"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>        <span class="token property">"first"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token property">"numberOfElements"</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>        <span class="token property">"sort"</span><span class="token operator">:</span> <span class="token punctuation">{</span>            <span class="token property">"sorted"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token property">"unsorted"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token property">"empty"</span><span class="token operator">:</span> <span class="token boolean">false</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token property">"empty"</span><span class="token operator">:</span> <span class="token boolean">false</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»„ä»¶åŒ–å˜›ï¼Œæ–‡ä»¶è‡ªç„¶æ¯”è¾ƒå¤šï¼Œæ‰“ä¸ªæ ‡è¯†</p><h3 id="1ã€ClientListï¼šé¡µé¢æ¸²æŸ“js"><a href="#1ã€ClientListï¼šé¡µé¢æ¸²æŸ“js" class="headerlink" title="1ã€ClientListï¼šé¡µé¢æ¸²æŸ“js"></a>1ã€ClientListï¼šé¡µé¢æ¸²æŸ“js</h3><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> PureComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'dva'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> Popconfirm<span class="token punctuation">,</span> Card<span class="token punctuation">,</span> Table<span class="token punctuation">,</span> Button<span class="token punctuation">,</span> Divider<span class="token punctuation">,</span> Tag<span class="token punctuation">,</span> message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span><span class="token keyword">import</span> PageHeaderWrapper <span class="token keyword">from</span> <span class="token string">'@/components/PageHeaderWrapper'</span><span class="token punctuation">;</span><span class="token keyword">import</span> DescriptionList <span class="token keyword">from</span> <span class="token string">'@/components/DescriptionList'</span><span class="token punctuation">;</span><span class="token keyword">import</span> ClientForm <span class="token keyword">from</span> <span class="token string">'./ClientForm'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> humanizeTime<span class="token punctuation">,</span> getOAuthTypeNames <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./ClientUtil'</span><span class="token punctuation">;</span><span class="token keyword">import</span> styles <span class="token keyword">from</span> <span class="token string">'../Common/TableList.less'</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token punctuation">{</span> Description <span class="token punctuation">}</span> <span class="token operator">=</span> DescriptionList<span class="token punctuation">;</span>@<span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> client<span class="token punctuation">,</span> loading <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>  client<span class="token punctuation">,</span>  loading<span class="token punctuation">:</span> loading<span class="token punctuation">.</span>effects<span class="token punctuation">[</span><span class="token string">'client/fetch'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  submitting<span class="token punctuation">:</span> loading<span class="token punctuation">.</span>effects<span class="token punctuation">[</span><span class="token string">'client/update'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">ClientList</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>  columns <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token string">'åº”ç”¨ID'</span><span class="token punctuation">,</span>      dataIndex<span class="token punctuation">:</span> <span class="token string">'clientId'</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token string">'åº”ç”¨åç§°'</span><span class="token punctuation">,</span>      dataIndex<span class="token punctuation">:</span> <span class="token string">'clientName'</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token punctuation">(</span>        <span class="token operator">&lt;</span>span<span class="token operator">></span>          Token          <span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">></span>          æœ‰æ•ˆæœŸ        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>      <span class="token punctuation">)</span><span class="token punctuation">,</span>      dataIndex<span class="token punctuation">:</span> <span class="token string">'accessTokenValidity'</span><span class="token punctuation">,</span>      render<span class="token punctuation">:</span> value <span class="token operator">=</span><span class="token operator">></span> <span class="token function">humanizeTime</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token punctuation">(</span>        <span class="token operator">&lt;</span>span<span class="token operator">></span>          RefreshToken          <span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">></span>          æœ‰æ•ˆæœŸ        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>      <span class="token punctuation">)</span><span class="token punctuation">,</span>      dataIndex<span class="token punctuation">:</span> <span class="token string">'refreshTokenValidity'</span><span class="token punctuation">,</span>      render<span class="token punctuation">:</span> value <span class="token operator">=</span><span class="token operator">></span> <span class="token function">humanizeTime</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token string">'æ“ä½œ'</span><span class="token punctuation">,</span>      dataIndex<span class="token punctuation">:</span> <span class="token string">'action'</span><span class="token punctuation">,</span>      render<span class="token punctuation">:</span> <span class="token punctuation">(</span>text<span class="token punctuation">,</span> record<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>        <span class="token operator">&lt;</span>span<span class="token operator">></span>          <span class="token operator">&lt;</span>a            onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleOpenForm</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">}</span>          <span class="token operator">></span>            ç¼–è¾‘          <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>          <span class="token operator">&lt;</span>Divider type<span class="token operator">=</span><span class="token string">"vertical"</span> <span class="token operator">/</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Popconfirm            title<span class="token operator">=</span><span class="token string">"ç¡®è®¤åˆ é™¤ï¼Ÿ"</span>            onConfirm<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleRemove</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">}</span>            okText<span class="token operator">=</span><span class="token string">"ç¡®è®¤"</span>            cancelText<span class="token operator">=</span><span class="token string">"å–æ¶ˆ"</span>          <span class="token operator">></span>            <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#"</span><span class="token operator">></span>åˆ é™¤<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Popconfirm<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>      <span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'client/fetch'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  handleTableChange <span class="token operator">=</span> pagination <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> current<span class="token punctuation">,</span> pageSize <span class="token punctuation">}</span> <span class="token operator">=</span> pagination<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'client/fetch'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> <span class="token punctuation">{</span> page<span class="token punctuation">:</span> current <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> size<span class="token punctuation">:</span> pageSize <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  handleTableExpand <span class="token operator">=</span> record <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> toTags <span class="token operator">=</span> items <span class="token operator">=</span><span class="token operator">></span> items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>Tag key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Tag<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>DescriptionList size<span class="token operator">=</span><span class="token string">"small"</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Description term<span class="token operator">=</span><span class="token string">"æˆæƒæ¨¡å¼"</span><span class="token operator">></span>            <span class="token punctuation">{</span><span class="token function">toTags</span><span class="token punctuation">(</span><span class="token function">getOAuthTypeNames</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>authorizedGrantTypes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Description<span class="token operator">></span>          <span class="token operator">&lt;</span>Description term<span class="token operator">=</span><span class="token string">"å¹³å°ç¼–ç "</span><span class="token operator">></span><span class="token punctuation">{</span>record<span class="token punctuation">.</span>platformCode<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Description<span class="token operator">></span>          <span class="token operator">&lt;</span>Description term<span class="token operator">=</span><span class="token string">"èµ„æºIDS"</span><span class="token operator">></span><span class="token punctuation">{</span>record<span class="token punctuation">.</span>resourceIds<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Description<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>DescriptionList<span class="token operator">></span>        <span class="token operator">&lt;</span>DescriptionList style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> marginTop<span class="token punctuation">:</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> size<span class="token operator">=</span><span class="token string">"small"</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Description term<span class="token operator">=</span><span class="token string">"çŸ­ä¿¡éªŒè¯ç é•¿åº¦"</span><span class="token operator">></span><span class="token punctuation">{</span>record<span class="token punctuation">.</span>smsCodeLength<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Description<span class="token operator">></span>          <span class="token operator">&lt;</span>Description term<span class="token operator">=</span><span class="token string">"çŸ­ä¿¡éªŒè¯ç æœ‰æ•ˆæœŸ"</span><span class="token operator">></span>            <span class="token punctuation">{</span>record<span class="token punctuation">.</span>smsCodeLength <span class="token operator">?</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>record<span class="token punctuation">.</span>smsCodeLength<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">åˆ†é’Ÿ`</span></span> <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">}</span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Description<span class="token operator">></span>          <span class="token operator">&lt;</span>Description term<span class="token operator">=</span><span class="token string">"çŸ­ä¿¡éªŒè¯ç ç­¾å"</span><span class="token operator">></span><span class="token punctuation">{</span>record<span class="token punctuation">.</span>smsCodeSign<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Description<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>DescriptionList<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  handleOpenForm <span class="token operator">=</span> formData <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'client/openForm'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> formData <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  handleCloseForm <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'client/closeForm'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  handleAdd <span class="token operator">=</span> values <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'client/update'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> values <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'æ“ä½œæˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  handleRemove <span class="token operator">=</span> record <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'client/remove'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> record<span class="token punctuation">.</span>clientId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'åˆ é™¤æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span>      client<span class="token punctuation">:</span> <span class="token punctuation">{</span> list<span class="token punctuation">,</span> form <span class="token punctuation">}</span><span class="token punctuation">,</span>      loading<span class="token punctuation">,</span>      submitting<span class="token punctuation">,</span>    <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">const</span> paginationProps <span class="token operator">=</span> <span class="token punctuation">{</span>      showSizeChanger<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>      showQuickJumper<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>      <span class="token operator">...</span>list<span class="token punctuation">.</span>pagination<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>PageHeaderWrapper title<span class="token operator">=</span><span class="token string">"åº”ç”¨åˆ—è¡¨"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>Card bordered<span class="token operator">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token operator">></span>          <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>tableList<span class="token punctuation">}</span><span class="token operator">></span>            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>tableListForm<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>tableListOperator<span class="token punctuation">}</span><span class="token operator">></span>              <span class="token operator">&lt;</span>Button icon<span class="token operator">=</span><span class="token string">"plus"</span> type<span class="token operator">=</span><span class="token string">"primary"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleOpenForm<span class="token punctuation">}</span><span class="token operator">></span>                æ–°å»º              <span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>            <span class="token operator">&lt;</span>Table              rowKey<span class="token operator">=</span><span class="token string">"clientId"</span>              size<span class="token operator">=</span><span class="token string">"middle"</span>              columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>columns<span class="token punctuation">}</span>              loading<span class="token operator">=</span><span class="token punctuation">{</span>loading<span class="token punctuation">}</span>              dataSource<span class="token operator">=</span><span class="token punctuation">{</span>list<span class="token punctuation">.</span>data<span class="token punctuation">}</span>              pagination<span class="token operator">=</span><span class="token punctuation">{</span>paginationProps<span class="token punctuation">}</span>              onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleTableChange<span class="token punctuation">}</span>              expandedRowRender<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleTableExpand<span class="token punctuation">}</span>            <span class="token operator">/</span><span class="token operator">></span>          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>Card<span class="token operator">></span>        <span class="token operator">&lt;</span>ClientForm          data<span class="token operator">=</span><span class="token punctuation">{</span>form<span class="token punctuation">.</span>data<span class="token punctuation">}</span>          visible<span class="token operator">=</span><span class="token punctuation">{</span>form<span class="token punctuation">.</span>visible<span class="token punctuation">}</span>          submitting<span class="token operator">=</span><span class="token punctuation">{</span>submitting<span class="token punctuation">}</span>          onClose<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleCloseForm<span class="token punctuation">}</span>          onSave<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleAdd<span class="token punctuation">}</span>        <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>PageHeaderWrapper<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> ClientList<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2ã€ClientFormï¼šæ·»åŠ ç¼–è¾‘å•æ¡æ•°æ®çš„Form"><a href="#2ã€ClientFormï¼šæ·»åŠ ç¼–è¾‘å•æ¡æ•°æ®çš„Form" class="headerlink" title="2ã€ClientFormï¼šæ·»åŠ ç¼–è¾‘å•æ¡æ•°æ®çš„Form"></a>2ã€ClientFormï¼šæ·»åŠ ç¼–è¾‘å•æ¡æ•°æ®çš„Form</h3><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> PureComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> Modal<span class="token punctuation">,</span> Form<span class="token punctuation">,</span> Input<span class="token punctuation">,</span> Tabs<span class="token punctuation">,</span> InputNumber <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span><span class="token keyword">import</span> SecretInput <span class="token keyword">from</span> <span class="token string">'./SecretInput'</span><span class="token punctuation">;</span><span class="token keyword">import</span> PeriodInput <span class="token keyword">from</span> <span class="token string">'./PeriodInput'</span><span class="token punctuation">;</span><span class="token keyword">import</span> GrantTypeInput <span class="token keyword">from</span> <span class="token string">'./GrantTypeInput'</span><span class="token punctuation">;</span><span class="token keyword">import</span> SmsSignInput <span class="token keyword">from</span> <span class="token string">'./SmsSignInput'</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token punctuation">{</span> Item<span class="token punctuation">:</span> FormItem <span class="token punctuation">}</span> <span class="token operator">=</span> Form<span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token punctuation">{</span> TabPane <span class="token punctuation">}</span> <span class="token operator">=</span> Tabs<span class="token punctuation">;</span>@Form<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">ClientForm</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    tabKey<span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  reset <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> form <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    form<span class="token punctuation">.</span><span class="token function">resetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> tabKey<span class="token punctuation">:</span> <span class="token string">'1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> visible<span class="token punctuation">,</span> submitting<span class="token punctuation">,</span> onSave<span class="token punctuation">,</span> onClose<span class="token punctuation">,</span> form <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> tabKey <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">const</span> formItemLayout <span class="token operator">=</span> <span class="token punctuation">{</span>      labelCol<span class="token punctuation">:</span> <span class="token punctuation">{</span> span<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>      wrapperCol<span class="token punctuation">:</span> <span class="token punctuation">{</span> span<span class="token punctuation">:</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> title <span class="token operator">=</span> data<span class="token punctuation">.</span>clientId <span class="token operator">?</span> <span class="token string">'æ›´æ–°åº”ç”¨'</span> <span class="token punctuation">:</span> <span class="token string">'æ·»åŠ åº”ç”¨'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>Modal        style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> top<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>        width<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">800</span><span class="token punctuation">}</span>        title<span class="token operator">=</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span>        visible<span class="token operator">=</span><span class="token punctuation">{</span>visible<span class="token punctuation">}</span>        confirmLoading<span class="token operator">=</span><span class="token punctuation">{</span>submitting<span class="token punctuation">}</span>        onCancel<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>        onOk<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          form<span class="token punctuation">.</span><span class="token function">validateFields</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> values<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span> <span class="token function">onSave</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> tabKey<span class="token punctuation">:</span> <span class="token string">'1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>      <span class="token operator">></span>        <span class="token operator">&lt;</span>Form<span class="token operator">></span>          <span class="token operator">&lt;</span>Tabs            tabPosition<span class="token operator">=</span><span class="token string">"left"</span>            activeKey<span class="token operator">=</span><span class="token punctuation">{</span>tabKey<span class="token punctuation">}</span>            onChange<span class="token operator">=</span><span class="token punctuation">{</span>activeKey <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> tabKey<span class="token punctuation">:</span> activeKey <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>          <span class="token operator">></span>            <span class="token operator">&lt;</span>TabPane tab<span class="token operator">=</span><span class="token string">"æˆæƒè®¾ç½®"</span> key<span class="token operator">=</span><span class="token string">"1"</span><span class="token operator">></span>              <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"åº”ç”¨ID"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'clientId'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>                    <span class="token punctuation">{</span>                      type<span class="token punctuation">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span>                      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                      message<span class="token punctuation">:</span> <span class="token string">'åº”ç”¨IDä¸èƒ½ä¸ºç©ºï¼'</span><span class="token punctuation">,</span>                    <span class="token punctuation">}</span><span class="token punctuation">,</span>                  <span class="token punctuation">]</span><span class="token punctuation">,</span>                  initialValue<span class="token punctuation">:</span> data<span class="token punctuation">.</span>clientId<span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Input disabled<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">!</span><span class="token operator">!</span>data<span class="token punctuation">.</span>clientId<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>              <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"åº”ç”¨åç§°"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'clientName'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>                    <span class="token punctuation">{</span>                      type<span class="token punctuation">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span>                      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                      message<span class="token punctuation">:</span> <span class="token string">'åº”ç”¨åç§°ä¸èƒ½ä¸ºç©ºï¼'</span><span class="token punctuation">,</span>                    <span class="token punctuation">}</span><span class="token punctuation">,</span>                  <span class="token punctuation">]</span><span class="token punctuation">,</span>                  initialValue<span class="token punctuation">:</span> data<span class="token punctuation">.</span>clientName<span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Input <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>              <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"èµ„æºIDs"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'resourceIds'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>                    <span class="token punctuation">{</span>                      type<span class="token punctuation">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span>                      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                      message<span class="token punctuation">:</span> <span class="token string">'èµ„æºIDsä¸èƒ½ä¸ºç©ºï¼'</span><span class="token punctuation">,</span>                    <span class="token punctuation">}</span><span class="token punctuation">,</span>                  <span class="token punctuation">]</span><span class="token punctuation">,</span>                  initialValue<span class="token punctuation">:</span> data<span class="token punctuation">.</span>resourceIds<span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Input <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>              <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"æˆæƒç±»å‹"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'authorizedGrantTypes'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>                    <span class="token punctuation">{</span>                      type<span class="token punctuation">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span>                      required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                      message<span class="token punctuation">:</span> <span class="token string">'è¯·é€‰æ‹©æˆæƒç±»å‹ï¼'</span><span class="token punctuation">,</span>                    <span class="token punctuation">}</span><span class="token punctuation">,</span>                  <span class="token punctuation">]</span><span class="token punctuation">,</span>                  initialValue<span class="token punctuation">:</span> data<span class="token punctuation">.</span>authorizedGrantTypes<span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>GrantTypeInput <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>              <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"Tokenæœ‰æ•ˆæœŸ"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'accessTokenValidity'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  initialValue<span class="token punctuation">:</span> _<span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>accessTokenValidity<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>PeriodInput <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>              <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"Refreshæœ‰æ•ˆæœŸ"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'refreshTokenValidity'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  initialValue<span class="token punctuation">:</span> _<span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>refreshTokenValidity<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>PeriodInput <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>              <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"ç§˜é’¥"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'clientSecret'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  initialValue<span class="token punctuation">:</span> _<span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>clientSecret<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>SecretInput <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>TabPane<span class="token operator">></span>            <span class="token operator">&lt;</span>TabPane tab<span class="token operator">=</span><span class="token string">"çŸ­ä¿¡è®¾ç½®"</span> key<span class="token operator">=</span><span class="token string">"2"</span><span class="token operator">></span>              <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"éªŒè¯ç é•¿åº¦"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'smsCodeLength'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  initialValue<span class="token punctuation">:</span> data<span class="token punctuation">.</span>smsCodeLength<span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>InputNumber min<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">300</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>              <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"éªŒè¯ç æœ‰æ•ˆæœŸ(åˆ†é’Ÿ)"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'smsCodeExpire'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  initialValue<span class="token punctuation">:</span> data<span class="token punctuation">.</span>smsCodeExpire<span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>InputNumber min<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">300</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>             <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"éªŒè¯ç ç­¾å"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'smsCodeSign'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  initialValue<span class="token punctuation">:</span> data<span class="token punctuation">.</span>smsCodeSign<span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>SmsSignInput <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>TabPane<span class="token operator">></span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Tabs<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>Form<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>Modal<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> ClientForm<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3ã€ClientUtil-js"><a href="#3ã€ClientUtil-js" class="headerlink" title="3ã€ClientUtil.js"></a>3ã€ClientUtil.js</h3><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span><span class="token keyword">import</span> moment <span class="token keyword">from</span> <span class="token string">'moment'</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">const</span> authTypes <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'æˆæƒç æ¨¡å¼'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'authorization_code'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'ç®€åŒ–æ¨¡å¼'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'implicit'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'å¯†ç æ¨¡å¼'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'password'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'å®¢æˆ·ç«¯æ¨¡å¼'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'client_credentials'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'åˆ·æ–°æ¨¡å¼'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'refresh_token'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getOAuthTypeNames</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>str<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> values <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> values<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>value <span class="token operator">=</span><span class="token operator">></span> _<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>authTypes<span class="token punctuation">,</span> t <span class="token operator">=</span><span class="token operator">></span> t<span class="token punctuation">.</span>value <span class="token operator">===</span> value<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getResources</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>str<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">humanizeTime</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">let</span> timeText <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>    timeText <span class="token operator">=</span> moment<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">'seconds'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">humanize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    timeText <span class="token operator">=</span> <span class="token string">'æœªè®¾ç½®'</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> timeText<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4ã€GrantTypeInputç»„ä»¶GrantTypeInput-js"><a href="#4ã€GrantTypeInputç»„ä»¶GrantTypeInput-js" class="headerlink" title="4ã€GrantTypeInputç»„ä»¶GrantTypeInput.js"></a>4ã€GrantTypeInputç»„ä»¶GrantTypeInput.js</h3><p><img src="/loading.gif" data-original="/images/fontend/antd-table-GrantTypeInput.png" alt="GrantTypeInput"></p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> PureComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> Select <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> authTypes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./ClientUtil'</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token punctuation">{</span> Option <span class="token punctuation">}</span> <span class="token operator">=</span> Select<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">GrantTypeInput</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    value<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> value <span class="token operator">=</span> props<span class="token punctuation">.</span>value <span class="token operator">?</span> props<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>value <span class="token operator">!==</span> nextProps<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>nextProps<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> value <span class="token operator">=</span> nextProps<span class="token punctuation">.</span>value <span class="token operator">?</span> nextProps<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  handleSelectChange <span class="token operator">=</span> value <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> onChange <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>onChange<span class="token punctuation">)</span> <span class="token function">onChange</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>Select        style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token string">'100%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>        mode<span class="token operator">=</span><span class="token string">"multiple"</span>        value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span>        onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSelectChange<span class="token punctuation">}</span>      <span class="token operator">></span>        <span class="token punctuation">{</span>authTypes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>          <span class="token operator">&lt;</span>Option key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>type<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token operator">></span>            <span class="token punctuation">{</span>type<span class="token punctuation">.</span>name<span class="token punctuation">}</span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">></span>        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>Select<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> GrantTypeInput<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5ã€tokenæœ‰æ•ˆæœŸè¾“å…¥ç»„ä»¶PeriodInput-js"><a href="#5ã€tokenæœ‰æ•ˆæœŸè¾“å…¥ç»„ä»¶PeriodInput-js" class="headerlink" title="5ã€tokenæœ‰æ•ˆæœŸè¾“å…¥ç»„ä»¶PeriodInput.js"></a>5ã€tokenæœ‰æ•ˆæœŸè¾“å…¥ç»„ä»¶PeriodInput.js</h3><p><img src="/loading.gif" data-original="/images/fontend/antd-table-PeriodInput.png" alt="PeriodInput.js"></p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> PureComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> moment <span class="token keyword">from</span> <span class="token string">'moment'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> Input<span class="token punctuation">,</span> Select <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token punctuation">{</span> Option <span class="token punctuation">}</span> <span class="token operator">=</span> Select<span class="token punctuation">;</span><span class="token keyword">const</span> getTime <span class="token operator">=</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> fromUnit<span class="token punctuation">,</span> toUnit<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> moment<span class="token punctuation">.</span><span class="token function">duration</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">,</span> fromUnit<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">as</span><span class="token punctuation">(</span>toUnit<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">const</span> timeUnits <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'ç§’'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'seconds'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'åˆ†é’Ÿ'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'minutes'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'å°æ—¶'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'hours'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'å¤©'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'days'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">PeriodInput</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    value<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>    unit<span class="token punctuation">:</span> <span class="token string">'seconds'</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        unit<span class="token punctuation">:</span> <span class="token string">'seconds'</span><span class="token punctuation">,</span>        value<span class="token punctuation">:</span> props<span class="token punctuation">.</span>value<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>value <span class="token operator">!==</span> nextProps<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>nextProps<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        unit<span class="token punctuation">:</span> <span class="token string">'seconds'</span><span class="token punctuation">,</span>        value<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        unit<span class="token punctuation">:</span> <span class="token string">'seconds'</span><span class="token punctuation">,</span>        value<span class="token punctuation">:</span> nextProps<span class="token punctuation">.</span>value<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  handleSelectChange <span class="token operator">=</span> unitValue <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> unit<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">const</span> newValue <span class="token operator">=</span> value <span class="token operator">?</span> <span class="token function">getTime</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> unit<span class="token punctuation">,</span> unitValue<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      unit<span class="token punctuation">:</span> unitValue<span class="token punctuation">,</span>      value<span class="token punctuation">:</span> newValue<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  onChangeValue <span class="token operator">=</span> e <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> unit <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> onChange <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">const</span> seconds <span class="token operator">=</span> <span class="token function">getTime</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> unit<span class="token punctuation">,</span> <span class="token string">'seconds'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>onChange<span class="token punctuation">)</span> <span class="token function">onChange</span><span class="token punctuation">(</span>seconds<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> unit<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>Input        value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span>        onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onChangeValue<span class="token punctuation">}</span>        addonAfter<span class="token operator">=</span><span class="token punctuation">{</span>          <span class="token operator">&lt;</span>Select style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">80</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>unit<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSelectChange<span class="token punctuation">}</span><span class="token operator">></span>            <span class="token punctuation">{</span>timeUnits<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>t <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>              <span class="token operator">&lt;</span>Option key<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">.</span>value<span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>t<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token punctuation">{</span>t<span class="token punctuation">.</span>name<span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">></span>            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Select<span class="token operator">></span>        <span class="token punctuation">}</span>      <span class="token operator">/</span><span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> PeriodInput<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6ã€ç§˜é’¥ç”Ÿæˆç»„ä»¶SecretInput-js"><a href="#6ã€ç§˜é’¥ç”Ÿæˆç»„ä»¶SecretInput-js" class="headerlink" title="6ã€ç§˜é’¥ç”Ÿæˆç»„ä»¶SecretInput.js"></a>6ã€ç§˜é’¥ç”Ÿæˆç»„ä»¶SecretInput.js</h3><p><img src="/loading.gif" data-original="/images/fontend/antd-table-SecretInput.png" alt="SecretInput"></p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> PureComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> Row<span class="token punctuation">,</span> Col<span class="token punctuation">,</span> Slider<span class="token punctuation">,</span> Input <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span><span class="token keyword">import</span> random <span class="token keyword">from</span> <span class="token string">'@/utils/random'</span><span class="token punctuation">;</span><span class="token keyword">const</span> minValue <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token keyword">const</span> maxValue <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span><span class="token keyword">const</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span>  visible<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  value<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>  length<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">SecretInput</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>defaultState <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token punctuation">:</span> props<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>value <span class="token operator">!==</span> nextProps<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>nextProps<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>defaultState <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token punctuation">:</span> nextProps<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  handleCreatePwd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> length <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> visible<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleChangeLength</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  handleChangeLength <span class="token operator">=</span> length <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> value <span class="token operator">=</span> random<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> length <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleChangeValue</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  handleChangeValue <span class="token operator">=</span> value <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> onChange <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>onChange<span class="token punctuation">)</span> <span class="token function">onChange</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> visible<span class="token punctuation">,</span> value<span class="token punctuation">,</span> length <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>Row gutter<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Col span<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token operator">></span>            <span class="token operator">&lt;</span>Input value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChangeValue<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Col<span class="token operator">></span>          <span class="token operator">&lt;</span>Col span<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token operator">></span>            <span class="token operator">&lt;</span>a onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleCreatePwd<span class="token punctuation">}</span><span class="token operator">></span>éšæœºç”Ÿæˆ<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Col<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>Row<span class="token operator">></span>        <span class="token punctuation">{</span>visible <span class="token operator">?</span> <span class="token punctuation">(</span>          <span class="token operator">&lt;</span>Row<span class="token operator">></span>            <span class="token operator">&lt;</span>Col span<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token operator">></span>              <span class="token operator">&lt;</span>Slider                min<span class="token operator">=</span><span class="token punctuation">{</span>minValue<span class="token punctuation">}</span>                max<span class="token operator">=</span><span class="token punctuation">{</span>maxValue<span class="token punctuation">}</span>                value<span class="token operator">=</span><span class="token punctuation">{</span>length<span class="token punctuation">}</span>                onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChangeLength<span class="token punctuation">}</span>              <span class="token operator">/</span><span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>Col<span class="token operator">></span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Row<span class="token operator">></span>        <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> SecretInput<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7ã€çŸ­ä¿¡ç­¾åï¼šè¾“å…¥å†…å®¹ä¸æ•°æ®åº“ä¿å­˜ä¸ä¸€è‡´ï¼Œå‰ç«¯æ­£åˆ™åŠ å‡æ‹¬å·"><a href="#7ã€çŸ­ä¿¡ç­¾åï¼šè¾“å…¥å†…å®¹ä¸æ•°æ®åº“ä¿å­˜ä¸ä¸€è‡´ï¼Œå‰ç«¯æ­£åˆ™åŠ å‡æ‹¬å·" class="headerlink" title="7ã€çŸ­ä¿¡ç­¾åï¼šè¾“å…¥å†…å®¹ä¸æ•°æ®åº“ä¿å­˜ä¸ä¸€è‡´ï¼Œå‰ç«¯æ­£åˆ™åŠ å‡æ‹¬å·"></a>7ã€çŸ­ä¿¡ç­¾åï¼šè¾“å…¥å†…å®¹ä¸æ•°æ®åº“ä¿å­˜ä¸ä¸€è‡´ï¼Œå‰ç«¯æ­£åˆ™åŠ å‡æ‹¬å·</h3><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> PureComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> Input <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span><span class="token keyword">const</span> removeBrackets <span class="token operator">=</span> value <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>value <span class="token operator">?</span> value<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[ã€ã€‘]/g</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> addBrackets <span class="token operator">=</span> value <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>value <span class="token operator">?</span> <span class="token template-string"><span class="token string">`ã€</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ã€‘`</span></span> <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">SmsSignInput</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    value<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setStateValue</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>value <span class="token operator">!==</span> nextProps<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>nextProps<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setStateValue</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setStateValue</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  setStateValue <span class="token operator">=</span> value <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token function">removeBrackets</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  handleChangeValue <span class="token operator">=</span> e <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> onChange <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>onChange<span class="token punctuation">)</span> <span class="token function">onChange</span><span class="token punctuation">(</span><span class="token function">addBrackets</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Input <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChangeValue<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> SmsSignInput<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> åå°ç®¡ç†ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Antd Pro </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Data Jpa ä½¿ç”¨å¤‡å¿˜</title>
      <link href="2019/03/24/spring-data-jpa-shi-yong-bei-wang/"/>
      <url>2019/03/24/spring-data-jpa-shi-yong-bei-wang/</url>
      
        <content type="html"><![CDATA[<p>å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´,springboot+SpringDataJpaç”¨äº†å¾ˆä¹…äº†,ç”¨åˆ°äº†åº”è¯¥è®°å½•ä¸€ä¸‹ã€‚<br><a href="https://www.jianshu.com/p/b0bfd76c6389">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>springboot+SpringDataJpaç”¨äº†å¾ˆä¹…äº†ï¼Œæœ‰äº›ä¸œè¥¿ä¸ç”¨æ—¶é—´é•¿äº†ä¹Ÿè¿˜æ˜¯ä¼šå¿˜ã€‚<br>å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œè¿™è¯æ˜¯æœ‰é“ç†çš„ï¼Œæ‰€ä»¥ç”¨åˆ°ä»€ä¹ˆå°±ç®€å•è®°å½•ä¸‹ï¼Œè¿˜æ˜¯æœ‰å¥½å¤„çš„ã€‚</p><h4 id="1ã€Qqueryä¸èƒ½ä½¿ç”¨limitå…³é”®å­—"><a href="#1ã€Qqueryä¸èƒ½ä½¿ç”¨limitå…³é”®å­—" class="headerlink" title="1ã€Qqueryä¸èƒ½ä½¿ç”¨limitå…³é”®å­—"></a>1ã€Qqueryä¸èƒ½ä½¿ç”¨limitå…³é”®å­—</h4><p>ç¬¬ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨nativeQuery</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM t_misaka m WHERE m.id>4 limit 0,2"</span><span class="token punctuation">,</span> nativeQuery<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>   Page<span class="token operator">&lt;</span>Misaka<span class="token operator">></span> <span class="token function">search</span><span class="token punctuation">(</span>Pageable pageable<span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç¬¬äºŒç§æ–¹å¼:ä½¿ç”¨Pageå®ç°</p><pre class="line-numbers language-java"><code class="language-java">Pageable pageable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageRequest</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Direction<span class="token punctuation">.</span>ASC<span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Page<span class="token operator">&lt;</span>Misaka<span class="token operator">></span> misakaPage <span class="token operator">=</span> misakaDao<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>pageable<span class="token punctuation">)</span><span class="token punctuation">;</span> List<span class="token operator">&lt;</span>Misaka<span class="token operator">></span> misakaList <span class="token operator">=</span> misakaPage<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æŸ¥è¯¢æ¥å£</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"SELECT m FROM Misaka m WHERE m.id>4"</span><span class="token punctuation">)</span>   Page<span class="token operator">&lt;</span>Misaka<span class="token operator">></span> <span class="token function">search</span><span class="token punctuation">(</span>Pageable pageable<span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼šå¦‚æœä½¿ç”¨springboot2.xï¼Œä¸Šé¢çš„<code>Pageable pageable = new PageRequest</code>éœ€è¦æ”¹æˆ<code>Pageable pageable = PageRequest.of();</code>ï¼Œé‡Œé¢å‚æ•°ä¸€æ ·ã€‚</p><h4 id="2ã€Jpa-Repositoryé‡Œç”¨-Queryçš„æŸ¥è¯¢ç»“æœé›†è‡ªå®šä¹‰æ¥å—å®ä½“"><a href="#2ã€Jpa-Repositoryé‡Œç”¨-Queryçš„æŸ¥è¯¢ç»“æœé›†è‡ªå®šä¹‰æ¥å—å®ä½“" class="headerlink" title="2ã€Jpa Repositoryé‡Œç”¨@Queryçš„æŸ¥è¯¢ç»“æœé›†è‡ªå®šä¹‰æ¥å—å®ä½“"></a>2ã€Jpa Repositoryé‡Œç”¨@Queryçš„æŸ¥è¯¢ç»“æœé›†è‡ªå®šä¹‰æ¥å—å®ä½“</h4><p>ç›´æ¥ä¸ŠæŸ¥è¯¢ä»£ç ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"SELECT d.smsDate AS smsDate , SUM(d.smsSendCount) AS smsSendCount , SUM(d.smsSendFailureCount) AS  smsSendFailureCount "</span> <span class="token operator">+</span>        <span class="token string">" FROM DashboardSms d"</span> <span class="token operator">+</span>        <span class="token string">" WHERE d.smsDate between :startDate AND :endDate "</span> <span class="token operator">+</span>        <span class="token string">" GROUP BY d.smsDate "</span> <span class="token operator">+</span>        <span class="token string">" ORDER BY d.smsDate ASC "</span><span class="token punctuation">)</span>List<span class="token operator">&lt;</span>SmsCountSum<span class="token operator">></span> <span class="token function">findAllBySmsDate</span><span class="token punctuation">(</span>Date startDate<span class="token punctuation">,</span> Date endDate<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">interface</span> <span class="token class-name">SmsCountSum</span> <span class="token punctuation">{</span>    Date <span class="token function">getSmsDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Integer <span class="token function">getSmsSendCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Integer <span class="token function">getSmsSendFailureCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨å¤„ï¼š</p><pre class="line-numbers language-java"><code class="language-java">List<span class="token operator">&lt;</span>SlaveDashboardSmsRepository<span class="token punctuation">.</span>SmsCountSum<span class="token operator">></span> list <span class="token operator">=</span> slaveDashboardSmsRepository<span class="token punctuation">.</span><span class="token function">findAllBySmsDate</span><span class="token punctuation">(</span>startDate<span class="token punctuation">,</span> entDate<span class="token punctuation">)</span><span class="token punctuation">;</span>List<span class="token operator">&lt;</span>DashboardXYVo<span class="token operator">></span> smsChartData <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span><span class="token operator">:</span>smsDataToVo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span> DashboardXYVo <span class="token function">smsDataToVo</span><span class="token punctuation">(</span>SlaveDashboardSmsRepository<span class="token punctuation">.</span>SmsCountSum sms<span class="token punctuation">)</span> <span class="token punctuation">{</span>    DashboardXYVo vo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DashboardXYVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    vo<span class="token punctuation">.</span><span class="token function">setX</span><span class="token punctuation">(</span>DateUtil<span class="token punctuation">.</span><span class="token function">date2str</span><span class="token punctuation">(</span>sms<span class="token punctuation">.</span><span class="token function">getSmsDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> DateUtil<span class="token punctuation">.</span>MONTH_DAY_FORMAT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    vo<span class="token punctuation">.</span><span class="token function">setY</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>sms<span class="token punctuation">.</span><span class="token function">getSmsSendCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> vo<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3ã€ä½¿ç”¨SpecificationæŸ¥è¯¢"><a href="#3ã€ä½¿ç”¨SpecificationæŸ¥è¯¢" class="headerlink" title="3ã€ä½¿ç”¨SpecificationæŸ¥è¯¢"></a>3ã€ä½¿ç”¨SpecificationæŸ¥è¯¢</h4><p>ä¸€ä¸ªå¸¸å†™çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">static</span> Specification<span class="token operator">&lt;</span>DashboardAppSmsLogin<span class="token operator">></span> <span class="token function">build</span><span class="token punctuation">(</span>Date startDate<span class="token punctuation">,</span> Date endDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>root<span class="token punctuation">,</span> criteriaQuery<span class="token punctuation">,</span> builder<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>            Predicate predicate <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">conjunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>startDate <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    Predicate graterStartTime <span class="token operator">=</span> null<span class="token punctuation">;</span>                    graterStartTime <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">greaterThanOrEqualTo</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"smsDate"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> DateUtil<span class="token punctuation">.</span><span class="token function">formateData</span><span class="token punctuation">(</span>startDate<span class="token punctuation">,</span> DateUtil<span class="token punctuation">.</span>DATE_FORMAT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    predicate <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>predicate<span class="token punctuation">,</span> graterStartTime<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>endDate <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    Predicate lessEndTime <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">lessThanOrEqualTo</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"smsDate"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> DateUtil<span class="token punctuation">.</span><span class="token function">formateData</span><span class="token punctuation">(</span>endDate<span class="token punctuation">,</span> DateUtil<span class="token punctuation">.</span>DATE_FORMAT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    predicate <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>predicate<span class="token punctuation">,</span> lessEndTime<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            criteriaQuery<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"appName"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> predicate<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨ï¼š</p><pre class="line-numbers language-java"><code class="language-java">    Date yesterday <span class="token operator">=</span> DateUtil<span class="token punctuation">.</span><span class="token function">pastDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Specification<span class="token operator">&lt;</span>DashboardAppSmsLogin<span class="token operator">></span> spec <span class="token operator">=</span> DashboardAppSmsSpecs<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>yesterday<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>DashboardAppSmsLogin<span class="token operator">></span> appSmsLogin <span class="token operator">=</span> slaveDashboardAppSmsLoginRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>spec<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å°è£…ä¸€å±‚æ¡ä»¶æŸ¥çš„ä¾‹å­ï¼š<br>åŒ…æ‹¬equalã€likeã€å¤§äºç­‰äºã€å°äºç­‰äºã€æ—¶é—´ç­‰æ¡ä»¶ã€‚</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**     * ç™»å½•æˆåŠŸæ„å»º     * @param query     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> Specification<span class="token operator">&lt;</span>UserLoginLog<span class="token operator">></span> <span class="token function">loginBuild</span><span class="token punctuation">(</span>UserLoginLogQuery query<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>root<span class="token punctuation">,</span> criteriaQuery<span class="token punctuation">,</span> builder<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">buildPredicate</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> builder<span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * ç™»å½•å¤±è´¥æ„å»º     * @param query     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> Specification<span class="token operator">&lt;</span>UserLoginFailureLog<span class="token operator">></span> <span class="token function">loginFailureBuild</span><span class="token punctuation">(</span>UserLoginLogQuery query<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>root<span class="token punctuation">,</span> criteriaQuery<span class="token punctuation">,</span> builder<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">buildPredicate</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> builder<span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> Predicate <span class="token function">buildPredicate</span><span class="token punctuation">(</span>Root root<span class="token punctuation">,</span> CriteriaBuilder builder<span class="token punctuation">,</span> UserLoginLogQuery query<span class="token punctuation">)</span><span class="token punctuation">{</span>        Predicate predicate <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">conjunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>StringUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getAppId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            Predicate equalMenuValue <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"appId"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> query<span class="token punctuation">.</span><span class="token function">getAppId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            predicate <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>predicate<span class="token punctuation">,</span> equalMenuValue<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>StringUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getMobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            String likeMobile <span class="token operator">=</span> <span class="token string">"%"</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">getMobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"%"</span><span class="token punctuation">;</span>            Predicate equalMenuValue <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"mobile"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> likeMobile<span class="token punctuation">)</span><span class="token punctuation">;</span>            predicate <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>predicate<span class="token punctuation">,</span> equalMenuValue<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getStartLoginTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            Predicate graterStartTime <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">greaterThanOrEqualTo</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"loginTime"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> query<span class="token punctuation">.</span><span class="token function">getStartLoginTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            predicate <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>predicate<span class="token punctuation">,</span> graterStartTime<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">getEndLoginTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            Predicate lessEndTime <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">lessThanOrEqualTo</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"loginTime"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> query<span class="token punctuation">.</span><span class="token function">getEndLoginTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            predicate <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>predicate<span class="token punctuation">,</span> lessEndTime<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> predicate<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨å°±ä¸€æ ·äº†ã€‚</p><h4 id="4ã€ç”¨-Modifyingè¿›è¡Œæ›´æ–°æ“ä½œ"><a href="#4ã€ç”¨-Modifyingè¿›è¡Œæ›´æ–°æ“ä½œ" class="headerlink" title="4ã€ç”¨@Modifyingè¿›è¡Œæ›´æ–°æ“ä½œ"></a>4ã€ç”¨@Modifyingè¿›è¡Œæ›´æ–°æ“ä½œ</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Modifying</span>    <span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"update YhTask t set t.deleteFlag = '1' where t.taskId = :taskId"</span><span class="token punctuation">)</span>    <span class="token keyword">int</span> <span class="token function">logicDeleteTask</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"taskId"</span><span class="token punctuation">)</span> String taskId<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="5ã€JPAçš„Queryé‡Œè¿›è¡Œæ¡ä»¶ä¸ºç©ºå®¹é”™ï¼Œæ—¶é—´æ ¼å¼åŒ–"><a href="#5ã€JPAçš„Queryé‡Œè¿›è¡Œæ¡ä»¶ä¸ºç©ºå®¹é”™ï¼Œæ—¶é—´æ ¼å¼åŒ–" class="headerlink" title="5ã€JPAçš„Queryé‡Œè¿›è¡Œæ¡ä»¶ä¸ºç©ºå®¹é”™ï¼Œæ—¶é—´æ ¼å¼åŒ–"></a>5ã€JPAçš„Queryé‡Œè¿›è¡Œæ¡ä»¶ä¸ºç©ºå®¹é”™ï¼Œæ—¶é—´æ ¼å¼åŒ–</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"select u from YhUser u "</span> <span class="token operator">+</span>            <span class="token string">"where u.deleteFlag = '0' and u.leaderFlag = '0' "</span> <span class="token operator">+</span>            <span class="token string">"and u.fullName like concat('%',:createUserName,'%') "</span> <span class="token operator">+</span>            <span class="token string">"and (:platformId is null or :platformId is not null and u.platformId = :platformId) "</span> <span class="token operator">+</span>            <span class="token string">"and (:areaId is null or :areaId is not null and u.areaId = :areaId) "</span> <span class="token operator">+</span>            <span class="token string">" and DATE_FORMAT(s.firstLoginTime,'%Y-%m-%d')>=str_to_date(:startTime,'%Y-%m-%d') "</span> <span class="token operator">+</span>            <span class="token string">" and DATE_FORMAT(s.firstLoginTime,'%Y-%m-%d')&lt;=str_to_date(:endTime,'%Y-%m-%d')"</span> <span class="token operator">+</span>            <span class="token string">"and u.haierUserId not in ("</span> <span class="token operator">+</span>            <span class="token string">"select t.createUserId from YhTask t where t.deleteFlag = '0' "</span> <span class="token operator">+</span>            <span class="token string">"and t.createTime between :startTime and :endTime)"</span><span class="token punctuation">)</span>    List<span class="token operator">&lt;</span>YhUser<span class="token operator">></span> <span class="token function">findUnsubmitedUserByTime</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"createUserName"</span><span class="token punctuation">)</span> String createUserName<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"platformId"</span><span class="token punctuation">)</span> String platformId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"areaId"</span><span class="token punctuation">)</span> String areaId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"startTime"</span><span class="token punctuation">)</span> Date startTime<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"endTime"</span><span class="token punctuation">)</span> Date endTime<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6ã€å¤šè¡¨çº§è”çš„æƒ…å†µï¼Œæ¡ä»¶æŸ¥è¯¢ç¤ºä¾‹"><a href="#6ã€å¤šè¡¨çº§è”çš„æƒ…å†µï¼Œæ¡ä»¶æŸ¥è¯¢ç¤ºä¾‹" class="headerlink" title="6ã€å¤šè¡¨çº§è”çš„æƒ…å†µï¼Œæ¡ä»¶æŸ¥è¯¢ç¤ºä¾‹"></a>6ã€å¤šè¡¨çº§è”çš„æƒ…å†µï¼Œæ¡ä»¶æŸ¥è¯¢ç¤ºä¾‹</h4><p>æ¯”å¦‚ï¼Œéƒ¨é—¨å®ä½“ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Entity</span><span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"t_user"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 3046056270962780761L<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * ç”¨æˆ·id     */</span>    <span class="token annotation punctuation">@Id</span>    <span class="token annotation punctuation">@GenericGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"idGenerator"</span><span class="token punctuation">,</span> strategy <span class="token operator">=</span> <span class="token string">"uuid"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>generator <span class="token operator">=</span> <span class="token string">"idGenerator"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> String userId<span class="token punctuation">;</span>    <span class="token annotation punctuation">@ManyToOne</span>    <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"dept_id"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@NotFound</span><span class="token punctuation">(</span>action <span class="token operator">=</span> NotFoundAction<span class="token punctuation">.</span>IGNORE<span class="token punctuation">)</span>    <span class="token keyword">private</span> Department department<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éƒ¨é—¨å®ä½“ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Entity</span><span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"t_department"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Department</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 5415593855586815943L<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Id</span>    <span class="token annotation punctuation">@GenericGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"idGenerator"</span><span class="token punctuation">,</span> strategy <span class="token operator">=</span> <span class="token string">"uuid"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>generator <span class="token operator">=</span> <span class="token string">"idGenerator"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"dept_id"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> String deptId<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * éƒ¨é—¨ä»¬ç§°     */</span>    <span class="token keyword">private</span> String deptName<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * éƒ¨é—¨ä»£ç      */</span>    <span class="token keyword">private</span> String deptCode<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * çˆ¶èŠ‚ç‚¹     */</span>    <span class="token keyword">private</span> String parentId<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ ¹æ®å¤šä¸ªéƒ¨é—¨idæŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨</p><pre class="line-numbers language-java"><code class="language-java">      List<span class="token operator">&lt;</span>String<span class="token operator">></span> allDeptIds <span class="token operator">=</span> <span class="token function">findDeptIds</span><span class="token punctuation">(</span>deptId<span class="token punctuation">)</span><span class="token punctuation">;</span>      Page<span class="token operator">&lt;</span>HaierUser<span class="token operator">></span> users <span class="token operator">=</span> haierUserRepository<span class="token punctuation">.</span><span class="token function">findByDepartment_DeptIdIn</span><span class="token punctuation">(</span>allDeptIds<span class="token punctuation">,</span> pageable<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>findByDepartment_DeptIdInæ–¹æ³•å‘¢ï¼Ÿ</p><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/**     * é€šè¿‡éƒ¨é—¨IDæŸ¥è¯¢ç”¨æˆ·     *     * @param deptIds     * @param pageable     * @return     */</span>    Page<span class="token operator">&lt;</span>HaierUser<span class="token operator">></span> <span class="token function">findByDepartment_DeptIdIn</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>String<span class="token operator">></span> deptIds<span class="token punctuation">,</span> Pageable pageable<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸­é—´ä¸€ä¸ªä¸‹åˆ’çº¿é“¾æ¥ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p><h3 id="7ã€åˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´è‡ªåŠ¨å¤„ç†"><a href="#7ã€åˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´è‡ªåŠ¨å¤„ç†" class="headerlink" title="7ã€åˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´è‡ªåŠ¨å¤„ç†"></a>7ã€åˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´è‡ªåŠ¨å¤„ç†</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>  <span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"t_login_log"</span><span class="token punctuation">)</span>  <span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginLog</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Id</span>    <span class="token annotation punctuation">@GenericGenerator</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"UUIDGENERATE"</span><span class="token punctuation">,</span>strategy<span class="token operator">=</span><span class="token string">"uuid2"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>generator<span class="token operator">=</span><span class="token string">"UUIDGENERATE"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>length<span class="token operator">=</span><span class="token number">36</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> String id<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name<span class="token operator">=</span>"create_time<span class="token punctuation">,</span> updatable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Temporal</span><span class="token punctuation">(</span>TemporalType<span class="token punctuation">.</span>TIMESTAMP<span class="token punctuation">)</span>    <span class="token annotation punctuation">@org</span><span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>CreationTimestamp     <span class="token keyword">private</span> Date createTime<span class="token punctuation">;</span>     <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"update_time"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Temporal</span><span class="token punctuation">(</span>TemporalType<span class="token punctuation">.</span>TIMESTAMP<span class="token punctuation">)</span>    <span class="token annotation punctuation">@org</span><span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>UpdateTimestamp  <span class="token keyword">private</span> Date updateTime<span class="token punctuation">;</span>   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="8ã€å®ä½“ä¸Šå¸¸ç”¨çš„ä¸€äº›æ³¨è§£"><a href="#8ã€å®ä½“ä¸Šå¸¸ç”¨çš„ä¸€äº›æ³¨è§£" class="headerlink" title="8ã€å®ä½“ä¸Šå¸¸ç”¨çš„ä¸€äº›æ³¨è§£"></a>8ã€å®ä½“ä¸Šå¸¸ç”¨çš„ä¸€äº›æ³¨è§£</h3><p>æ—¶é—´æ ¼å¼åŒ–</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> DateUtil<span class="token punctuation">.</span>TIME_FORMAT<span class="token punctuation">,</span> timezone <span class="token operator">=</span> <span class="token string">"GMT+8"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>updatable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> Date createTime<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åœ¨jsonç»“æ„ä¸­å¿½ç•¥</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**     * åˆ é™¤æ ‡å¿—ï¼Œ1ï¼šåˆ é™¤ï¼Œ0ï¼šæœªåˆ é™¤     */</span>    <span class="token annotation punctuation">@JsonIgnore</span>    <span class="token keyword">private</span> Boolean deleteFlag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ’å…¥/æ›´æ–°æ—¶è‡ªåŠ¨èµ‹å€¼</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@PrePersist</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">PrePersist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>createTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token annotation punctuation">@PreUpdate</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">PreUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>updateTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä»–å±æ€§ï¼š<br>@Temporal(TemporalType.DATE)<br>åœ¨é¡µé¢ç«¯å–å€¼ï¼š2016â€“09â€“28<br>@Temporal(TemporalType.TIME)<br>åœ¨é¡µé¢ç«¯å–å€¼ï¼š15:50:30<br>@Temporal(TemporalType.TIMESTAMP)<br>åœ¨é¡µé¢ç«¯å–å€¼ï¼š2016-09-28 15:52:32:000</p><h4 id="9ã€è‡ªå®šä¹‰Repositoryå®ç°æŸ¥è¯¢"><a href="#9ã€è‡ªå®šä¹‰Repositoryå®ç°æŸ¥è¯¢" class="headerlink" title="9ã€è‡ªå®šä¹‰Repositoryå®ç°æŸ¥è¯¢"></a>9ã€è‡ªå®šä¹‰Repositoryå®ç°æŸ¥è¯¢</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Repository<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>EntityManager<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>PersistenceContext<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>Query<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * æ¨é€ç±»å‹ç»Ÿè®¡ */</span><span class="token annotation punctuation">@Repository</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageStatisticRepository</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@PersistenceContext</span>    <span class="token keyword">private</span> EntityManager entityManager<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * ç»Ÿè®¡æ¯ä¸ªæ¨é€ç±»å‹çš„æ¨é€æ¶ˆæ¯æ•°é‡     * @param userId     * @param search     * @return     */</span>    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>Object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span>  <span class="token function">findMessageTypeCont</span><span class="token punctuation">(</span>String userId<span class="token punctuation">,</span> String search<span class="token punctuation">)</span><span class="token punctuation">{</span>        String sql <span class="token operator">=</span> <span class="token string">"SELECT t.id,t.title,t.icon,p.num FROM t_message_type AS t INNER JOIN  "</span> <span class="token operator">+</span>                     <span class="token string">"("</span> <span class="token operator">+</span>                        <span class="token string">"SELECT type,COUNT(*) AS num FROM t_message_push "</span> <span class="token operator">+</span>                        <span class="token string">"WHERE (title LIKE :search OR content LIKE :search) AND state &lt;> 3 AND receive_user_id=:userId "</span> <span class="token operator">+</span>                        <span class="token string">"GROUP BY type"</span> <span class="token operator">+</span>                     <span class="token string">") AS p "</span> <span class="token operator">+</span>                     <span class="token string">" on t.id = p.type WHERE t.delete_flag=0 ORDER BY t.order ASC"</span><span class="token punctuation">;</span>        Query query <span class="token operator">=</span> entityManager<span class="token punctuation">.</span><span class="token function">createNativeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>        query<span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span><span class="token string">"search"</span><span class="token punctuation">,</span> <span class="token string">'%'</span> <span class="token operator">+</span>search <span class="token operator">+</span> <span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        query<span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span><span class="token string">"userId"</span><span class="token punctuation">,</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> query<span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è·å–åˆ°çš„ç»“æœæ˜¯Listçš„Objectæ•°ç»„ï¼Œé‡Œé¢çš„å€¼éœ€è¦è§£æObjectè·å–ã€‚</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">static</span> MessageTypeVo <span class="token function">toMessageTypeVo</span><span class="token punctuation">(</span>Object<span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">)</span><span class="token punctuation">{</span>        MessageTypeVo messageType <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageTypeVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        messageType<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        messageType<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        messageType<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        messageType<span class="token punctuation">.</span><span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">)</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> messageType<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    List<span class="token operator">&lt;</span>Object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> rows <span class="token operator">=</span> messageStatisticRepository<span class="token punctuation">.</span><span class="token function">findMessageTypeCont</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span> keywords<span class="token punctuation">)</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>MessageTypeVo<span class="token operator">></span> messageTypes <span class="token operator">=</span> rows<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>MessageTypeVo<span class="token operator">:</span><span class="token operator">:</span>toMessageTypeVo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢çš„æŸ¥è¯¢å¦‚æœä¸è¿”å›Objectï¼Œä¹Ÿå¯ä»¥è®¾ç½®è¿”å›æˆmapï¼Œåªéœ€è¦åœ¨æŸ¥è¯¢å‰è®¾ç½®<code>ResultTransformer</code>å³å¯:</p><pre class="line-numbers language-java"><code class="language-java">query<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span>SQLQuery<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setResultTransformer</span><span class="token punctuation">(</span>Transformers<span class="token punctuation">.</span>ALIAS_TO_ENTITY_MAP<span class="token punctuation">)</span><span class="token punctuation">;</span>List<span class="token operator">&lt;</span>Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">>></span> resultLit <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="10ã€å¤šè¡¨çº§è”æŸ¥è¯¢è‡ªå®šä¹‰è¿”å›ç»“æœ"><a href="#10ã€å¤šè¡¨çº§è”æŸ¥è¯¢è‡ªå®šä¹‰è¿”å›ç»“æœ" class="headerlink" title="10ã€å¤šè¡¨çº§è”æŸ¥è¯¢è‡ªå®šä¹‰è¿”å›ç»“æœ"></a>10ã€å¤šè¡¨çº§è”æŸ¥è¯¢è‡ªå®šä¹‰è¿”å›ç»“æœ</h4><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªç»“æœé›†çš„æ¥å£ç±»ï¼Œ</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">HotelSummary</span> <span class="token punctuation">{</span>    City <span class="token function">getCity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Double <span class="token function">getAverageRating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">default</span> Integer <span class="token function">getAverageRatingRounded</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">getAverageRating</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> null <span class="token operator">?</span> null <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">getAverageRating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥è¯¢çš„æ–¹æ³•è¿”å›ç±»å‹è®¾ç½®ä¸ºæ–°åˆ›å»ºçš„æ¥å£</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"select h.city as city, h.name as name, avg(r.rating) as averageRating "</span>        <span class="token operator">-</span> <span class="token string">"from Hotel h left outer join h.reviews r where h.city = ?1 group by h"</span><span class="token punctuation">)</span>Page<span class="token operator">&lt;</span>HotelSummary<span class="token operator">></span> <span class="token function">findByCity</span><span class="token punctuation">(</span>City city<span class="token punctuation">,</span> Pageable pageable<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"select h.name as name, avg(r.rating) as averageRating "</span>        <span class="token operator">-</span> <span class="token string">"from Hotel h left outer join h.reviews r  group by h"</span><span class="token punctuation">)</span>Page<span class="token operator">&lt;</span>HotelSummary<span class="token operator">></span> <span class="token function">findByCity</span><span class="token punctuation">(</span>Pageable pageable<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨</p><pre class="line-numbers language-java"><code class="language-java">Page<span class="token operator">&lt;</span>HotelSummary<span class="token operator">></span> hotels <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>hotelRepository<span class="token punctuation">.</span><span class="token function">findByCity</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PageRequest</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> Direction<span class="token punctuation">.</span>ASC<span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span>HotelSummary summay<span class="token operator">:</span>hotels<span class="token punctuation">)</span> <span class="token punctuation">{</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Name"</span> <span class="token operator">+</span>summay<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ç¢°åˆ°çš„é”™è¯¯"><a href="#ç¢°åˆ°çš„é”™è¯¯" class="headerlink" title="ç¢°åˆ°çš„é”™è¯¯"></a>ç¢°åˆ°çš„é”™è¯¯</h1><h3 id="ç‰ˆæœ¬é—®é¢˜"><a href="#ç‰ˆæœ¬é—®é¢˜" class="headerlink" title="ç‰ˆæœ¬é—®é¢˜"></a>ç‰ˆæœ¬é—®é¢˜</h3><p>1ã€é—®é¢˜å’Œç°çŠ¶<br>é…ç½®ä¸€ä¸ªHibernateçš„OneToManyçš„æ˜ å°„ï¼Œæƒ³è¦è¾¾åˆ°çº§è”ä¿å­˜å’Œçº§è”æŸ¥è¯¢ï¼ŒæŸ¥ä¸»ä½“æ—¶å°†å¯¹åº”çš„manyçš„åˆ—è¡¨é¡µæŸ¥å‡ºæ¥ï¼Œä½†æ˜¯åœ¨å¦‚ä¸‹çš„é…ç½®åï¼Œ<br>ä¸»è¡¨ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Entity</span><span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"t_patient"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Patient</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Id</span>    <span class="token annotation punctuation">@GenericGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"idGenerator"</span><span class="token punctuation">,</span> strategy <span class="token operator">=</span> <span class="token string">"uuid"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>generator <span class="token operator">=</span> <span class="token string">"idGenerator"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"patient_id"</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> String patientId<span class="token punctuation">;</span>    <span class="token annotation punctuation">@OneToMany</span><span class="token punctuation">(</span>cascade <span class="token operator">=</span> CascadeType<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> fetch <span class="token operator">=</span> FetchType<span class="token punctuation">.</span>EAGER<span class="token punctuation">)</span>    <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"patient_id"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> List<span class="token operator">&lt;</span>PatientAllergicHistory<span class="token operator">></span> patientAllergicHistory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å­è¡¨ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Entity</span><span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"t_patient_allergic_history"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PatientAllergicHistory</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Id</span>    <span class="token annotation punctuation">@GenericGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"idGenerator"</span><span class="token punctuation">,</span> strategy <span class="token operator">=</span> <span class="token string">"uuid"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>generator <span class="token operator">=</span> <span class="token string">"idGenerator"</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> Long id<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/** æ‚£è€…id */</span>    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"patient_id"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> String patientId<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥è¯¢æ—¶æŠ›å‡ºå¼‚å¸¸</p><pre class="line-numbers language-shell"><code class="language-shell">org.springframework.http.converter.HttpMessageNotWritableException: Could not write JSON: failed to lazily initialize a collection of role: com.hczt.xhminiapp.db.entity.Patient.patientContacts, could not initialize proxy - no Session; nested exception is com.fasterxml.jackson.databind.JsonMappingException: failed to lazily initialize a collection of role: com.hczt.xhminiapp.db.entity.Patient.patientContacts, could not initialize proxy - no Session (through reference chain: com.hczt.xhminiapp.common.bean.RtnResult["data"]->com.hczt.xhminiapp.db.entity.Patient["patientContacts"])    at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:296)    at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:103)    at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:290)    at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.handleReturnValue(RequestResponseBodyMethodProcessor.java:180)    at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:82)    at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:119)    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800)    at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038)    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942)    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1005)    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:897)    at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)    at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:882)    at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)    at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)    at com.alibaba.druid.support.http.WebStatFilter.doFilter(WebStatFilter.java:123)    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200)    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)    at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:96)    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:200)    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)    at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)    at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)    at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:834)    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1415)    at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)    at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)    at java.lang.Thread.run(Thread.java:748)Caused by: com.fasterxml.jackson.databind.JsonMappingException: failed to lazily initialize a collection of role: com.hczt.xhminiapp.db.entity.Patient.patientContacts, could not initialize proxy - no Session (through reference chain: com.hczt.xhminiapp.common.bean.RtnResult["data"]->com.hczt.xhminiapp.db.entity.Patient["patientContacts"])    at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:394)    at com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:353)    at com.fasterxml.jackson.databind.ser.std.StdSerializer.wrapAndThrow(StdSerializer.java:316)    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:727)    at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:155)    at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:727)    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:719)    at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:155)    at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider._serialize(DefaultSerializerProvider.java:480)    at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider.serializeValue(DefaultSerializerProvider.java:319)    at com.fasterxml.jackson.databind.ObjectWriter$Prefetch.serialize(ObjectWriter.java:1396)    at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:913)    at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:287)    ... 47 common frames omittedCaused by: org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.hczt.xhminiapp.db.entity.Patient.patientContacts, could not initialize proxy - no Session    at org.hibernate.collection.internal.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:597)    at org.hibernate.collection.internal.AbstractPersistentCollection.withTemporarySessionIfNeeded(AbstractPersistentCollection.java:216)    at org.hibernate.collection.internal.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:160)    at org.hibernate.collection.internal.PersistentBag.size(PersistentBag.java:287)    at com.fasterxml.jackson.databind.ser.std.CollectionSerializer.serialize(CollectionSerializer.java:97)    at com.fasterxml.jackson.databind.ser.std.CollectionSerializer.serialize(CollectionSerializer.java:25)    at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:727)    at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSerializerBase.java:719)    ... 56 common frames omitted<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2ã€åŸå› å’Œè§£å†³<br>è¯¥å¼‚å¸¸åœ¨<a href="https://stackoverflow.com/questions/4334970/hibernate-cannot-simultaneously-fetch-multiple-bags">https://stackoverflow.com/questions/4334970/hibernate-cannot-simultaneously-fetch-multiple-bags</a>ä¸Šæ‰¾åˆ°äº†ç­”æ¡ˆï¼ˆstaticOverFlowè¿˜æ˜¯å¾ˆå¼ºå¤§çš„ï¼‰ã€‚</p><p>I think a newer version of hibernate (supporting JPA 2.0) should handle this. But otherwise you can work it around by annotating the collection fields with:  <code>@LazyCollection(LazyCollectionOption.FALSE)</code>,Remember to remove the fetchType attribute from the @*ToMany annotation.</p><pre class="line-numbers language-java"><code class="language-java"> <span class="token annotation punctuation">@OneToMany</span><span class="token punctuation">(</span>cascade <span class="token operator">=</span> CascadeType<span class="token punctuation">.</span>ALL<span class="token punctuation">)</span> <span class="token annotation punctuation">@LazyCollection</span><span class="token punctuation">(</span>LazyCollectionOption<span class="token punctuation">.</span>FALSE<span class="token punctuation">)</span> <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"patient_id"</span><span class="token punctuation">)</span> <span class="token keyword">private</span> List<span class="token operator">&lt;</span>PatientAllergicHistory<span class="token operator">></span> patientAllergicHistory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ­£å¸¸çš„æ§åˆ¶å°æ—¥å¿—åº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œä¸»æŸ¥è¯¢å®Œäº†ä»¥åï¼Œå¼€å¯å­æŸ¥è¯¢</p><pre class="line-numbers language-shell"><code class="language-shell">10:26:29.920 [http-nio-8085-exec-10] INFO  p6spy - 10:26:29|1|SELECT 1 FROM DUAL10:26:29.932 [http-nio-8085-exec-10] INFO  p6spy - 10:26:29|4|select patient0_.patient_id as patient_1_3_0_, patient0_.create_time as create_t2_3_0_, patient0_.deleted as deleted3_3_0_, patient0_.first_diagnose_date as first_di4_3_0_, patient0_.first_injection_date as first_in5_3_0_, patient0_.gender as gender6_3_0_, patient0_.height as height7_3_0_, patient0_.mobile as mobile8_3_0_, patient0_.name as name9_3_0_, patient0_.nick_name as nick_na10_3_0_, patient0_.openid as openid11_3_0_, patient0_.passive_smoking as passive15_3_0_, patient0_.self_smoking as self_sm12_3_0_, patient0_.unionid as unionid13_3_0_, patient0_.weight as weight14_3_0_, sysdict1_.id as id1_6_1_, sysdict1_.code as code2_6_1_, sysdict1_.create_time as create_t3_6_1_, sysdict1_.deleted as deleted4_6_1_, sysdict1_.group_code as group_co5_6_1_, sysdict1_.name as name6_6_1_, sysdict1_.parent_id as parent_i7_6_1_, sysdict1_.sort as sort8_6_1_, sysdict1_.type as type9_6_1_, sysdict1_.update_time as update_10_6_1_ from t_patient patient0_ left outer join t_sys_dict sysdict1_ on patient0_.passive_smoking=sysdict1_.id where patient0_.patient_id='111'10:26:29.940 [http-nio-8085-exec-10] INFO  p6spy - 10:26:29|2|select patientcon0_.patient_id as patient_6_5_0_, patientcon0_.id as id1_5_0_, patientcon0_.id as id1_5_1_, patientcon0_.address as address2_5_1_, patientcon0_.gender as gender3_5_1_, patientcon0_.mobile as mobile4_5_1_, patientcon0_.name as name5_5_1_, patientcon0_.patient_id as patient_6_5_1_, patientcon0_.relation as relation7_5_1_, sysdict1_.id as id1_6_2_, sysdict1_.code as code2_6_2_, sysdict1_.create_time as create_t3_6_2_, sysdict1_.deleted as deleted4_6_2_, sysdict1_.group_code as group_co5_6_2_, sysdict1_.name as name6_6_2_, sysdict1_.parent_id as parent_i7_6_2_, sysdict1_.sort as sort8_6_2_, sysdict1_.type as type9_6_2_, sysdict1_.update_time as update_10_6_2_ from t_patient_contacts patientcon0_ left outer join t_sys_dict sysdict1_ on patientcon0_.relation=sysdict1_.id where patientcon0_.patient_id='111'10:26:29.945 [http-nio-8085-exec-10] INFO  p6spy - 10:26:29|1|select patientall0_.patient_id as patient_5_4_0_, patientall0_.id as id1_4_0_, patientall0_.id as id1_4_1_, patientall0_.gmxby as gmxby2_4_1_, patientall0_.gmxpy as gmxpy3_4_1_, patientall0_.main as main4_4_1_, patientall0_.patient_id as patient_5_4_1_, patientall0_.swgm as swgm6_4_1_, patientall0_.ybgmz as ybgmz7_4_1_, patientall0_.zqgxc as zqgxc8_4_1_ from t_patient_allergic_history patientall0_ where patientall0_.patient_id='111'10:26:29.947 [http-nio-8085-exec-10] INFO  p6spy - 10:26:29|0|<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h3><p><a href="%5Bhttps://niocoder.com/categories/#Security%5D(https://niocoder.com/categories/#Security)">Securityæºç åˆ†æ</a></p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è½¬--BizChartsä½¿ç”¨é‡‡å‘æ•™ç¨‹</title>
      <link href="2019/03/19/zhuan-bizcharts-shi-yong-cai-keng-jiao-cheng/"/>
      <url>2019/03/19/zhuan-bizcharts-shi-yong-cai-keng-jiao-cheng/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘é¡¹ç›®çš„ç®¡ç†åå°éƒ½åœ¨ç”¨é˜¿é‡Œç²‘ç²‘å¼€æºçš„ç®¡ç†æ¡†æ¶<a href="https://pro.ant.design/index-cn">Ant Design Pro</a>ï¼Œè¯´çœŸè¯ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¥½ç”¨çš„ã€‚è¯¥æ¡†æ¶å†…éƒ¨ä¹Ÿå°è£…äº†ä¸€äº›å›¾æ ‡æ’ä»¶ï¼Œä½†æ˜¯åœ¨æœ€è¿‘çš„ä¸€ä¸ªé¡¹ç›®ä¸­å‘ç°ï¼Œè¿™äº›å›¾æ ‡å¯å®šåˆ¶æ€§è¿˜æ˜¯å·®äº†ç‚¹ï¼Œä¸èƒ½æ»¡è¶³å®¢æˆ·éœ€æ±‚ã€‚</p><p><a href="https://www.jianshu.com/p/9dc63b4d96dd">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æœ€è¿‘é¡¹ç›®çš„ç®¡ç†åå°éƒ½åœ¨ç”¨é˜¿é‡Œç²‘ç²‘å¼€æºçš„ç®¡ç†æ¡†æ¶<a href="https://pro.ant.design/index-cn">Ant Design Pro</a>ï¼Œè¯´çœŸè¯ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¥½ç”¨çš„ã€‚è¯¥æ¡†æ¶å†…éƒ¨ä¹Ÿå°è£…äº†ä¸€äº›å›¾æ ‡æ’ä»¶ï¼Œä½†æ˜¯åœ¨æœ€è¿‘çš„ä¸€ä¸ªé¡¹ç›®ä¸­å‘ç°ï¼Œè¿™äº›å›¾æ ‡å¯å®šåˆ¶æ€§è¿˜æ˜¯å·®äº†ç‚¹ï¼Œä¸èƒ½æ»¡è¶³å®¢æˆ·éœ€æ±‚ã€‚</p><p>å¥½åœ¨å®ƒçš„åé¢ä¹Ÿä»‹ç»äº†è‡ªå·±äº²ç”Ÿçš„BizChartå¯è§†åŒ–å›¾è¡¨ç»„ä»¶ï¼Œå› ä¸ºå®šåˆ¶æ€§æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯apiä¸­çš„ä»‹ç»åˆä¸æ˜¯æ¯ä¸ªéƒ½æœ‰ä¾‹å­ï¼Œæ›´æ²¡æœ‰ç»„åˆä½¿ç”¨çš„ä¾‹å­ï¼Œç»è¿‡åº¦å¨˜ä»‹ç»ï¼Œå‘ç°è¿™ç‰‡æ–‡ç« å¤‡å—æˆ‘é’çï¼Œæˆ‘æ€•ä½œè€…å“ªå¤©ä¸é«˜å…´æ”¾å¼ƒäº†ï¼Œæ‰€ä»¥è½¬å­˜äº†ä¸€ä»½ï¼Œé¡ºä¾¿æŠŠè‡ªå·±å®è·µåˆ°çš„è¡¥å……åˆ°åé¢ã€‚</p><h1 id="åŸæ–‡"><a href="#åŸæ–‡" class="headerlink" title="åŸæ–‡"></a>åŸæ–‡</h1><p>ä½œä¸ºä¸€ä¸ªå‰ç«¯æ‰“å­—å‘˜ï¼Œé™¤äº†ç»¿èŒ¶å©Šä¹‹å¤–ï¼Œæœ€è®¨åŒçš„å°±æ˜¯å›¾è¡¨ï¼šä¸€ä¸ªè®©æˆ‘ä¼¤å¿ƒï¼Œä¸€ä¸ªè®©æˆ‘éš¾è¿‡ï¼›æ¯”è¿™æ›´è®¨åŒçš„å°±æ˜¯æ–‡æ¡£å†™å¾—ä¸æ¸…ä¸æ¥šçš„å›¾è¡¨åº“ï¼ˆå¤§æ¦‚ç‡æ˜¯ä¹å¹´ä¹‰åŠ¡æ•™è‚²æœŸé—´æ²¡æœ‰å­¦å¥½è¯­æ–‡ï¼‰ï¼Œè®©æˆ‘åˆçˆ±åˆæ¨ï¼æ‰€ä»¥æœ¬ç¯‡åšæ–‡ä¼šæ¯”è¾ƒæ¯ç‡¥ï¼Œåªç®€å•æè¿°ä¸€ä¸‹ä½¿ç”¨BizChartsçš„è¿‡ç¨‹ï¼Œå½“ç„¶ï¼Œé‡è¦çš„æ˜¯æ€»ç»“é‡åˆ°çš„å‘ï¼ˆéµä»ä¸€ä¸ªå‘ä¸è¸©ä¸¤æ¬¡ï¼Œä¸€ä¸ªå¥³ç”Ÿä¸æ³¡ä¸¤æ¬¡åŸåˆ™ï¼‰ã€‚</p><p>By the wayï¼Œæåˆ°BizChartsï¼Œè®©æˆ‘ä»¬æ„Ÿè°¢ä¸€ä¸‹é˜¿é‡Œå·´å·´ï¼šå…¶å¼€æºäº†è¿™ä¸ªå¥½ç”¨çš„ï¼ˆè™½ç„¶å¶å°”ä¸é‚£ä¹ˆå¥½ç”¨ï¼Œè¿˜å¶å¾—æŒºç»å¸¸çš„ï¼‰çš„reactå›¾è¡¨åº“ä¾›å¤§å®¶ä½¿ç”¨ï¼Œå¯¹ä½¿ç”¨reactæŠ€æœ¯æ ˆçš„å‰ç«¯æ‰“å­—å‘˜æ¥è¯´ç®€ç›´å°±æ˜¯ç¦éŸ³ã€‚æœ¬æ–‡ä¸ä¼šæœ‰è¿‡å¤šçš„apiè§£é‡Šï¼Œå…·ä½“çš„æ¥å£å¯ä»¥çœ‹å®˜ç½‘æ–‡æ¡£é¬¼é—¨å…³ã€‚</p><h2 id="æ­£ç»ç¯‡å¹…"><a href="#æ­£ç»ç¯‡å¹…" class="headerlink" title="æ­£ç»ç¯‡å¹…"></a>æ­£ç»ç¯‡å¹…</h2><p>åˆšå¼€å§‹ï¼Œè§†è§‰è®¾è®¡å¸ˆå“„æˆ‘è¯´ï¼šâ€œæˆ‘çš„è¦æ±‚å¹¶ä¸é«˜ï¼Œå¾…æˆ‘ä»å‰ä¸€æ ·å¥½â€ï¼Œå•Šå‘¸ï¼Œè¯´é”™äº†ï¼Œâ€œæˆ‘çš„è¦æ±‚æ˜¯ï¼šåªè¦èƒ½æŠŠæ•°æ®ç”¨ç›´æ–¹å›¾å±•ç°å‡ºæ¥å°±å¥½äº†â€ï¼Œso easy</p><pre class="line-numbers language-js"><code class="language-js"><span class="token comment" spellcheck="true">// å¼•å…¥ç›¸å…³çš„ç»„ä»¶</span>    <span class="token keyword">import</span> <span class="token punctuation">{</span> Chart<span class="token punctuation">,</span> Axis<span class="token punctuation">,</span> Tooltip<span class="token punctuation">,</span> Geom <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'bizcharts'</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// éšä¾¿mockä¸€ä¸‹æ•°æ®</span>    <span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'we'</span><span class="token punctuation">,</span> <span class="token string">'are'</span><span class="token punctuation">,</span> <span class="token string">'the'</span><span class="token punctuation">,</span> <span class="token string">'black'</span><span class="token punctuation">,</span> <span class="token string">'gold'</span><span class="token punctuation">,</span> <span class="token string">'team'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> mockData <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                xAxis<span class="token punctuation">:</span> ticks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>                yAxis<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å›¾è¡¨ç»„ä»¶</span>    <span class="token operator">&lt;</span>Chart        width<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token number">600</span> <span class="token punctuation">}</span>        height<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token number">400</span> <span class="token punctuation">}</span>        data<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token function">mockData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>    <span class="token operator">></span>        <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* xè½´ï¼Œæ¨ªè½´ï¼Œä»¥dataæ•°æ®çš„xAxiså±æ€§å€¼ä¸ºæŸ±å­çš„å€¼ */</span><span class="token punctuation">}</span>        <span class="token operator">&lt;</span>Axis name<span class="token operator">=</span><span class="token string">"xAxis"</span> <span class="token operator">/</span><span class="token operator">></span>        <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* yè½´ï¼Œçºµè½´ï¼Œä»¥dataæ•°æ®çš„yAxiså±æ€§å€¼ä¸ºæŸ±å­çš„å€¼ */</span><span class="token punctuation">}</span>        <span class="token operator">&lt;</span>Axis name<span class="token operator">=</span><span class="token string">"yAxis"</span> <span class="token operator">/</span><span class="token operator">></span>        <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* é¼ æ ‡hoverç›´æ–¹å›¾æŸ±å­çš„æ—¶å€™ï¼Œtooltipæ˜¾ç¤ºçš„å€¼ */</span><span class="token punctuation">}</span>        <span class="token operator">&lt;</span>Tooltip <span class="token operator">/</span><span class="token operator">></span>        <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* å‡ ä½•æ ‡è®°å¯¹è±¡ï¼Œä¸»è¦ç”¨ä»¥æè¿°ä½ è¦ç”»çš„æ˜¯ä»€ä¹ˆå›¾å½¢ï¼ˆç›´æ–¹å›¾ã€æŠ˜çº¿å›¾ã€é¥¼çŠ¶å›¾ã€åŒºåŸŸå›¾ï¼‰ï¼šintervalæ˜¯ç›´æ–¹å›¾ */</span><span class="token punctuation">}</span>        <span class="token operator">&lt;</span>Geom            type<span class="token operator">=</span><span class="token string">"interval"</span>            position<span class="token operator">=</span><span class="token string">"xAxis*yAxis"</span>        <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>Chart<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€æ³¢æ“ä½œçŒ›å¦‚ç‹—ï¼Œè®©è§†è§‰è®¾è®¡å¸ˆçœ‹çœ‹æ•ˆæœï¼š</p><p><img src="/loading.gif" data-original="/images/fontend/echart-1.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>noteï¼šæ­¤ç›´æ–¹å›¾æ¯ä¸€æ ¹æŸ±å­éƒ½æ˜¯å•ç‚¹çš„ï¼Œä¹Ÿå°±æ˜¯å…¶åæ˜ äº†æŸä¸ªæ¨ªåæ ‡ç‚¹çš„æ•°æ®æƒ…å†µã€‚åŠ å…¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¿ç»­åŒºé—´æŸ±å­ï¼Œé‚£ä¹ˆä½œä¸ºxAxisçš„æ•°æ®å­—æ®µå€¼åº”è¯¥ä¸ºä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼Œè¡¨æ˜åŒºé—´çš„èµ·å§‹å€¼ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">const</span> mockData <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                xAxis<span class="token punctuation">:</span> <span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">0.01</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token number">0.01</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// å¦‚æœä¸åŠ å‡0.01ï¼Œé‚£ä¹ˆç¬¬ä¸€æ ¹æŸ±å­çš„ç»ˆç‚¹è·Ÿç¬¬äºŒæ ¹æŸ±å­çš„èµ·ç‚¹æ˜¯åŒä¸€ä¸ªï¼Œä¼šæ„Ÿè§‰ä¸¤ä¸ªæŸ±å­ç²˜åœ¨ä¸€èµ·</span>                yAxis<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/BizChart2.png" alt="BizChart2.jpg"></p><p>è§†è§‰è®¾è®¡å¸ˆï¼šâ€œemmmmmmï¼Œå›¾è¡¨é•¿å®½å®šæ­»äº†ä¼šä¸ä¼šæœ‰ç‚¹åƒµç¡¬å•Šï¼Œé«˜åº¦å¯ä»¥å†™æ­»ï¼Œå®½åº¦æ€»å¾—æ¥ä¸ªè‡ªé€‚åº”å§ï¼Ÿâ€</p><p>â€œæ¯›é—·å°â€</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Chart        height<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token number">400</span> <span class="token punctuation">}</span>        data<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token function">mockData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>        forceFit <span class="token comment" spellcheck="true">// æˆ‘å¦ˆè¯´äº†ï¼ˆguanfang wendang shuodeï¼‰ï¼ŒåŠ ä¸Šè¿™ä¸ªå±æ€§å°±å¯ä»¥ä½¿å›¾è¡¨å®½åº¦è‡ªé€‚åº”äº†ï¼Œéš”å£echartåŒå­¦è¦å­¦ä¹ ä¸€ä¸‹</span>    <span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Chart<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•ˆæœç§€ä¸€æ³¢</p><p><img src="/loading.gif" data-original="/images/fontend/echart3.gif" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>è§†è§‰ï¼ˆèœœæ±å¾®ç¬‘ï¼‰ï¼šâ€œçŒ¿å­ï¼Œä½ è¿™ç©æ„æœ‰bugå•Šâ€</p><p>â€œèƒ¡è¯´ï¼Œä½ è¿™å‚»*ä¸ä¼šç”¨å§â€</p><p>ï¼ˆç†ç›´æ°”å£®ï¼‰â€œå“¼å“¼ï¼Œæ”¾å¤§çª—å£å›¾è¡¨å®½åº¦ç¡®å®ä¼šè‡ªé€‚åº”ï¼Œä½†æ˜¯ç¼©å°å°±æŒ‚æ‰äº†ï¼ˆå¹¶ä¸è‡ªé€‚åº”ï¼‰ï¼Œahhhhhhâ€</p><p>ï¼ˆè°„åªšï¼‰â€œè®¨åŒï¼Œå†ç»™æˆ‘ä¸¤åˆ†é’Ÿ~~è®©æˆ‘æŠŠbugç»“æˆå†°ã€‚ã€‚ã€‚â€</p><p>note: å®éªŒè¡¨æ˜ï¼Œå¦‚æœChartç»„ä»¶çš„çˆ¶ç»„ä»¶Fatheré‡‡ç”¨flexå¸ƒå±€ï¼Œå³Fatherä½¿ç”¨flexè‡ªé€‚åº”å®½åº¦ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ä¸Šè¿°çš„é—®é¢˜ï¼›æ‰€ä»¥ï¼Œå¦‚æœæœ‰å¤šä¸ªå›¾è¡¨åŒè¡Œå¹¶åˆ—å¸ƒå±€ï¼Œè¯·ä¸è¦ä½¿ç”¨flexå¸ƒå±€ï¼Œç»™Fatherç»„ä»¶çš„å®½åº¦è®¾ç½®ä¸ºç™¾åˆ†æ¯”å§ï¼Œæ­¤æ—¶çš„forceFitå°±ä¼šèµ·ä½œç”¨äº†ã€‚åŒæ—¶ï¼ŒBizChartså¯¹é‡ç»˜è®¾ç½®äº†é˜²æŠ–ï¼Œåªæœ‰å½“åœæ­¢ç¼©æ”¾çš„æ—¶å€™æ‰ä¼šé‡ç»˜ã€‚</p><p><img src="/loading.gif" data-original="/images/fontend/echart4.gif" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>ï¼ˆå±Œåˆ°é£èµ·ï¼‰â€œoverï¼Œæ‹¿å»ç”¨å§â€</p><p>ï¼ˆä¸€è„¸é„™è§†ï¼‰â€œå“‡å–”~å¥½æ£’æ£’å‘€ï¼Œæ•¢ä¸æ•¢è®©æˆ‘è°ƒä¸€ç‚¹ç‚¹å°ç»†èŠ‚ï¼Œæˆ‘ä¿è¯å°±ä¸€ç‚¹ç‚¹ï¼â€</p><p>â€œCome on babyï¼â€</p><p>â€œ</p><ol><li> é¼ æ ‡hoveræŸ±å­çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆæŸ±å­åé¢æœ‰ä¸ªå¾ˆä¸‘çš„æ–¹æ¡†ï¼Œæ¢ä¸ªé¢œè‰²å§ï¼</li><li> é¼ æ ‡hoveræŸ±å­çš„æ—¶å€™ï¼Œå‡ºç°çš„tooltipæ ·å¼ä¸‘çˆ†äº†ï¼Œå¾…ä¼šæˆ‘ç»™ä½ è®¾è®¡ä¸€ä¸ªå§</li><li> é¼ æ ‡hoveræŸ±å­çš„æ—¶å€™ï¼ŒæŸ±å­çš„é¢œè‰²åº”è¯¥æœ‰æ‰€æ”¹å˜ï¼Œå¯¹ç”¨æˆ·æ¯”è¾ƒå‹å¥½ï¼ï¼ï¼</li><li> â€¦å“ï¼Œä½ åˆ«æ‹¿åˆ€å•Š~~~</li></ol><p>â€</p><p>æŠŠè§†è§‰æ€äº†ä¹‹åï¼Œéœ€æ±‚è¿˜æ˜¯è¦åšçš„ï¼Œå…ˆè§£å†³æ­»è€…çš„ç¬¬ä¸€ä¸ªé—æ„¿ã€‚</p><p>Tooltipç»„ä»¶æä¾›äº†ä¸€ä¸ªå±æ€§crosshairsï¼Œç”¨ä»¥è®¾ç½®tooltipçš„è¾…åŠ©çº¿å’Œè¾…åŠ©æ¡†ï¼›é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤å±æ€§ä¼šä¸ºâ€™lineâ€™ã€â€˜areaâ€™ã€â€˜pathâ€™ã€â€˜areaStackâ€™ç±»å‹çš„Geomç»„ä»¶å¼€å¯å‚ç›´è¾…åŠ©çº¿ã€ä¸ºâ€˜intervalâ€™ç±»å‹çš„Geomç»„ä»¶å±•ç¤ºçŸ©å½¢èƒŒæ™¯æ¡†ã€‚æ­»è€…è¯´çš„å¾ˆä¸‘çš„æ–¹æ¡†å°±æ˜¯è¿™ä¸ªï¼</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Tooltip crosshairs<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¥½çš„ï¼ŒæŠŠæ¡†å»æ‰äº†ï¼å’¦ï¼Œæˆ‘ä»¬ä¸æ˜¯è¯´è¦ä¿®æ”¹å®ƒçš„é¢œè‰²å—ï¼Ÿå¥½çš„ï¼Œæ”¹ä¸€ä¸‹</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Tooltip        crosshairs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>            type<span class="token punctuation">:</span> <span class="token string">"rect"</span> <span class="token comment" spellcheck="true">// å¯é€‰å€¼ï¼šrectã€xã€yã€crossï¼Œåˆ†åˆ«å¯¹åº”è¾…åŠ©ç‹‚ã€å¹³è¡Œxè½´è¾…åŠ©çº¿ã€å¹³è¡Œyè½´è¾…åŠ©çº¿ï¼Œåå­—è¾…åŠ©çº¿</span>            style<span class="token punctuation">:</span> <span class="token punctuation">{</span>                fill<span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¾…åŠ©æ¡†é¢œè‰²</span>                shadowColor<span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¾…åŠ©æ¡†å‘¨è¾¹é˜´å½±çš„é¢œè‰²</span>                shadowBlur<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¾…åŠ©æ¡†å‘¨è¾¹é˜´å½±çš„é€æ˜åº¦</span>                opacity<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token comment" spellcheck="true">// è¾…åŠ©æ¡†çš„é€æ˜åº¦</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>    <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart4.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>noteï¼šå‡å¦‚å¼€å¯çš„æ˜¯è¾…åŠ©çº¿ï¼Œå³typeä¸æ˜¯â€œrectâ€ï¼Œé‚£ä¹ˆä¸Šè¿°çš„æ ·å¼å®šä¹‰å°†ä¸èµ·ä½œç”¨ã€‚ç©¶å…¶åŸå› ï¼Œçœ‹äº†æ­¤ç»„ä»¶çš„æºç ä¹‹åæ‰å‘ç°ï¼Œæè¿°è¾…åŠ©çº¿æ ·å¼çš„å±æ€§ä¸æ˜¯styleå¯¹è±¡ï¼Œè€Œæ˜¯lineStyleå¯¹è±¡ï¼Œå®˜æ–¹æ–‡æ¡£å¹¶æœªè¯´æ˜è¿™ä¸€ç‚¹ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Tooltip        crosshairs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>            type<span class="token punctuation">:</span> <span class="token string">"y"</span>            lineStyle<span class="token punctuation">:</span> <span class="token punctuation">{</span>                stroke<span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¾…åŠ©çº¿é¢œè‰²</span>                lineWidth<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¾…åŠ©çº¿å®½åº¦ï¼Œå•ä½ä¸ºpx</span>                opacity<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token comment" spellcheck="true">// è¾…åŠ©çº¿é€æ˜åº¦</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>    <span class="token operator">/</span><span class="token operator">></span>å¤åˆ¶ä»£ç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart5.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>çœ‹èµ·æ¥è¿˜æ˜¯å¾ˆå®¹æ˜“å°±å®ç°äº†æ­»è€…çš„ç¬¬ä¸€ä¸ªé—æ„¿ï¼Œå°±è¿™æ ·æ€¼æ­»äº†è§†è§‰ï¼Œæ˜¯ä¸æ˜¯å¤ªæ®‹å¿äº†ç‚¹ï¼Ÿäº‹å·²è‡³æ­¤ï¼Œç»§ç»­å®ç°ä»–çš„é—æ„¿å§ã€‚</p><p>ç¬¬äºŒä¸ªé—æ„¿æ˜¯ç»™tooltipæ¢ä¸ªæ ·å¼ã€‚æ—¢ç„¶è¦ä¿®æ”¹tooltipçš„æ ·å¼ï¼Œå°±åº”è¯¥ç»§ç»­å¯¹Tooltipç»„ä»¶ä¸‹æ‰‹ã€‚é€šè¿‡é˜…è¯»æ–‡æ¡£ï¼Œå‘ç°å…¶è¿˜æœ‰ä¸€ä¸ªitemTplçš„å±æ€§ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥é€šè¿‡è¿™ä¸ªå±æ€§å®šä¹‰tooltipçš„æ¨¡æ¿</p><pre class="line-numbers language-js"><code class="language-js"><span class="token comment" spellcheck="true">// å®šä¹‰ä¸€ä¸ªæ¨¡æ¿</span>    <span class="token comment" spellcheck="true">// name-valueæ˜¯ç›¸å…³æŸ±å­çš„key-valueå€¼</span>    <span class="token keyword">const</span> tooltipsDisplayTpl <span class="token operator">=</span> <span class="token template-string"><span class="token string">`        &lt;p class="chart-tooptip">            &lt;span class="chart-tooptip-right">{name}&lt;/span>            &lt;span>{value}&lt;/span>        &lt;/p>    `</span></span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*        // é‡å†™tooltipå…ƒç´ çš„æ ·å¼        // å› ä¸ºè§†è§‰å·²æ­»ï¼Œæ ·å¼æ˜¯éšä¾¿æçš„ï¼Œå°±å¼„ç‚¹é»‘è‰²èƒŒæ™¯å½“é»˜å“€ä¸€ä¸‹å§        .g2-tooltip {            background-color: rgba(44, 49, 68, 0.80) !important;        }        .chart-tooptip {            margin: 0;            color: white;        }        .chart-tooptip-right {            margin-right: 12px;        }    */</span>    <span class="token operator">&lt;</span>Tooltip        crosshairs<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>        itemTpl<span class="token operator">=</span><span class="token punctuation">{</span> tooltipsDisplayTpl <span class="token punctuation">}</span>        showTitle<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// å»å¤´ï¼ˆæ ‡é¢˜ï¼Œå³æ¨ªè½´å¯¹åº”çš„åˆ»åº¦ï¼‰ï¼Œå¾€å¾€å½±å“æˆ‘é¢œå€¼çš„ä¸æ˜¯æˆ‘çš„èº«æï¼Œè€Œæ˜¯æˆ‘çš„è„¸ï¼Œæ‰€ä»¥ä¸è¦è„¸äº†</span>    <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart6.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>noteï¼šå¦‚æœæƒ³è‡ªå®šä¹‰tooltipå±•ç¤ºçš„å†…å®¹ï¼Œè¿˜éœ€è¦è®¾ç½®Geomç»„ä»¶çš„tooltipå±æ€§ï¼Œå³å°†æ•°æ®æ˜ å°„åˆ°Tooltipå¯¹è±¡ä¸Šï¼›æ‰€ä»¥æ­¤å±æ€§å€¼å¦‚æœä¸ºfalseçš„è¯ï¼Œå°±ä¸ä¼šå‘Tooltipç»„ä»¶ä¼ é€’ä»»ä½•æ•°æ®ï¼ˆæ­¤æ—¶Tooltipåªä¼šæ˜¾ç¤ºtitleï¼‰ï¼›è¿˜å¯è®¾ç½®ä¸ºå­—ç¬¦ä¸²ï¼Œå±•ç¤ºå­—ç¬¦ä¸²å¯¹åº”çš„æ•°æ®å­—æ®µï¼›But, itâ€™s not the pointï¼Œé‡ç‚¹åœ¨äºå¯è‡ªå®šä¹‰</p><pre class="line-numbers language-js"><code class="language-js"><span class="token comment" spellcheck="true">// å®šä¹‰æ•°æ®è¿”å›çš„æ ¼å¼ï¼Œnameå±æ€§å¯¹åº”çš„æ˜¯itemTplé‡Œé¢çš„åŒåå˜é‡</span>    <span class="token keyword">const</span> getTooltipData <span class="token operator">=</span> <span class="token punctuation">(</span>xAxis<span class="token punctuation">,</span> yAxis<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            name<span class="token punctuation">:</span> xAxis<span class="token punctuation">,</span>            value<span class="token punctuation">:</span> yAxis        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token operator">&lt;</span>Geom        type<span class="token operator">=</span><span class="token string">"interval"</span>        position<span class="token operator">=</span><span class="token string">"xAxis*yAxis"</span>        tooltip<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">"xAxis*yAxis"</span><span class="token punctuation">,</span> getTooltipData<span class="token punctuation">]</span><span class="token punctuation">}</span>    <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart7.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>ç¬¬äºŒä¸ªé—æ„¿ä¹Ÿå®ç°äº†ï¼Œæ„§ç–šæ„Ÿä¹Ÿå¤šäº†ä¸€ç‚¹ï¼æœ€ä¸»è¦æ˜¯å†™ä»£ç çš„æ—¶å€™è€æ˜¯è§‰å¾—åé¢æœ‰äººç«™ç€ç›¯ç€æˆ‘çœ‹ã€‚</p><p>è¯´ä¸å®šå®ç°æ‰€æœ‰é—æ„¿å°±ä¸ä¼šæœ‰è¿™ç§æ„Ÿè§‰äº†å‘¢ï¼Œé‚£å°±ç»§ç»­ç¬¬ä¸‰ä¸ªé—æ„¿å§ï¼šâ€œæ”¹å˜é¼ æ ‡hoveræŸ±å­æ—¶å€™æŸ±å­çš„é¢œè‰²â€ï¼Œç¿»éäº†æ•´ä¸ªæ–‡æ¡£ï¼Œå‘ç°æ²¡æœ‰å…³äºhoverçš„æ¥å£å•Šï¼çœ‹æ¥è§†è§‰æ˜¯è¦æ­»ä¸ç‘ç›®äº†ï¼Œé˜¿é—¨ã€‚</p><p>å°±åœ¨æˆ‘æ„Ÿè§‰åˆ°åèƒŒè¶Šå‘çš„å‡‰é£•é£•çš„æ—¶å€™ï¼Œæˆ‘å‘ç°Geomç»„ä»¶æœ‰ä¸€ä¸ªå±æ€§active</p><p><img src="/loading.gif" data-original="/images/fontend/echart8.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>æ–‡æ¡£å°±çœŸçš„æè¿°äº†é‚£ä¹ˆä¸¤å¥è¯ï¼Œä¹Ÿæ²¡ä¾‹å­ã€‚æ€¥ç—…ä¹±æŠ•åŒ»çš„æˆ‘åªèƒ½å°è¯•ä¸€æ³¢ï¼Œè®¾ç½®ä¸ºtrueï¼Œå¾—äº†ï¼ŒhoveræŸ±å­çš„æ—¶å€™æŸ±å­é¢œè‰²æ”¹å˜äº†ï¼ï¼ï¼</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Geom        type<span class="token operator">=</span><span class="token string">"interval"</span>        position<span class="token operator">=</span><span class="token string">"xAxis*yAxis"</span>        tooltip<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">"xAxis*yAxis"</span><span class="token punctuation">,</span> getTooltipData<span class="token punctuation">]</span><span class="token punctuation">}</span>        active<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>    <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart8.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>é‚£å¦‚æœéœ€è¦è‡ªå®šä¹‰é¼ æ ‡hoveræŸ±å­çš„æ ·å¼å‘¢ï¼Ÿå¯¹ç…§ç€Geomæ–‡æ¡£çš„selectå±æ€§ï¼Œåˆå°è¯•äº†ä¸€é</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Geom        type<span class="token operator">=</span><span class="token string">"interval"</span>        position<span class="token operator">=</span><span class="token string">"xAxis*yAxis"</span>        tooltip<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">"xAxis*yAxis"</span><span class="token punctuation">,</span> getTooltipData<span class="token punctuation">]</span><span class="token punctuation">}</span>        style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> cursor<span class="token punctuation">:</span> <span class="token string">'pointer'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//  é¼ æ ‡hoverä¸Šå»çš„æ—¶å€™ï¼Œæ˜¾ç¤ºå°æ‰‹æ‰‹ï¼Œå…è´¹é€çš„</span>        active<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>            <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token punctuation">{</span>                style<span class="token punctuation">:</span> <span class="token punctuation">{</span>                    fill<span class="token punctuation">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// æŸ±å­é¢œè‰²ï¼Œç»§ç»­é»˜å“€</span>                    shadowColor<span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// æ•´ä½“é˜´å½±é¢œè‰²ï¼ŒåŒ…æ‹¬è¾¹ç¼˜</span>                    shadowBlur<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// é˜´å½±çš„é€æ˜åº¦</span>                    opacity<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token comment" spellcheck="true">// æŸ±å­é¢œè‰²é€æ˜åº¦</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">]</span><span class="token punctuation">}</span>    <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart9.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>ï¼ˆç¥æ°”çš„ï¼‰â€œç‹—å­ï¼Œåˆ«æ­»äº†ï¼Œè€å­æå®šå•¦â€</p><p>â€œé ï¼Œæˆ‘éƒ½è£…æ­»ä¸¤å¤©äº†ï¼Œä½ æ•¢ä¸æ•¢å†æ…¢ä¸€ç‚¹â€</p><p>â€œé‚£å®˜æ–¹æ–‡æ¡£å°±å†™äº†ä¸€è¡Œå­—ï¼šåªå¯æ„ä¼šä¸å¯è¨€ä¼ ï¼æˆ‘å¤©åˆ†æœ‰é™ï¼Œæ„ä¼šäº†æ¯”è¾ƒä¹…â€</p><p>â€œå˜šç‘Ÿï¼Œçœ‹ï¼Œåˆå‡ºbugäº†å§ï¼ä½ çš„è¡¨å­ä¸€é—ªä¸€é—ªçš„â€</p><p>ï¼ˆæç€ä»–è„–å­ä½¿åŠ²æ™ƒï¼‰â€œé‚£TMä¸æ˜¯bugï¼ï¼ï¼â€</p><p><img src="/loading.gif" data-original="/images/fontend/echart10.gif" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>ä¸è¿‡è¯è¯´å›æ¥ï¼Œå½“æ•°æ®æ›´æ–°æ—¶ï¼Œä»æ—§æ•°æ®åˆ‡æ¢åˆ°æ–°æ•°æ®ï¼Œä¼šå¾ˆçªå…€ï¼Œæ²¡æœ‰ç¼“å†²è¿‡ç¨‹ï¼Œçœ‹ç€ç‰¹åˆ«ä¸èˆ’æœã€‚æˆ‘å¯»æ€ç€ï¼Œåœ¨æ•°æ®æ›´æ–°çš„æ—¶å€™ï¼ŒåŠ ä¸ªåŠ¨ç”»å‘—ï¼ä½†æ˜¯åˆå§‹åŠ¨ç”»ç”Ÿæ•ˆäº†ï¼Œæ›´æ–°åŠ¨ç”»å°±ä¸ç”Ÿæ•ˆäº†ï¼ˆå¦‚çœ‹å®˜ä»¬çŸ¥é“è§£å†³åŠæ³•ï¼Œè¯·ä¸åèµæ•™ï¼‰ã€‚ç”±äºèµ¶ç€ä¸‹ç­ï¼Œæˆ‘å†³å®šä½¿ç”¨DataSetï¼šä¸€ä¸ªç”¨äºç®¡ç†è¡¨æ ¼æ•°æ®çš„ç¥å™¨ï¼Œæ®è¯´æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œå…¶ä¼šç»™æˆ‘å¼„ä¸ªåŠ¨ç”»ï¼ˆé™¤æ­¤ä»¥å¤–æœ‰æ–¹ä¾¿åœ°å¯¼å…¥é&nbsp;<a href="http://www.codercto.com/category/json.html">json</a>&nbsp;æ•°æ®ç­‰ç­‰åŠŸèƒ½ï¼Œä¸‹æ–‡æœ‰ä¸€äº›ä¾‹å­ï¼Œå…·ä½“ç»†èŠ‚æˆ‘æ²¡æœ‰è¯¦ç»†å»ç ”ç©¶ï¼Œä»¥åå­¦ä¹ äº†å†åˆ†äº«ï¼‰ã€‚å””å¥½ç†ï¼Œæ€»ä¹‹å¥½çŠ€åˆ©ï¼</p><pre class="line-numbers language-shell"><code class="language-shell">// å®‰è£…    // npm install @antv/data-set    // å¼•å…¥    import DataSet from '@antv/data-set';    // ç”Ÿæˆä¸€ä¸ªViewå®ä¾‹ï¼Œä½œä¸ºç±»çš„å±æ€§ï¼Œæ•…ä¸è¦åœ¨renderæ–¹æ³•é‡Œé¢ç”Ÿæˆè¿™ä¸ªå®ä¾‹    dv = new DataSet().createView();    render() {        this.dv.source(data);        <Chart            height={ 400 }            data={ this.dv }            forceFit        ></Chart>    }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart11.gif" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>â€œçŒ¿å­ï¼Œ6å•Šï¼åƒå®µå¤œå—ï¼Ÿæˆ‘çš„â€</p><p>â€œè™½ç„¶ä¸æ€ä¹ˆé¥¿ï¼Œä½†æ˜¯ä½ è¯·å°±ä¸ä¸€æ ·äº†ï¼Œgoâ€</p><p>åƒäº†ä¸€æ¡¶æ³¡é¢åâ€¦â€¦</p><p>â€œçŒ¿å­ï¼Œä½ çœ‹ï¼Œå®µå¤œä¹Ÿåƒäº†Â·Â·Â·Â·Â·Â·Â·â€</p><p>â€œä½ åˆæƒ³å¹²å˜›Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·â€</p><p>ç®€ç›´å°±æ˜¯é¥±é¥­æ€æ·«æ¬²å•Šï¼ï¼ï¼</p><p>â€æˆ‘åªæ˜¯è§‰å¾—æŸ±å­çš„é¢œè‰²å¯ä»¥æ¸å˜ä¼šæ˜¾å¾—æˆ‘ä»¬å…¬å¸çš„äº§å“æ›´å±Œä¸€ç‚¹â€œ</p><p>â€ç‹—å­ï¼Œä½ æ‰›æä¸ï¼Ÿâ€œ</p><p>ï¼ˆå¯æ€œå…®å…®ï¼‰â€æå®Œä¹‹åå¯ä»¥åŠ ä¸ªæ¸å˜å—â€¦â€¦â€œ</p><p>â€â€¦â€¦â€œ</p><p>â€æˆ‘å°±çŸ¥é“ä½ å¯¹æˆ‘æœ€å¥½äº†ï¼Œæˆ‘ç»™ä½ æ¶èƒŒæå¤§è…¿å§~â€œ</p><p>â€æ»šä¸€è¾¹å»â€œ</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Geom        type<span class="token operator">=</span><span class="token string">"interval"</span>        position<span class="token operator">=</span><span class="token string">"xAxis*yAxis"</span>        tooltip<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">"xAxis*yAxis"</span><span class="token punctuation">,</span> getTooltipData<span class="token punctuation">]</span><span class="token punctuation">}</span>        color<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">'xAxis'</span><span class="token punctuation">,</span> <span class="token string">'#3DA4FF-#FFFFFF'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>    <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart12.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>ï¼ˆæç€æˆ‘è„–å­ä½¿åŠ²æ™ƒï¼‰â€è€å­è¦çš„æ˜¯ä»ä¸Šå¾€ä¸‹æ¸å˜ï¼Œä¸æ˜¯ä»å·¦å¾€å³æ¸å˜â€œ</p><p>â€œåˆ«â€¦..åˆ«â€¦..æâ€¦..æˆ‘â€¦.æ”¹â€¦.æ”¹â€¦..â€</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Geom        type<span class="token operator">=</span><span class="token string">"interval"</span>        position<span class="token operator">=</span><span class="token string">"xAxis*yAxis"</span>        tooltip<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">"xAxis*yAxis"</span><span class="token punctuation">,</span> getTooltipData<span class="token punctuation">]</span><span class="token punctuation">}</span>        color<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">'xAxis'</span><span class="token punctuation">,</span> <span class="token string">'l(90) 0:#3DA4FF 1:#FFFFFF'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>    <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart13.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>noteï¼šlæ˜¯æŒ‡çº¿æ€§æ¸å˜ï¼Œ90æ˜¯æŒ‡æ—‹è½¬ä¹ååº¦ï¼ˆå³ä»ä¸Šåˆ°ä¸‹æ¸å˜ï¼Œçœ‹å®˜ä»¬å¯ä»¥å¤šè¯•è¯•å‡ ä¸ªå§¿åŠ¿ï¼Œå•Šå‘¸ï¼Œå¤šè¯•è¯•å‡ ä¸ªè§’åº¦ï¼‰</p><p>0å’Œ1æ ‡å®šçš„è‰²å€¼æ ‡æ˜åˆå§‹è‰²å€¼å’Œç»ˆæ­¢è‰²å€¼ï¼Œæ³¨æ„ä¸€ç‚¹ï¼Œè‰²å€¼ä¸å¯ä»¥ä½¿ç”¨é¢œè‰²åå­—ï¼Œå¦‚â€œredâ€ã€â€œblueâ€ç­‰</p><p>å¯æ·»åŠ å¤šä¸ªæ¸å˜è‰²å€¼ï¼Œå¦‚</p><pre class="line-numbers language-js"><code class="language-js">color<span class="token operator">=</span><span class="token string">"l(90) 0:#000000 0.5:#FFFFFF 1:#000000"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>noteï¼šå¦‚æœæ˜¯areaç±»å‹çš„Geomï¼Œé‚£ä¹ˆç¬¬ä¸€ç§æ¸å˜æ–¹å¼æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œåªèƒ½é€‰ç”¨ç¬¬äºŒç§</p><p>â€œç‹—å­ï¼Œæˆ‘çœŸè¦ä¸‹ç­äº†â€</p><p>â€œé‚£ä¸ªï¼Œä½ çœ‹éƒ½æç€æ¸å˜äº†ï¼Œè¦ä¸æä¸€æ³¢é¢œè‰²åˆ†ç±»â€</p><p>â€æ²¡å¾—è°ˆï¼Œgoodbyeï¼â€œ</p><p>â€å®µå¤œæˆ‘çš„â€œ</p><p>â€é¡¶ä½ ä¸ªè‚ºï¼Œåˆæƒ³ç”¨æ³¡é¢å¿½æ‚ æˆ‘ï¼ï¼ï¼â€œ</p><p>â€æ’¸ä¸²ï¼Œéª—ä½ æˆ‘æ˜¯ç‹—â€œ</p><p>â€emmmmmmâ€¦..â€œ</p><p>æ—¢ç„¶æåˆ°é¢œè‰²åˆ†ç±»ï¼Œæˆ‘ä»¬å°±æ¥ç€æä¸€ä¸‹dv.transform å§, dv.transformå†…ç½®äº†ä¸€äº›åŸºç¡€çš„å‡½æ•°ï¼šfilterï¼Œmapï¼Œpickï¼Œrenameï¼Œreverse â€¦â€¦ å…·ä½“å¯è‡ªè¡ŒæŸ¥çœ‹æ–‡æ¡£</p><p>åªéœ€è¦æ·»åŠ  groupBy å­—æ®µï¼Œå¹¶ä¸”åœ¨ä¼ å…¥çš„åŸå§‹æ•°æ®dataä¸­æ·»åŠ å¯¹åº”çš„å­—æ®µclassifyå³å¯è½»æ¾æå®šã€‚</p><pre class="line-numbers language-js"><code class="language-js">dv<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        groupBy<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'classify'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// ä»¥classifyå­—æ®µè¿›è¡Œåˆ†ç»„ </span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>â€çŒ¿å­ï¼Œé¢œè‰²è¿˜æ˜¯è¦è‡ªå®šä¹‰çš„å“¦â€œ</p><p>ï¼ˆç™½çœ¼ï¼‰</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Geom        position<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'xAxis*yAxis'</span><span class="token punctuation">}</span>        color<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">'classify'</span><span class="token punctuation">,</span> classify <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// è¿™é‡Œæ ¹æ®ä¸åŒå­—æ®µè¿”å›ä¸åŒé¢œè‰²</span>            <span class="token keyword">return</span> classify <span class="token operator">===</span> <span class="token string">'test'</span> <span class="token operator">?</span> <span class="token string">'red'</span> <span class="token punctuation">:</span> <span class="token string">'yellow'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>        style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> cursor<span class="token punctuation">:</span> <span class="token string">'pointer'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>    <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart14.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>ä½œä¸ºä¸€ä¸ªæœ‰è´£ä»»çš„å‰ç«¯æ‰“å­—å‘˜ï¼Œæœ‰ä¸€ç‚¹å³ä½¿è®¾è®¡ä¸è¦æ±‚çš„ï¼Œæˆ‘è¿˜æ˜¯éœ€è¦è¯´æ˜çš„ï¼Œæ¨ªè½´çš„åˆ»åº¦å€¼æ˜¯å¯ä»¥è‡ªå®šä¹‰çš„</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Axis        name<span class="token operator">=</span><span class="token punctuation">{</span>xAxis<span class="token punctuation">}</span>        label<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>            textStyle<span class="token punctuation">:</span> <span class="token punctuation">{</span>                fill<span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// é¢œè‰²</span>                textBaseline<span class="token punctuation">:</span> <span class="token string">'top'</span>  <span class="token comment" spellcheck="true">// å¯¹é½åŸºçº¿</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span>            formatter<span class="token punctuation">:</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> val <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\næ¢è¡Œäº†`</span></span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>    <span class="token operator">/</span><span class="token operator">></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/echart15.png" alt="æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹"></p><p>â€ç‹—å­ï¼Œæ’¸ä¸²å»ï¼ï¼ï¼â€œ</p><p>â€è¦ä¸è¿˜æ˜¯åƒä¸ªæ³¡é¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿâ€œ</p><p>ç‹—å­ï¼Œå’ï¼</p><hr><h1 id="ä»¥ä¸‹å†…å®¹æ¥è‡ªè‡ªå·±çš„æ€»ç»“"><a href="#ä»¥ä¸‹å†…å®¹æ¥è‡ªè‡ªå·±çš„æ€»ç»“" class="headerlink" title="ä»¥ä¸‹å†…å®¹æ¥è‡ªè‡ªå·±çš„æ€»ç»“"></a>ä»¥ä¸‹å†…å®¹æ¥è‡ªè‡ªå·±çš„æ€»ç»“</h1><hr><p>å¾ˆæ˜¾ç„¶ï¼Œæœ¬äººæ²¡æœ‰åšä¸»è¿™æšçŒ¿æœ‰æ–‡åŒ–åº•è•´ï¼Œè¾è—»ä¸Šæ—¢ä¸åä¸½ä¸½ï¼Œä¹Ÿæ²¡æœ‰æ•…äº‹æ€§ï¼Œçº¯å±å°±æ˜¯è®ºäº‹ï¼Œè®°ç¬”è®°çš„å½¢å¼ã€‚</p><h4 id="1-æŸ±çŠ¶å›¾-ç‚¹å›¾ä¸Šæ˜¾ç¤ºæ–‡å­—åŠæ ¼å¼åŒ–å†…å®¹"><a href="#1-æŸ±çŠ¶å›¾-ç‚¹å›¾ä¸Šæ˜¾ç¤ºæ–‡å­—åŠæ ¼å¼åŒ–å†…å®¹" class="headerlink" title="1. æŸ±çŠ¶å›¾/ç‚¹å›¾ä¸Šæ˜¾ç¤ºæ–‡å­—åŠæ ¼å¼åŒ–å†…å®¹"></a>1. æŸ±çŠ¶å›¾/ç‚¹å›¾ä¸Šæ˜¾ç¤ºæ–‡å­—åŠæ ¼å¼åŒ–å†…å®¹</h4><p>è¯¥éœ€æ±‚éœ€è¦ç”¨åˆ°<code>Label</code>ç»„ä»¶ï¼Œå¥¹æ˜¯Geonçš„å­ç»„ä»¶ï¼Œä¸Šä»£ç </p><pre class="line-numbers language-js"><code class="language-js">      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>Chart height<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">400</span><span class="token punctuation">}</span> data<span class="token operator">=</span><span class="token punctuation">{</span>dv<span class="token punctuation">}</span> forceFit<span class="token operator">></span>          <span class="token operator">&lt;</span>Axis name<span class="token operator">=</span><span class="token string">"æœˆä»½"</span> <span class="token operator">/</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Axis name<span class="token operator">=</span><span class="token string">"æœˆå‡é™é›¨é‡"</span> <span class="token operator">/</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Legend <span class="token operator">/</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Tooltip            crosshairs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>              type<span class="token punctuation">:</span> <span class="token string">"y"</span>            <span class="token punctuation">}</span><span class="token punctuation">}</span>          <span class="token operator">/</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Geom            type<span class="token operator">=</span><span class="token string">"interval"</span>            position<span class="token operator">=</span><span class="token string">"æœˆä»½*æœˆå‡é™é›¨é‡"</span>            color<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">}</span>            adjust<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>              <span class="token punctuation">{</span>                type<span class="token punctuation">:</span> <span class="token string">"dodge"</span><span class="token punctuation">,</span>                marginRatio<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">32</span>              <span class="token punctuation">}</span>            <span class="token punctuation">]</span><span class="token punctuation">}</span>          <span class="token operator">></span>            <span class="token operator">&lt;</span>Label                content<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">'æœˆä»½*æœˆå‡é™é›¨é‡'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>æœˆä»½<span class="token punctuation">,</span> æœˆå‡é™é›¨é‡<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>æœˆå‡é™é›¨é‡<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span>                textStyle<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>                  textAlign<span class="token punctuation">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ–‡æœ¬å¯¹é½æ–¹å‘ï¼Œå¯å–å€¼ä¸ºï¼š start middle end</span>                  fill<span class="token punctuation">:</span> <span class="token string">'#404040'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ–‡æœ¬çš„é¢œè‰²</span>                  fontSize<span class="token punctuation">:</span> <span class="token string">'14'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ–‡æœ¬å¤§å°</span>                  fontWeight<span class="token punctuation">:</span> <span class="token string">'normal'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ–‡æœ¬ç²—ç»†</span>                  rotate<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ–‡å­—æ—‹è½¬</span>                  textBaseline<span class="token punctuation">:</span> <span class="token string">'top'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ–‡æœ¬åŸºå‡†çº¿ï¼Œå¯å– top middle bottomï¼Œé»˜è®¤ä¸ºmiddle</span>                <span class="token punctuation">}</span><span class="token punctuation">}</span>              <span class="token operator">/</span><span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>Geom<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>Chart<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•ˆæœï¼š</p><p><img src="/loading.gif" data-original="/images/fontend/echart16.png" alt="image.png"></p><p>åŸæ–‡åœ°å€ï¼š<br><a href="https://juejin.im/post/5c0f45edf265da61327f285c">æ•°æ®å¯è§†åŒ–ï¼ŒBizChartså›¾è¡¨åº“å…¥å‘å†ç¨‹</a></p>]]></content>
      
      
      <categories>
          
          <category> åå°ç®¡ç†ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Antd Pro </tag>
            
            <tag> BizCharts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ant Design Proå­¦ä¹ ä¹‹ä½¿ç”¨uploadç»„ä»¶å¹¶ç”¨formè¡¨å•æäº¤</title>
      <link href="2019/03/14/ant-design-pro-xue-xi-zhi-shi-yong-upload-zu-jian-bing-yong-form-biao-dan-ti-jiao/"/>
      <url>2019/03/14/ant-design-pro-xue-xi-zhi-shi-yong-upload-zu-jian-bing-yong-form-biao-dan-ti-jiao/</url>
      
        <content type="html"><![CDATA[<p>é˜¿é‡Œç²‘ç²‘å¼€æºçš„ç®¡ç†æ¡†æ¶<a href="https://pro.ant.design/index-cn">Ant Design Pro</a>ä½¿ç”¨è®°å½•ä¹‹è¡¨å•æäº¤ã€‚<br><a href="https://www.jianshu.com/p/6dddd745231b">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h3><p><img src="/loading.gif" data-original="/images/fontend/antd-upload1.png" alt="upload view"></p><p><img src="/loading.gif" data-original="/images/fontend/antd-upload2.png" alt="http network"></p><p><img src="/loading.gif" data-original="/images/fontend/antd-upload3.png" alt="api-debug"></p><h3 id="å®ç°æ€è·¯å’Œä»£ç "><a href="#å®ç°æ€è·¯å’Œä»£ç " class="headerlink" title="å®ç°æ€è·¯å’Œä»£ç "></a>å®ç°æ€è·¯å’Œä»£ç </h3><p>åˆ©ç”¨uploadæä¾›çš„<code>beforeUpload</code>å±æ€§ï¼Œå…ˆå°†æ–‡ä»¶æ”¾åˆ°stateé‡Œï¼Œéšåå’Œformè¡¨å•ä¸€èµ·æäº¤ã€‚<br>å…ˆä¸Šå¹²è´§ï¼Œå†è§£é‡Šä¸€äº›èµ°è¿‡çš„å¼¯å¼¯ç»•</p><blockquote><p>æ¥å£ä»£ç <br>æ¥å—å®ä½“ç±»</p></blockquote><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>multipart<span class="token punctuation">.</span>MultipartFile<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>Transient<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Date<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * @author çº¢åˆ›-é©¬æµ·å¼º * @date 2019-02-20 14:06 * @description æˆ˜ç•¥æŠ¥å‘Š */</span>@Data<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StrategyReportVo</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String id<span class="token punctuation">;</span>    <span class="token keyword">private</span> String title<span class="token punctuation">;</span>    <span class="token keyword">private</span> Date showTime<span class="token punctuation">;</span>    <span class="token keyword">private</span> String periods<span class="token punctuation">;</span>    <span class="token keyword">private</span> String fileUrl<span class="token punctuation">;</span>    <span class="token keyword">private</span> int deleteFlag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> Date createTime<span class="token punctuation">;</span>    @Transient    <span class="token keyword">private</span> int readCount<span class="token punctuation">;</span>    <span class="token keyword">private</span> MultipartFile<span class="token punctuation">[</span><span class="token punctuation">]</span> files<span class="token punctuation">;</span>    <span class="token keyword">private</span> MultipartFile file<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>APIæ¥å£</p><pre class="line-numbers language-js"><code class="language-js"> @<span class="token function">PostMapping</span><span class="token punctuation">(</span><span class="token string">"/reports"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> RtnResult <span class="token function">update</span><span class="token punctuation">(</span>StrategyReportVo vo<span class="token punctuation">)</span> <span class="token punctuation">{</span>        StrategyReport report <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StrategyReport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        BeanUtils<span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>vo<span class="token punctuation">,</span> report<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> RtnResult<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>strategyReportAdminService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>report<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>æ³¨æ„ï¼šæ¥å£ä½¿ç”¨formå½¢å¼æäº¤ï¼Œå› æ­¤åœ¨voå‰é¢ä¸èƒ½ä½¿ç”¨@RequestBodyæ³¨è§£</strong></p></blockquote><p>å‰ç«¯ä¸ºäº†æ–¹ä¾¿å…ˆå°†fetchè¯·æ±‚å†™åœ¨formé¡µé¢é‡Œï¼Œè§„èŒƒçš„è¯åº”è¯¥å†™åœ¨modelé‡Œã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>PureComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span>Modal<span class="token punctuation">,</span> Form<span class="token punctuation">,</span> Input<span class="token punctuation">,</span> Spin<span class="token punctuation">,</span> DatePicker<span class="token punctuation">,</span> Button<span class="token punctuation">,</span> Icon<span class="token punctuation">,</span> Upload<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span><span class="token keyword">import</span> FileUpload <span class="token keyword">from</span> <span class="token string">'../Common/FileUpload'</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span>uploadUrl<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../services/api-base'</span><span class="token punctuation">;</span><span class="token keyword">import</span> moment <span class="token keyword">from</span> <span class="token string">"moment"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span>prefix<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../services/api'</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token punctuation">{</span>Item<span class="token punctuation">:</span> FormItem<span class="token punctuation">}</span> <span class="token operator">=</span> Form<span class="token punctuation">;</span>@Form<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">StrategyReportForm</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>    state <span class="token operator">=</span> <span class="token punctuation">{</span>        fileData<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/** æ–‡ä»¶ä¸Šä¼ å±æ€§ **/</span>    uploadProps <span class="token operator">=</span> <span class="token punctuation">{</span>        accept<span class="token punctuation">:</span> <span class="token string">'.pdf'</span><span class="token punctuation">,</span>        action<span class="token punctuation">:</span> uploadUrl<span class="token punctuation">,</span>        name<span class="token punctuation">:</span> <span class="token string">'files'</span><span class="token punctuation">,</span>        onUpload<span class="token punctuation">:</span> <span class="token punctuation">(</span>fileList<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onChangeFile</span><span class="token punctuation">(</span>fileList<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        onSuccess<span class="token punctuation">:</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">const</span> <span class="token punctuation">{</span>name<span class="token punctuation">,</span> url<span class="token punctuation">}</span> <span class="token operator">=</span> response<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token punctuation">{</span>                uid<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>                name<span class="token punctuation">:</span> name<span class="token punctuation">,</span>                status<span class="token punctuation">:</span> <span class="token string">'done'</span><span class="token punctuation">,</span>                url<span class="token punctuation">:</span> url            <span class="token punctuation">}</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">setFieldsValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>fileUrl<span class="token punctuation">:</span> url<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onChangeFile</span><span class="token punctuation">(</span><span class="token punctuation">[</span>file<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        onRemove<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onChangeFile</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token comment" spellcheck="true">//è¿™ä¸ªæ˜¯ç›‘å¬æ–‡ä»¶å˜åŒ–çš„</span>fileChange<span class="token operator">=</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span>file<span class="token punctuation">,</span>fileList<span class="token punctuation">}</span><span class="token operator">=</span>params<span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>status<span class="token operator">===</span><span class="token string">'uploading'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                percent<span class="token punctuation">:</span>fileList<span class="token punctuation">.</span>percent                <span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>           <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// æ‹¦æˆªæ–‡ä»¶ä¸Šä¼ </span>beforeUploadHandle<span class="token operator">=</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span>fileData<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">{</span>        fileData<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">...</span>fileData<span class="token punctuation">,</span>file<span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// æ–‡ä»¶åˆ—è¡¨çš„åˆ é™¤</span>fileRemove<span class="token operator">=</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span>fileData<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>        <span class="token keyword">const</span> index <span class="token operator">=</span> fileData<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            fileData<span class="token punctuation">:</span> fileData<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> i <span class="token operator">!==</span> index<span class="token punctuation">)</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> <span class="token punctuation">{</span>modalVisible<span class="token punctuation">,</span> formLoading<span class="token punctuation">,</span> confirmLoading<span class="token punctuation">,</span> data<span class="token punctuation">,</span> onSave<span class="token punctuation">,</span> onCancel<span class="token punctuation">,</span> form<span class="token punctuation">,</span> fileList<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>        <span class="token keyword">const</span> <span class="token punctuation">{</span>getFieldDecorator<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>form<span class="token punctuation">;</span>        <span class="token keyword">const</span> title <span class="token operator">=</span> data<span class="token punctuation">.</span>id <span class="token operator">?</span> <span class="token string">'ç¼–è¾‘æŠ¥å‘Š'</span> <span class="token punctuation">:</span> <span class="token string">'æ·»åŠ æŠ¥å‘Š'</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> formItemLayout <span class="token operator">=</span> <span class="token punctuation">{</span>            labelCol<span class="token punctuation">:</span> <span class="token punctuation">{</span>span<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>            wrapperCol<span class="token punctuation">:</span> <span class="token punctuation">{</span>span<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>fileData<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>            <span class="token operator">&lt;</span>Modal                title<span class="token operator">=</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span>                visible<span class="token operator">=</span><span class="token punctuation">{</span>modalVisible<span class="token punctuation">}</span>                confirmLoading<span class="token operator">=</span><span class="token punctuation">{</span>confirmLoading<span class="token punctuation">}</span>                onOk<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                    form<span class="token punctuation">.</span><span class="token function">validateFields</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> values<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>                          <span class="token keyword">let</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                          formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">,</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                          <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>i<span class="token operator">&lt;</span>files<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                            <span class="token comment" spellcheck="true">//dataParament.files.fileList[i].originFileObj è¿™ä¸ªå¯¹è±¡æ˜¯æˆ‘è§‚å¯Ÿ antdçš„Uploadç»„ä»¶å‘ç°çš„é‡Œé¢çš„originFileObj å¯¹è±¡å°±æ˜¯fileå¯¹è±¡</span>                            formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'files'</span><span class="token punctuation">,</span>files<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>                           <span class="token punctuation">}</span>                           <span class="token comment" spellcheck="true">//fileä»¥å¤–çš„å¯¹è±¡æ‹¼æ¥</span>                           <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">in</span> values<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>                             <span class="token keyword">if</span><span class="token punctuation">(</span>item <span class="token operator">!==</span> <span class="token string">'files'</span> <span class="token operator">&amp;&amp;</span> values<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> values<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                             <span class="token punctuation">}</span>                           <span class="token punctuation">}</span>                          <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prefix<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/questionnaire/admin/strategy/reports`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                            method<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>                            body<span class="token punctuation">:</span> formData<span class="token punctuation">,</span>                            headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>                                <span class="token string">'Authorization'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sessionStorage<span class="token punctuation">.</span>accessToken<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>                            <span class="token punctuation">}</span><span class="token punctuation">,</span>                          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                              <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                                  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"====================="</span><span class="token punctuation">,</span> <span class="token string">'OK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                              <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                                  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"====================="</span><span class="token punctuation">,</span> <span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                              <span class="token punctuation">}</span>                          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                          <span class="token function">onSave</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token punctuation">}</span>                onCancel<span class="token operator">=</span><span class="token punctuation">{</span>onCancel<span class="token punctuation">}</span><span class="token operator">></span>                <span class="token operator">&lt;</span>Form id<span class="token operator">=</span><span class="token string">"postForm"</span><span class="token operator">></span>                    <span class="token operator">&lt;</span>Spin spinning<span class="token operator">=</span><span class="token punctuation">{</span>formLoading<span class="token punctuation">}</span> tip<span class="token operator">=</span><span class="token string">"åŠ è½½ä¸­..."</span><span class="token operator">></span>                        <span class="token punctuation">{</span>                            <span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>initialValue<span class="token punctuation">:</span> _<span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>                        <span class="token punctuation">}</span>                        <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"æŠ¥å‘Šæ ‡é¢˜"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                            <span class="token punctuation">{</span>                                <span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                                    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>                                        <span class="token punctuation">{</span>                                            type<span class="token punctuation">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span>                                            required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                                            message<span class="token punctuation">:</span> <span class="token string">'æ ‡é¢˜ä¸èƒ½ä¸ºç©ºï¼'</span><span class="token punctuation">,</span>                                        <span class="token punctuation">}</span><span class="token punctuation">,</span>                                    <span class="token punctuation">]</span><span class="token punctuation">,</span>                                    initialValue<span class="token punctuation">:</span> _<span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Input<span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span>                            <span class="token punctuation">}</span>                        <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>                        <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"æ˜¾ç¤ºæ—¶é—´"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                            <span class="token punctuation">{</span>                                <span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'showTime'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                                    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>                                        <span class="token punctuation">{</span>                                            required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                                            message<span class="token punctuation">:</span> <span class="token string">'æ˜¾ç¤ºæ—¶é—´ä¸èƒ½ä¸ºç©º'</span><span class="token punctuation">,</span>                                        <span class="token punctuation">}</span><span class="token punctuation">,</span>                                    <span class="token punctuation">]</span><span class="token punctuation">,</span>                                    initialValue<span class="token punctuation">:</span> data<span class="token punctuation">.</span>showTime <span class="token operator">?</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token function">moment</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>showTime<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'YYYY-MM-DD HH:mm'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span> <span class="token operator">&lt;</span>DatePicker showTime style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>width<span class="token punctuation">:</span> <span class="token number">280</span><span class="token punctuation">}</span><span class="token punctuation">}</span> format<span class="token operator">=</span><span class="token string">"YYYY-MM-DD HH:mm"</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span>                            <span class="token punctuation">}</span>                        <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>                        <span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"æŒ‡å®šæœŸæ•°"</span> <span class="token punctuation">{</span><span class="token operator">...</span>formItemLayout<span class="token punctuation">}</span><span class="token operator">></span>                            <span class="token punctuation">{</span>                                <span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'periods'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                                    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>                                        <span class="token punctuation">{</span>                                            type<span class="token punctuation">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span>                                            required<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>                                            message<span class="token punctuation">:</span> <span class="token string">'æœŸæ•°'</span><span class="token punctuation">,</span>                                        <span class="token punctuation">}</span><span class="token punctuation">,</span>                                    <span class="token punctuation">]</span><span class="token punctuation">,</span>                                    initialValue<span class="token punctuation">:</span> _<span class="token punctuation">.</span><span class="token function">defaultTo</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>periods<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Input<span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span>                            <span class="token punctuation">}</span>                        <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>                        <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* &lt;FormItem label="ä¸Šä¼ é™„ä»¶" {...formItemLayout}>                            {                                getFieldDecorator('fileUrl', {                                    rules: [                                        {                                            type: 'string',                                            required: true,                                            message: 'è¯·ä¸Šä¼ PDFæ–‡æ¡£',                                        },                                    ],                                    initialValue: _.defaultTo(data.fileUrl, '')                                })(&lt;FileUpload                                    uploadProps={this.uploadProps}                                    fileList={fileList}                                    data={{'objectKey': 'strategy/report'}}/>)                            }                        &lt;/FormItem> */</span><span class="token punctuation">}</span>                        <span class="token operator">&lt;</span>FormItem labelCol<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>span<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">}</span> wrapperCol<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>span<span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">}</span><span class="token punctuation">}</span> label<span class="token operator">=</span><span class="token string">'æ–‡ä»¶ä¸Šä¼ '</span><span class="token operator">></span>                            <span class="token punctuation">{</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'files'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>                                <span class="token operator">&lt;</span>Upload action<span class="token operator">=</span><span class="token string">'è·¯å¾„'</span>                                     multiple uploadList                                     beforeUpload<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>beforeUploadHandle<span class="token punctuation">}</span>                                     onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileChange<span class="token punctuation">}</span>                                     onRemove<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileRemove<span class="token punctuation">}</span>                                     fileList<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>fileData<span class="token punctuation">}</span><span class="token operator">></span>                                    <span class="token operator">&lt;</span>Button<span class="token operator">></span><span class="token operator">&lt;</span>Icon type<span class="token operator">=</span><span class="token string">'upload'</span> <span class="token operator">/</span><span class="token operator">></span>ä¸Šä¼ æ–‡ä»¶<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">></span>                                <span class="token operator">&lt;</span><span class="token operator">/</span>Upload<span class="token operator">></span>                            <span class="token punctuation">)</span><span class="token punctuation">}</span>                        <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>                    <span class="token operator">&lt;</span><span class="token operator">/</span>Spin<span class="token operator">></span>                <span class="token operator">&lt;</span><span class="token operator">/</span>Form<span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>Modal<span class="token operator">></span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>modalVisible <span class="token operator">&amp;&amp;</span> nextProps<span class="token punctuation">.</span>modalVisible<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">resetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><ul><li>1ã€Uploadç»„ä»¶é»˜è®¤æ˜¯é€‰æ‹©æ–‡ä»¶åç›´æ¥è°ƒç”¨actionä¸Šä¼ æ–‡ä»¶ï¼Œè¿”å›urlã€‚é€šå¸¸æ–‡ä»¶éƒ½ä¼šåœ¨formè¡¨å•é‡Œè·Ÿåˆ«çš„å‚æ•°ä¸€èµ·ï¼Œè¿™æ—¶å€™formé‡Œå…¶å®æ²¡æœ‰æ–‡ä»¶ï¼Œè€Œæ˜¯æ–‡ä»¶çš„urlåœ°å€ã€‚<br>å°±åƒä¸‹é¢è¿™æ ·ã€‚<br><code>StrategyReportForm</code>æ˜¯è¿™ä¸ªå¼¹å‡ºå±‚ï¼Œè€Œå®ƒçš„ä¸Šå±‚é¡µé¢æ˜¯<code>StrategyReportList</code>ï¼Œåœ¨listä¸­çš„formæ˜¯è¿™æ ·çš„<pre class="line-numbers language-js"><code class="language-js">        <span class="token operator">&lt;</span>StrategyReportForm                modalVisible<span class="token operator">=</span><span class="token punctuation">{</span>strategyReportForm<span class="token punctuation">.</span>modalVisible<span class="token punctuation">}</span>                confirmLoading<span class="token operator">=</span><span class="token punctuation">{</span>strategyReportForm<span class="token punctuation">.</span>confirmLoading<span class="token punctuation">}</span>                options<span class="token operator">=</span><span class="token punctuation">{</span>strategyReportForm<span class="token punctuation">.</span>options<span class="token punctuation">}</span>                data<span class="token operator">=</span><span class="token punctuation">{</span>strategyReportForm<span class="token punctuation">.</span>data<span class="token punctuation">}</span>                fileList<span class="token operator">=</span><span class="token punctuation">{</span>strategyReportForm<span class="token punctuation">.</span>fileList<span class="token punctuation">}</span>                formLoading<span class="token operator">=</span><span class="token punctuation">{</span>strategyReportForm<span class="token punctuation">.</span>formLoading<span class="token punctuation">}</span>                onChangeFile<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>fileList<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>                  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'strategyReportForm/fileList'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> fileList<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token punctuation">}</span>                onSave<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>                  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'strategyReportForm/update'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>data<span class="token punctuation">,</span> callback<span class="token punctuation">:</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>                      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'strategyReportList/list'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">}</span><span class="token punctuation">}</span>              onCancel<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>                  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'strategyReportForm/close'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>è¿™æ®µä»£ç é‡Œçš„onSaveå›è°ƒæ–¹æ³•çš„æ„æ€å°±æ˜¯ä¸Šä¼ æ–‡ä»¶ï¼Œå…³é—­å¼¹æ¡†ï¼Œåˆ·æ–°åˆ—è¡¨ã€‚<br>modleé‡Œçš„updateæ–¹æ³•ä¸å…¶ä»–çš„æ²¡æœ‰ä¸¤æ ·ã€‚<pre class="line-numbers language-js"><code class="language-js">  effects<span class="token punctuation">:</span> <span class="token punctuation">{</span>      <span class="token operator">*</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>payload<span class="token punctuation">:</span><span class="token punctuation">{</span>data<span class="token punctuation">,</span> callback<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>call<span class="token punctuation">,</span> put<span class="token punctuation">,</span> select<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>          <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'confirmLoading'</span><span class="token punctuation">,</span> payload<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>update<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>              message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">"æ“ä½œæˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">'close'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>              message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>api.uploadè¿™ä¸ªæ–¹æ³•åœ¨antd proé‡Œæ˜¯éš”ç¦»å®šä¹‰å†serviceç›®å½•ä¸‹çš„ï¼Œå†…å®¹å¾ˆç®€å•ï¼š<pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prefix<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/questionnaire/admin/strategy/reports`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  method<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>  body<span class="token punctuation">:</span> params<span class="token punctuation">,</span>  headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>      <span class="token string">'Authorization'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sessionStorage<span class="token punctuation">.</span>accessToken<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><em>éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œå¾—ç›´æ¥ä½¿ç”¨fetchæ–¹æ³•ï¼Œä¸èƒ½ä½¿ç”¨æ¡†æ¶å°è£…çš„requestå‘èµ·è¯·æ±‚ï¼Œå› ä¸ºrequesté‡Œå°è£…çš„content-typeç±»å‹æ˜¯application/json</em>*</li></ul><p>åœ¨and design pro2.xçš„ç‰ˆæœ¬é‡Œï¼Œrequestæ–¹æ³•å·²ç»å…¼å®¹äº†è¿™ä¸ªå¤„ç†<br><img src="/loading.gif" data-original="/images/fontend/antd-upload4.png" alt="2.x request"></p><p>åœ¨antd1.xçš„ç‰ˆæœ¬é‡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨reqeusté‡Œå°è£…å¥½çš„<code>postFormWithProgress</code>æ–¹æ³•ã€‚æ¯”å¦‚è¿™ä¸ªç”¨æ³•ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>FormItem label<span class="token operator">=</span><span class="token string">"å®‰è£…åŒ…åœ°å€"</span> labelCol<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> span<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> wrapperCol<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> span<span class="token punctuation">:</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>          <span class="token punctuation">{</span>            <span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'downloadAddr'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>              rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>                <span class="token punctuation">{</span>                  required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                  message<span class="token punctuation">:</span> <span class="token string">'å®‰è£…åŒ…åœ°å€ä¸èƒ½ä¸ºç©º'</span><span class="token punctuation">,</span>                <span class="token punctuation">}</span><span class="token punctuation">,</span>              <span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>              <span class="token operator">&lt;</span>Input disabled <span class="token operator">/</span><span class="token operator">></span>            <span class="token punctuation">)</span>          <span class="token punctuation">}</span>        <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>        <span class="token operator">&lt;</span>FormItem wrapperCol<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> offset<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span> span<span class="token punctuation">:</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>          <span class="token operator">&lt;</span>Upload beforeUpload<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>uploadFile<span class="token punctuation">}</span><span class="token operator">></span>            <span class="token operator">&lt;</span>Button<span class="token operator">></span>              <span class="token operator">&lt;</span>Icon type<span class="token operator">=</span><span class="token string">"upload"</span> <span class="token operator">/</span><span class="token operator">></span>ä¸Šä¼ æ–‡ä»¶            <span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">></span>          <span class="token operator">&lt;</span><span class="token operator">/</span>Upload<span class="token operator">></span>          <span class="token operator">&lt;</span>Progress size<span class="token operator">=</span><span class="token string">"small"</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> display<span class="token punctuation">:</span> <span class="token string">'inline'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> percent<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">~</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>uploadPercent<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>js</p><pre class="line-numbers language-js"><code class="language-js">  uploadFile <span class="token operator">=</span> <span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uploadPercent<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">uploadAppBinary</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> percent <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uploadPercent<span class="token punctuation">:</span> percent <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>      <span class="token punctuation">(</span>resp<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> <span class="token punctuation">{</span>          code<span class="token punctuation">,</span>          message<span class="token punctuation">:</span> msg<span class="token punctuation">,</span>          data<span class="token punctuation">,</span>        <span class="token punctuation">}</span> <span class="token operator">=</span> resp<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token keyword">const</span> <span class="token punctuation">{</span> downloadAddr <span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>          <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>form<span class="token punctuation">.</span><span class="token function">setFieldsValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>            downloadAddr<span class="token punctuation">,</span>          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>          message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`ä¸Šä¼ æ–‡ä»¶å¤±è´¥ï¼--</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>msg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e <span class="token operator">=</span><span class="token operator">></span> message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>service</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">uploadAppBinary</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token function">postFormWithProgress</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prefix<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/questionnaire/admin/app/release/uploadPackage`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>    file<span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>2ã€ä½†æ˜¯è¿™æ¬¡ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬æ–‡ä»¶å…ˆä¸ä¸Šä¼ ï¼Œè€Œæ˜¯ä¸formè¡¨å•çš„å…¶ä»–å†…å®¹ä¸€èµ·æäº¤åˆ°APIé‡Œã€‚è§£å†³é—®é¢˜æ˜¯å­¦åˆ°çš„ä¸œè¥¿ä¸å°‘ï¼Œç®€å•è®°å½•ä¸‹ã€‚<blockquote><p>2.1ã€formé‡Œåº”ä¸åº”è¯¥è®¾ç½®Content-Typeå±æ€§ï¼Œåº”è¯¥è®¾ç½®æˆä»€ä¹ˆï¼Ÿrequesté‡Œä¼šæœ‰å“ªäº›ä¸ä¸€æ ·ï¼Ÿ<br>ç›´æ¥å‚è€ƒ<a href="https://blog.csdn.net/u013827143/article/details/86222486">postä½¿ç”¨form-dataå’Œx-www-form-urlencodedçš„æœ¬è´¨åŒºåˆ«</a>å³å¯ï¼Œä½†æ˜¯ç»“è®ºæ˜¯ä¸éœ€è¦è‡ªå·±è®¾å®šï¼Œç¨‹åºä¼šè‡ªå·±æ ¹æ®ç±»å‹è®¾å®šã€‚</p></blockquote></li></ul><blockquote><p>2.2ã€è°ƒç”¨æ¥å£æ—¶åªè¦æ²¡æœ‰æ–‡ä»¶å°±æ²¡é—®é¢˜ï¼Œä½†æ˜¯æœ‰æ–‡ä»¶äº†å°±ä¼š400ã€‚<br>åŸå› ï¼šå¤šä¸ªæ–‡ä»¶çš„appendä¸èƒ½ç›´æ¥æŠŠæ•°ç»„appendè¿›å»ï¼Œæ¯”å¦‚ä¸Šé¢å¦‚æœä¸ç”¨å¾ªç¯è·å–fileDataé‡Œçš„æ•°æ®ï¼Œè€Œæ˜¯ç›´æ¥formData.append(this.state.fileData);è¿™æ ·çš„æ•°æ®å‘é€çš„æ¥å£ï¼Œå°±ä¼š400ï¼ŒåŸå› å°±æ˜¯ç±»å‹ä¸å¯¹ã€‚<br>å¦‚æœæ˜¯å•ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨formData.append(files[0]);è¿™æ ·å®ç°ã€‚</p></blockquote><blockquote><p>2.3ã€å¤šä¸ªæ–‡ä»¶å’Œå•ä¸ªæ–‡ä»¶çš„å¤„ç†ã€‚<br>ä¸è®ºæ˜¯å•ä¸ªæ–‡ä»¶æˆ–æ˜¯å¤šä¸ªæ–‡ä»¶ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å¾ªç¯çš„å½¢å¼å°†æ–‡ä»¶appendåˆ°formdataä¸­ã€‚</p></blockquote><ul><li>3ã€å…¶ä»–å®ç°æ–¹å¼<br>åŸºäº2.xä»¥åçš„ç‰ˆæœ¬å®ç°æ›´ç®€å•ä¸€äº›ã€‚<br>æŠŠjsonä¼ åˆ°serviceçš„apiä»¥åï¼Œnewå‡ºformDataï¼Œappendä¸Šå‚æ•°å³å¯ã€‚<pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">batchImport</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>      formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> params<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token string">'/customer/batchImport'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>       method<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>      body<span class="token punctuation">:</span> formData   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>ä¸è¿‡å°±æ˜¯åœ¨formé‡Œè¦åˆ©ç”¨<code>valuePropName</code>å’Œ<code>getValueFromEvent</code>å±æ€§æŠŠå±æ€§å€¼ä»¥jsonçš„ç»“æ„ä¼ é€’åˆ°modlesé‡Œã€‚<pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>Modal          destroyOnClose          title<span class="token operator">=</span><span class="token string">"å¯¼å…¥é‡ä½“äºº"</span>          visible<span class="token operator">=</span><span class="token punctuation">{</span>batchImportShow<span class="token punctuation">}</span>          onOk<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleOk<span class="token punctuation">}</span>          onCancel<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">handleImportVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>          <span class="token operator">&lt;</span>FormItem labelCol<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> span<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> wrapperCol<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> span<span class="token punctuation">:</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> label<span class="token operator">=</span><span class="token string">"æµ‹é‡è®¡åˆ’"</span><span class="token operator">></span>              <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'planId'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>                  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token string">'è¯·é€‰æ‹©æµ‹é‡è®¡åˆ’'</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Select style<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> id<span class="token operator">=</span><span class="token string">'planSelect'</span><span class="token operator">></span>                  <span class="token operator">&lt;</span>Select<span class="token punctuation">.</span>Option key<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">99</span><span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token string">''</span><span class="token operator">></span>å…¨éƒ¨<span class="token operator">&lt;</span><span class="token operator">/</span>Select<span class="token punctuation">.</span>Option<span class="token operator">></span>              <span class="token punctuation">{</span> planList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>Select<span class="token punctuation">.</span>Option key<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>planId<span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>planId<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>planName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Select<span class="token punctuation">.</span>Option<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>              <span class="token operator">&lt;</span><span class="token operator">/</span>Select<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>          <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>          <span class="token operator">&lt;</span>FormItem labelCol<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> span<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> wrapperCol<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> span<span class="token punctuation">:</span> <span class="token number">15</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> label<span class="token operator">=</span><span class="token string">"æ•°æ®æ–‡ä»¶"</span><span class="token operator">></span>              <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token function">getFieldDecorator</span><span class="token punctuation">(</span><span class="token string">'customerFile'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token string">'è¯·ä¸Šä¼ æ•°æ®æ–‡ä»¶'</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                  valuePropName<span class="token punctuation">:</span> <span class="token string">'files'</span><span class="token punctuation">,</span>                  getValueFromEvent<span class="token punctuation">:</span> e <span class="token operator">=</span><span class="token operator">></span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">,</span>              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Input type<span class="token operator">=</span><span class="token string">'file'</span> name<span class="token operator">=</span><span class="token string">'customerFile'</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>height<span class="token punctuation">:</span><span class="token number">35</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>          <span class="token operator">&lt;</span><span class="token operator">/</span>FormItem<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>Modal<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h3 id="å‹æƒ…å‚è€ƒ"><a href="#å‹æƒ…å‚è€ƒ" class="headerlink" title="å‹æƒ…å‚è€ƒ"></a>å‹æƒ…å‚è€ƒ</h3><p><a href="https://blog.csdn.net/qq8241994/article/details/82857730">å°†é€‰ä¸­æ–‡ä»¶ä¿å­˜åˆ°é¡µé¢çš„stateä¸­</a><br><a href="https://blog.csdn.net/a2469025185/article/details/82770762">å°†æ–‡ä»¶appendåˆ°æ–°çš„formdataä¸­ä½¿ç”¨postæ–¹å¼æäº¤</a></p>]]></content>
      
      
      <categories>
          
          <category> åå°ç®¡ç†ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Antd Pro </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ant Design Pro å­¦ä¹ ä¹‹è·³é¡µä¼ å‚</title>
      <link href="2019/02/06/ant-design-pro-xue-xi-zhi-tiao-ye-chuan-can/"/>
      <url>2019/02/06/ant-design-pro-xue-xi-zhi-tiao-ye-chuan-can/</url>
      
        <content type="html"><![CDATA[<p>é˜¿é‡Œç²‘ç²‘å¼€æºçš„ç®¡ç†æ¡†æ¶<a href="https://pro.ant.design/index-cn">Ant Design Pro</a>ä½¿ç”¨è®°å½•ä¹‹è·³é¡µä¼ å‚ã€‚</p><p><a href="https://www.jianshu.com/p/71cb72f8dcfb">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>å·ç›—åˆ«äººè€åŠ¨æˆæœï¼Œè¦ä¾µæƒäº†ã€‚<br>è¿™æ˜¯åŒäº‹æ€»ç»“çš„è·³é¡µåœºæ™¯ä¼ å‚çš„å½¢å¼ã€‚</p><h2 id="umi-router-link-ç”¨æ³•"><a href="#umi-router-link-ç”¨æ³•" class="headerlink" title="umi - router / link ç”¨æ³•"></a>umi - router / link ç”¨æ³•</h2><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">'umi/link'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/* æ™®é€šä½¿ç”¨ */</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">"/list"</span><span class="token operator">></span>Go to list page<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">></span><span class="token comment" spellcheck="true">/* å¸¦å‚æ•° */</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">"/list?a=b"</span><span class="token operator">></span>Go to list page<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">></span><span class="token comment" spellcheck="true">/* åŒ…å«å­ç»„ä»¶ */</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">"/list?a=b"</span><span class="token operator">></span><span class="token operator">&lt;</span>button<span class="token operator">></span>Go to list page<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="umi-router"><a href="#umi-router" class="headerlink" title="umi/router"></a>umi/router</h3><h4 id="router-push-path"><a href="#router-push-path" class="headerlink" title="router.push(path)"></a>router.push(path)</h4><p>æ¨ä¸€ä¸ªæ–°çš„é¡µé¢åˆ° history é‡Œã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'umi/router'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ™®é€šè·³è½¬ï¼Œä¸å¸¦å‚æ•°</span>router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/list'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¸¦å‚æ•°</span>router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/list?a=b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¸¦å‚æ•°ï¼Œå¹¶ä¸”å‚æ•°ä¼šæ˜¾ç¤ºåœ¨urlä¸­</span>router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> pathname<span class="token punctuation">:</span> <span class="token string">'/list'</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> query<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> a<span class="token punctuation">:</span> <span class="token string">'b'</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¸¦å‚æ•°ï¼Œä½†æ˜¯å‚æ•°ä¸ä¼šæ˜¾ç¤ºåœ¨urlä¸­</span>router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> pathname<span class="token punctuation">:</span> <span class="token string">'/list'</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> state<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// stateå­—æ®µå¯ä»¥è‡ªå®šä¹‰ï¼Œå¦‚ç”¨paramsç­‰ä¹Ÿå¯ä»¥</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> a<span class="token punctuation">:</span> <span class="token string">'b'</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>listé¡µé¢å¯¹å‚æ•°çš„æ¥æ”¶å–å€¼ï¼š</strong></p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> location<span class="token punctuation">:</span> <span class="token punctuation">{</span> query<span class="token punctuation">,</span> state <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span><span class="token operator">**</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span>a<span class="token punctuation">,</span> state<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">**</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="router-replace-path"><a href="#router-replace-path" class="headerlink" title="router.replace(path)"></a>router.replace(path)</h4><p>æ›¿æ¢å½“å‰é¡µé¢ï¼Œå‚æ•°å’Œ&nbsp;<a href="https://umijs.org/zh/api/#router.push(path)">router.push()</a>&nbsp;ç›¸åŒã€‚</p><h4 id="router-go-n"><a href="#router-go-n" class="headerlink" title="router.go(n)"></a>router.go(n)</h4><p>å¾€å‰æˆ–å¾€åè·³æŒ‡å®šé¡µæ•°ã€‚</p><h4 id="router-goBack"><a href="#router-goBack" class="headerlink" title="router.goBack()"></a>router.goBack()</h4><p>åé€€ä¸€é¡µã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åå°ç®¡ç†ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Antd Pro </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>â€œSpringBoot2.0ä¸å®¹é”™è¿‡çš„æ–°ç‰¹æ€§ WebFluxå“åº”å¼ç¼–ç¨‹â€å­¦ä¹ ç¬”è®°(ä¸€)</title>
      <link href="2019/01/12/springboot2.0-webflux-xue-xi-bi-ji-2/"/>
      <url>2019/01/12/springboot2.0-webflux-xue-xi-bi-ji-2/</url>
      
        <content type="html"><![CDATA[<p>WebFluxå“åº”å¼ç¼–ç¨‹å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´<br><a href="https://www.jianshu.com/p/2a484e7bbce3">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="ç¬¬äº”èŠ‚-webfluxæœåŠ¡ç«¯å¼€å‘è®²è§£"><a href="#ç¬¬äº”èŠ‚-webfluxæœåŠ¡ç«¯å¼€å‘è®²è§£" class="headerlink" title="ç¬¬äº”èŠ‚  webfluxæœåŠ¡ç«¯å¼€å‘è®²è§£"></a>ç¬¬äº”èŠ‚  webfluxæœåŠ¡ç«¯å¼€å‘è®²è§£</h2><ul><li>5.1 å¼‚æ­¥servlet<br>1ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ å¼‚æ­¥servletï¼Ÿ<br>å›ç­”ï¼šåŒæ­¥servletä¸€ç›´å ç”¨æœåŠ¡å™¨tomcatçš„çº¿ç¨‹æ•°ï¼Œæ˜¯tomcatæ— æš‡æ¥å—æ›´å¤šçš„è¯·æ±‚ã€‚å› æ­¤æœ‰å¿…è¦ä½¿ç”¨å¼‚æ­¥servletã€‚<br>2ã€åŒæ­¥servleté˜»å¡äº†ä»€ä¹ˆï¼Ÿ<br>ä¹Ÿå°±æ˜¯è¯´åŒæ­¥servletå…¶å®æ˜¯é˜»å¡äº†tomcatçš„servletçº¿ç¨‹ã€‚<br>3ã€å¼‚æ­¥servletæ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ<br>å…ˆçœ‹ä¸€ä¸ªåŒæ­¥servletçš„ä¾‹å­:</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>TimeUnit<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletException<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>WebServlet<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServlet<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletRequest<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletResponse<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * Servlet implementation class SyncServlet */</span><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/SyncServlet"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SyncServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 1L<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * @see HttpServlet#HttpServlet()     */</span>    <span class="token keyword">public</span> <span class="token function">SyncServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// TODO Auto-generated constructor stub</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse     *      response)     */</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span>            HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>        <span class="token keyword">long</span> t1 <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// æ‰§è¡Œä¸šåŠ¡ä»£ç </span>        <span class="token function">doSomeThing</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"sync use:"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">doSomeThing</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span>            HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//</span>        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"done"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse     *      response)     */</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span>            HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// TODO Auto-generated method stub</span>        <span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†æ¨¡æ‹Ÿä¸€ä¸ªå¼‚æ­¥servletçš„ä¾‹å­ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>CompletableFuture<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>TimeUnit<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>AsyncContext<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletException<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletRequest<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletResponse<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>WebServlet<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServlet<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletRequest<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletResponse<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * Servlet implementation class AsyncServlet */</span><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>asyncSupported <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> urlPatterns <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"/AsyncServlet"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AsyncServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 1L<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * @see HttpServlet#HttpServlet()     */</span>    <span class="token keyword">public</span> <span class="token function">AsyncServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// TODO Auto-generated constructor stub</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse     *      response)     */</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span>            HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>        <span class="token keyword">long</span> t1 <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å¼€å¯å¼‚æ­¥</span>        AsyncContext asyncContext <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">startAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// æ‰§è¡Œä¸šåŠ¡ä»£ç </span>        CompletableFuture<span class="token punctuation">.</span><span class="token function">runAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token function">doSomeThing</span><span class="token punctuation">(</span>asyncContext<span class="token punctuation">,</span>                asyncContext<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> asyncContext<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"async use:"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">doSomeThing</span><span class="token punctuation">(</span>AsyncContext asyncContext<span class="token punctuation">,</span>            ServletRequest servletRequest<span class="token punctuation">,</span> ServletResponse servletResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            servletResponse<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"done"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// ä¸šåŠ¡ä»£ç å¤„ç†å®Œæ¯•, é€šçŸ¥ç»“æŸ</span>        asyncContext<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse     *      response)     */</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span>            HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// TODO Auto-generated method stub</span>        <span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‰åä¸¤æ¬¡åœ¨æµè§ˆå™¨ä¸Šè®¿é—®<a href="http://localhost:8080/SyncServlet%E5%92%8Chttp://localhost:8080/AsyncServlet%EF%BC%8C%E5%9C%A8%E5%89%8D%E5%8F%B0%E7%9C%8B%E9%83%BD%E6%98%AF%E5%A4%A7%E7%BA%A65s%E8%BF%94%E5%9B%9E%E3%80%82">http://localhost:8080/SyncServletå’Œhttp://localhost:8080/AsyncServletï¼Œåœ¨å‰å°çœ‹éƒ½æ˜¯å¤§çº¦5sè¿”å›ã€‚</a><br>ä½†æ˜¯æŸ¥çœ‹æœåŠ¡ç«¯æ§åˆ¶å°ï¼š</p><blockquote><p>sync use:5002<br>async use:16</p></blockquote><p>å¯ä»¥çœ‹åˆ°ï¼ŒåŒæ­¥æ˜¯5sï¼Œå¼‚æ­¥çš„æ˜¯16msè¿”å›äº†ï¼Œè¿™æ ·tomcatå°±åˆæœ‰æ—¶é—´å¤„ç†åˆ«çš„ä¸šåŠ¡äº†ï¼Œä¹Ÿå°±æ˜¯æé«˜äº†æœåŠ¡å™¨çš„å¹¶å‘ã€‚</p><ul><li>5.2 Monoå’ŒFluxè¿”å›æµæ¥å£<br>reactor = java8çš„æµ + java9çš„å“åº”å¼æµ</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>TimeUnit<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>reactivestreams<span class="token punctuation">.</span>Subscriber<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>reactivestreams<span class="token punctuation">.</span>Subscription<span class="token punctuation">;</span><span class="token keyword">import</span> reactor<span class="token punctuation">.</span>core<span class="token punctuation">.</span>publisher<span class="token punctuation">.</span>Flux<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReactorDemo</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// reactor = jdk8 stream + jdk9 reactive stream</span>        <span class="token comment" spellcheck="true">// Mono 0-1ä¸ªå…ƒç´ </span>        <span class="token comment" spellcheck="true">// Flux 0-Nä¸ªå…ƒç´ </span>        String<span class="token punctuation">[</span><span class="token punctuation">]</span> strs <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"3"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 2. å®šä¹‰è®¢é˜…è€…</span>        Subscriber<span class="token operator">&lt;</span>Integer<span class="token operator">></span> subscriber <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subscriber</span><span class="token operator">&lt;</span>Integer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">private</span> Subscription subscription<span class="token punctuation">;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onSubscribe</span><span class="token punctuation">(</span>Subscription subscription<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// ä¿å­˜è®¢é˜…å…³ç³», éœ€è¦ç”¨å®ƒæ¥ç»™å‘å¸ƒè€…å“åº”</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription <span class="token operator">=</span> subscription<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// è¯·æ±‚ä¸€ä¸ªæ•°æ®</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onNext</span><span class="token punctuation">(</span>Integer item<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// æ¥å—åˆ°ä¸€ä¸ªæ•°æ®, å¤„ç†</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¥å—åˆ°æ•°æ®: "</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">try</span> <span class="token punctuation">{</span>                    TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                                <span class="token comment" spellcheck="true">// å¤„ç†å®Œè°ƒç”¨requestå†è¯·æ±‚ä¸€ä¸ªæ•°æ®</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// æˆ–è€… å·²ç»è¾¾åˆ°äº†ç›®æ ‡, è°ƒç”¨cancelå‘Šè¯‰å‘å¸ƒè€…ä¸å†æ¥å—æ•°æ®äº†</span>                <span class="token comment" spellcheck="true">// this.subscription.cancel();</span>            <span class="token punctuation">}</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span>Throwable throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// å‡ºç°äº†å¼‚å¸¸(ä¾‹å¦‚å¤„ç†æ•°æ®çš„æ—¶å€™äº§ç”Ÿäº†å¼‚å¸¸)</span>                throwable<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// æˆ‘ä»¬å¯ä»¥å‘Šè¯‰å‘å¸ƒè€…, åé¢ä¸æ¥å—æ•°æ®äº†</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// å…¨éƒ¨æ•°æ®å¤„ç†å®Œäº†(å‘å¸ƒè€…å…³é—­äº†)</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¤„ç†å®Œäº†!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// è¿™é‡Œå°±æ˜¯jdk8çš„stream</span>        Flux<span class="token punctuation">.</span><span class="token function">fromArray</span><span class="token punctuation">(</span>strs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>s <span class="token operator">-</span><span class="token operator">></span> Integer<span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">// æœ€ç»ˆæ“ä½œ</span>        <span class="token comment" spellcheck="true">// è¿™é‡Œå°±æ˜¯jdk9çš„reactive stream</span>        <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>5.2  å®Œæ•´çš„fluxweb<br>æ­¥éª¤ï¼š<br>1ã€æ·»åŠ ä¾èµ–<br>åœ¨<a href="https://start.spring.io/%E4%B8%8A%E9%80%89%E6%8B%A9Reactive">https://start.spring.io/ä¸Šé€‰æ‹©Reactive</a> MongoDBè¿™ä¸ªdependenciesï¼ŒæŒ‰ä¸‹ã€Genarate Projectã€‘æŒ‰é’®ï¼Œä¸‹è½½demo.zip,æŸ¥çœ‹mongodbçš„ä¾èµ–ï¼ŒåŠ å…¥åˆ°pomæ–‡ä»¶ä¸­ã€‚</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token operator">&lt;</span>dependency<span class="token operator">></span>    <span class="token operator">&lt;</span>groupId<span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>    <span class="token operator">&lt;</span>artifactId<span class="token operator">></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>data<span class="token operator">-</span>mongodb<span class="token operator">-</span>reactive<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> lombok <span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span>dependency<span class="token operator">></span>     <span class="token operator">&lt;</span>groupId<span class="token operator">></span>org<span class="token punctuation">.</span>projectlombok<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>     <span class="token operator">&lt;</span>artifactId<span class="token operator">></span>lombok<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>     <span class="token operator">&lt;</span>scope<span class="token operator">></span>provided<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2ã€å¯åŠ¨ç±»applicationä¸Šæ·»åŠ mongodbæ”¯æŒæ³¨è§£<code>@EnableReactiveMongoRepositories</code><br>3ã€å®šä¹‰å¯¹è±¡</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>collection <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Id</span>    <span class="token keyword">private</span> String id<span class="token punctuation">;</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>4ã€å®šä¹‰ä»“åº“repository<br>åˆ›å»ºUserRepositoryæ¥å£ï¼Œç»§æ‰¿<code>ReactiveMongoRepository</code>ï¼Œå¹¶ä½¿ç”¨<code>@Repository</code>æ³¨è§£ã€‚<br>5ã€å®šä¹‰controller</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> UserRepository userRepository<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å®˜æ–¹æ¨èä½¿ç”¨æ„é€ å‡½æ•°çš„æ–¹å¼æ³¨å…¥ä¾èµ–çš„bean</span>    <span class="token keyword">public</span> <span class="token function">UserController</span><span class="token punctuation">(</span>UserRepository userRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository <span class="token operator">=</span> userRepository<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> Flux<span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/stream/all"</span><span class="token punctuation">,</span> produces <span class="token operator">=</span> MediaType<span class="token punctuation">.</span>TEXT_EVENT_STREAM_VALUE<span class="token punctuation">)</span>    <span class="token keyword">public</span> Flux<span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token function">findAllByStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>6ã€æœ¬åœ°å®‰è£…é…ç½®mongodb<br>å…ˆ<a href="https://www.mongodb.com/download-center#enterprise">ä¸‹è½½</a>mongodbï¼Œå®‰è£…é…ç½®ï¼Œæ ¹æ®å¹³å°è‡ªè¡ŒæŸ¥è¯¢ï¼Œæˆ‘çš„windowså¹³å°ï¼Œå‚è€ƒçš„<a href="https://www.cnblogs.com/weschen/p/8213746.html">https://www.cnblogs.com/weschen/p/8213746.html</a></p><p><img src="/loading.gif" data-original="/images/java/mongodb1.png" alt="é€‰æ‹©customä¿®æ”¹å®‰è£…ä½ç½®"></p><p><img src="/loading.gif" data-original="/images/java/mongodb-log.png" alt="é€‰æ‹©æ•°æ®åº“å’Œlogä½ç½®"></p><p><img src="/loading.gif" data-original="/images/java/mongodb-next.png" alt="next"></p><p><img src="/loading.gif" data-original="/images/java/mongodb-next2.png" alt="next"></p><p>æ‰§è¡Œ<code>mongod --dbpath D:\MongoDB\data\db --logpath=D:\MongoDB\log\mongodb.log --logappend</code>å¯åŠ¨mongodb</p><p><img src="/loading.gif" data-original="/images/java/mongodb-start.png" alt="å¯åŠ¨mongodb"></p><p><img src="/loading.gif" data-original="/images/java/mongodb-connect.png" alt="å‘½ä»¤è¡Œé“¾æ¥"></p><p><img src="/loading.gif" data-original="/images/java/mongodb-test.png" alt="æµ‹è¯•å¯åŠ¨"></p><p>7ã€mongodbæ•°æ®åº“é…ç½®mongodbï¼Œåœ¨application.propertiesé‡Œæ·»åŠ å¦‚ä¸‹é…ç½®</p><pre class="line-numbers language-shell"><code class="language-shell">spring.data.mongodb.uri=mongodb://localhost:27017/webflux<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>8ã€å¯åŠ¨é¡¹ç›®å¹¶ç”¨å®¢æˆ·ç«¯è®¿é—®éªŒè¯<br><img src="/loading.gif" data-original="/images/java/mongodb-project-connect.png" alt="http://127.0.0.1:8080/user"></p><p><img src="/loading.gif" data-original="/images/java/mongodb-no-connect.png" alt="http://127.0.0.1:8080/user/stream/all"></p><p>åç»­åŠ å…¥CURDçš„æ™®é€šæ¥å£å’Œstreamæ¥å£ã€‚<br>æ·»åŠ validation<br>å‚æ•°checkï¼Œç»Ÿä¸€exceptionæŠ›å‡ºåŠåˆ‡é¢æ‹¦æˆªã€‚<br>å…·ä½“ä»£ç å‚è€ƒ<a href=""></a><br>å…¨å±€å¼‚å¸¸ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-10 22:54 * @desc ${DESCRIPTION} **/</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CheckException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 1L<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * å‡ºé”™å­—æ®µçš„åå­—     */</span>    <span class="token keyword">private</span> String fieldName<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * å‡ºé”™å­—æ®µçš„å€¼     */</span>    <span class="token keyword">private</span> String fieldValue<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">CheckException</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token function">CheckException</span><span class="token punctuation">(</span>String message<span class="token punctuation">,</span> Throwable cause<span class="token punctuation">,</span>            <span class="token keyword">boolean</span> enableSuppression<span class="token punctuation">,</span> <span class="token keyword">boolean</span> writableStackTrace<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> cause<span class="token punctuation">,</span> enableSuppression<span class="token punctuation">,</span> writableStackTrace<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token function">CheckException</span><span class="token punctuation">(</span>String message<span class="token punctuation">,</span> Throwable cause<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> cause<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token function">CheckException</span><span class="token punctuation">(</span>String message<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token function">CheckException</span><span class="token punctuation">(</span>Throwable cause<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>cause<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token function">CheckException</span><span class="token punctuation">(</span>String fieldName<span class="token punctuation">,</span> String fieldValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>fieldName <span class="token operator">=</span> fieldName<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>fieldValue <span class="token operator">=</span> fieldValue<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‚æ•°æ£€æŸ¥å…¬ç”¨æ–¹æ³•ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>marvin<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>webflux<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>exception<span class="token punctuation">.</span>CheckException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>Stream<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-10 22:53 * @desc tool **/</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CheckUtil</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> INVALID_NAMES <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"guanliyuan"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * ç”¨æˆ·åæ ¡éªŒï¼Œä¸æˆåŠŸæ—¶æŠ›å‡ºå¼‚å¸¸     * @param value     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">checkUserName</span><span class="token punctuation">(</span>String value<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Stream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>INVALID_NAMES<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>name <span class="token operator">-</span><span class="token operator">></span> name<span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">findAny</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span>name <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CheckException</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¼‚å¸¸æ‹¦æˆªåˆ‡é¢ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>marvin<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>webflux<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>exception<span class="token punctuation">.</span>CheckException<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpStatus<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>ResponseEntity<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ControllerAdvice<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ExceptionHandler<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>support<span class="token punctuation">.</span>WebExchangeBindException<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-10 22:43 * @desc å¼‚å¸¸å¤„ç†åˆ‡é¢ **/</span><span class="token annotation punctuation">@ControllerAdvice</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CheckAdvice</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>WebExchangeBindException<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> ResponseEntity <span class="token function">handleBindException</span><span class="token punctuation">(</span>WebExchangeBindException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token function">toStr</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span> HttpStatus<span class="token punctuation">.</span>BAD_REQUEST<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>CheckException<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> ResponseEntity <span class="token function">handleBindException</span><span class="token punctuation">(</span>CheckException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token function">toStr</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span> HttpStatus<span class="token punctuation">.</span>BAD_REQUEST<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * æŠŠæ ¡éªŒå¼‚å¸¸è½¬æ¢æˆå­—ç¬¦ä¸²     * @param ex     * @return     */</span>    <span class="token keyword">private</span> String <span class="token function">toStr</span><span class="token punctuation">(</span>WebExchangeBindException ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> ex<span class="token punctuation">.</span><span class="token function">getFieldErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>e <span class="token operator">-</span><span class="token operator">></span> e<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> s1 <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * æŠŠæ ¡éªŒå¼‚å¸¸è½¬æ¢æˆå­—ç¬¦ä¸²     * @param ex     * @return     */</span>    <span class="token keyword">private</span> String <span class="token function">toStr</span><span class="token punctuation">(</span>CheckException ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> ex<span class="token punctuation">.</span><span class="token function">getFieldName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":é”™è¯¯çš„å€¼ "</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span><span class="token function">getFieldValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>controllerå±‚åŠ æ ¡éªŒï¼š</p><pre class="line-numbers language-java"><code class="language-java"> <span class="token comment" spellcheck="true">/**     * ä¿®æ”¹æ•°æ®     * å­˜åœ¨çš„æ—¶å€™è¿”å›200ï¼Œæ•°æ®ä¸å­˜åœ¨çš„è¯è¿”å›404     */</span>    <span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span><span class="token string">"/{id}"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> Mono<span class="token operator">&lt;</span>ResponseEntity<span class="token operator">&lt;</span>User<span class="token operator">>></span> <span class="token function">updateUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> String id<span class="token punctuation">,</span> <span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> User user<span class="token punctuation">)</span> <span class="token punctuation">{</span>        CheckUtil<span class="token punctuation">.</span><span class="token function">checkUserName</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">//flatMatï¼š æ“ä½œæ•°æ®</span>            <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>u <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span>                u<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                u<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">//mapï¼šè½¬æ¢æ•°æ®</span>            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>u <span class="token operator">-</span><span class="token operator">></span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> HttpStatus<span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">defaultIfEmpty</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>HttpStatus<span class="token punctuation">.</span>NOT_FOUND<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š<br><img src="/loading.gif" data-original="/images/java/mongodb-pug.png" alt="å‚æ•°æ ¡éªŒ"></p><ul><li>5.3 RouterFunctionæ¨¡å¼<br><strong>å®ç°åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥</strong><br>é™¤äº†ä¸Šä¸€èŠ‚çš„Userå®ä½“ç±»ï¼Œå’ŒUserRepositoryæ¥å£ç±»ä¸¤ä¸ªï¼Œæ–°å»ºä¸€ä¸ªUserHandlerç±»ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>marvin<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>webfluxrouter<span class="token punctuation">.</span>router<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>User<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>marvin<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>webfluxrouter<span class="token punctuation">.</span>router<span class="token punctuation">.</span>repository<span class="token punctuation">.</span>UserRepository<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>MediaType<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Component<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span>function<span class="token punctuation">.</span>server<span class="token punctuation">.</span>ServerRequest<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span>function<span class="token punctuation">.</span>server<span class="token punctuation">.</span>ServerResponse<span class="token punctuation">;</span><span class="token keyword">import</span> reactor<span class="token punctuation">.</span>core<span class="token punctuation">.</span>publisher<span class="token punctuation">.</span>Mono<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Resource<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-26 22:32 * @desc UserHandler  **/</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserHandler</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> UserRepository userRepository<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * å¾—åˆ°æ‰€æœ‰ç”¨æˆ·     * @param request     * @return     */</span>    <span class="token keyword">public</span> Mono<span class="token operator">&lt;</span>ServerResponse<span class="token operator">></span> <span class="token function">getAllUser</span><span class="token punctuation">(</span>ServerRequest request<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> ServerResponse<span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span>MediaType<span class="token punctuation">.</span>APPLICATION_JSON_UTF8<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span>userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> User<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * åˆ›å»ºç”¨æˆ·     * @param request     * @return     */</span>    <span class="token keyword">public</span> Mono<span class="token operator">&lt;</span>ServerResponse<span class="token operator">></span> <span class="token function">createUser</span><span class="token punctuation">(</span>ServerRequest request<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Mono<span class="token operator">&lt;</span>User<span class="token operator">></span> user <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">bodyToMono</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ServerResponse<span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span>MediaType<span class="token punctuation">.</span>APPLICATION_JSON_UTF8<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span>userRepository<span class="token punctuation">.</span><span class="token function">saveAll</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">,</span> User<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * æ ¹æ®idåˆ é™¤ç”¨æˆ·     * @param request     * @return     */</span>    <span class="token keyword">public</span> Mono<span class="token operator">&lt;</span>ServerResponse<span class="token operator">></span> <span class="token function">deleteUserById</span><span class="token punctuation">(</span>ServerRequest request<span class="token punctuation">)</span> <span class="token punctuation">{</span>        String id <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">pathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>user <span class="token operator">-</span><span class="token operator">></span>            <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>ServerResponse<span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">switchIfEmpty</span><span class="token punctuation">(</span>ServerResponse<span class="token punctuation">.</span><span class="token function">notFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨åˆ›å»ºä¸€ä¸ªAllRoutersç±»ï¼Œå¹¶ä¸”ç±»ä¼¼é€šå¸¸å†™çš„RequestMappingï¼Œå¤„ç†URLè·¯ç”±ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>marvin<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>webfluxrouter<span class="token punctuation">.</span>router<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>UserHandler<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Bean<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>MediaType<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span>function<span class="token punctuation">.</span>server<span class="token punctuation">.</span>RequestPredicates<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span>function<span class="token punctuation">.</span>server<span class="token punctuation">.</span>RouterFunction<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span>function<span class="token punctuation">.</span>server<span class="token punctuation">.</span>RouterFunctions<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span>function<span class="token punctuation">.</span>server<span class="token punctuation">.</span>ServerResponse<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-26 22:45 * @desc è·¯ç”± **/</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AllRouters</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Bean</span>    RouterFunction<span class="token operator">&lt;</span>ServerResponse<span class="token operator">></span> <span class="token function">userRouter</span><span class="token punctuation">(</span>UserHandler handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> RouterFunctions<span class="token punctuation">.</span><span class="token function">nest</span><span class="token punctuation">(</span>          <span class="token comment" spellcheck="true">//ç›¸å½“äºç±»ä¸Šé¢çš„@RequestMapping("/user")</span>          RequestPredicates<span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token comment" spellcheck="true">//ç›¸å½“äºæ–¹æ³•ä¸Šé¢çš„@RequestMappingï¼Œè·å–æ‰€æœ‰ç”¨æˆ·</span>                RouterFunctions<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span>RequestPredicates<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> handler<span class="token operator">:</span><span class="token operator">:</span>getAllUser<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">//æ·»åŠ ç”¨æˆ·</span>                <span class="token punctuation">.</span><span class="token function">andRoute</span><span class="token punctuation">(</span>RequestPredicates<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>RequestPredicates<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>MediaType<span class="token punctuation">.</span>APPLICATION_JSON_UTF8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> handler<span class="token operator">:</span><span class="token operator">:</span>createUser<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">//åˆ é™¤ç”¨æˆ·</span>                <span class="token punctuation">.</span><span class="token function">andRoute</span><span class="token punctuation">(</span>RequestPredicates<span class="token punctuation">.</span><span class="token function">DELETE</span><span class="token punctuation">(</span><span class="token string">"/{id}"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> handler<span class="token operator">:</span><span class="token operator">:</span>deleteUserById<span class="token punctuation">)</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç¨‹åºï¼Œå¹¶ä¸”æ·»åŠ ï¼Œåˆ—è¡¨ï¼Œåˆ é™¤æ¥å£ï¼Œå®Œç¾~~~</p><p><strong>å®ç°æ•°æ®æ ¡éªŒåŠŸèƒ½</strong><br>ä»ç„¶ä½¿ç”¨ä¸Šä¸€èŠ‚ä¸­çš„<code>CheckException</code>å’Œ<code>CheckUtil</code>ä¸¤ä¸ªç±»ã€‚<br>ä¿®æ”¹UserHanderï¼š</p><pre><code></code></pre>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> springboot </tag>
            
            <tag> webflux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux ä¸Šæˆ‘å¸¸ç”¨çš„å‡ ç§nginxé…ç½®</title>
      <link href="2019/01/08/linux-shang-wo-chang-yong-de-ji-chong-nginx-pei-zhi/"/>
      <url>2019/01/08/linux-shang-wo-chang-yong-de-ji-chong-nginx-pei-zhi/</url>
      
        <content type="html"><![CDATA[<p>å·¥ä½œä¸­å¸¸ç”¨çš„nginxé…ç½®å¤‡å¿˜å½•<br><a href="https://www.jianshu.com/p/a6472181e6be">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>nginxä½œä¸ºç”¨çƒ‚äº†çš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œè¿™ä¸¤å¹´ç»æ‰‹çš„é¡¹ç›®ä¹Ÿæ˜¯å„ç§é…ç½®ï¼Œå„ç§å­¦ä¹ ï¼Œå†æ¬¡è®°å½•ä¸‹è¿˜èƒ½æƒ³çš„èµ·æ¥æˆ–è€…æœ‰æ®å¯æŸ¥çš„nginxé…ç½®ï¼Œä»¥é˜²å“ªå¤©æ‰å‘é‡Œæ—¶è¿˜æœ‰ä¸€æ ¹æ•‘å‘½ç¨»è‰ã€‚</p><h3 id="å‰ç½®"><a href="#å‰ç½®" class="headerlink" title="å‰ç½®"></a>å‰ç½®</h3><p>ä¸ªäººçˆ±å¥½çš„åŸå› ï¼Œæˆ‘çš„nginxä¸€èˆ¬å®‰è£…åœ¨<code>/usr/local/nginx</code>è¿™ä¸ªç›®å½•ï¼Œä¸»é…ç½®æ–‡ä»¶<code>/usr/local/nginx/conf/nginx.conf</code>ï¼Œå…¶ä»–é…ç½®æ–‡ä»¶åˆ™æ˜¯åœ¨<code>/usr/local/nginx/conf/conf.d/*.conf</code>è¿™äº›å•ç‹¬çš„æ–‡ä»¶ä¸Šã€‚<br>è¿™äº›conf.dç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶è¦åœ¨nginx.confä¸­è¢«å¼•å…¥ï¼Œå› æ­¤nginx.confæ–‡ä»¶æœ€åä¸€è¡Œæœ‰è¿™ä¹ˆä¸€å¥</p><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token keyword">include</span> conf<span class="token punctuation">.</span>d<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="1ã€ä¸€ä¸ªåŸŸåï¼Œå¤šä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®"><a href="#1ã€ä¸€ä¸ªåŸŸåï¼Œå¤šä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®" class="headerlink" title="1ã€ä¸€ä¸ªåŸŸåï¼Œå¤šä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®"></a>1ã€ä¸€ä¸ªåŸŸåï¼Œå¤šä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®</h3><p>è¿™ç§æƒ…å†µæ˜¯æœ€ç†æƒ³ï¼Œæœ€å¥½é…ç½®çš„ï¼Œä½†æ˜¯ä¹Ÿæ˜¯æœ€æ²¡æœ‰å•¥å¯è¯´çš„ä¸€ç§ï¼Œä¸è¿‡æˆ‘è¿˜çš„æ˜¯copyä¸€ä¸ªè®°å½•ä¸€ä¸‹å§ã€‚<br>æ¯”å¦‚conf.dä¸‹æœ‰å‡ ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¤§æ¦‚è¿™æ ·ï¼š</p><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token punctuation">[</span>haieradmin@1169CKT2 conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ lltotal <span class="token number">20</span><span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span> <span class="token number">1</span> haieradmin haieradmin  <span class="token number">828</span> Mar  <span class="token number">7</span>  <span class="token number">2018</span> hrsj<span class="token number">.15386</span><span class="token punctuation">.</span>conf<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span> <span class="token number">1</span> haieradmin haieradmin  <span class="token number">827</span> Mar  <span class="token number">7</span>  <span class="token number">2018</span> hryh<span class="token number">.10386</span><span class="token punctuation">.</span>conf<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span> <span class="token number">1</span> haieradmin haieradmin <span class="token number">1166</span> Nov <span class="token number">22</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">49</span> html<span class="token number">.8880</span><span class="token punctuation">.</span>conf<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span> <span class="token number">1</span> haieradmin haieradmin <span class="token number">1022</span> Jul <span class="token number">16</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">50</span> portal<span class="token number">.8886</span><span class="token punctuation">.</span>conf<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span> <span class="token number">1</span> haieradmin haieradmin  <span class="token number">846</span> Jul <span class="token number">13</span>  <span class="token number">2018</span> questionnaire<span class="token number">.8081</span><span class="token punctuation">.</span>conf<span class="token punctuation">[</span>haieradmin@1169CKT2 conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ pwd<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>conf<span class="token punctuation">.</span>d<span class="token punctuation">[</span>haieradmin@1169CKT2 conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥çœ‹å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼š</p><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token punctuation">[</span>haieradmin@1169CKT2 conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ cat hrsj<span class="token number">.15386</span><span class="token punctuation">.</span>conf <span class="token keyword">server</span>    <span class="token punctuation">{</span>        <span class="token keyword">listen</span>       <span class="token number">15386</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">#server_name  tech.haier.net;</span>        <span class="token comment" spellcheck="true">#ssl                  on;</span>        <span class="token comment" spellcheck="true">#ssl_certificate      /usr/local/nginx/key/server.crt;</span>        <span class="token comment" spellcheck="true">#ssl_certificate_key  /usr/local/nginx/key/server.key;</span>        <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>        <span class="token keyword">root</span> <span class="token operator">/</span>opt<span class="token operator">/</span>chuangke<span class="token operator">/</span>website<span class="token operator">/</span>hrsj<span class="token punctuation">;</span>        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>            <span class="token keyword">client_max_body_size</span>    100M<span class="token punctuation">;</span>            <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token punctuation">)</span>$        <span class="token punctuation">{</span>            <span class="token keyword">expires</span>      30d<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>js<span class="token operator">|</span>css<span class="token punctuation">)</span><span class="token operator">?</span>$        <span class="token punctuation">{</span>            <span class="token keyword">expires</span>      12h<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>\<span class="token punctuation">.</span>        <span class="token punctuation">{</span>            <span class="token keyword">deny</span> all<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">error_page</span>  <span class="token number">404</span>              <span class="token operator">/</span><span class="token number">404</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>        <span class="token keyword">access_log</span>  <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>hrsj<span class="token punctuation">.</span>host<span class="token punctuation">.</span>access<span class="token punctuation">.</span>log<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">[</span>haieradmin@1169CKT2 conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä»–å‡ ä¸ªé…ç½®æ–‡ä»¶çŸ¥è¯†é‡Œé¢listençš„ç«¯å£å’Œrootç›®å½•ä¸ä¸€æ ·ã€‚</p><h3 id="2ã€ä¸€ä¸ªåŸŸåï¼Œä¸€ä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®ï¼Œè®¿é—®æ—¶ç”¨äºŒçº§ç›®å½•åç§°åŒºåˆ†"><a href="#2ã€ä¸€ä¸ªåŸŸåï¼Œä¸€ä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®ï¼Œè®¿é—®æ—¶ç”¨äºŒçº§ç›®å½•åç§°åŒºåˆ†" class="headerlink" title="2ã€ä¸€ä¸ªåŸŸåï¼Œä¸€ä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®ï¼Œè®¿é—®æ—¶ç”¨äºŒçº§ç›®å½•åç§°åŒºåˆ†"></a>2ã€ä¸€ä¸ªåŸŸåï¼Œä¸€ä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®ï¼Œè®¿é—®æ—¶ç”¨äºŒçº§ç›®å½•åç§°åŒºåˆ†</h3><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token punctuation">[</span>haieradmin@1169CKT conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ lltotal <span class="token number">8</span><span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span> <span class="token number">1</span> <span class="token keyword">root</span> <span class="token keyword">root</span> <span class="token number">1594</span> Jun <span class="token number">26</span>  <span class="token number">2018</span> nginx_8086_to_5601<span class="token punctuation">.</span>conf<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span> <span class="token number">1</span> <span class="token keyword">root</span> <span class="token keyword">root</span> <span class="token number">1592</span> Jun <span class="token number">28</span>  <span class="token number">2018</span> nginx_8888_gitstats<span class="token punctuation">.</span>conf<span class="token punctuation">[</span>haieradmin@1169CKT conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥çœ‹é…ç½®æ–‡ä»¶</p><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token punctuation">[</span>haieradmin@1169CKT conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ cat nginx_8888_gitstats<span class="token punctuation">.</span>conf     <span class="token keyword">server</span> <span class="token punctuation">{</span>        <span class="token keyword">listen</span>       <span class="token number">8888</span><span class="token punctuation">;</span>        <span class="token keyword">server_name</span>  localhost<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">#charset koi8-r;</span>        <span class="token comment" spellcheck="true">#access_log  logs/host.access.log  main;</span>        <span class="token comment" spellcheck="true">#location / {</span>        <span class="token comment" spellcheck="true">#    root   html;</span>        <span class="token comment" spellcheck="true">#    index  index.html index.htm;</span>        <span class="token comment" spellcheck="true">#}</span>        <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm<span class="token punctuation">;</span>        <span class="token keyword">client_max_body_size</span>    100m<span class="token punctuation">;</span>            <span class="token keyword">location</span> <span class="token operator">/</span>questionnaire <span class="token punctuation">{</span>            <span class="token keyword">alias</span>  <span class="token operator">/</span>opt<span class="token operator">/</span>chuangke<span class="token operator">/</span>gitstats<span class="token operator">/</span>result<span class="token operator">/</span>questionnaire<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">location</span> <span class="token operator">/</span>portal <span class="token punctuation">{</span>            <span class="token keyword">alias</span>  <span class="token operator">/</span>opt<span class="token operator">/</span>chuangke<span class="token operator">/</span>gitstats<span class="token operator">/</span>result<span class="token operator">/</span>Portal<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">location</span> <span class="token operator">/</span>portalmanage <span class="token punctuation">{</span>            <span class="token keyword">alias</span>  <span class="token operator">/</span>opt<span class="token operator">/</span>chuangke<span class="token operator">/</span>gitstats<span class="token operator">/</span>result<span class="token operator">/</span>portalmanage<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">error_page</span>  <span class="token number">404</span>              <span class="token operator">/</span><span class="token number">404</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true"># redirect server error pages to the static page /50x.html</span>        <span class="token comment" spellcheck="true">#</span>        <span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  <span class="token operator">/</span>50x<span class="token punctuation">.</span>html<span class="token punctuation">;</span>        <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span>50x<span class="token punctuation">.</span>html <span class="token punctuation">{</span>            <span class="token keyword">root</span>   html<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span>        <span class="token comment" spellcheck="true">#</span>        <span class="token comment" spellcheck="true">#location ~ \.php$ {</span>        <span class="token comment" spellcheck="true">#    proxy_pass   http://127.0.0.1;</span>        <span class="token comment" spellcheck="true">#}</span>        <span class="token comment" spellcheck="true"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span>        <span class="token comment" spellcheck="true">#</span>        <span class="token comment" spellcheck="true">#location ~ \.php$ {</span>        <span class="token comment" spellcheck="true">#    root           html;</span>        <span class="token comment" spellcheck="true">#    fastcgi_pass   127.0.0.1:9000;</span>        <span class="token comment" spellcheck="true">#    fastcgi_index  index.php;</span>        <span class="token comment" spellcheck="true">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span>        <span class="token comment" spellcheck="true">#    include        fastcgi_params;</span>        <span class="token comment" spellcheck="true">#}</span>        <span class="token comment" spellcheck="true"># deny access to .htaccess files, if Apache's document root</span>        <span class="token comment" spellcheck="true"># concurs with nginx's one</span>        <span class="token comment" spellcheck="true">#</span>        <span class="token comment" spellcheck="true">#location ~ /\.ht {</span>        <span class="token comment" spellcheck="true">#    deny  all;</span>        <span class="token comment" spellcheck="true">#}</span>    <span class="token punctuation">}</span><span class="token punctuation">[</span>haieradmin@1169CKT conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®çš„æ—¶å€™å¦‚ï¼š<br><code>http://localhost:8888/portalmanage</code>å’Œ<code>http://localhost:8888/portal</code>ç­‰ã€‚</p><h3 id="3ã€å¤šä¸ªåŸŸåï¼Œä¸€ä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®"><a href="#3ã€å¤šä¸ªåŸŸåï¼Œä¸€ä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®" class="headerlink" title="3ã€å¤šä¸ªåŸŸåï¼Œä¸€ä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®"></a>3ã€å¤šä¸ªåŸŸåï¼Œä¸€ä¸ªç«¯å£ï¼Œå¤šä¸ªé¡¹ç›®</h3><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token punctuation">[</span><span class="token keyword">root</span>@im<span class="token operator">-</span>test<span class="token operator">-</span>cpr<span class="token number">-1</span> nginx<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># cat nginx.conf</span><span class="token comment" spellcheck="true">#   * Official Russian Documentation: http://nginx.org/ru/docs/</span><span class="token keyword">user</span> <span class="token keyword">root</span><span class="token punctuation">;</span><span class="token keyword">worker_processes</span> auto<span class="token punctuation">;</span><span class="token keyword">error_log</span> <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>error<span class="token punctuation">.</span>log<span class="token punctuation">;</span><span class="token keyword">pid</span> <span class="token operator">/</span>run<span class="token operator">/</span>nginx<span class="token punctuation">.</span><span class="token keyword">pid</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"># Load dynamic modules. See /usr/share/nginx/README.dynamic.</span><span class="token keyword">include</span> <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>modules<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span><span class="token keyword">events</span> <span class="token punctuation">{</span>    <span class="token keyword">worker_connections</span> <span class="token number">1024</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">http</span> <span class="token punctuation">{</span>    <span class="token keyword">log_format</span>  main  <span class="token string">'$remote_addr - $remote_user [$time_local] "$request" '</span>                      <span class="token string">'$status $body_bytes_sent "$http_referer" '</span>                      <span class="token string">'"$http_user_agent" "$http_x_forwarded_for"'</span><span class="token punctuation">;</span>    <span class="token keyword">access_log</span>  <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>access<span class="token punctuation">.</span>log  main<span class="token punctuation">;</span>    <span class="token keyword">sendfile</span>            on<span class="token punctuation">;</span>    <span class="token keyword">tcp_nopush</span>          on<span class="token punctuation">;</span>    <span class="token keyword">tcp_nodelay</span>         on<span class="token punctuation">;</span>    <span class="token keyword">keepalive_timeout</span>   <span class="token number">65</span><span class="token punctuation">;</span>    <span class="token keyword">types_hash_max_size</span> <span class="token number">2048</span><span class="token punctuation">;</span>    <span class="token keyword">include</span>             <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>mime<span class="token punctuation">.</span><span class="token keyword">types</span><span class="token punctuation">;</span>    <span class="token keyword">default_type</span>        application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># Load modular configuration files from the /etc/nginx/conf.d directory.</span>    <span class="token comment" spellcheck="true"># See http://nginx.org/en/docs/ngx_core_module.html#include</span>    <span class="token comment" spellcheck="true"># for more information.</span>    <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span>    <span class="token keyword">upstream</span> server1 <span class="token punctuation">{</span>        <span class="token keyword">server</span> <span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token punctuation">:</span><span class="token number">8890</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">upstream</span> server2 <span class="token punctuation">{</span>        <span class="token keyword">server</span> <span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token punctuation">:</span><span class="token number">5151</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">server</span> <span class="token punctuation">{</span>        <span class="token keyword">listen</span>       <span class="token number">5050</span> default_server <span class="token keyword">ssl</span><span class="token punctuation">;</span>        <span class="token keyword">listen</span>       <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">5050</span> default_server<span class="token punctuation">;</span>        <span class="token keyword">server_name</span>  _<span class="token punctuation">;</span>        <span class="token keyword">root</span>         <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token punctuation">;</span>        <span class="token keyword">ssl_certificate</span> <span class="token string">"/etc/pki/nginx/server.crt"</span><span class="token punctuation">;</span>        <span class="token keyword">ssl_certificate_key</span> <span class="token string">"/etc/pki/nginx/private/server.key"</span><span class="token punctuation">;</span>        <span class="token keyword">ssl_session_cache</span> shared<span class="token punctuation">:</span><span class="token keyword">SSL</span><span class="token punctuation">:</span>1m<span class="token punctuation">;</span>        <span class="token keyword">ssl_session_timeout</span>  10m<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true"># Load configuration files for the default server block.</span>        <span class="token keyword">include</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>default<span class="token punctuation">.</span>d<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>conf<span class="token punctuation">;</span>        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>            <span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span><span class="token punctuation">:</span><span class="token variable">$server_port</span><span class="token punctuation">;</span>            <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Real<span class="token operator">-</span>IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>            <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>            <span class="token keyword">proxy_connect_timeout</span> <span class="token number">90</span><span class="token punctuation">;</span>            <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Origin <span class="token variable">$http_origin</span><span class="token punctuation">;</span>            <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Methods <span class="token string">'GET, POST, PUT, DELETE, OPTIONS'</span><span class="token punctuation">;</span>            <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Credentials <span class="token string">'true'</span><span class="token punctuation">;</span>            <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Headers <span class="token string">'Accept, Authorization,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type'</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$request_method</span> <span class="token operator">=</span> <span class="token string">'OPTIONS'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token keyword">add_header</span> <span class="token string">'Access-Control-Max-Age'</span> <span class="token number">1728000</span><span class="token punctuation">;</span>               <span class="token keyword">add_header</span> <span class="token string">'Content-Type'</span> <span class="token string">'text/plain charset=UTF-8'</span><span class="token punctuation">;</span>               <span class="token keyword">add_header</span> <span class="token string">'Content-Length'</span> <span class="token number">0</span><span class="token punctuation">;</span>               <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Origin <span class="token variable">$http_origin</span><span class="token punctuation">;</span>               <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Methods <span class="token string">'GET, POST, PUT, DELETE, OPTIONS'</span><span class="token punctuation">;</span>               <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Credentials <span class="token string">'true'</span><span class="token punctuation">;</span>               <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Headers <span class="token string">'Accept, Authorization,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type'</span><span class="token punctuation">;</span>               <span class="token keyword">return</span> <span class="token number">204</span><span class="token punctuation">;</span>           <span class="token punctuation">}</span>                <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>server2<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">error_page</span> <span class="token number">404</span> <span class="token operator">/</span><span class="token number">404</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>            <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span>40x<span class="token punctuation">.</span>html <span class="token punctuation">{</span>        <span class="token punctuation">}</span>        <span class="token keyword">error_page</span> <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span> <span class="token operator">/</span>50x<span class="token punctuation">.</span>html<span class="token punctuation">;</span>            <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span>50x<span class="token punctuation">.</span>html <span class="token punctuation">{</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">server</span> <span class="token punctuation">{</span>        <span class="token keyword">listen</span>       <span class="token number">8443</span> <span class="token keyword">ssl</span><span class="token punctuation">;</span>        <span class="token keyword">server_name</span>  sysadmint<span class="token punctuation">.</span>rrs<span class="token punctuation">.</span>com<span class="token punctuation">;</span>        <span class="token keyword">root</span>         <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token operator">/</span>sysadmin<span class="token operator">/</span><span class="token punctuation">;</span>        <span class="token keyword">ssl_certificate</span> <span class="token string">"/etc/pki/nginx/server.crt"</span><span class="token punctuation">;</span>        <span class="token keyword">ssl_certificate_key</span> <span class="token string">"/etc/pki/nginx/private/server.key"</span><span class="token punctuation">;</span>        <span class="token keyword">ssl_session_cache</span> shared<span class="token punctuation">:</span><span class="token keyword">SSL</span><span class="token punctuation">:</span>1m<span class="token punctuation">;</span>        <span class="token keyword">ssl_session_timeout</span>  10m<span class="token punctuation">;</span>        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token operator">|</span>js<span class="token operator">|</span>css<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>                <span class="token keyword">add_header</span> Cache<span class="token operator">-</span>Control no<span class="token operator">-</span>store<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>            <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">server</span> <span class="token punctuation">{</span>        <span class="token keyword">listen</span>       <span class="token number">8443</span> <span class="token keyword">ssl</span><span class="token punctuation">;</span>        <span class="token keyword">server_name</span>  opadmint<span class="token punctuation">.</span>rrs<span class="token punctuation">.</span>com<span class="token punctuation">;</span>        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token operator">|</span>js<span class="token operator">|</span>css<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>                <span class="token keyword">add_header</span> Cache<span class="token operator">-</span>Control no<span class="token operator">-</span>store<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">root</span>         <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token operator">/</span>opadmin<span class="token operator">/</span><span class="token punctuation">;</span>        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>            <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">ssl_certificate</span> <span class="token string">"/etc/pki/nginx/server.crt"</span><span class="token punctuation">;</span>        <span class="token keyword">ssl_certificate_key</span> <span class="token string">"/etc/pki/nginx/private/server.key"</span><span class="token punctuation">;</span>        <span class="token keyword">ssl_session_cache</span> shared<span class="token punctuation">:</span><span class="token keyword">SSL</span><span class="token punctuation">:</span>1m<span class="token punctuation">;</span>        <span class="token keyword">ssl_session_timeout</span>  10m<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">server</span> <span class="token punctuation">{</span>        <span class="token keyword">listen</span>       <span class="token number">8443</span> <span class="token keyword">ssl</span><span class="token punctuation">;</span>        <span class="token keyword">server_name</span>  shopadmint<span class="token punctuation">.</span>rrs<span class="token punctuation">.</span>com<span class="token punctuation">;</span>        <span class="token keyword">root</span>         <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token operator">/</span>shopadmin<span class="token operator">/</span><span class="token punctuation">;</span>        <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token operator">|</span>js<span class="token operator">|</span>css<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>                <span class="token keyword">add_header</span> Cache<span class="token operator">-</span>Control no<span class="token operator">-</span>store<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>            <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">ssl_certificate</span> <span class="token string">"/etc/pki/nginx/server.crt"</span><span class="token punctuation">;</span>        <span class="token keyword">ssl_certificate_key</span> <span class="token string">"/etc/pki/nginx/private/server.key"</span><span class="token punctuation">;</span>        <span class="token keyword">ssl_session_cache</span> shared<span class="token punctuation">:</span><span class="token keyword">SSL</span><span class="token punctuation">:</span>1m<span class="token punctuation">;</span>        <span class="token keyword">ssl_session_timeout</span>  10m<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token keyword">root</span>@im<span class="token operator">-</span>test<span class="token operator">-</span>cpr<span class="token number">-1</span> nginx<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®ï¼šhost name+8443ç«¯å£å·</p><h3 id="4ã€å°†æ”¶åˆ°çš„æœåŠ¡è½¬å‘ç»™åˆ«çš„æœåŠ¡"><a href="#4ã€å°†æ”¶åˆ°çš„æœåŠ¡è½¬å‘ç»™åˆ«çš„æœåŠ¡" class="headerlink" title="4ã€å°†æ”¶åˆ°çš„æœåŠ¡è½¬å‘ç»™åˆ«çš„æœåŠ¡"></a>4ã€å°†æ”¶åˆ°çš„æœåŠ¡è½¬å‘ç»™åˆ«çš„æœåŠ¡</h3><p>æ¯”å¦‚æ¥å—ç«¯å£æ¥å—çš„ç«¯å£æ˜¯8086ï¼Œä½†æ˜¯æ˜ å°„åè®¿é—®5601çš„èµ„æºã€‚</p><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token punctuation">[</span>haieradmin@1169CKT conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ cat nginx_8086_to_5601<span class="token punctuation">.</span>conf <span class="token keyword">server</span> <span class="token punctuation">{</span>        <span class="token keyword">listen</span>      <span class="token number">8086</span><span class="token punctuation">;</span>        <span class="token keyword">server_name</span>  office<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>net<span class="token punctuation">;</span>        <span class="token keyword">access_log</span>  logs<span class="token operator">/</span><span class="token number">5601</span><span class="token punctuation">.</span>host<span class="token punctuation">.</span>access<span class="token punctuation">.</span>log  main<span class="token punctuation">;</span>        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>            <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token punctuation">:</span><span class="token number">5601</span><span class="token operator">/</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">location</span> <span class="token operator">~</span><span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>bmp<span class="token operator">|</span>swf<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>            <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token punctuation">:</span><span class="token number">5601</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">location</span> <span class="token operator">~</span><span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>js<span class="token operator">|</span>css<span class="token punctuation">)</span><span class="token operator">?</span>$ <span class="token punctuation">{</span>            <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token punctuation">:</span><span class="token number">5601</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>           <span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  <span class="token operator">/</span>50x<span class="token punctuation">.</span>html<span class="token punctuation">;</span>        <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span>50x<span class="token punctuation">.</span>html <span class="token punctuation">{</span>            <span class="token keyword">root</span>   html<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">[</span>haieradmin@1169CKT conf<span class="token punctuation">.</span>d<span class="token punctuation">]</span>$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo+nextä½¿ç”¨Valineè¯„è®ºç³»ç»Ÿ</title>
      <link href="2018/11/24/hexo-bo-ke-shi-yong-valine-ping-lun-xi-tong/"/>
      <url>2018/11/24/hexo-bo-ke-shi-yong-valine-ping-lun-xi-tong/</url>
      
        <content type="html"><![CDATA[<p>åšå®¢è¯„è®ºç³»ç»Ÿä»éŸ©å›½äº§æ¥å¿…åŠ›æ¢æˆå›½äº§Valine<br><a href="https://www.jianshu.com/p/728a9594bb6c">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>åŸæ–‡åœ°å€ï¼š<a href="https://qdhaiqiang.github.io/2018/11/24/hexo%E5%8D%9A%E5%AE%A2%E4%BD%BF%E7%94%A8Valine%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/">hexo+nextä½¿ç”¨Valineè¯„è®ºç³»</a></p><h3 id="æ¥å¿…åŠ›"><a href="#æ¥å¿…åŠ›" class="headerlink" title="æ¥å¿…åŠ›"></a>æ¥å¿…åŠ›</h3><p>åšä¸»åŸæ¥çš„åšå®¢ä½¿ç”¨çš„æ¥å¿…åŠ›ç³»ç»Ÿï¼Œç¡®å®å¡é¡¿å¤ªå‰å®³ã€‚ä½œä¸ºä¸€æšç¨‹åºçŒ¿å²‚èƒ½å…è®¸è¿™ä¹ˆç£¨ç£¨å”§å”§çš„ä¸œè¥¿ä¸€ç›´å­˜åœ¨ï¼Œç”²æ–¹è¯´ä¼˜åŒ–ï¼Œä¼˜åŒ–æ‰ã€‚å› ä¸ºæˆ‘æœ€ä¸å–œæ¬¢åœ¨è¯„è®ºç³»ç»Ÿé‡Œçœ‹åˆ°è¿˜éœ€è¦ç™»å½•è¿™æ ·çš„æ­¥éª¤ã€‚</p><p>å…ˆå±•ç¤ºä¸‹ç°åœ¨çš„ä¸œä¸œ<br><img src="/loading.gif" data-original="/images/blog/laibili.png" alt="è½½å…¥"></p><p>ç»ˆäºå‡ºæ¥äº†ï¼Œè¯„è®ºè¯•è¯•<br><img src="/loading.gif" data-original="/images/blog/laibili2.png" alt="å‘å¸ƒä¸€æ¡è¯„è®ºè¯•è¯•"></p><p>å’¦ï¼Œè¿˜å¾—ç™»é™†ä¸€ä¸‹ï¼Œè¾“ä¸ªé‚®ç®±è¯•è¯•</p><p><img src="/loading.gif" data-original="/images/blog/laibili3.png" alt="æç¤ºç™»å½•.png"></p><p>ä»€ä¹ˆé¬¼ï¼Œé‚£å°±ç™»å½•å§ï¼ï¼ï¼<br><img src="/loading.gif" data-original="/images/blog/laibili4.png" alt="æ”¯æŒå¾ˆå¤šç¬¬ä¸‰æ–¹ç™»å½•"></p><p>çœ‹åˆ°äº†å§ï¼Œä½ å¯ä»¥ç™»é™†äº†ã€‚å™—å™—å™—~<br><img src="/loading.gif" data-original="/images/blog/laibili5.png" alt="ç™»å½•çª—å£"></p><p>è¿˜æ²¡æœ‰æ”¾å¼ƒçš„çœŸæ˜¯æˆ‘å´‡æ‹œçš„å¤§å“¥å•Šã€‚<br>å½“ç„¶ï¼Œåæ§½å½’åæ§½ï¼Œä¹Ÿä¸æ˜¯ä¸€æ— æ˜¯å¤„ï¼Œå½“æ—¶é€‰æ‹©ä¸€æ˜¯æ²¡æœ‰å…¶ä»–å¯é€‰çš„ï¼Œè€Œæ˜¯çœ‹äº†çœ‹æœ‰äº›æˆªå›¾ï¼Œè¿˜ä¸é”™ã€‚æ¯”å¦‚ä¸‹é¢è¿™æ ·çš„ï¼ˆæˆ‘ç”¨githubç¬¬ä¸‰æ–¹ç™»å½•çš„ï¼‰ï¼š<br><img src="/loading.gif" data-original="/images/blog/laibili6.png" alt="è¯„è®º"></p><p>è¾“å…¥æ¡†å³ä¸Šè§’è¿˜æœ‰ä¸ªå°é“ƒé“›ï¼Œç‚¹ç‚¹è¯•è¯•<br><img src="/loading.gif" data-original="/images/blog/laibili8.png" alt="æ‰€æœ‰è¯„è®º"></p><p>æ˜¯å§ï¼Œè¿˜ä¸é”™å§ã€‚å“ˆå“ˆå“ˆã€‚</p><p>å†æ¥çœ‹çœ‹æ¥å¿…åŠ›çš„<a href="https://www.livere.com/">åå°</a>å§ï¼ˆæˆ‘å¯ä»¥è·³è¿‡å¢™ï¼Œæ‰€ä»¥é€Ÿåº¦è¿˜å¯ä»¥ï¼‰<br><img src="/loading.gif" data-original="/images/blog/laibili9.png" alt="åå°"></p><p>æ¯•ç«Ÿæ˜¯å›½é™…åŒ–çš„ï¼Œèƒ½é€‰ä¸­æ–‡ã€‚<br><img src="/loading.gif" data-original="/images/blog/laibili10.png" alt="åˆ†æ"></p><p><img src="/loading.gif" data-original="/images/blog/laibili11.png" alt="è¯„è®ºç®¡ç†"></p><p><img src="/loading.gif" data-original="/images/blog/laibili12.png" alt="è®¾ç½®"></p><p><img src="/loading.gif" data-original="/images/blog/laibili13.png" alt="é€šçŸ¥æé†’"></p><p>åˆ°æ­¤ä¸ºæ­¢å§ã€‚</p><h3 id="ç»™hexoæ·»åŠ Valineè¯„è®ºåŠŸèƒ½"><a href="#ç»™hexoæ·»åŠ Valineè¯„è®ºåŠŸèƒ½" class="headerlink" title="ç»™hexoæ·»åŠ Valineè¯„è®ºåŠŸèƒ½"></a>ç»™hexoæ·»åŠ Valineè¯„è®ºåŠŸèƒ½</h3><p>åé¢äº†è§£åˆ°ä¸€æ¬¾å›½äººå¼€å‘çš„è¯„è®ºç³»ç»Ÿå«Valineç”¨çš„æ˜¯LeanCloudä½œä¸ºæ•°æ®åº“ï¼Œæ´é¢å¾ˆç®€æ´ï¼Œä¸åƒæ¥å¿…åŠ›é‚£æ ·èŠ±å“¨åªæ˜¯å•çº¯çš„è¯„è®ºï¼Œç®€æ´åˆ°æ²¡æœ‰åå°ï¼ï¼ï¼åˆ é™¤å’Œç®¡ç†è¯„è®ºåªèƒ½ç›´æ¥æ“ä½œæ•°æ®åº“ã€‚<br>è¿™é‡Œå†™ä¸‹ä¸ºHexo-Nextæ¨¡æ¿æ·»åŠ Valineçš„è¿‡ç¨‹å’Œå‘ç‚¹ã€‚<br>1.Nextæ¨¡æ¿è¦5.14ï¼ˆå…å»è‡ªå·±æ‰‹åŠ¨ä¿®æ”¹çš„éº»çƒ¦ï¼‰ã€‚ä¸æ˜¯è¿™ä¸ªç‰ˆæœ¬çš„å¯ä»¥è€ƒè™‘å‡çº§æˆ–è€…è‡ªå·±æ‰‹åŠ¨ä¿®æ”¹ï¼Œä¿®æ”¹æ•™ç¨‹åœ¨&nbsp;<a href="https://github.com/iissnan/hexo-theme-next/pull/1983">https://github.com/iissnan/hexo-theme-next/pull/1983</a><br>2.æ³¨å†ŒLeanCloudå¹¶åˆ›å»ºä¸€ä¸ªå¼€å‘ç‰ˆåº”ç”¨ï¼ˆå…è´¹ï¼‰</p><p><img src="/loading.gif" data-original="/images/blog/valine1.jpg" alt="æ³¨å†Œåº”ç”¨"></p><p>3.åœ¨LeanCloud -&gt; å­˜å‚¨ -&gt; åˆ›å»ºClass -&gt; æ— é™åˆ¶çš„Classï¼ˆå‘ç‚¹1ï¼‰<br>classåç§°ä¸ºï¼šComment<br><img src="/loading.gif" data-original="/images/blog/valine2.jpg" alt="LeanCloudåˆ›å»ºClass"></p><p>4.åœ¨LeanCloud-è®¾ç½®-æŠŠé™¤æ•°æ®å­˜å‚¨å…¶ä»–é€‰é¡¹éƒ½å…³é—­ã€‚<br><img src="/loading.gif" data-original="/images/blog/valine3.jpg" alt="LeanCloudè®¾ç½®"></p><p>å®‰å…¨åŸŸåä¸­æ·»åŠ åŸŸåï¼Œä¸€å®šè¦æ³¨æ„æ ¼å¼ï¼ˆå‘ç‚¹2ï¼‰</p><p>ä¾‹å¦‚ï¼š<a href="https://www.nobige.cn/">https://www.nobige.cn:443</a></p><p><img src="/loading.gif" data-original="/images/blog/valine4.jpg" alt="LeanCloudè®¾ç½®2"></p><p>5.åœ¨Nextæ¨¡æ¿ä¸‹çš„*_config.yml<em>æœç´¢</em>Valine*è¿›è¡Œå¡«å†™appidå’Œappkey</p><p><img src="/loading.gif" data-original="/images/blog/valine5.jpg" alt="Next _config.yml"></p><p>åŠŸèƒ½å±•ç¤º</p><p><img src="/loading.gif" data-original="/images/blog/valine6.jpg" alt="ValineåŠŸèƒ½å±•ç¤º"></p><p>ä¸‹é¢è¯´ä¸‹å„ä¸ªé€‰é¡¹çš„å«ä¹‰</p><pre class="line-numbers language-yml"><code class="language-yml"># Valine.# You can get your appid and appkey from https://leancloud.cn# more info please open https://valine.js.orgvaline:  enable: true  appid:    # your leancloud application appid  appkey:    # your leancloud application appkey  notify: true # mail notifier , https://github.com/xCss/Valine/wiki  verify: false # Verification code  placeholder: ãƒ¾ï¾‰â‰§âˆ€â‰¦)o æ¥å‘€ï¼åæ§½ä¸€ç•ªå§ï¼ # comment box placeholder  avatar: mm # gravatar style  guest_info: nick,mail,link # custom comment header  pageSize: 10 # pagination size<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€èˆ¬æ”¹åŠ¨çš„ä¸ºappidå’Œappkeyå…¶ä»–é»˜è®¤å³å¯ï¼Œå¦‚æœè¦å¼€å¯emailé€šçŸ¥é™¤äº†ä¿®æ”¹*_config.yml*æ–‡ä»¶ä¹‹å¤–è¿˜è¦å°†LeanCloud -&gt; è®¾ç½®é‚®ä»¶æ¨¡æ¿ -&gt;&nbsp;<em>ç”¨äºé‡ç½®å¯†ç çš„é‚®ä»¶ä¸»é¢˜</em>è¿›è¡Œä¿®æ”¹</p><p><img src="/loading.gif" data-original="/images/blog/valine7.jpg" alt="LeanCloudè®¾ç½®é‚®ä»¶æ¨¡æ¿"></p><pre class="line-numbers language-html"><code class="language-html">ä½ åœ¨{{appname}} çš„è¯„è®ºæ”¶åˆ°äº†æ–°çš„å›å¤<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Hi, {{username}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>ä½ åœ¨ {{appname}} çš„è¯„è®ºæ”¶åˆ°äº†æ–°çš„å›å¤ï¼Œè¯·ç‚¹å‡»æŸ¥çœ‹ï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ä½ çš„ç½‘å€é¦–é¡µé“¾æ¥<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span>px <span class="token number">20</span>px<span class="token punctuation">;</span> <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">4</span>px<span class="token punctuation">;</span> <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#3090e4</span><span class="token punctuation">;</span> <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#fff</span><span class="token punctuation">;</span> <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>é©¬ä¸ŠæŸ¥çœ‹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="CDNä¿®æ”¹"><a href="#CDNä¿®æ”¹" class="headerlink" title="CDNä¿®æ”¹"></a>CDNä¿®æ”¹</h3><p>å»ºè®®å°†è‡ªå¸¦çš„CDNæ”¹æˆç¬¬ä¸‰æ–¹CDNï¼Œä¸ºå•¥ï¼Ÿï¼Ÿï¼Ÿ10+sçš„åŠ è½½é‚£é…¸çˆ½æ˜¯åœ¨æ˜¯è¿‡ç˜¾ã€‚<br>æ–‡ä»¶ç›®å½•ï¼šnext/layout/_third-party/comments/valine.swig</p><blockquote><p>//cdn.jsdelivr.net/npm/valine/dist/Valine.min.js</p></blockquote><p>å®˜æ–¹çš„CDNæ˜¯</p><blockquote><p>//unpkg.com/valine/dist/Valine.min.js</p></blockquote><p><em>æ›´å¤šé«˜çº§ç”¨æ³•è¯·åˆ°å®˜ç½‘æŸ¥çœ‹&nbsp;<a href="https://valine.js.org/">https://valine.js.org/</a></em></p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo,Valine </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows ä¸Šæ­å»ºclojureå¼€å‘ç¯å¢ƒ</title>
      <link href="2018/11/05/window-shang-da-jian-clojure-kai-fa-huan-jing/"/>
      <url>2018/11/05/window-shang-da-jian-clojure-kai-fa-huan-jing/</url>
      
        <content type="html"><![CDATA[<p>Windowsä¸ŠClojureç¯å¢ƒæ­å»º<br><a href="https://www.jianshu.com/p/27e1fa8fc5cc">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h4 id="1ã€å®‰è£…JDK"><a href="#1ã€å®‰è£…JDK" class="headerlink" title="1ã€å®‰è£…JDK"></a>1ã€å®‰è£…JDK</h4><p>æˆ‘æœ¬åœ°å·²ç»è£…å¥½äº†jdk9ï¼Œæ²¡è£…å¥½çš„è‡ªå·±ç™¾åº¦ä¸‹ï¼Œæ–‡ç« å¤šåˆ°çƒ‚äº†ã€‚<br>ä½¿ç”¨<code>java -version</code>æŸ¥çœ‹æ˜¯å¦å®‰è£…å¦¥å½“ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">C:\Users\marvin>java -versionjava version "9.0.4"Java(TM) SE Runtime Environment (build 9.0.4+11)Java HotSpot(TM) 64-Bit Server VM (build 9.0.4+11, mixed mode)C:\Users\marvin><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2ã€å®‰è£…leiningen-win-installer"><a href="#2ã€å®‰è£…leiningen-win-installer" class="headerlink" title="2ã€å®‰è£…leiningen-win-installer"></a>2ã€å®‰è£…leiningen-win-installer</h4><p><a href="https://djpowell.github.io/leiningen-win-installer/">ç‚¹æˆ‘è¿›å…¥ä¸‹è½½é¡µ</a>ï¼Œæˆ–è€…ç›´æ¥<a href="https://bitbucket.org/djpowell/leiningen-win-installer/downloads/leiningen-installer-1.0.exe">ç‚¹æˆ‘ä¸‹è½½</a>ä¸‹è½½ä¸€ä¸ª.exeçš„windowså¯æ‰§è¡Œæ–‡ä»¶ï¼Œå®‰è£…æ—¶ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œä¸ç„¶å¯èƒ½ç¼ºå°‘self-installsæ–‡ä»¶å¤¹ã€‚<br><img src="/loading.gif" data-original="/images/clojure/leiningen-win-installer.png" alt="leiningen-win-installer.png"></p><h4 id="3ã€è¿è¡Œå®‰è£…å¥½çš„clojure-REPL"><a href="#3ã€è¿è¡Œå®‰è£…å¥½çš„clojure-REPL" class="headerlink" title="3ã€è¿è¡Œå®‰è£…å¥½çš„clojure REPL"></a>3ã€è¿è¡Œå®‰è£…å¥½çš„clojure REPL</h4><p>ä¸å‡ºæ„å¤–çš„è¯ä¼šé—ªé€€ï¼Œé—ªé€€çš„è¯å»cmdè¿è¡Œ <code>lein -version </code>ä¼šæç¤ºä½ è¦å…ˆå®‰è£…ï¼Œå®‰è£…å‘½ä»¤çœ‹æç¤ºï¼Œä½†è¯¥å‘½ä»¤å› ä¸ºæœ‰å¢™åŸºæœ¬ä¸Šéƒ½æ‰§è¡Œä¸äº†ï¼ŒæŒ‰ç…§ä¸‹ä¸€æ­¥å®‰è£…ã€‚</p><h4 id="4ã€æ‰‹åŠ¨é…ç½®leiningen"><a href="#4ã€æ‰‹åŠ¨é…ç½®leiningen" class="headerlink" title="4ã€æ‰‹åŠ¨é…ç½®leiningen"></a>4ã€æ‰‹åŠ¨é…ç½®leiningen</h4><p>å»<a href="https://link.jianshu.com/?t=https://github.com/technomancy/leiningen/releases">https://github.com/technomancy/leiningen/releases</a>ä¸‹è½½[<strong>leiningen-2.8.1-standalone.zip</strong>]ï¼Œæ‰¾åˆ°ä¸Šä¸€æ­¥å®‰è£…leinå®‰è£…ç›®å½•ï¼Œæ”¾åœ¨self-installæ–‡ä»¶å¤¹ä¸‹ï¼ˆC:\Users\marvin\.lein\self-installsï¼‰ï¼ŒæŠŠæ–‡ä»¶åç¼€åæ”¹æˆ.jarã€‚<br><img src="/loading.gif" data-original="/images/clojure/lein-win-setting.png" alt="æ‰‹åŠ¨é…ç½®leiningen"></p><h4 id="5ã€åœ¨cmdä¸­æ‰§è¡Œlein-replå³å¯è¿›å…¥clojureå‘½ä»¤è¡Œï¼Œæ‰§è¡Œlein-repl"><a href="#5ã€åœ¨cmdä¸­æ‰§è¡Œlein-replå³å¯è¿›å…¥clojureå‘½ä»¤è¡Œï¼Œæ‰§è¡Œlein-repl" class="headerlink" title="5ã€åœ¨cmdä¸­æ‰§è¡Œlein replå³å¯è¿›å…¥clojureå‘½ä»¤è¡Œï¼Œæ‰§è¡Œlein repl"></a>5ã€åœ¨cmdä¸­æ‰§è¡Œlein replå³å¯è¿›å…¥clojureå‘½ä»¤è¡Œï¼Œæ‰§è¡Œ<code>lein repl</code></h4><p><img src="/loading.gif" data-original="/images/clojure/lein-win-repl.png" alt="lein-win-repl"></p><p>æˆ–è€…å¯ä»¥ç›´æ¥åœ¨windowså¼€å§‹æ æœç´¢å®‰è£…çš„ç¨‹åºï¼Œç‚¹å‡»æ‰“å¼€ã€‚<br><img src="/loading.gif" data-original="/images/clojure/lein-win.png" alt="lein"></p><p>æ›´è¿›ä¸€æ­¥ï¼Œè¾“å‡ºä¸ªHello Worldå§</p><p><img src="/loading.gif" data-original="/images/clojure/lein-win-helloword.png" alt="hello world"></p><h4 id="6ã€ä½¿ç”¨Intellij-Ideaä½œä¸ºå¼€å‘IED"><a href="#6ã€ä½¿ç”¨Intellij-Ideaä½œä¸ºå¼€å‘IED" class="headerlink" title="6ã€ä½¿ç”¨Intellij Ideaä½œä¸ºå¼€å‘IED"></a>6ã€ä½¿ç”¨Intellij Ideaä½œä¸ºå¼€å‘IED</h4><p>éœ€è¦å®‰è£…<a href="https://plugins.jetbrains.com/plugin/8090-cursive">Cursiveæ’ä»¶</a></p><p>æ³¨æ„ï¼šå¦‚æœåœ¨çº¿å®‰è£…å®‰è£…ä¸ä¸Šçš„è¯ï¼Œå¯ä»¥<a href="https://plugins.jetbrains.com/plugin/8090-cursive">ä¸‹è½½</a>ä½ çš„IDEå¯¹åº”ç‰ˆæœ¬æ’ä»¶çš„zipåŒ…ï¼Œè¿›è¡Œæœ¬åœ°å¯¼å…¥å®‰è£…ã€‚</p><p>å¦‚å›¾æ˜¯æœ¬åœ°æ–°å»ºçš„ä¸€ä¸ªdemoå·¥ç¨‹ï¼Œå¯ä»¥åœ¨.cljæ–‡ä»¶ä¸Šç›´æ¥å³å‡»è¿è¡Œã€‚<br><img src="/loading.gif" data-original="/images/clojure/hexo-hello-world.png" alt="Hello world"></p><p>ä»£ç ï¼š</p><pre class="line-numbers language-clojure"><code class="language-clojure">(ns firstclojure.core)(defn foo  "I don't do a whole lot."  [x]  (println x "Hello, World!"))(println (foo "Hello Clojure \n"))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡lein runçš„æ–¹å¼ä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‰§è¡Œä»£ç ï¼Œä½†æ˜¯å¦‚æœè¦å°†æˆ‘ä»¬çš„ä»£ç shareå‡ºå»ï¼Œå°±éœ€è¦ç”Ÿæˆä¸€ä¸ªjaræ–‡ä»¶äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨lein uberjaræ¥ç”Ÿæˆjarï¼Œç”Ÿæˆçš„jaræ–‡ä»¶ä¸ºtarget/uberjar/clojure-noob-0.1.0-SNAPSHOT-standalone.jarï¼Œæˆ‘ä»¬å¯ä»¥åœ¨javaé‡Œé¢ç›´æ¥è¿è¡Œäº†ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">java -jar target/uberjar/clojure-noob-0.1.0-SNAPSHOT-standalone.jar Hello, Clojure!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h4><p><a href="https://blog.3vyd.com/blog/posts-output/2018-10-31-Clojure-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">Mac ä¸‹ Clojure ç¯å¢ƒæ­å»º</a></p>]]></content>
      
      
      <categories>
          
          <category> clojure </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clojure </tag>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·å°”åˆ›å®¢æ±‡ç¬”è®°----å®‰å“æµ‹è¯•ç¯å¢ƒæ£€æµ‹ä¸åˆ°çƒ­æ›´</title>
      <link href="2018/11/01/hai-er-chuang-ke-hui-bi-ji-an-zhuo-ce-shi-huan-jing-jian-ce-bu-dao-re-geng/"/>
      <url>2018/11/01/hai-er-chuang-ke-hui-bi-ji-an-zhuo-ce-shi-huan-jing-jian-ce-bu-dao-re-geng/</url>
      
        <content type="html"><![CDATA[<p>å®‰å“æµ‹è¯•ç¯å¢ƒæ£€æµ‹ä¸åˆ°çƒ­æ›´ï¼Œé—®é¢˜å‘ç°ã€æ’æŸ¥æ€è·¯åŠè§£å†³<br><a href="https://www.jianshu.com/p/b374a782ec1c">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="æ€•å•¥æ¥å•¥"><a href="#æ€•å•¥æ¥å•¥" class="headerlink" title="æ€•å•¥æ¥å•¥"></a>æ€•å•¥æ¥å•¥</h2><p>æ˜¨å¤©æ™šä¸Šçº¦å®šçš„æ™šä¸Š11ç‚¹å‘å¸ƒæµ‹è¯•ç¯å¢ƒçš„çƒ­æ›´ï¼Œå°æ¨åŒå­¦è¯´äº†ï¼šâ€œæ€•å•¥æ¥å•¥â€ï¼Œæœç„¶ï¼Œå®‰å“æµ‹è¯•çš„appå‘¨ä¸€å°±æ‰”å‡ºå»äº†ï¼Œçº¦å®šå¥½çš„ä»Šå¤©æ™šä¸Šçƒ­æ›´ï¼Œç»“æœå‘äº†çƒ­æ›´ç§»åŠ¨ç«¯å´æ£€æµ‹ä¸åˆ°ã€‚</p><p>æ™šä¸Šè·Ÿioså‰ç«¯åŒäº‹æŠ˜è…¾äº†ä¸¤æ¬¡ï¼Œä½†æ˜¯æ— æœè€Œç»ˆï¼Œç”²æ–¹ç²‘ç²‘ä¸ä¹æ„äº†ã€‚</p><p><img src="/loading.gif" data-original="/images/fontend/%E5%AE%A2%E6%88%B7%E6%9C%89%E6%84%8F%E8%A7%81%E4%BA%86%E5%93%88.png" alt="å®¢æˆ·æœ‰æ„è§äº†å“ˆ.png"></p><p>ä»Šå¤©å¼€å§‹è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆè¿‡ç¨‹è®¨è®º"><a href="#è§£å†³æ–¹æ¡ˆè¿‡ç¨‹è®¨è®º" class="headerlink" title="è§£å†³æ–¹æ¡ˆè¿‡ç¨‹è®¨è®º"></a>è§£å†³æ–¹æ¡ˆè¿‡ç¨‹è®¨è®º</h2><ul><li><p>èƒŒæ™¯ï¼š</p><blockquote><p>1ã€å‘å‡ºå»ä¹‹å‰ç¡®å®åšè¿‡çƒ­æ›´æµ‹è¯•ï¼Œä¸è¿‡ç°åœ¨çœ‹æ¥ï¼Œå½“æ—¶æµ‹æ˜¯æµ‹äº†ï¼Œä½†æ˜¯æµ‹è¯•çš„ç¯å¢ƒä¸€ç›´åœç•™åœ¨debugç¯å¢ƒã€‚<br>2ã€å¦‚æœæœ¬åœ°ä»£ç å’ŒæœåŠ¡å™¨ä¸Šæœ€æ–°çš„çƒ­æ›´åŒ…æ˜¯ä¸€æ ·çš„è¯ï¼Œæ¨é€çƒ­æ›´æ˜¯ä¸ä¼šæˆåŠŸçš„ã€‚</p></blockquote></li><li><p>ç¬¬ä¸€æ­¥ï¼Œçƒ­æ›´æ˜¯å¦æ¨é€æˆåŠŸï¼Ÿ<br>1ã€å°æ¨åŒå­¦åœ¨ä»–çš„ç¯å¢ƒä¸‹å‘äº†iosçš„æ¨é€ï¼Œæµ‹è¯•å®Œç¾ä»¥åï¼Œåˆå‘äº†androidçš„çƒ­æ›´ã€‚é—æ†¾çš„æ˜¯æ‰‹æœºä¸Šå¯åŠ¨æ£€æµ‹ä¸åˆ°æ›´æ–°ã€‚<br>åæ¥å†æ›´æ–°ä»£ç ï¼Œå‘äº†å‡ æ¬¡ï¼Œæ— æœã€‚</p></li></ul><p><img src="/loading.gif" data-original="/images/fontend/rn-codepush-his.png" alt="çƒ­æ›´history"></p><ul><li><p>ç¬¬äºŒæ­¥ï¼Œappæ£€æŸ¥é€»è¾‘æ˜¯å¦æ­£å¸¸ï¼Ÿ<br>appå¯åŠ¨æ—¶åšäº†æ£€æŸ¥æ—¥å¿—å¤„ç†ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token comment" spellcheck="true">// çƒ­æ›´-æ£€æŸ¥æ›´æ–°</span>codePushCheckForUpdate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  CodePush<span class="token punctuation">.</span><span class="token function">checkForUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>update<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>update<span class="token punctuation">)</span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å·²æ˜¯æœ€æ–°ç‰ˆæœ¬...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æœ‰æ–°ç‰ˆæœ¬-------'</span><span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> packageSize <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>update<span class="token punctuation">.</span>packageSize <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'packageSize'</span><span class="token punctuation">,</span> packageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> totalSize<span class="token punctuation">:</span> packageSize <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showUpdateInfoAlert</span><span class="token punctuation">(</span>update<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®‰å“æ‰‹æœºå¯åŠ¨æŸ¥çœ‹logï¼Œç»“æœç¡®å®æ˜¯åŒ¹é…çš„<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-app-log.png" alt="å®‰å“logcatæ—¥å¿—"></p></li><li><p>ç¬¬ä¸‰æ­¥ï¼Œå‘é€æ¨é€çš„ç¯å¢ƒå’Œå·²æœ‰appçš„åŸç”Ÿä»£ç æœ‰åŒºåˆ«å¯¼è‡´çš„ï¼Ÿ<br>æŠŠæœ¬åœ°æ‰€æœ‰ä»£ç æš‚å­˜ï¼Œç›´æ¥å‘å¸ƒçƒ­æ›´ã€‚<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-push.png" alt="å‘å¸ƒçƒ­æ›´"></p></li></ul><p>ç»“æœæ˜¯ä¸€æ ·çš„ã€‚<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-app-log2.png" alt="image.png"></p><ul><li>ç¬¬å››æ­¥ï¼ŒæŠŠä»£ç åˆ‡æ¢åˆ°æ‰“åŒ…æ—¶çš„commitï¼Œç„¶åå‘çƒ­æ›´ã€‚<br>æ€€ç–‘æ˜¯å¦‚ä¸‹çš„è¿™ç§ä»£ç æœ‰åŒºåˆ«å¯¼è‡´çš„ã€‚<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-reset.png" alt="image.png"></li></ul><p>åˆ‡æ¢åˆ°å½“æ—¶æ‰“åŒ…çš„é‚£æ¬¡commitï¼Œé‡æ–°å‘çƒ­æ›´ã€‚<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-reset2.png" alt="image.png"></p><p>å¾ˆé—æ†¾ï¼Œç»“è®ºæ˜¯ä¸€æ ·çš„ã€‚</p><p><img src="/loading.gif" data-original="/images/fontend/rn-codepush-app-log3.png" alt="image.png"></p><p>å‘Šè¯‰ç”²æ–¹ç²‘ç²‘ï¼Œç„¶åç”¨æœ€æ–°çš„ä»£ç æ‰“ä¸ªåŒ…ï¼Œè¿™å°±ç¡è§‰äº†ã€‚</p><h2 id="çƒ­æ›´è®°å½•ç¡¬åˆ é™¤æµ‹è¯•"><a href="#çƒ­æ›´è®°å½•ç¡¬åˆ é™¤æµ‹è¯•" class="headerlink" title="çƒ­æ›´è®°å½•ç¡¬åˆ é™¤æµ‹è¯•"></a>çƒ­æ›´è®°å½•ç¡¬åˆ é™¤æµ‹è¯•</h2><p>åœ¨çƒ­æ›´æ•°æ®åº“å¼ºåˆ¶åˆ é™¤çƒ­æ›´è®°å½•</p><pre class="line-numbers language-shell"><code class="language-shell">DELETE FROM codepush.deployments_historyWHERE  id=192;DELETE FROM codepush.deployments_historyWHERE  id=193;DELETE FROM codepush.deployments_historyWHERE  id=194;DELETE FROM codepush.deployments_history WHERE  id=195;DELETE FROM codepush.packages WHERE  id=192;DELETE FROM codepush.packages WHERE  id=193;DELETE FROM codepush.packages WHERE  id=194;DELETE FROM codepush.packages WHERE  id=195;DELETE FROM codepush.packages_metrics WHERE  id=192;DELETE FROM codepush.packages_metrics WHERE  id=193;DELETE FROM codepush.packages_metrics WHERE  id=194;DELETE FROM codepush.packages_metrics WHERE  id=195;DELETE FROM codepush.packages_diff WHERE  id=450;DELETE FROM codepush.packages_diff WHERE  id=451;DELETE FROM codepush.packages_diff WHERE  id=452;DELETE FROM codepush.packages_diff WHERE  id=453;DELETE FROM codepush.packages_diff WHERE  id=454;DELETE FROM codepush.packages_diff WHERE  id=455;DELETE FROM codepush.deployments_versions WHERE  id=43;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ é™¤4æ¬¡1.5.1çš„code-pushå<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-his2.png" alt="code push history"></p><p>é‡æ–°å‘èµ·çƒ­æ›´<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-push2.png" alt="code push"></p><p>å¾ˆé—æ†¾ä»ç„¶æ²¡æœ‰ç”Ÿæ•ˆã€‚æ­¤æ—¶æœ¬åœ°çš„debugç¯å¢ƒä¸€ä¸ªappå¯åŠ¨åï¼Œå‘ç°å±…ç„¶æç¤ºæ›´æ–°ã€‚</p><p><strong>é—®é¢˜æ¥äº†ï¼Œå¯èƒ½æ˜¯çƒ­æ›´å’Œæ£€æŸ¥çƒ­æ›´ä¸åœ¨ä¸€ä¸ªé¢‘é“ä¸Š</strong></p><p>æ£€æŸ¥å®‰å“çƒ­æ›´é…ç½®ï¼Œæœç„¶éªŒè¯äº†è¿™ä¸€çŒœæµ‹ã€‚</p><pre class="line-numbers language-js"><code class="language-js">    buildTypes <span class="token punctuation">{</span>        debug <span class="token punctuation">{</span>            ext<span class="token punctuation">.</span>alwaysUpdateBuildId <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment" spellcheck="true">// é¿å… crashLytics çš„alwaysUpdateBuildIdæ¯æ¬¡ç¼–è¯‘éƒ½é‡æ–°ç”Ÿæˆ åŠ å¿«ç¼–è¯‘é€Ÿåº¦</span>            buildConfigField <span class="token string">"String"</span><span class="token punctuation">,</span> <span class="token string">"CODEPUSH_KEY"</span><span class="token punctuation">,</span> <span class="token string">'"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"'</span> <span class="token comment" spellcheck="true">// Staging</span>        <span class="token punctuation">}</span>        release <span class="token punctuation">{</span>            signingConfig signingConfigs<span class="token punctuation">.</span>release            minifyEnabled enableProguardInReleaseBuilds            proguardFiles <span class="token function">getDefaultProguardFile</span><span class="token punctuation">(</span><span class="token string">"proguard-android.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"proguard-rules.pro"</span>            buildConfigField <span class="token string">"String"</span><span class="token punctuation">,</span> <span class="token string">"CODEPUSH_KEY"</span><span class="token punctuation">,</span> <span class="token string">'"pppppppppppppppppppppppppppppp"'</span> <span class="token comment" spellcheck="true">//Production</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ä¸€ä¸ªè§£é‡Š"><a href="#ä¸€ä¸ªè§£é‡Š" class="headerlink" title="ä¸€ä¸ªè§£é‡Š"></a>ä¸€ä¸ªè§£é‡Š</h5><p>é…ç½®é‡Œåªæœ‰debugï¼ˆStagingï¼‰å’Œreleaseï¼ˆProductionï¼‰çš„é…ç½®,é…ç½®äº†ä¸åŒçš„deployment keyï¼Œä½†å› ä¸ºæ‰“æµ‹è¯•ç¯å¢ƒçš„appæ—¶ï¼Œé€‰æ‹©çš„æ˜¯releaseï¼Œæ‰€ä»¥ï¼ŒæŒ‰ç…§è¿™ä¸ªé…ç½®ï¼Œåªæœ‰å‘åœ¨Productionçš„ä¸Šçš„çƒ­æ›´ï¼Œappå¯åŠ¨æ—¶æ‰èƒ½æ£€æŸ¥åˆ°ï¼Œè€Œç°åœ¨ä¸€ç›´åœ¨ç”¨Stagingå‘ã€‚</p><h2 id="ä¿®æ”¹é…ç½®"><a href="#ä¿®æ”¹é…ç½®" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h2><pre class="line-numbers language-js"><code class="language-js">    buildTypes <span class="token punctuation">{</span>        debug <span class="token punctuation">{</span>            ext<span class="token punctuation">.</span>alwaysUpdateBuildId <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment" spellcheck="true">// é¿å… crashLytics çš„alwaysUpdateBuildIdæ¯æ¬¡ç¼–è¯‘éƒ½é‡æ–°ç”Ÿæˆ åŠ å¿«ç¼–è¯‘é€Ÿåº¦</span>            buildConfigField <span class="token string">"String"</span><span class="token punctuation">,</span> <span class="token string">"CODEPUSH_KEY"</span><span class="token punctuation">,</span> <span class="token string">'"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"'</span> <span class="token comment" spellcheck="true">// Staging</span>        <span class="token punctuation">}</span>        beta <span class="token punctuation">{</span>            signingConfig signingConfigs<span class="token punctuation">.</span>release            minifyEnabled enableProguardInReleaseBuilds            buildConfigField <span class="token string">"String"</span><span class="token punctuation">,</span> <span class="token string">"CODEPUSH_KEY"</span><span class="token punctuation">,</span> <span class="token string">'"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"'</span> <span class="token comment" spellcheck="true">//Staging</span>        <span class="token punctuation">}</span>        release <span class="token punctuation">{</span>            signingConfig signingConfigs<span class="token punctuation">.</span>release            minifyEnabled enableProguardInReleaseBuilds            proguardFiles <span class="token function">getDefaultProguardFile</span><span class="token punctuation">(</span><span class="token string">"proguard-android.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"proguard-rules.pro"</span>            buildConfigField <span class="token string">"String"</span><span class="token punctuation">,</span> <span class="token string">"CODEPUSH_KEY"</span><span class="token punctuation">,</span> <span class="token string">'"pppppppppppppppppppppppppppppp"'</span> <span class="token comment" spellcheck="true">//Production</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>syncæ—¶æŠ¥é”™ï¼Œæ‰€æœ‰çš„åº“éƒ½æ‰¾ä¸åˆ°ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-sync-error.png" alt="android sync error"></p><p>å‚è€ƒ<a href="https://stackoverflow.com/questions/47001656/unable-to-resolve-dependency-android-studio-3-0/47021147">æœ¬æ–‡æç¤º</a>ï¼Œå‘ç°é…ç½®å°‘äº†ä¸€é¡¹<code>matchingFallbacks = ['release', 'debug']</code>ï¼Œæ·»åŠ åˆ°betaé…ç½®åï¼ŒbuildæˆåŠŸã€‚</p><pre class="line-numbers language-js"><code class="language-js">beta <span class="token punctuation">{</span>    signingConfig signingConfigs<span class="token punctuation">.</span>release    minifyEnabled enableProguardInReleaseBuilds    buildConfigField <span class="token string">"String"</span><span class="token punctuation">,</span> <span class="token string">"CODEPUSH_KEY"</span><span class="token punctuation">,</span> <span class="token string">'"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"'</span> <span class="token comment" spellcheck="true">//Staging</span>   matchingFallbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'release'</span><span class="token punctuation">,</span> <span class="token string">'debug'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>buildåï¼Œé‡æ–°æ‰“åŒ…ï¼Œé€‰æ‹©betaåŒ…ï¼Œ<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-build.png" alt="é‡æ–°æ‰“åŒ…"></p><p>é¦–é¡µèœå•æ”¹æˆã€ä¸“å±åº”ç”¨ã€‘ï¼Œå‘çƒ­æ›´ï¼Œè€Œä¸”å¼ºæ›´ã€‚<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-push3.png" alt="code-push.png"></p><p>appå¯åŠ¨æµ‹è¯•ï¼š<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-app.gif" alt="suceess"></p><p>æ£€æŸ¥åº”ç”¨æ›´æ–°æ•°ï¼Œæœç„¶æœ‰æ›´æ–°ï¼ˆæ­¤å¤„æˆ‘æˆªå›¾æ—¶å·²ç»æˆåŠŸäº†ä¸¤æ¬¡ï¼‰<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-deployment.png" alt="image.png"></p><p>successï¼ï¼ï¼</p><p>å‰ç«¯è·¯æ¼«æ¼«ï¼Œä¸”é‡‡å‘ä¸”è®°å½•~~~~</p><h2 id="ç›¸å…³æ–‡æ¡£"><a href="#ç›¸å…³æ–‡æ¡£" class="headerlink" title="ç›¸å…³æ–‡æ¡£"></a>ç›¸å…³æ–‡æ¡£</h2><ul><li><a href="https://stackoverflow.com/questions/47001656/unable-to-resolve-dependency-android-studio-3-0">Unable to resolve dependency Android Studio 3.0</a></li><li><a href="https://blog.csdn.net/monkin2011/article/details/78427598">å‡çº§AndroidStudio3.0 Unable to resolve dependency for â€˜:app@betaUnitTest/compileClasspathâ€™: Could not resolve project</a></li><li><a href="https://www.jianshu.com/p/6bbb8020c29e">code-pushçƒ­æ›´æ–°é…ç½®ï¼ˆå‘½ä»¤æ•´ç†ï¼‰</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
            <tag> android </tag>
            
            <tag> code-push </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows10 ä¸Šæµ…å°vue jså¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ä¹‹ä¸‰</title>
      <link href="2018/10/31/windows-vuejs-xue-xi-bi-ji-3/"/>
      <url>2018/10/31/windows-vuejs-xue-xi-bi-ji-3/</url>
      
        <content type="html"><![CDATA[<p>vuejså­¦ä¹ ç¬”è®°â€”-çˆ¶å­ç»„ä»¶ä¼ å€¼ã€åŠ¨æ€ç»„ä»¶ã€è‡ªå®šä¹‰ç»„ä»¶ã€vue-routerã€vue-linkã€state<br><a href="https://www.jianshu.com/p/ac1ebafd755f">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æœ¬èŠ‚å¼€å§‹å®æˆ˜é¡¹ç›®ã€‚<br>å¸ƒå±€layout.vue<br>é¦–é¡µindex.vue<br>å¼•å…¥vue-resource<br>å¼•å…¥json-server<br>config/index.js ä¸­proxyTableä½¿ç”¨<br><img src="/loading.gif" data-original="/images/fontend/vue1.png" alt="image.png"><br><img src="/loading.gif" data-original="/images/fontend/vue2.png" alt="image.png"></p><p><img src="/loading.gif" data-original="/images/fontend/vue3.png" alt="vue data mock"><br>é¦–é¡µå¹»ç¯ç‰‡åˆ¶ä½œ,æœ¬æ¬¡è‡ªå·±å®ç°<br>0ã€çˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶ï¼Œä¼ å€¼<br>1ã€å­ç»„ä»¶æ¥æ”¶å‚æ•°ï¼Œç»´æŠ¤å½“å‰indexï¼Œåˆ†é¡µåˆ‡æ¢å®ç°<br>2ã€å‰ä¸€é¡µï¼Œåä¸€é¡µæŒ‰é’®å®ç°<br>3ã€è‡ªåŠ¨æ’­æ”¾å®ç°<br>4ã€åˆ‡å…¥åŠ¨ç”»æ•ˆæœå®ç°â€”transition<br>5ã€å­ç»„ä»¶é€šè¿‡äº‹ä»¶è§¦å‘çˆ¶ç»„ä»¶å†æ¬¡å­¦ä¹ <br>æŸ¥æ‰¾vue jsçš„ç»„ä»¶åº“çš„æ¨è <a href="https://github.com/vuejs/awesome-vue">https://github.com/vuejs/awesome-vue</a></p><p><img src="/loading.gif" data-original="/images/fontend/vue-banner.png" alt="vue banner"></p><p>å¼¹çª—ç»„ä»¶åŠå…³é—­<br><img src="/loading.gif" data-original="/images/fontend/vue-alert.png" alt="vue alert"></p><p>ç™»å½•æ³¨å†Œè¡¨å•éªŒè¯å’Œæäº¤</p><p>å¤Ÿä¹°è¯¦æƒ…é¡µè·¯ç”±</p><p>å…¶ä»–</p><p>è§†é¢‘å…±äº«ï¼š<br>é“¾æ¥: <a href="https://pan.baidu.com/s/18TFC0-VSCIWFo977p4YcTQ">https://pan.baidu.com/s/18TFC0-VSCIWFo977p4YcTQ</a><br>æå–ç : rjcp </p><p>æºä»£ç å…±äº«ï¼š<br><a href="https://gitee.com/marvinma/vue2-pc">https://gitee.com/marvinma/vue2-pc</a></p>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·å°”åˆ›å®¢æ±‡ç¬”è®°----å®‰å“ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…é…ç½®</title>
      <link href="2018/10/25/hai-er-chuang-ke-hui-bi-ji-an-zhuo-sheng-chan-huan-jing-da-bao-pei-zhi/"/>
      <url>2018/10/25/hai-er-chuang-ke-hui-bi-ji-an-zhuo-sheng-chan-huan-jing-da-bao-pei-zhi/</url>
      
        <content type="html"><![CDATA[<p>åˆ›å®¢æ±‡é¡¹ç›®æ‰“åŒ…ç”Ÿäº§ç¯å¢ƒçš„appéœ€è¦ä¿®æ”¹çš„é…ç½®<br><a href="https://www.jianshu.com/p/cb25e817ba36">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="æ‰“åŒ…ä¿®æ”¹é…ç½®"><a href="#æ‰“åŒ…ä¿®æ”¹é…ç½®" class="headerlink" title="æ‰“åŒ…ä¿®æ”¹é…ç½®"></a>æ‰“åŒ…ä¿®æ”¹é…ç½®</h2><p>1ã€headerå±…ä¸­&nbsp;çœ‹è¿™ä¸ª<a href="https://blog.csdn.net/hunannanhu/article/details/79285736">https://blog.csdn.net/hunannanhu/article/details/79285736</a></p><p><img src="/loading.gif" data-original="/images/fontend/rn-header-center.png" alt="head å±…ä¸­"></p><p>æ³¨é‡Šæ‰å…³äºå®‰å“çš„ç‰¹æ®Šå¤„ç†ï¼š<br><img src="/loading.gif" data-original="/images/fontend/rn-head-center2.png" alt="æ³¨é‡Šå®‰å“ä»£ç "></p><p>2ã€ä¿®æ”¹ç½‘ç»œè¯·æ±‚apiåœ°å€ï¼Œå…¨éƒ¨æ¢æˆæ­£å¼</p><p>\Portal\js\network\constants.js<br><img src="/loading.gif" data-original="/images/fontend/rn-change-baseurl.png" alt="æ›¿æ¢æˆæ­£å¼çš„url"></p><p>3ã€ä¿®æ”¹IMç¯å¢ƒåˆ‡æ¢æˆæ­£å¼çš„</p><p>\Portal\js\network\constants.js<br><img src="/loading.gif" data-original="/images/fontend/rn-package-change-im-baseurl.png" alt="ä¿®æ”¹IMç¯å¢ƒ"></p><p>4ã€è¦†ç›–documentpicker&nbsp;&nbsp;è¿™ä¸ªæ–‡ä»¶ï¼Œ</p><p>è·¯å¾„Portal\node_modules\react-native-document-picker\android\src\main\java\com\reactnativedocumentpicker\DocumentPicker.java</p><p><img src="/loading.gif" data-original="/images/fontend/rn-override-documentpicker.png" alt="documentpicker"></p><p>æ–°æ–‡ä»¶å†…å®¹ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>reactnativedocumentpicker<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>app<span class="token punctuation">.</span>Activity<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>ContentResolver<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>ContentUris<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Context<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Intent<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>database<span class="token punctuation">.</span>Cursor<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>net<span class="token punctuation">.</span>Uri<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Build<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Bundle<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Environment<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>DocumentsContract<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>MediaStore<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>OpenableColumns<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Log<span class="token punctuation">;</span><span class="token keyword">import</span> android<span class="token punctuation">.</span>webkit<span class="token punctuation">.</span>MimeTypeMap<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>facebook<span class="token punctuation">.</span>react<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>ActivityEventListener<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>facebook<span class="token punctuation">.</span>react<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>Arguments<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>facebook<span class="token punctuation">.</span>react<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>Callback<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>facebook<span class="token punctuation">.</span>react<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>ReactApplicationContext<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>facebook<span class="token punctuation">.</span>react<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>ReactContextBaseJavaModule<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>facebook<span class="token punctuation">.</span>react<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>ReactMethod<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>facebook<span class="token punctuation">.</span>react<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>ReadableArray<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>facebook<span class="token punctuation">.</span>react<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>ReadableMap<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>facebook<span class="token punctuation">.</span>react<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>WritableMap<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>File<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileOutputStream<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>net<span class="token punctuation">.</span>URL<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>channels<span class="token punctuation">.</span>Channels<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>channels<span class="token punctuation">.</span>ReadableByteChannel<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * @see &lt;a href="https://developer.android.com/guide/topics/providers/document-provider.html">android documentation&lt;/a> * marvin.ma use for production */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DocumentPicker</span> <span class="token keyword">extends</span> <span class="token class-name">ReactContextBaseJavaModule</span> <span class="token keyword">implements</span> <span class="token class-name">ActivityEventListener</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String NAME <span class="token operator">=</span> <span class="token string">"RNDocumentPicker"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> READ_REQUEST_CODE <span class="token operator">=</span> <span class="token number">41</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> Context mContex<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Fields</span> <span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String FILE_SIZE <span class="token operator">=</span> <span class="token string">"fileSize"</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String FILE_NAME <span class="token operator">=</span> <span class="token string">"fileName"</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String TYPE <span class="token operator">=</span> <span class="token string">"type"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> Callback callback<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">DocumentPicker</span><span class="token punctuation">(</span>ReactApplicationContext reactContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>reactContext<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>mContex <span class="token operator">=</span> reactContext<span class="token punctuation">;</span>        reactContext<span class="token punctuation">.</span><span class="token function">addActivityEventListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> NAME<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@ReactMethod</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span>ReadableMap args<span class="token punctuation">,</span> Callback callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Intent intent<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Build<span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">>=</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>KITKAT<span class="token punctuation">)</span> <span class="token punctuation">{</span>            intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_OPEN_DOCUMENT<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_PICK<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        intent<span class="token punctuation">.</span><span class="token function">addCategory</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>CATEGORY_OPENABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>args<span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span><span class="token string">"filetype"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            ReadableArray filetypes <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">getArray</span><span class="token punctuation">(</span><span class="token string">"filetype"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>filetypes<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                intent<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span>filetypes<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>callback <span class="token operator">=</span> callback<span class="token punctuation">;</span>        <span class="token function">getReactApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startActivityForResult</span><span class="token punctuation">(</span>intent<span class="token punctuation">,</span> READ_REQUEST_CODE<span class="token punctuation">,</span> Bundle<span class="token punctuation">.</span>EMPTY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// removed @Override temporarily just to get it working on RN0.33 and RN0.32 - will remove</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onActivityResult</span><span class="token punctuation">(</span>Activity activity<span class="token punctuation">,</span> <span class="token keyword">int</span> requestCode<span class="token punctuation">,</span> <span class="token keyword">int</span> resultCode<span class="token punctuation">,</span> Intent data<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">onActivityResult</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span> resultCode<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// removed @Override temporarily just to get it working on RN0.33 and RN0.32</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onActivityResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> requestCode<span class="token punctuation">,</span> <span class="token keyword">int</span> resultCode<span class="token punctuation">,</span> Intent data<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>requestCode <span class="token operator">!=</span> READ_REQUEST_CODE<span class="token punctuation">)</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>resultCode <span class="token operator">!=</span> Activity<span class="token punctuation">.</span>RESULT_OK<span class="token punctuation">)</span> <span class="token punctuation">{</span>            callback<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">"Bad result code: "</span> <span class="token operator">+</span> resultCode<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            callback<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">"No data"</span><span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            Uri uri <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            callback<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> <span class="token function">toMapWithMetadata</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            Log<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>NAME<span class="token punctuation">,</span> <span class="token string">"Failed to read"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>            callback<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> WritableMap <span class="token function">toMapWithMetadata</span><span class="token punctuation">(</span>Uri uri<span class="token punctuation">)</span> <span class="token punctuation">{</span>        WritableMap map<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            map <span class="token operator">=</span> <span class="token function">metaDataFromFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"http"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            map <span class="token operator">=</span> <span class="token function">metaDataFromUri</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            map <span class="token operator">=</span> <span class="token function">metaDataFromContentResolver</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        map<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span><span class="token string">"uri"</span><span class="token punctuation">,</span> uri<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>Build<span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">>=</span> Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>KITKAT<span class="token punctuation">)</span><span class="token punctuation">{</span>            map<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span><span class="token string">"filePath"</span><span class="token punctuation">,</span> <span class="token function">getPath</span><span class="token punctuation">(</span>mContex<span class="token punctuation">,</span> uri<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>            map<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span><span class="token string">"filePath"</span><span class="token punctuation">,</span> <span class="token function">uri2Path</span><span class="token punctuation">(</span>mContex<span class="token punctuation">,</span> uri<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> map<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> WritableMap <span class="token function">metaDataFromUri</span><span class="token punctuation">(</span>Uri uri<span class="token punctuation">)</span> <span class="token punctuation">{</span>        WritableMap map <span class="token operator">=</span> Arguments<span class="token punctuation">.</span><span class="token function">createMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        File outputDir <span class="token operator">=</span> <span class="token function">getReactApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCacheDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            File downloaded <span class="token operator">=</span> <span class="token function">download</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> outputDir<span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">putInt</span><span class="token punctuation">(</span>Fields<span class="token punctuation">.</span>FILE_SIZE<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> downloaded<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span>Fields<span class="token punctuation">.</span>FILE_NAME<span class="token punctuation">,</span> downloaded<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span>Fields<span class="token punctuation">.</span>TYPE<span class="token punctuation">,</span> <span class="token function">mimeTypeFromName</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            Log<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">"DocumentPicker"</span><span class="token punctuation">,</span> <span class="token string">"Failed to download file"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> map<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> WritableMap <span class="token function">metaDataFromFile</span><span class="token punctuation">(</span>File file<span class="token punctuation">)</span> <span class="token punctuation">{</span>        WritableMap map <span class="token operator">=</span> Arguments<span class="token punctuation">.</span><span class="token function">createMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> map<span class="token punctuation">;</span>        map<span class="token punctuation">.</span><span class="token function">putInt</span><span class="token punctuation">(</span>Fields<span class="token punctuation">.</span>FILE_SIZE<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> file<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        map<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span>Fields<span class="token punctuation">.</span>FILE_NAME<span class="token punctuation">,</span> file<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        map<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span>Fields<span class="token punctuation">.</span>TYPE<span class="token punctuation">,</span> <span class="token function">mimeTypeFromName</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> map<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> WritableMap <span class="token function">metaDataFromContentResolver</span><span class="token punctuation">(</span>Uri uri<span class="token punctuation">)</span> <span class="token punctuation">{</span>        WritableMap map <span class="token operator">=</span> Arguments<span class="token punctuation">.</span><span class="token function">createMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ContentResolver contentResolver <span class="token operator">=</span> <span class="token function">getReactApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        map<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span>Fields<span class="token punctuation">.</span>TYPE<span class="token punctuation">,</span> contentResolver<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Cursor cursor <span class="token operator">=</span> contentResolver<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> cursor<span class="token punctuation">.</span><span class="token function">moveToFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                map<span class="token punctuation">.</span><span class="token function">putString</span><span class="token punctuation">(</span>Fields<span class="token punctuation">.</span>FILE_NAME<span class="token punctuation">,</span> cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span>OpenableColumns<span class="token punctuation">.</span>DISPLAY_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> sizeIndex <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span>OpenableColumns<span class="token punctuation">.</span>SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cursor<span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>sizeIndex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    String size <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>sizeIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">!=</span> null<span class="token punctuation">)</span>                        map<span class="token punctuation">.</span><span class="token function">putInt</span><span class="token punctuation">(</span>Fields<span class="token punctuation">.</span>FILE_SIZE<span class="token punctuation">,</span> Integer<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> map<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> File <span class="token function">download</span><span class="token punctuation">(</span>Uri uri<span class="token punctuation">,</span> File outputDir<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>        File file <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">createTempFile</span><span class="token punctuation">(</span><span class="token string">"prefix"</span><span class="token punctuation">,</span> <span class="token string">"extension"</span><span class="token punctuation">,</span> outputDir<span class="token punctuation">)</span><span class="token punctuation">;</span>        URL url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ReadableByteChannel channel <span class="token operator">=</span> Channels<span class="token punctuation">.</span><span class="token function">newChannel</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">openStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span><span class="token punctuation">{</span>            FileOutputStream stream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                stream<span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transferFrom</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Long<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> file<span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>                stream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>            channel<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String <span class="token function">mimeTypeFromName</span><span class="token punctuation">(</span>String absolutePath<span class="token punctuation">)</span> <span class="token punctuation">{</span>        String extension <span class="token operator">=</span> MimeTypeMap<span class="token punctuation">.</span><span class="token function">getFileExtensionFromUrl</span><span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>extension <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> MimeTypeMap<span class="token punctuation">.</span><span class="token function">getSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMimeTypeFromExtension</span><span class="token punctuation">(</span>extension<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> null<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// Required for RN 0.30+ modules than implement ActivityEventListener</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onNewIntent</span><span class="token punctuation">(</span>Intent intent<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * ä¸“ä¸ºAndroid4.4ä»¥ä¸Šè®¾è®¡çš„ä»Uriè·å–æ–‡ä»¶è·¯å¾„     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">getPath</span><span class="token punctuation">(</span><span class="token keyword">final</span> Context context<span class="token punctuation">,</span> <span class="token keyword">final</span> Uri uri<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">final</span> <span class="token keyword">boolean</span> isKitKat <span class="token operator">=</span> Build<span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">>=</span> Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>KITKAT<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// DocumentProvider</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>isKitKat <span class="token operator">&amp;&amp;</span> DocumentsContract<span class="token punctuation">.</span><span class="token function">isDocumentUri</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> uri<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// ExternalStorageProvider</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isExternalStorageDocument</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//                LogUtils.logInfoStar("isExternalStorageDocument");</span>                <span class="token keyword">final</span> String docId <span class="token operator">=</span> DocumentsContract<span class="token punctuation">.</span><span class="token function">getDocumentId</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">final</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> split <span class="token operator">=</span> docId<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">final</span> String type <span class="token operator">=</span> split<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"primary"</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">return</span> Environment<span class="token punctuation">.</span><span class="token function">getExternalStorageDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> split<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token comment" spellcheck="true">// TODO handle non-primary volumes</span>            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true">// DownloadsProvider</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDownloadsDocument</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//                LogUtils.logInfoStar("isDownloadsDocument");</span>                <span class="token keyword">final</span> String id <span class="token operator">=</span> DocumentsContract<span class="token punctuation">.</span><span class="token function">getDocumentId</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">final</span> Uri contentUri <span class="token operator">=</span> ContentUris<span class="token punctuation">.</span><span class="token function">withAppendedId</span><span class="token punctuation">(</span>                        Uri<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"content://downloads/public_downloads"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Long<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token function">getDataColumn</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> contentUri<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true">// MediaProvider</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isMediaDocument</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//                LogUtils.logInfoStar("isMediaDocument");</span>                <span class="token keyword">final</span> String docId <span class="token operator">=</span> DocumentsContract<span class="token punctuation">.</span><span class="token function">getDocumentId</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">final</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> split <span class="token operator">=</span> docId<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">final</span> String type <span class="token operator">=</span> split<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                Uri contentUri <span class="token operator">=</span> null<span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"image"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    contentUri <span class="token operator">=</span> MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>Media<span class="token punctuation">.</span>EXTERNAL_CONTENT_URI<span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"video"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    contentUri <span class="token operator">=</span> MediaStore<span class="token punctuation">.</span>Video<span class="token punctuation">.</span>Media<span class="token punctuation">.</span>EXTERNAL_CONTENT_URI<span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"audio"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    contentUri <span class="token operator">=</span> MediaStore<span class="token punctuation">.</span>Audio<span class="token punctuation">.</span>Media<span class="token punctuation">.</span>EXTERNAL_CONTENT_URI<span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">final</span> String selection <span class="token operator">=</span> <span class="token string">"_id=?"</span><span class="token punctuation">;</span>                <span class="token keyword">final</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> selectionArgs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>split<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token function">getDataColumn</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> contentUri<span class="token punctuation">,</span> selection<span class="token punctuation">,</span> selectionArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// MediaStore (and general)</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">getScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token function">getDataColumn</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> uri<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// File</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">getScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> uri<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * Get the value of the data column for this Uri. This is useful for     * MediaStore Uris, and other file-based ContentProviders.     *     * @param context       The context.     * @param uri           The Uri to query.     * @param selection     (Optional) Filter used in the query.     * @param selectionArgs (Optional) Selection arguments used in the query.     * @return The value of the _data column, which is typically a file path.     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">getDataColumn</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> Uri uri<span class="token punctuation">,</span> String selection<span class="token punctuation">,</span>                                       String<span class="token punctuation">[</span><span class="token punctuation">]</span> selectionArgs<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Cursor cursor <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">final</span> String column <span class="token operator">=</span> <span class="token string">"_data"</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> projection <span class="token operator">=</span> <span class="token punctuation">{</span>column<span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            cursor <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> projection<span class="token punctuation">,</span> selection<span class="token punctuation">,</span> selectionArgs<span class="token punctuation">,</span>                    null<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> cursor<span class="token punctuation">.</span><span class="token function">moveToFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">final</span> <span class="token keyword">int</span> column_index <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getColumnIndexOrThrow</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>column_index<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor <span class="token operator">!=</span> null<span class="token punctuation">)</span>                cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * @param uri The Uri to check.     * @return Whether the Uri authority is ExternalStorageProvider.     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isExternalStorageDocument</span><span class="token punctuation">(</span>Uri uri<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"com.android.externalstorage.documents"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">getAuthority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * @param uri The Uri to check.     * @return Whether the Uri authority is DownloadsProvider.     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isDownloadsDocument</span><span class="token punctuation">(</span>Uri uri<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"com.android.providers.downloads.documents"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">getAuthority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * @param uri The Uri to check.     * @return Whether the Uri authority is MediaProvider.     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isMediaDocument</span><span class="token punctuation">(</span>Uri uri<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"com.android.providers.media.documents"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">getAuthority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * Try to return the absolute file path from the given Uri     *     * @param context     * @param uri     * @return the file path or null     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">uri2Path</span><span class="token punctuation">(</span><span class="token keyword">final</span> Context context<span class="token punctuation">,</span> <span class="token keyword">final</span> Uri uri<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>null <span class="token operator">==</span> uri<span class="token punctuation">)</span> <span class="token keyword">return</span> null<span class="token punctuation">;</span>        <span class="token keyword">final</span> String scheme <span class="token operator">=</span> uri<span class="token punctuation">.</span><span class="token function">getScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String data <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>scheme <span class="token operator">==</span> null<span class="token punctuation">)</span>            data <span class="token operator">=</span> uri<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ContentResolver<span class="token punctuation">.</span>SCHEME_FILE<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>scheme<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            data <span class="token operator">=</span> uri<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ContentResolver<span class="token punctuation">.</span>SCHEME_CONTENT<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>scheme<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            Cursor cursor <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>ImageColumns<span class="token punctuation">.</span>DATA<span class="token punctuation">}</span><span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>null <span class="token operator">!=</span> cursor<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">moveToFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">int</span> index <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span>MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>ImageColumns<span class="token punctuation">.</span>DATA<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        index <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getColumnIndexOrThrow</span><span class="token punctuation">(</span>MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>Media<span class="token punctuation">.</span>DATA<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        data <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>                cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> data<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>5ã€ä½¿ç”¨å‘½ä»¤unzip -l wuliuxj20181010.zipæ£€æŸ¥ç‰©æµç­‰js bundleæ–‡ä»¶å†…å®¹æ˜¯å¦æ­£ç¡®ï¼Œéœ€è¦æœ‰å­æ–‡ä»¶å¤¹ã€‚</p><p>6ã€æ›¿æ¢å›¾æ ‡ï¼š</p><p>\Portal\android\app\src\main\AndroidManifest.xml</p><p><img src="/loading.gif" data-original="/images/fontend/rn-package-logo.png" alt="log"></p><p>7ã€æ”¾å¼€çƒ­æ›´</p><p>Portal\index.jsï¼Œç¡®ä¿è¿™è¡Œä»£ç æ²¡è¢«æ³¨é‡Šæ‰</p><p><img src="/loading.gif" data-original="/images/fontend/rn-package-codepush.png" alt="çƒ­æ›´"></p><p>8ã€ä¿®æ”¹BTCé€šçŸ¥ã€è¯·ç¤ºæŠ¥å‘Šå•ç­‰HTMLçš„ä½ç½®ä¸ºæ­£å¼çš„ã€‚  </p><p>9ã€æ‰“åŒ…</p><p>keystore&nbsp;&nbsp;åœ¨è¿™ä¸ªè·¯å¾„ä¸‹</p><p><img src="/loading.gif" data-original="/images/fontend/rn-package-keystore.png" alt="keystore"></p><p>******è¿™æ˜¯å¯†ç </p><h2 id="æ–°ç‰ˆå‘å‡ºå‰å†…æµ‹æ£€æŸ¥äº‹é¡¹"><a href="#æ–°ç‰ˆå‘å‡ºå‰å†…æµ‹æ£€æŸ¥äº‹é¡¹" class="headerlink" title="æ–°ç‰ˆå‘å‡ºå‰å†…æµ‹æ£€æŸ¥äº‹é¡¹"></a>æ–°ç‰ˆå‘å‡ºå‰å†…æµ‹æ£€æŸ¥äº‹é¡¹</h2><p>1ã€æ‰€æœ‰åœ°å€æ˜¯ä¸æ˜¯ç”Ÿäº§çš„<br>  1.1ã€ ç™»å½•<br>  1.2ã€æ°´ç«™<br>  1.3ã€IMç³»ç»Ÿ<br>  1.4ã€ä¼šè®®å®¤é¢„è®¢<br>  1.5ã€BTB/BTC</p><p>2ã€å¸¸ç”¨åŠŸèƒ½æ­£å¸¸<br>  2.1ã€å¯åŠ¨<br>  2.2ã€ç™»å½•<br>  2.3ã€æ—¥ç¨‹ï¼Œåˆ—è¡¨ï¼Œåˆ›å»ºä¼šè®®/ä»»åŠ¡ï¼Œèƒ½æ·»åŠ é™„ä»¶<br>  2.4ã€ç›´æ’­<br>  2.5ã€BTC/BTB/å·¡æ£€èƒ½æ‰“å¼€ï¼Œé¦–æ¬¡åŠ è½½æœ‰è¿›åº¦æ¡ï¼Œèƒ½ä¸‹è½½<br>  2.6ã€æˆ‘çš„å›¢é˜Ÿï¼Œåˆ—è¡¨æ­£å¸¸ï¼Œèƒ½åˆ›å»ºå›¢é˜Ÿ<br>  2.7ã€IMç™»å½•æ­£å¸¸ï¼Œèƒ½èŠå¤©ï¼Œè§†é¢‘ï¼Œç™½ç‰ˆååŒ<br>  2.8ã€å¯ä»¥æ£€æŸ¥æ›´æ–° </p>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
            <tag> android </tag>
            
            <tag> package </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux å®‰è£…mavenç§æœ</title>
      <link href="2018/09/02/linux-an-zhuang-maven-si-fu/"/>
      <url>2018/09/02/linux-an-zhuang-maven-si-fu/</url>
      
        <content type="html"><![CDATA[<p>å¼€å‘ç¯å¢ƒæ­å»ºâ€”å®‰è£…mavenç§æœ<br><a href="https://www.jianshu.com/p/06c1ca9052eb">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="1ã€ä¸‹è½½"><a href="#1ã€ä¸‹è½½" class="headerlink" title="1ã€ä¸‹è½½"></a>1ã€ä¸‹è½½</h3><p>é€šè¿‡æ­¤<a href="https://www.sonatype.com/oss-thank-you-tar.gz">åœ°å€</a>ä¸‹è½½éœ€è¦çš„ç‰ˆæœ¬</p><p>å®‰è£…ä¸‹è½½å¥½nexus3.9æœ€æ–°ç‰ˆåè§£å‹ï¼Œcopyåˆ°/usr/local/nexus/ç›®å½•ä¸‹ç„¶åä¿®æ”¹ç«¯å£ç­‰é…ç½®ã€‚</p><h3 id="2ã€ä¿®æ”¹é…ç½®"><a href="#2ã€ä¿®æ”¹é…ç½®" class="headerlink" title="2ã€ä¿®æ”¹é…ç½®"></a>2ã€ä¿®æ”¹é…ç½®</h3><p>2.1ã€å¯åŠ¨ã€‚ä»¥3.6.0ä¸ºä¾‹</p><pre class="line-numbers language-shell"><code class="language-shell">[root@MiWiFi-R3-srv ~]# cd /usr/local/nexus-3.6.0-02/bin/[root@MiWiFi-R3-srv ~]# ./nexus run &<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç¨ç­‰ä¸€ä¼š(é¦–æ¬¡å¯åŠ¨ä¼šæ¯”è¾ƒæ…¢),å½“å‡ºç°ä»¥ä¸‹æ—¥å¿—çš„æ—¶å€™è¡¨ç¤ºå¯åŠ¨æˆåŠŸ!</p><blockquote><p>Started Sonatype Nexus OSS 3.6.0-02</p></blockquote><p>2.2ã€å¼€å¯è¿œç¨‹è®¿é—®ç«¯å£</p><pre class="line-numbers language-shell"><code class="language-shell">[root@MiWiFi-R3-srv bin]# firewall-cmd --zone=public --add-port=8081/tcp --permanent[root@MiWiFi-R3-srv bin]# firewall-cmd --reload<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/java/maven-repo.png" alt="mavenç§æœ"></p><blockquote><p>nexus3é»˜è®¤ç«¯å£æ˜¯:8081<br>nexus3é»˜è®¤è´¦å·æ˜¯:admin<br>nexus3é»˜è®¤å¯†ç æ˜¯:admin123</p></blockquote><p>2.3ã€è®¾ç½®å¼€æœºè‡ªå¯åŠ¨(systemctlæ–¹å¼)<br>åˆ›å»ºä¸€ä¸ªæœåŠ¡</p><pre class="line-numbers language-shell"><code class="language-shell">[root@MiWiFi-R3-srv ~]# vim /usr/lib/systemd/system/nexus.service<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¡«å…¥ç›¸å…³å†…å®¹</p><pre class="line-numbers language-shell"><code class="language-shell">[Unit]Description=nexus service[Service]Type=forkingLimitNOFILE=65536 #è­¦å‘Šå¤„ç†ExecStart=/usr/local/nexus/nexus-3.7.1-02/bin/nexus startExecReload=/usr/local/nexus/nexus-3.7.1-02/bin/nexus restartExecStop=/usr/local/nexus/nexus-3.7.1-02/bin/nexus stopRestart=on-failure[Install]WantedBy=multi-user.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†æœåŠ¡åŠ å…¥å¼€æœºå¯åŠ¨</p><pre class="line-numbers language-shell"><code class="language-shell">[root@MiWiFi-R3-srv ~]# systemctl enable nexus.service<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶</p><pre class="line-numbers language-shell"><code class="language-shell">[root@MiWiFi-R3-srv ~]# systemctl daemon-reload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.4ã€ä¿®æ”¹nexus3çš„è¿è¡Œç”¨æˆ·ä¸ºroot</p><pre class="line-numbers language-shell"><code class="language-shell">[root@MiWiFi-R3-srv bin]# vim nexus.rcrun_as_user="root"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>2.5ã€ä¿®æ”¹nexus3å¯åŠ¨æ—¶è¦ä½¿ç”¨çš„jdkç‰ˆæœ¬</p><pre class="line-numbers language-shell"><code class="language-shell">[root@MiWiFi-R3-srv bin]# vim nexus<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬14è¡Œ:</p><pre class="line-numbers language-shell"><code class="language-shell">INSTALL4J_JAVA_HOME_OVERRIDE=/usr/local/java/jdk1.8.0_144<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.6ã€ä¿®æ”¹nexus3é»˜è®¤ç«¯å£(å¯é€‰)</p><pre class="line-numbers language-shell"><code class="language-shell">[root@MiWiFi-R3-srv etc]# cd /usr/local/nexus-3.6.0-02/etc/[root@MiWiFi-R3-srv etc]# vim nexus-default.properties <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é»˜è®¤ç«¯å£:8081</p><pre class="line-numbers language-shell"><code class="language-shell">application-port=8081<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2.7ã€ä¿®æ”¹nexus3æ•°æ®ä»¥åŠç›¸å…³æ—¥å¿—çš„å­˜å‚¨ä½ç½®(å¯é€‰)ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">[root@MiWiFi-R3-srv bin]# cd /usr/local/nexus-3.6.0-02/bin/[root@MiWiFi-R3-srv bin]# vim nexus.vmoptions -XX:LogFile=./sonatype-work/nexus3/log/jvm.log-Dkaraf.data=./sonatype-work/nexus3-Djava.io.tmpdir=./sonatype-work/nexus3/tmp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3ã€ä¸Šä¼ å¤–éƒ¨jaræ–‡ä»¶"><a href="#3ã€ä¸Šä¼ å¤–éƒ¨jaræ–‡ä»¶" class="headerlink" title="3ã€ä¸Šä¼ å¤–éƒ¨jaræ–‡ä»¶"></a>3ã€ä¸Šä¼ å¤–éƒ¨jaræ–‡ä»¶</h3><p>3.1ã€åˆ›å»ºä»“åº“<br><img src="/loading.gif" data-original="/images/java/maven-repo-create-repo.png" alt="åˆ›å»ºä»“åº“"></p><p>3.2ã€ä¸Šä¼ jar<br><img src="/loading.gif" data-original="/images/java/maven-repo-upload.png" alt="upload jar"></p><p>3.3ã€æœ€æœ€æœ€é‡è¦çš„ä¸€æ­¥ï¼šå°†æ–°åˆ›å»ºçš„3rdPartyåŠ å…¥åˆ°publicå¯¹å¤–å…¬å¸ƒçš„groupä¸‹<br><img src="/loading.gif" data-original="/images/java/maven-repo-set-public.png" alt="è®¾ç½®ä¸ºpublic"></p><h3 id="4ã€é…ç½®æœ¬åœ°mavençš„pomæ–‡ä»¶"><a href="#4ã€é…ç½®æœ¬åœ°mavençš„pomæ–‡ä»¶" class="headerlink" title="4ã€é…ç½®æœ¬åœ°mavençš„pomæ–‡ä»¶"></a>4ã€é…ç½®æœ¬åœ°mavençš„pomæ–‡ä»¶</h3><p>4.1ã€å…¨å±€ä¿®æ”¹mavené…ç½®æ–‡ä»¶çš„setting.xmlé…ç½®æ–‡ä»¶</p><pre class="line-numbers language-xml"><code class="language-xml"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profiles</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>dev<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repositories</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repository</span><span class="token punctuation">></span></span>             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>central<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>http://jenkins.haier.haiqiang.xin:8887/repository/maven-public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>Yuandian Maven Repo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repository</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repository</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>mvn-repo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>http://jenkins.haier.haiqiang.xin:8887/repository/maven-public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repository</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repositories</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pluginRepositories</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pluginRepository</span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>nexus<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>nexus<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>http://jenkins.haier.haiqiang.xin:8887/repository/maven-public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>releases</span><span class="token punctuation">></span></span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>releases</span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snapshots</span><span class="token punctuation">></span></span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>snapshots</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pluginRepository</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pluginRepositories</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profiles</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>4.2ã€åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ç§æœï¼Œä¿®æ”¹mavençš„pomæ–‡ä»¶ï¼ŒåŠ å…¥repositoryçš„é…ç½®</p><pre class="line-numbers language-xml"><code class="language-xml">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repositories</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repository</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>nexus<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>Team Nexus Repository<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>http://27.223.70.82:8887/repository/maven-public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span><span class="token punctuation">></span></span>default<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>releases</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>releases</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snapshots</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>snapshots</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repository</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repositories</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pluginRepositories</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pluginRepository</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>nexus<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>Team Nexus Repository<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>http://27.223.70.82:8887/repository/maven-public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pluginRepository</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pluginRepositories</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æŸã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://blog.csdn.net/yougoule/article/details/56843562">https://blog.csdn.net/yougoule/article/details/56843562</a> </p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows10 ä¸Šæµ…å°vue jså¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ä¹‹ä¸€</title>
      <link href="2018/09/02/windows-vuejs-xue-xi-bi-ji-1/"/>
      <url>2018/09/02/windows-vuejs-xue-xi-bi-ji-1/</url>
      
        <content type="html"><![CDATA[<p>vuejså­¦ä¹ ç¬”è®°â€”-vueå®‰è£…ã€æ•°æ®åˆå§‹åŒ–ã€æ•°æ®mock<br><a href="https://www.jianshu.com/p/a16bc309c7fd">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>è¯´å®è¯ï¼Œåœ¨windowsé…ç½®å‰ç«¯ä¸æ˜¯ä¸å¯ä»¥ï¼Œä½†æ˜¯ç¡®å®æ¯”ç”¨macéº»çƒ¦å¤šäº†ï¼ˆè¯´çš„å¥½åƒæˆ‘æ˜¯macè€æ‰‹ä¼¼çš„ï¼Œå…¶å®åªæ˜¯æœ‰å‡ ä¸ªæœˆçš„ä½¿ç”¨ç»éªŒè€Œå·²ï¼‰ï¼Œæ›¾è®°å¾—ï¼Œå½“å¹´æreact-nativeç¯å¢ƒå°±æ˜¯è¿™æ ·ï¼Œæpythonç¯å¢ƒä¹Ÿæ˜¯ä¸€æ ·ï¼Œå†åˆ°å¦‚ä»Šæƒ³ævueï¼Œè¿˜æ˜¯è¿™æ ·ã€‚</p><p>ä¸è¿‡ä¹Ÿä¸æ˜¯ä¸å¯èƒ½ï¼Œåªè¦ä½ æ„¿æ„æŠ˜è…¾ï¼Œä¸æ”¾å¼ƒï¼ˆå…¶å®æ˜¯ä¹°ä¸èµ·macï¼‰ã€‚</p><h3 id="å®‰è£…ç¯å¢ƒ"><a href="#å®‰è£…ç¯å¢ƒ" class="headerlink" title="å®‰è£…ç¯å¢ƒ"></a>å®‰è£…ç¯å¢ƒ</h3><p>1ã€å®‰è£…nodeï¼Œåˆ°ä»Šå¤©ï¼ˆ2018-09-10æ•™å¸ˆèŠ‚ï¼‰ï¼Œnodeæœ€æ–°ç‰ˆæ˜¯10.8äº†ï¼Œä½†æ˜¯å› ä¸ºå‡ ä¸ªæœˆå‰æè¿‡vueï¼Œå®‰è£…çš„nodeæ˜¯8.6.0ï¼Œä»Šå¤©å‡çº§ä»¥ååè€Œè¿vue initéƒ½ä¸èƒ½ç”¨äº†ï¼Œæ‰€ä»¥ä¸å¾—å·²å›é€€åˆ°8.6.0ï¼Œæ‰€ä»¥è¿˜æ˜¯ä½¿ç”¨ç¨³å®šç‰ˆæ¯”è¾ƒç¨³å¦¥ã€‚ç›´æ¥åˆ°<a href="https://npm.taobao.org/mirrors/node/">å®˜ç½‘</a>ä¸‹è½½siæ–‡ä»¶ä¸‹ä¸€æ­¥ä¸‹ä¸€æ­¥å‚»ç“œå¼å®‰è£…å³å¯ã€‚</p><p>2ã€å®‰è£…webpack</p><pre class="line-numbers language-shell"><code class="language-shell">$ npm install -g webpack<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3ã€å®‰è£…vue-cli</p><pre class="line-numbers language-shell"><code class="language-shell">$ npm install -g vue-cli<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4ã€åˆå§‹åŒ–é¡¹ç›®</p><pre class="line-numbers language-shell"><code class="language-shell">$ vue init webpack demo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>5ã€è¿è¡Œé¡¹ç›®</p><pre class="line-numbers language-shell"><code class="language-shell">$ npm install$ npm run dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é»˜è®¤è®¿é—®ç«¯å£æ˜¯8080ï¼Œè®¿é—®å³å¯<br><img src="/loading.gif" data-original="/images/fontend/vue-hello-world.png" alt="hello world"></p><h3 id="ä½¿ç”¨json-serveræ¨¡æ‹ŸREST-API"><a href="#ä½¿ç”¨json-serveræ¨¡æ‹ŸREST-API" class="headerlink" title="ä½¿ç”¨json-serveræ¨¡æ‹ŸREST API"></a>ä½¿ç”¨json-serveræ¨¡æ‹ŸREST API</h3><p>å› ä¸ºæ˜¯å­¦ä¹ ï¼Œè€è€å®å®å†™åç«¯æ¥å£ï¼Œå†ç»™å‰ç«¯è°ƒç”¨ï¼Œç¡®å®æœ‰äº›å¤´é‡è„šè½»ï¼Œæˆ‘é€‰æ‹©äº†json-serverç”¨æ¥mockæ•°æ®ã€‚</p><ul><li>å®‰è£…æœåŠ¡<pre class="line-numbers language-shell"><code class="language-shell">$ npm install json-server -g<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>åˆ›å»ºæ–‡ä»¶<br>åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»º/mockæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”åœ¨mockç›®å½•ä¸‹æ–°å»ºdb.jsonæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</li></ul><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>    <span class="token property">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span>      <span class="token punctuation">{</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">,</span>        <span class="token property">"tel"</span><span class="token operator">:</span> <span class="token string">"15223810923"</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"æå››"</span><span class="token punctuation">,</span>        <span class="token property">"tel"</span><span class="token operator">:</span> <span class="token string">"15223810923"</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ç‹äºŒ"</span><span class="token punctuation">,</span>        <span class="token property">"tel"</span><span class="token operator">:</span> <span class="token string">"15223810923"</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"é™ˆäº”"</span><span class="token punctuation">,</span>        <span class="token property">"tel"</span><span class="token operator">:</span> <span class="token string">"15223810923"</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"èµµå…­"</span><span class="token punctuation">,</span>        <span class="token property">"tel"</span><span class="token operator">:</span> <span class="token string">"123454323"</span><span class="token punctuation">,</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">5</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"èµµå…­"</span><span class="token punctuation">,</span>        <span class="token property">"tel"</span><span class="token operator">:</span> <span class="token string">"123454323"</span><span class="token punctuation">,</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">6</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"èµµå…­"</span><span class="token punctuation">,</span>        <span class="token property">"tel"</span><span class="token operator">:</span> <span class="token string">"123454323"</span><span class="token punctuation">,</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">7</span>      <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"users"</span><span class="token operator">:</span> <span class="token punctuation">[</span>      <span class="token punctuation">{</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"é™ˆäº”"</span><span class="token punctuation">,</span>        <span class="token property">"sex"</span><span class="token operator">:</span><span class="token string">"male"</span><span class="token punctuation">,</span>        <span class="token property">"tel"</span><span class="token operator">:</span> <span class="token string">"12345678"</span><span class="token punctuation">,</span>        <span class="token property">"auther"</span><span class="token operator">:</span><span class="token punctuation">{</span>          <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"é™ˆäº”"</span><span class="token punctuation">,</span>          <span class="token property">"age"</span><span class="token operator">:</span><span class="token string">"25"</span>        <span class="token punctuation">}</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ç‹äºŒ"</span><span class="token punctuation">,</span>        <span class="token property">"sex"</span><span class="token operator">:</span><span class="token string">"male"</span><span class="token punctuation">,</span>        <span class="token property">"tel"</span><span class="token operator">:</span> <span class="token string">"15223810923"</span><span class="token punctuation">,</span>        <span class="token property">"auther"</span><span class="token operator">:</span><span class="token punctuation">{</span>          <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"ç‹äºŒ"</span><span class="token punctuation">,</span>          <span class="token property">"age"</span><span class="token operator">:</span><span class="token string">"22"</span>        <span class="token punctuation">}</span>      <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"user"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>        <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"é™ˆäº”"</span><span class="token punctuation">,</span>        <span class="token property">"tel"</span><span class="token operator">:</span> <span class="token string">"15223810923"</span>      <span class="token punctuation">}</span>      <span class="token punctuation">,</span>    <span class="token property">"posts"</span><span class="token operator">:</span> <span class="token punctuation">[</span>      <span class="token punctuation">{</span> <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"json-server"</span><span class="token punctuation">,</span> <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"typicode"</span> <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"comments"</span><span class="token operator">:</span> <span class="token punctuation">[</span>      <span class="token punctuation">{</span> <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token property">"body"</span><span class="token operator">:</span> <span class="token string">"some comment"</span><span class="token punctuation">,</span> <span class="token property">"postId"</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token property">"profile"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"typicode"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>     <span class="token property">"goods"</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token property">"data"</span> <span class="token operator">:</span><span class="token punctuation">[</span>        <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token string">"69.9"</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"å¾·èŠ™"</span><span class="token punctuation">,</span> <span class="token property">"img"</span><span class="token operator">:</span> <span class="token string">"http://m.360buyimg.com/babel/s211x211_jfs/t3688/270/776223567/128582/fa074fb3/58170f6dN6b9a12bf.jpg!q50.jpg.webp"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token string">"63"</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"è´¹åˆ—ç½—"</span><span class="token punctuation">,</span> <span class="token property">"img"</span><span class="token operator">:</span> <span class="token string">"http://m.360buyimg.com/babel/s211x211_jfs/t613/100/1264998035/221234/1a29d51f/54c34525Nb4f6581c.jpg!q50.jpg.webp"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token string">"29.9"</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"å¤§ç±³"</span><span class="token punctuation">,</span> <span class="token property">"img"</span><span class="token operator">:</span> <span class="token string">"http://m.360buyimg.com/babel/s211x211_jfs/t1258/40/17387560/108696/aced445f/54e011deN3ae867ae.jpg!q50.jpg.webp"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token string">"54.9"</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"å®‰æ…•å¸Œ"</span><span class="token punctuation">,</span> <span class="token property">"img"</span><span class="token operator">:</span> <span class="token string">"http://m.360buyimg.com/babel/s211x211_jfs/t2734/15/680373407/215934/3abaa748/572057daNc09b5da7.jpg!q50.jpg.webp"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token string">"58"</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"é‡‘å…¸"</span><span class="token punctuation">,</span> <span class="token property">"img"</span><span class="token operator">:</span> <span class="token string">"http://m.360buyimg.com/babel/s211x211_jfs/t2482/145/1424008556/91991/d62f5454/569f47a2N3f763060.jpg!q50.jpg.webp"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token string">"60"</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"å‘³å¯æ»‹"</span><span class="token punctuation">,</span> <span class="token property">"img"</span><span class="token operator">:</span> <span class="token string">"http://m.360buyimg.com/babel/s211x211_jfs/t2368/3/874563950/70786/7b5e8edd/563074c8N4d535db4.jpg!q50.jpg.webp"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token string">"248.00"</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"æ³¸å·è€çª–"</span><span class="token punctuation">,</span> <span class="token property">"img"</span><span class="token operator">:</span> <span class="token string">"http://m.360buyimg.com/babel/s211x211_jfs/t283/166/1424018055/189580/7c0792b7/543b4958N05fa2feb.jpg!q50.jpg.webp"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token string">"328.8"</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"å‰‘å—æ˜¥"</span><span class="token punctuation">,</span> <span class="token property">"img"</span><span class="token operator">:</span> <span class="token string">"http://m.360buyimg.com/babel/s350x350_g15/M05/1A/0A/rBEhWlNeLAwIAAAAAAHyok3PZY0AAMl8gO8My0AAfK6307.jpg!q50.jpg.webp"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token string">"49.00"</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"è“è“"</span><span class="token punctuation">,</span> <span class="token property">"img"</span><span class="token operator">:</span> <span class="token string">"http://m.360buyimg.com/babel/s211x211_jfs/t2332/148/2952098628/94387/e64654e2/56f8d76aNb088c2ab.jpg!q50.jpg.webp"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">{</span> <span class="token property">"price"</span><span class="token operator">:</span> <span class="token string">"68"</span><span class="token punctuation">,</span> <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"èŠ’æœ"</span><span class="token punctuation">,</span> <span class="token property">"img"</span><span class="token operator">:</span> <span class="token string">"http://m.360buyimg.com/n0/jfs/t3709/334/1378702984/206759/5c100ab5/58253588Naaa05c5c.jpg!q70.jpg"</span><span class="token punctuation">}</span>      <span class="token punctuation">]</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>è¿è¡Œjson-server</p><pre class="line-numbers language-shell"><code class="language-shell">json-server db.json -p 8080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŒ‡å®šrest apiåœ¨8080ç«¯å£ä¸Šè¿è¡Œï¼Œä½¿ç”¨<a href="http://127.0.0.1:8080/goods/%E6%9F%A5%E7%9C%8B%E3%80%82">http://127.0.0.1:8080/goods/æŸ¥çœ‹ã€‚</a></p></li><li><p>å¿«æ·å¯åŠ¨<br>ä¸ºäº†æ–¹ä¾¿ï¼Œå†åˆ›å»ºä¸€ä¸ª package.json æ–‡ä»¶ï¼Œå†™å…¥</p><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>  <span class="token property">"mock"</span><span class="token operator">:</span> <span class="token string">"json-server db.json --port 3003"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åä½¿ç”¨åˆ° /mock ç›®å½•ä¸‹æ‰§è¡Œ <code>npm run mock</code> å‘½ä»¤ï¼Œå¦‚æœæˆåŠŸä¼šå‡ºç°</p></li></ul><pre class="line-numbers language-shell"><code class="language-shell">$ npm run mock> @ mock D:\Git\demo\vue\demo\mock> json-server db.json --port 8080  \{^_^}/ hi!  Loading db.json  Done  Resources  http://localhost:8080/list  http://localhost:8080/users  http://localhost:8080/user  http://localhost:8080/posts  http://localhost:8080/comments  http://localhost:8080/profile  http://localhost:8080/goods  Home  http://localhost:8080<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä¸æˆåŠŸè¯·æ£€æŸ¥ db.json æ–‡ä»¶çš„æ ¼å¼æ˜¯å¦æ­£ç¡®ã€‚<br><img src="/loading.gif" data-original="/images/fontend/vue-helloworld-api.png" alt="api.png"></p><ul><li>ä½¿ç”¨æœ¬åœ°api<br>ä»£ç ï¼š<pre class="line-numbers language-js"><code class="language-js">created <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">/* è¿™ä¸ªæ˜¯vueçš„é’©å­å‡½æ•°ï¼Œå½“new Vue()å®ä¾‹åˆ›å»ºå®Œæ¯•åæ‰§è¡Œçš„å‡½æ•° */</span>    <span class="token keyword">const</span> Http <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'http://127.0.0.1:8080/goods'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">/* è°ƒç”¨vueçš„ajaxæ¥è¯·æ±‚æ•°æ®ï¼Œpromiseè¯­æ³•ï¼Œå¹¶ç”¨es6çš„ç®­å¤´å‡½æ•° */</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'==================================='</span><span class="token punctuation">)</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'==================================='</span><span class="token punctuation">)</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>items <span class="token operator">=</span> data<span class="token punctuation">.</span>body<span class="token punctuation">.</span>data<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>ä½†æ˜¯è¿™æ ·æ“ä½œä¼šæŠ¥é”™,é”™è¯¯å¦‚ä¸‹ï¼š<br><img src="/loading.gif" data-original="/images/fontend/vue-helloworld-errorage.png" alt="errorage.png"><br>è¿™æ˜¯å› ä¸ºæ²¡æœ‰å¼•å…¥vue-resourceå¯¼è‡´çš„ï¼Œå¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/weixin_39581226/article/details/80682132">Cannot read property â€˜getâ€™ of undefinedâ€ in vuejs</a>å’Œ<a href="https://segmentfault.com/q/1010000006984096/a-1020000006985045">vueå¼•å…¥vue-resourceæ— æ³•ä½¿ç”¨$http.get</a>ã€‚</li></ul><p><img src="/loading.gif" data-original="/images/fontend/vue-helloworld-resource.png" alt="vue-resource.png"></p><p>æœ€ç»ˆå®ç°çš„æ•ˆæœå¦‚å›¾ï¼š<br><img src="/loading.gif" data-original="/images/fontend/vue-helloworld-success.png" alt="goods"></p><p>æ ¸å¿ƒå‚è€ƒæ–‡æ¡£ï¼š<a href="https://www.jianshu.com/p/7c5ccfac3fa8">https://www.jianshu.com/p/7c5ccfac3fa8</a></p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://www.cnblogs.com/itfantasy/p/6043111.html">https://www.cnblogs.com/itfantasy/p/6043111.html</a><br><a href="https://blog.csdn.net/sinat_17775997/article/details/77824878">https://blog.csdn.net/sinat_17775997/article/details/77824878</a></p><h2 id="è§†é¢‘å’Œæºç "><a href="#è§†é¢‘å’Œæºç " class="headerlink" title="è§†é¢‘å’Œæºç "></a>è§†é¢‘å’Œæºç </h2><p>è§†é¢‘å…±äº«ï¼š<br>é“¾æ¥: <a href="https://pan.baidu.com/s/18TFC0-VSCIWFo977p4YcTQ">https://pan.baidu.com/s/18TFC0-VSCIWFo977p4YcTQ</a><br>æå–ç : rjcp </p><p>æºä»£ç å…±äº«ï¼š<br><a href="https://gitee.com/marvinma/vue2-pc">https://gitee.com/marvinma/vue2-pc</a></p>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows10 ä¸Šæµ…å°vue jså¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ä¹‹äºŒ</title>
      <link href="2018/09/02/windows-vuejs-xue-xi-bi-ji-2/"/>
      <url>2018/09/02/windows-vuejs-xue-xi-bi-ji-2/</url>
      
        <content type="html"><![CDATA[<p>vuejså­¦ä¹ ç¬”è®°â€”-çˆ¶å­ç»„ä»¶ä¼ å€¼ã€åŠ¨æ€ç»„ä»¶ã€è‡ªå®šä¹‰ç»„ä»¶ã€vue-routerã€vue-linkã€state<br><a href="https://www.jianshu.com/p/a16bc309c7fd">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æœ¬ç‰‡æ˜¯çœ‹è§†é¢‘è®°å½•é›¶ç¢çŸ¥è¯†ç‚¹<br>1ã€ä½¿ç”¨mustacheè¾“å‡ºå†…å®¹æ—¶å°†è¾“å…¥æ¡†è¾“å…¥çš„å†…å®¹åšå¤„ç†ï¼Œä½¿ç”¨è®¡ç®—å±æ€§ï¼Œä¸éœ€è¦ä½¿ç”¨ç›‘å¬ç­‰åŠŸèƒ½å®ç°ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>    data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span>  <span class="token punctuation">{</span>           myValue <span class="token punctuation">:</span> <span class="token string">''</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>         checkData <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>             <span class="token keyword">this</span><span class="token punctuation">.</span>myValue<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\d/g</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨çš„åœ°æ–¹</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"myValue"</span><span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> checkData <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æƒ³å®ç°çš„å°±æ˜¯åœ¨inputè¾“å…¥æ¡†è¾“å…¥å†…å®¹æ—¶ï¼Œåé¢åªæ˜¾ç¤ºå­—æ¯ï¼Œé‡æ•°å­—ç›¸å½“äºéšè—ã€‚</p><p>å½“ç„¶ï¼Œè¿˜æœ‰ä¸€ç§å®ç°æ–¹å¼ï¼Œå°±æ˜¯åœ¨methodsé‡Œå†™ä¸ªæ–¹æ³•ï¼ŒåŒæ—¶åœ¨inputåé¢ä½¿ç”¨æ•°æ®æ£€æŸ¥æ–¹æ³•æ¥å®ç°ã€‚</p><p>é‚£ä¹ˆï¼Œè¿™ä¸¤ç§æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿå“ªç§æ›´æ¨èå‘¢ï¼Ÿ</p><p>æ¨èç¬¬ä¸€ç§ã€‚</p><p>2ã€ çˆ¶å­ç»„ä»¶é—´ä¼ å€¼ï¼Œåœ¨vue2.0ä»¥ä¸Šç‰ˆæœ¬ï¼Œçˆ¶å­ç»„ä»¶ä¼ å€¼æ–¹å¼å¦‚ä¸‹<br><img src="/loading.gif" data-original="/images/fontend/vue-%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC.png" alt="çˆ¶å­ç»„ä»¶ä¼ å€¼.png"></p><p>ä¸¾ä¾‹ï¼Œçˆ¶ç»„ä»¶</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">></span>    <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> å‚æ•°ä¸åŒºåˆ†å¤§å°å†™ï¼Œä¹Ÿå°±æ˜¯æœ€å¥½ä¸è¦ä½¿ç”¨é©¼å³°å‘½åï¼Œç”¨ä¸­çº¿é“¾æ¥å³å¯ <span class="token operator">--</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> ä¼ å›ºå®šå€¼  <span class="token operator">--</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>com<span class="token operator">-</span>a number<span class="token operator">-</span>to<span class="token operator">-</span><span class="token keyword">do</span><span class="token operator">=</span><span class="token number">78</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>com<span class="token operator">-</span>a<span class="token operator">></span>   <span class="token operator">--</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> åŠ¨æ€ä¼ å€¼ <span class="token operator">--</span><span class="token operator">></span>        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"myVal"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>com<span class="token operator">-</span>a <span class="token punctuation">:</span>my<span class="token operator">-</span>value <span class="token operator">=</span> <span class="token string">"myVal"</span> @my<span class="token operator">-</span>event<span class="token operator">=</span><span class="token string">"getMyEvent"</span><span class="token operator">></span>            <span class="token operator">&lt;</span>p slot<span class="token operator">=</span><span class="token string">"header"</span><span class="token operator">></span>xxxxx header<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>            <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token number">1</span>ã€sloat ä½¿ç”¨æ’æ§½çš„æ–¹å¼ç”¨æ¥å°†å­ç»„ä»¶é‡Œçš„å†…å®¹æ’å…¥åˆ°çˆ¶ç»„ä»¶ä¸­ã€‚è¿˜å¯ä»¥è®¾å®šé»˜è®¤å€¼<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>            <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token number">2</span>ã€æ’æ§½å†…å®¹æ¯”è¾ƒå¤šçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å‘½åçš„æ–¹å¼æŒ‡å®šä¸ªå­—è¦å¤„ç†çš„æ’æ§½æ•°æ®<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>                        <span class="token operator">&lt;</span>p slot<span class="token operator">=</span><span class="token string">"footer"</span><span class="token operator">></span>xxxxx footer<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>com<span class="token operator">-</span>a<span class="token operator">></span>        <span class="token operator">&lt;</span>p <span class="token punctuation">:</span>is<span class="token operator">=</span><span class="token string">"currentView"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token keyword">import</span> ComA <span class="token keyword">from</span> <span class="token string">'../components/comA'</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>    components<span class="token punctuation">:</span> <span class="token punctuation">{</span>        ComA    <span class="token punctuation">}</span><span class="token punctuation">,</span>    data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            currentView<span class="token punctuation">:</span> <span class="token string">'com-a'</span><span class="token punctuation">,</span>            myVal <span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>            myList<span class="token punctuation">:</span> <span class="token punctuation">[</span>                <span class="token punctuation">{</span>                    name<span class="token punctuation">:</span><span class="token string">'appale'</span><span class="token punctuation">,</span>                    price<span class="token punctuation">:</span> <span class="token number">2.50</span>                <span class="token punctuation">}</span><span class="token punctuation">,</span>                <span class="token punctuation">{</span>                    name<span class="token punctuation">:</span><span class="token string">'banaber'</span><span class="token punctuation">,</span>                    price<span class="token punctuation">:</span><span class="token number">8.50</span>                <span class="token punctuation">}</span>            <span class="token punctuation">]</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token function">getMyEvent</span><span class="token punctuation">(</span>hello<span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I got my event and '</span> <span class="token operator">+</span> hello<span class="token punctuation">)</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å­ç»„ä»¶æ¥æ”¶å‚æ•°ä¾‹å­</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">></span>    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"comA"</span><span class="token operator">></span>        <span class="token punctuation">{</span><span class="token punctuation">{</span> hello <span class="token punctuation">}</span><span class="token punctuation">}</span>        <span class="token punctuation">{</span><span class="token punctuation">{</span> numberToDo<span class="token punctuation">}</span><span class="token punctuation">}</span>        <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"emitMyEvent"</span><span class="token operator">></span>emit<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> slotä¸­é—´çš„å†…å®¹æ˜¯slotçš„é»˜è®¤å€¼ <span class="token operator">--</span><span class="token operator">></span>        <span class="token operator">&lt;</span>slot name <span class="token operator">=</span> <span class="token string">"header"</span><span class="token operator">></span>no slot<span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">></span>    <span class="token operator">&lt;</span>slot<span class="token operator">></span>no slot<span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">></span>    <span class="token operator">&lt;</span>slot name <span class="token operator">=</span> <span class="token string">"footer"</span><span class="token operator">></span>no slot<span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// propsæ¥æ”¶ä¸¤ç§ç±»å‹çš„å‚æ•°</span>    <span class="token comment" spellcheck="true">// ä¸€ç§æ˜¯æ•°ç»„ï¼Œä¸€ç§æ˜¯å¯¹è±¡ã€‚å¯¹è±¡ç”¨çš„æ¯”è¾ƒå¤šï¼Œæ¥æ”¶æ—¶å¯ä»¥é™å®šç±»å‹</span>    <span class="token comment" spellcheck="true">// props: ['number-to-do'],</span>    props<span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 'number-to-do': [Number, String, Object]</span>        <span class="token string">'my-value'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Number<span class="token punctuation">,</span> String<span class="token punctuation">,</span> Object<span class="token punctuation">]</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            hello <span class="token punctuation">:</span> <span class="token string">"I am component A"</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    methods <span class="token punctuation">:</span> <span class="token punctuation">{</span>        emitMyEvent <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'my-event'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>hello<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span>style<span class="token operator">></span><span class="token punctuation">.</span>comA <span class="token punctuation">{</span>    background<span class="token operator">-</span>color<span class="token punctuation">:</span> antiquewhite<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>3ã€åŠ¨æ€ç»„ä»¶<br>åŠåœ¨templateä¸­åŠ¨æ€åŠ è½½éœ€è¦çš„ç»„ä»¶çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">></span>    <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"myVal"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>keep<span class="token operator">-</span>alive<span class="token operator">></span>            <span class="token operator">&lt;</span>p <span class="token punctuation">:</span>is<span class="token operator">=</span><span class="token string">"currentView"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>keep<span class="token operator">-</span>alive<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token keyword">import</span> ComA <span class="token keyword">from</span> <span class="token string">'../components/comA'</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>    components<span class="token punctuation">:</span> <span class="token punctuation">{</span>        ComA    <span class="token punctuation">}</span><span class="token punctuation">,</span>    data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            currentView<span class="token punctuation">:</span> <span class="token string">'com-a'</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>:is  å®ç°åŠ¨æ€ç»„ä»¶åˆ‡æ¢ï¼Œæ¯”å¦‚  :is=â€currentViewâ€ è€Œåœ¨dataé‡Œç»™currentViewèµ‹å€¼comAã€‚<br>æ­¤æ—¶å¯ä»¥ç”¨keep-aliveå°†ç»„ä»¶ç¼“å­˜ï¼Œæ¯”å¦‚comAå’ŒcomBäº’ç›¸åˆ‡æ¢æ—¶ä¼šå°†ä¸æ˜¾ç¤ºçš„å†…å®¹è¿›è¡Œç¼“å­˜ï¼Œæé«˜åˆ‡æ¢æ—¶æ˜¾ç¤ºé€Ÿåº¦ã€‚</p><p>4ã€cssé˜¶æ®µç±»å<br><img src="/loading.gif" data-original="/images/fontend/vue-css%E9%98%B6%E6%AE%B5%E7%B1%BB%E5%90%8D.png" alt="vue-cssé˜¶æ®µç±»å"></p><pre class="line-numbers language-js"><code class="language-js">    <span class="token operator">&lt;</span>button v<span class="token operator">-</span>on<span class="token punctuation">:</span>click<span class="token operator">=</span><span class="token string">"show = !show"</span><span class="token operator">></span>            Toggle      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>p v<span class="token operator">-</span>color<span class="token operator">=</span><span class="token string">"'red'"</span><span class="token operator">></span>Hello World<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span> <span class="token operator">--</span><span class="token operator">></span>                <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"ab"</span><span class="token operator">></span>            <span class="token operator">&lt;</span>transition name<span class="token operator">=</span><span class="token string">"fade"</span><span class="token operator">></span>                <span class="token operator">&lt;</span>p v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"show"</span><span class="token operator">></span>é€æ˜åˆ‡æ¢æ•ˆæœ<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">></span>            <span class="token operator">&lt;</span>transition name<span class="token operator">=</span><span class="token string">"my-trans"</span><span class="token operator">></span>                <span class="token operator">&lt;</span>p v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"show"</span><span class="token operator">></span>ä¸Šå…¥ä¸‹å‡ºåŠ¨ç”»<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>style<span class="token operator">></span><span class="token punctuation">.</span>fade<span class="token operator">-</span>enter<span class="token operator">-</span>active<span class="token punctuation">,</span> <span class="token punctuation">.</span>fade<span class="token operator">-</span>leave<span class="token operator">-</span>active <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/* opacityæ˜¯é€æ˜åº¦çš„æ„æ€ï¼Œå¦‚æœæ˜¯æ‰€æœ‰å±æ€§éƒ½è¦transitionï¼Œè¦å°†opacityæ”¹æˆall */</span>    transition<span class="token punctuation">:</span> opacity <span class="token punctuation">.</span>5s<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">.</span>fade<span class="token operator">-</span>enter<span class="token punctuation">,</span> <span class="token punctuation">.</span>fade<span class="token operator">-</span>leave <span class="token punctuation">{</span>    opacity<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">.</span>my<span class="token operator">-</span>trans<span class="token operator">-</span>enter<span class="token operator">-</span>active<span class="token punctuation">,</span> <span class="token punctuation">.</span>my<span class="token operator">-</span>trans<span class="token operator">-</span>leave<span class="token operator">-</span>active <span class="token punctuation">{</span>    transition<span class="token punctuation">:</span> all <span class="token number">0</span><span class="token punctuation">.</span>5s ease<span class="token operator">-</span>out<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">.</span>my<span class="token operator">-</span>trans<span class="token operator">-</span>enter <span class="token punctuation">{</span>    transform<span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span><span class="token operator">-</span>500px<span class="token punctuation">)</span><span class="token punctuation">;</span>    opacity<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">.</span>my<span class="token operator">-</span>trans<span class="token operator">-</span>leave<span class="token operator">-</span>active <span class="token punctuation">{</span>    transform<span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span>500px<span class="token punctuation">)</span><span class="token punctuation">;</span>    opacity<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>enter-activeå‰é¢çš„åå­—å°±æ˜¯nameå‰é¢çš„åå­—ã€‚è¯¥å¤„çš„æ¼”ç¤ºå…ƒç´ ç”¨çš„æ˜¯pæ ‡ç­¾ï¼Œå…¶å®å¯ä»¥æ˜¯ä¸€ä¸ªdivï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªcomponentï¼Œå®ç°åŠ¨æ€ç»„ä»¶è¿‡æ¸¡ã€‚transition é»˜è®¤çš„modeæ˜¯in-outï¼Œä¹Ÿå¯ä»¥æ”¹æˆout-inï¼Œä¹Ÿå°±æ˜¯æ–°çš„å‡ºæ¥çš„å®ç°å’Œæ—§çš„æ¶ˆå¤±çš„æ—¶æœºé—®é¢˜ã€‚</p><p>5ã€å…ƒç´ /ç»„ä»¶è¿›å…¥/ç¦»å¼€ &amp; åˆ—è¡¨è¿‡æ¸¡<br><a href="https://cn.vuejs.org/v2/guide/transitions.html">å®˜ç½‘</a></p><pre class="line-numbers language-html"><code class="language-html">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>show <span class="token punctuation">=</span> !show<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            è¿›å…¥/ç¦»å¼€è¿‡æ¸¡åŠ¨ç”»         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ab<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span>             <span class="token attr-name">@before-enter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>beforeEnter<span class="token punctuation">"</span></span>            <span class="token attr-name">@enter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>enter<span class="token punctuation">"</span></span>            <span class="token attr-name">@leave</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>leave<span class="token punctuation">"</span></span>            <span class="token attr-name">:css</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>animate-p<span class="token punctuation">"</span></span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>show<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>I am show<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-js"><code class="language-js">methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token function">getMyEvent</span><span class="token punctuation">(</span>hello<span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I got my event and '</span> <span class="token operator">+</span> hello<span class="token punctuation">)</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        beforeEnter<span class="token punctuation">:</span> <span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                left<span class="token punctuation">:</span><span class="token string">'-500px'</span><span class="token punctuation">,</span>                opacity<span class="token punctuation">:</span><span class="token number">0</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        enter<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> done<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                left<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>                opacity<span class="token punctuation">:</span><span class="token number">1</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                duration<span class="token punctuation">:</span> <span class="token number">1500</span><span class="token punctuation">,</span>                complete<span class="token punctuation">:</span> done            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        leave<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> done<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                left<span class="token punctuation">:</span> <span class="token string">'500px'</span><span class="token punctuation">,</span>                opacity<span class="token punctuation">:</span><span class="token number">0</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>                duration<span class="token punctuation">:</span><span class="token number">1500</span><span class="token punctuation">,</span>                complete<span class="token punctuation">:</span>done            <span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>6ã€è‡ªå®šä¹‰æŒ‡ä»¤<br>è‡ªå®šä¹‰æŒ‡ä»¤functionä½¿ç”¨direactivesæ¥å®šä¹‰ï¼Œä¸dataï¼Œmethodç­‰å¹³è¡Œã€‚ä½¿ç”¨æ—¶æ˜¯â€™v-xxxâ€™çš„å½¢å¼ï¼Œåé¢çš„xxxä¸directivesé‡Œçš„functionåè¦ä¸€è‡´ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>p v<span class="token operator">-</span>color<span class="token operator">=</span><span class="token string">"'red'"</span><span class="token operator">></span>v<span class="token operator">-</span>xxx çš„è‡ªå®šä¹‰æŒ‡ä»¤<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-js"><code class="language-js">directives<span class="token punctuation">:</span> <span class="token punctuation">{</span>    color<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> binding<span class="token punctuation">)</span> <span class="token punctuation">{</span>        el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> binding<span class="token punctuation">.</span>value    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ˜¯åœ¨ç»„ä»¶å†…éƒ¨ï¼Œä¹Ÿå°±æ˜¯è¯´v-coloræŒ‡ä»¤åªèƒ½åœ¨è¿™ä¸ªç»„ä»¶å†…ä½¿ç”¨ã€‚é‚£ä¹ˆï¼Œæ€ä¹ˆå®šä¸€ä¸ªå…¨å±€çš„æŒ‡ä»¤ï¼Œå¯ä»¥åœ¨æ‰€æœ‰ç»„ä»¶å†…ä½¿ç”¨å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å°†æ­¤å®šä¹‰æ”¾åœ¨Vueå®ä¾‹åŒ–çš„åœ°æ–¹ï¼Œæ¯”å¦‚main.jsé‡Œé¢ã€‚</p><p>7ã€vue-cli è„šæ‰‹æ¶çš„å®‰è£…å’Œä½¿ç”¨<br><img src="/loading.gif" data-original="/images/fontend/vue-cli-install.png" alt="vue-cli å®‰è£…"></p><p>8ã€cnpmçš„ä½¿ç”¨<br><img src="/loading.gif" data-original="/images/fontend/vue-cli-cnpm.png" alt="cnpmå‘½ä»¤ä½¿ç”¨"></p><p>9ã€vue-routeræ·»åŠ å­ç»„ä»¶<br>æ³¨æ„ä¸€ç‚¹ï¼Œå¦‚æœè·¯ç”±æœ‰å­è·¯ç”±ï¼Œæ¯”å¦‚<a href="http://localhost:3000/apple/">http://localhost:3000/apple/</a> å’Œ<a href="http://localhost:3000/apple/red%EF%BC%8C%E5%85%B6%E4%B8%AD%E7%AC%AC%E4%BA%8C%E6%98%AF%E5%B0%B1%E6%98%AF%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%9A%84%E5%AD%90%E8%B7%AF%E7%94%B1%EF%BC%8C%E8%B7%AF%E7%94%B1%E4%BB%A3%E7%A0%81%E6%98%AF%E8%BF%99%E6%A0%B7%E7%9A%84">http://localhost:3000/apple/redï¼Œå…¶ä¸­ç¬¬äºŒæ˜¯å°±æ˜¯ç¬¬ä¸€ä¸ªçš„å­è·¯ç”±ï¼Œè·¯ç”±ä»£ç æ˜¯è¿™æ ·çš„</a></p><pre class="line-numbers language-js"><code class="language-js"><span class="token punctuation">{</span>      path<span class="token punctuation">:</span> <span class="token string">'/apple'</span><span class="token punctuation">,</span>      component<span class="token punctuation">:</span> Apple<span class="token punctuation">,</span>      children<span class="token punctuation">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">{</span>          path<span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span>          component<span class="token punctuation">:</span> RedApple        <span class="token punctuation">}</span>      <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/vue-clj-route.png" alt="æ·»åŠ è·¯ç”±"></p><p>è¿™æ—¶å€™å¦‚æœè¦è®©redè¿™ä¸ªå­è·¯ç”±ç”Ÿæ•ˆï¼Œå¿…é¡»åœ¨appleè¿™ä¸ªçˆ¶ç»„ä»¶ä¸­ä¹Ÿä½¿ç”¨<code>&lt;router-view&gt;&lt;/router-view&gt;</code>,æ‰èƒ½æ‰“åŒ…ç›®çš„ï¼Œapple/redæ‰èƒ½æ¸²æŸ“å‡ºredappleä¸­çš„å†…å®¹<br><img src="/loading.gif" data-original="/images/fontend/vue-clj-route2.png" alt="å­è·¯ç”±"></p><p>apple.vueæ–‡ä»¶çš„å†…å®¹ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">></span>  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"content"</span><span class="token operator">></span>      <span class="token operator">&lt;</span>img <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"img"</span> src<span class="token operator">=</span><span class="token string">"../assets/apple.jpg"</span> alt<span class="token operator">=</span><span class="token string">"appale"</span><span class="token operator">></span>      <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"getParam"</span><span class="token operator">></span><span class="token keyword">get</span> route param<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>      <span class="token operator">&lt;</span>router<span class="token operator">-</span>view<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>view<span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span> <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>10ã€vue-link<br>è¿™ä¸ªç»„ä»¶ä¹Ÿæ˜¯è®¾ç½®è·¯ç”±ç”¨çš„ï¼Œå¯ä»¥ç»‘å®šéœ€è¦è·³è½¬çš„åœ°å€ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-js"><code class="language-js">      <span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token punctuation">:</span>to<span class="token operator">=</span><span class="token string">"{name: 'applePage'}"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">></span>      <span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token punctuation">:</span>to<span class="token operator">=</span><span class="token string">"'goods'"</span><span class="token operator">></span> to goodsList <span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">></span>      <span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token punctuation">:</span>to<span class="token operator">=</span><span class="token string">"{path : 'banana', param:{color:'yellow'}}"</span><span class="token operator">></span> to banana <span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">></span>      <span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token punctuation">:</span>to<span class="token operator">=</span><span class="token string">"{path : 'apple/red'}"</span><span class="token operator">></span> to red apple <span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">></span>      <span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token punctuation">:</span>to<span class="token operator">=</span><span class="token string">"goodsDetail"</span><span class="token operator">></span> to goods detail <span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢çš„applePageå’Œgoodsæ˜¯è¦åœ¨dataé‡Œå®šä¹‰çš„ï¼Œä¸ç„¶æ˜¯ä¼šæŠ¥é”™çš„ã€‚<br>å½“ç„¶ï¼Œè¿™ä¸ªæ˜¯åœ¨å…¥å£çš„App.vueé‡Œï¼Œå› ä¸ºè·³è½¬åœ°å€éƒ½æ˜¯æ ¹è·¯å¾„ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœè¿™æ®µä»£ç åœ¨apple.vueè¿™ä¸ªç±»ä¸­ï¼Œé¡µé¢å¦‚ä¸‹ï¼š<br><img src="/loading.gif" data-original="/images/fontend/vue-clj-apple.png" alt="apple page"></p><p>é‚£è¿™äº›æŒ‰é’®ç‚¹ä¸‹å»ä»¥åurlä¼šå˜æˆä»€ä¹ˆå‘¢?æ¯”å¦‚ç¬¬ä¸€ä¸ªgoodsListï¼Œå°±ä¼šæ˜¯è¿™æ ·ï¼š<br><img src="/loading.gif" data-original="/images/fontend/vue-clj-apple-list.png" alt="apple list"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è·¯ç”±çš„å‰é¢éƒ½æœ‰ä¸€ä¸ª<code>apple</code>è¿™ä¸ªè·¯å¾„ã€‚</p><p>å…¶ä»–çœ‹<a href="https://router.vuejs.org/">vue-routeå®˜ç½‘</a>å§</p><ul><li><p>å‘½åè·¯ç”±<br>å‘½åè·¯ç”±æ˜¯æŒ‡åœ¨route-viewæ ‡ç­¾ä¸ŠæŒ‡å®šç»„ä»¶åç§°ï¼Œæ¯”å¦‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>router<span class="token operator">-</span>view name<span class="token operator">=</span><span class="token string">"viewA"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>view<span class="token operator">></span><span class="token operator">&lt;</span>router<span class="token operator">-</span>view name<span class="token operator">=</span><span class="token string">"viewB"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>view<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å“åº”çš„åœ¨routeré‡ŒæŒ‡å®šç»„ä»¶å°±å¯ä»¥ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token punctuation">{</span>    path<span class="token punctuation">:</span> <span class="token string">'/apple'</span><span class="token punctuation">,</span>    component<span class="token punctuation">:</span> <span class="token punctuation">{</span>        viewA<span class="token punctuation">:</span> Apple<span class="token punctuation">,</span>        viewB<span class="token punctuation">:</span> RedApple    <span class="token punctuation">}</span><span class="token punctuation">,</span>    children<span class="token punctuation">:</span> <span class="token punctuation">[</span>      <span class="token punctuation">{</span>        path<span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span>        component<span class="token punctuation">:</span> RedApple      <span class="token punctuation">}</span>    <span class="token punctuation">]</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·åŒ¹é…æ¥ç”¨ã€‚</p></li><li><p>é‡å®šå‘<br>ç›®æ ‡ï¼šè®¿é—®æ ¹ç›®å½•æ˜¯è‡ªåŠ¨è®¿é—®appleè¿™ä¸ªè·¯å¾„ã€‚</p><pre class="line-numbers language-js"><code class="language-js"><span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>redirect<span class="token punctuation">:</span> <span class="token string">'apple'</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>11ã€ vuex â€“ <a href="https://vuex.vuejs.org/zh/">å®˜ç½‘</a><br>vuexæ˜¯çŠ¶æ€ç®¡ç†æ’ä»¶ã€‚å°†ç»„ä»¶ä¹‹é—´å…±äº«çš„çŠ¶æ€ï¼Œå…¬ç”¨å‹å†…å®¹çš„æ”¹åŠ¨ç­‰ä½¿ç”¨ç»Ÿä¸€çš„çŠ¶æ€ç®¡ç†æ’ä»¶èµ·æ¥ã€‚</p><p>æ•°æ®çŠ¶æ€ç®¡ç†æ¨¡å¼å›¾ï¼š<br><img src="/loading.gif" data-original="/images/fontend/vuex.png" alt="vuex"></p><p>flux:çŠ¶æ€ç®¡ç†å®ç°æµç¨‹ï¼š<br>![vuex-flux(/images/fontend/vuex-flux.png)</p><p>actionå’Œmutatonsçš„åŒºåˆ«ï¼Œmunationæœ¬èº«å¯ä»¥ä¿®æ”¹stateçš„å€¼ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¿˜è¦é€šè¿‡actionæ¥å¤„ç†å‘¢ï¼Ÿå› ä¸ºactionè¿™ä¸€æ­¥å¯ä»¥åŠ æ¯”å¦‚å¼‚æ­¥ã€ç½‘ç»œè¯·æ±‚ç­‰è¿™æ ·çš„å®ç°é€»è¾‘ï¼Œè€Œmutationåªèƒ½æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿä¸èƒ½åœ¨å…¶ä¸­å‘å‡ºhttpè¯·æ±‚ã€‚</p><p>vuexå¸¸ç”¨çš„æœ‰stateï¼Œmuntionsï¼Œgettersï¼Œactionsï¼Œmodulesè¿™å‡ ä¸ªæ ¸å¿ƒçš„conceptsï¼Œæ›´è¯¦ç»†çš„è¯·å‚è€ƒ<a href="https://vuex.vuejs.org/zh/">å®˜ç½‘</a>.</p><p>ç¤ºä¾‹ä»£ç ï¼š<br>vuex.vueå…¥å£æ–‡ä»¶</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">></span>    <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> msg <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token operator">&lt;</span>p<span class="token operator">></span> state æ€»ä»·<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span> totalPrice <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token operator">&lt;</span>dog<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>dog<span class="token operator">></span>        <span class="token operator">&lt;</span>cat<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>cat<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token keyword">import</span> Dog <span class="token keyword">from</span> <span class="token string">'../components/dog'</span><span class="token keyword">import</span> Cat <span class="token keyword">from</span> <span class="token string">'../components/cat'</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>    data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            msg <span class="token punctuation">:</span> <span class="token string">'vuex demo'</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    components<span class="token punctuation">:</span> <span class="token punctuation">{</span>        Dog<span class="token punctuation">,</span>        Cat    <span class="token punctuation">}</span><span class="token punctuation">,</span>    computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token function">totalPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>getTotal            <span class="token comment" spellcheck="true">//vuexå¯¦ç¾äº†getteræ–¹æ³•ï¼Œå› æ­¤ä¸æ¨èç›´æ¥ä»stateä¸­æ‹¿å±æ€§çš„å€¼</span>            <span class="token comment" spellcheck="true">// return this.$store.state.totalPrice</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒ…æ‹¬çš„ä¸¤ä¸ªå­ç»„ä»¶dog.vue</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">></span>    <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> msg <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"addOne"</span><span class="token operator">></span>add one<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>        <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"minusOne"</span><span class="token operator">></span>minus one<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>    data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            msg <span class="token punctuation">:</span> <span class="token string">'I am a dog, each of me is 5$. '</span><span class="token punctuation">,</span>            price<span class="token punctuation">:</span> <span class="token number">5</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token function">addOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price<span class="token punctuation">)</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token function">minusOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'decrement'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price<span class="token punctuation">)</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å’Œcat.vue</p><pre class="line-numbers language-js"><code class="language-js"><span class="token operator">&lt;</span>template<span class="token operator">></span>    <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> msg <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"addOne"</span><span class="token operator">></span>add one<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>        <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"minusOne"</span><span class="token operator">></span>minus one<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>    data <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            msg <span class="token punctuation">:</span> <span class="token string">'I am a dog, each of me is 15$. '</span><span class="token punctuation">,</span>            price<span class="token punctuation">:</span> <span class="token number">15</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token function">addOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//æ¨èä½¿ç”¨actionè°ƒç”¨mutationçš„æ–¹å¼</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'increase'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">//ä¸æ¨èä½¿ç”¨ä¸‹é¢çš„ç›´æ¥è°ƒç”¨mutationsæ–¹æ³•çš„æ–¹å¼</span>            <span class="token comment" spellcheck="true">// this.$store.commit('increment', this.price)</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token function">minusOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'decrement'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price<span class="token punctuation">)</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°çš„æ•ˆæœï¼š<br><img src="/loading.gif" data-original="https://upload-images.jianshu.io/upload_images/4109786-e3b9be38a2f9a8e4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="vuex demo"></p><h2 id="è§†é¢‘å’Œæºç "><a href="#è§†é¢‘å’Œæºç " class="headerlink" title="è§†é¢‘å’Œæºç "></a>è§†é¢‘å’Œæºç </h2><p>è§†é¢‘å…±äº«ï¼š<br>é“¾æ¥: <a href="https://pan.baidu.com/s/18TFC0-VSCIWFo977p4YcTQ">https://pan.baidu.com/s/18TFC0-VSCIWFo977p4YcTQ</a><br>æå–ç : rjcp </p><p>æºä»£ç å…±äº«ï¼š<br><a href="https://gitee.com/marvinma/vue2-pc">https://gitee.com/marvinma/vue2-pc</a></p>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windowsä¸Šå®‰è£…nvm-nodeç‰ˆæœ¬ç®¡ç†å·¥å…·å„ç§å</title>
      <link href="2018/09/02/windows-shang-an-zhuang-nvm-node-ban-ben-guan-li-gong-ju-ge-chong-kan/"/>
      <url>2018/09/02/windows-shang-an-zhuang-nvm-node-ban-ben-guan-li-gong-ju-ge-chong-kan/</url>
      
        <content type="html"><![CDATA[<p>nodejsç‰ˆæœ¬ç®¡ç†å·¥å…·åœ¨windowsç¯å¢ƒä¸Šå®‰è£…å’Œä½¿ç”¨<br><a href="https://www.jianshu.com/p/c424a44f6964">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨githubä¸Šforkäº†ä¸€ä¸ªvueç®¡ç†åå°çš„<a href="https://gitee.com/smallweigit/avue">é¡¹ç›®</a>ï¼Œnpm installçš„æ—¶å€™æç¤ºnode è¦ç”¨8.10åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ä½†æ˜¯æˆ‘æ­£åœ¨ç®¡ç†çš„é¡¹ç›®ç”¨çš„åˆæ˜¯8.9ï¼Œè·Ÿåˆ«çš„å‰ç«¯åŒäº‹èŠå¤©æ— æ„ä¸­æ‰çŸ¥é“nodeè¿˜æœ‰ä¸“é—¨çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œè¯´æ˜¯<code>npm install n</code> å°±è¡Œï¼Œäºæ˜¯ä¸Šç­å»è¯•äº†ä¸€æŠŠã€‚</p><h3 id="æ­£é¢˜"><a href="#æ­£é¢˜" class="headerlink" title="æ­£é¢˜"></a>æ­£é¢˜</h3><p>ä¸è¯•ä¸è¦ç´§ï¼Œä¸€è¯•å°±å¼€å¿ƒäº†ï¼Œä¸€å¼€å§‹ç”¨çš„<code>npm install -g n</code><br><img src="/loading.gif" data-original="/images/fontend/npm-install-error.png" alt="npm-install-error"></p><p>åŸæ¥ï¼Œwindowsä¸Šæ²¡æœ‰ï¼Œwindowsä¸Šå«åšnvmï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://github.com/coreybutler/nvm-windows/releases">https://github.com/coreybutler/nvm-windows/releases</a></p><p><strong>å®‰è£…å‚è€ƒ</strong>ï¼š<br><a href="https://blog.csdn.net/sinat_38334334/article/details/80013648">https://blog.csdn.net/sinat_38334334/article/details/80013648</a>  </p><h3 id="ç¢°åˆ°çš„å‘ï¼š"><a href="#ç¢°åˆ°çš„å‘ï¼š" class="headerlink" title="ç¢°åˆ°çš„å‘ï¼š"></a>ç¢°åˆ°çš„å‘ï¼š</h3><p>1ã€ å®‰è£…ä¸Šåªå¥½æ‰§è¡Œnvm use 8.10.0 æç¤ºé”™è¯¯ï¼Œä¸èƒ½ä½¿ç”¨ã€‚</p><p>æœ€åæ‰æŸ¥åˆ°nvmå®‰è£…åœ¨C:\Program Files\nvmä¸‹ï¼Œè·¯å¾„ä¸‹æœ‰ç©ºæ ¼å¯¼è‡´çš„ã€‚è¿™ä¸€ç‚¹åœ¨æ–‡ç« æœ€åæœ‰è¯´æ˜ã€‚</p><p>2ã€è§£å†³äº†ä»¥ååˆå˜æˆï¼š<br><img src="/loading.gif" data-original="/images/fontend/nvm-error1.png" alt="nvm-error1"></p><p>è¿™æ˜¯gitè¿™ä¸ªå‘½ä»¤è¡Œçš„é—®é¢˜ï¼ŒåŸå› ä¸ç»†ç©¶äº†ï¼Œç”¨ç³»ç»Ÿè‡ªå¸¦çš„å‘½ä»¤è¡Œç®¡ç†å·¥å…·å¯ä»¥æ‰§è¡Œã€‚</p><p><img src="/loading.gif" data-original="/images/fontend/nvm-error2.png" alt="nvm-error2"></p><p>3ã€ç„¶åå°±å¯ä»¥ä½¿ç”¨äº†<br><img src="/loading.gif" data-original="/images/fontend/nvm-error3.png" alt="image"></p><p>å¯ä»¥å®‰è£…åˆ«çš„ç‰ˆæœ¬äº†ï¼Œç¾æ»‹æ»‹<br><img src="/loading.gif" data-original="/images/fontend/nvm-success.png" alt="åˆ‡æ¢ä½¿ç”¨"></p><h3 id="æ–‡ç« æœ€åå†æŠ„ç‚¹"><a href="#æ–‡ç« æœ€åå†æŠ„ç‚¹" class="headerlink" title="æ–‡ç« æœ€åå†æŠ„ç‚¹"></a>æ–‡ç« æœ€åå†æŠ„ç‚¹</h3><h5 id="ä½¿ç”¨å‘½ä»¤æ—¶æ³¨æ„ç‚¹"><a href="#ä½¿ç”¨å‘½ä»¤æ—¶æ³¨æ„ç‚¹" class="headerlink" title="ä½¿ç”¨å‘½ä»¤æ—¶æ³¨æ„ç‚¹"></a>ä½¿ç”¨å‘½ä»¤æ—¶æ³¨æ„ç‚¹</h5><ul><li>è¯·ç”¨ç®¡ç†å‘˜èº«ä»½è¿è¡Œå‘½ä»¤ç®¡ç†å™¨ï¼Œå¦åˆ™å¯èƒ½å‡ºé”™ã€‚</li><li>å…ˆè®¾ç½®nodeå’Œnpmçš„æ·˜å®é•œåƒï¼Œè¿™æ ·æˆåŠŸç‡å’Œä¸‹è½½é€Ÿåº¦ä¼šæ›´é«˜ç‚¹ã€‚<h5 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h5>1ï¼šä¸»è¦ç”¨é€”ï¼Œåˆ‡æ¢nodejsç‰ˆæœ¬ã€‚å¦‚æœæƒ³ä½¿ç”¨æœ€æ–°çš„æµè¡Œç‰ˆæœ¬æµ‹è¯•æ‚¨æ­£åœ¨å¼€å‘çš„æ¨¡å—ï¼Œè€Œä¸ç”¨å¸è½½ç¨³å®šç‰ˆæœ¬çš„nodeï¼Œåˆ™å¯ä»¥ä½¿ç”¨nvmæ¥åˆ‡æ¢nodejsç‰ˆæœ¬ã€‚</li></ul><h5 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h5><ul><li>1ã€nvmå®‰è£…ç›®å½•ï¼Œæœ€å¥½ä¸è¦å­˜åœ¨ç©ºæ ¼ã€‚å¦åˆ™ï¼Œnvmå¯ä»¥å®‰è£…æˆåŠŸï¼Œä½†ä½¿ç”¨nvm use x.y.zï¼ˆnodejsçš„åˆ‡æ¢ï¼‰ä¼šæœ‰é—®é¢˜ã€‚</li><li>2ã€æœ‰äº›å…¨å±€çš„npmæ¨¡å—ï¼Œå¯èƒ½åœ¨å„ç‰ˆæœ¬çš„node.jsä¹‹é—´ä¸å…±äº«ã€‚</li><li>3ã€ä½ æ­£åœ¨ä½¿ç”¨çš„node.jsç‰ˆæœ¬ä¸­å¯èƒ½ä¸æ”¯æŒæŸäº›npmæ¨¡å—ã€‚å› æ­¤åœ¨å·¥ä½œçš„æ—¶å€™è¯·æ³¨æ„å·¥ä½œç¯å¢ƒã€‚</li></ul><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://blog.csdn.net/sinat_38334334/article/details/80013648">windowsä¸ŠNVMå®‰è£…ä¸ä½¿ç”¨</a></p>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
            <tag> tools </tag>
            
            <tag> node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux å®‰è£…mavenï¼ŒjenkinsæŒç»­é›†æˆ</title>
      <link href="2018/08/14/linux-an-zhuang-maven-jenkins-chi-xu-ji-cheng/"/>
      <url>2018/08/14/linux-an-zhuang-maven-jenkins-chi-xu-ji-cheng/</url>
      
        <content type="html"><![CDATA[<p>å¼€å‘ç¯å¢ƒæ­å»ºâ€”å®‰è£…mavenå’ŒjenkinsæŒç»­é›†æˆ<br><a href="https://www.jianshu.com/p/64a7027df154">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="1ã€å®‰è£…maven"><a href="#1ã€å®‰è£…maven" class="headerlink" title="1ã€å®‰è£…maven"></a>1ã€å®‰è£…maven</h3><p>1.1ã€ åˆ›å»ºä¸€ä¸ªmavenæ–‡ä»¶å¤¹ï¼Œè§£å‹mavenæ–‡ä»¶</p><pre class="line-numbers language-shell"><code class="language-shell">[root@1169CKT ~]# cd /home/haieradmin/softs/[root@1169CKT softs]# lsapache-maven-3.5.2-bin.tar.gz &nbsp;apache-tomcat-8.5.24.tar.gz &nbsp;jdk-8u151-linux-x64.tar.gz &nbsp;mysql57-community-release-el7-8.noarch.rpm &nbsp;nginx-1.12.2.tar.gz &nbsp;redis-4.0.6.tar.gz[root@1169CKT softs]# mkdir /usr/local/maven[root@1169CKT softs]# tar -zxvf apache-maven-3.5.2-bin.tar.gz -C /usr/local/maven/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>1.2ã€è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œåœ¨/etc/profileçš„æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹é…ç½®:</p><pre class="line-numbers language-shell"><code class="language-shell">export M2_HOME=/usr/local/maven/apache-maven-3.5.2export PATH=$JAVA_HOME/bin:$JAVA_HOME/jre/bin:$M2_HOME/bin:$PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰§è¡Œsourceå‘½ä»¤è®©æ–°é…ç½®ç«‹å³ç”Ÿæ•ˆ:</p><pre class="line-numbers language-shell"><code class="language-shell">[root@1169CKT softs]# source /etc/profile[root@1169CKT softs]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>1.3ã€éªŒè¯</p><pre class="line-numbers language-shell"><code class="language-shell">[root@1169CKT softs]# mvn -vApache Maven 3.5.2 (138edd61fd100ec658bfa2d307c43b76940a5d7d; 2017-10-18T15:58:13+08:00)Maven home: /usr/local/maven/apache-maven-3.5.2Java version: 1.8.0_151, vendor: Oracle CorporationJava home: /usr/local/java/jdk1.8.0_151/jreDefault locale: en_US, platform encoding: UTF-8OS name: "linux", version: "3.10.0-693.el7.x86_64", arch: "amd64", family: "unix"[root@1169CKT softs]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2ã€å®‰è£…jenkins"><a href="#2ã€å®‰è£…jenkins" class="headerlink" title="2ã€å®‰è£…jenkins"></a>2ã€å®‰è£…jenkins</h3><p>å®‰è£…jenkinsç®€å•æ¥è¯´éœ€è¦ä¸‹é¢å››æ­¥ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">wget -q -O - https://pkg.jenkins.io/debian/jenkins-ci.org.key | sudo apt-key add -sudo sh -c 'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'sudo apt-get updatesudo apt-get install jenkins<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/linux/linux-install-jenkins.png" alt="install"></p><p>2.1ã€ å®‰è£…ç®€ä»‹:</p><blockquote><p>1ã€é€šè¿‡ä¸Šé¢çš„å®‰è£…ï¼ŒJenkinså°†ä½œä¸ºä¸€ä¸ªLinuxå®ˆæŠ¤è¿›ç¨‹ï¼Œå¯ä»¥æŸ¥çœ‹æ–‡ä»¶/etc/init.d/jenkins<br>2ã€åˆ›å»ºä¸€ä¸ªåä¸ºJenkinsçš„Linuxç”¨æˆ·<br>3ã€ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ /var/log/jenkins/jenkins.log<br>4ã€Jenkins é»˜è®¤ç«¯å£æ˜¯8080ï¼Œåœ¨é…ç½®æ–‡ä»¶/etc/default/jenkins ä¸­å®šä¹‰ã€‚</p></blockquote><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-pwd.png" alt="password"></p><p>install plugins<br><img src="/loading.gif" data-original="/images/linux/jenkins-install-plugins.png" alt="install plugins"></p><p>started</p><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-started.png" alt="started"></p><p>è®¾ç½®ç”¨æˆ·åå¯†ç :admin/admin123</p><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-first.png" alt="é¦–æ¬¡è®¿é—®"></p><p>å¯åŠ¨åè®¿é—®ï¼š</p><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-success.png" alt="è¿›å…¥jenkins"></p><p>2.2ã€ é…ç½®æƒé™</p><p>gitä»£ç åº“æˆæƒé…ç½®é—®é¢˜ï¼Œéœ€è¦é…ç½®sshå…å¯†ç ç™»å½•ï¼Œæ³¨æ„ï¼Œå¿…é¡»æ˜¯jenkinsç”¨æˆ·çš„æˆæƒï¼Œä¸æ˜¯rootç”¨æˆ·<br>å¦‚æœsshæˆ–è€…scpæ—¶é‡åˆ°é”™è¯¯ç±»ä¼¼å¦‚ä¸‹ï¼š<br><code>ssh_exchange_identification: read: Connection reset by peer</code><br>é‚£å°±æ˜¯éœ€è¦è®¾ç½®è®¿é—®IPçš„ç™½åå•ï¼Œå…·ä½“æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š<br>é»‘åå•<br><code>cat /etc/hosts.deny</code><br>ç™½åå•<br><code>cat /etc/hosts.allow</code><br>åŠ ä¸Šéœ€è¦è®¿é—®æœ¬æœºçš„æœåŠ¡å™¨ipåœ°å€ï¼Œä¿å­˜å³å¯ã€‚<br>å¦‚æœsshåˆ°å…¶ä»–æœåŠ¡å™¨å‡ºç°<br><code>centos ssh: connect to host 10.138.227.188 port 22: No route to host</code><br>çš„é”™è¯¯ï¼Œæµ‹éœ€è¦åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šé…ç½®22ç«¯å£çš„é˜²ç«å¢™ç™½åå•ï¼Œå¦‚æœæ˜¯firewallï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><pre class="line-numbers language-shell"><code class="language-shell">firewall-cmd --permanent --add-port=22/tcpfirewall-cmd --reload<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-no-git-per.png" alt="jenkinsæ²¡æœ‰gitæƒé™"></p><p>æˆæƒé…ç½®æ­£ç¡®ä»¥åçš„æ ·å­å¤§æ¦‚æ˜¯è¿™æ ·çš„<br><img src="/loading.gif" data-original="/images/linux/jenkins-install-git-ok.png" alt="gitæˆæƒok"></p><pre class="line-numbers language-shell"><code class="language-shell">ssh-keygen -t rsa      #ç”Ÿæˆkey cd /var/lib/jenkins/.ssh     #å¦‚æœæ²¡æœ‰åˆ›å»ºjenkins homeçš„è¯ï¼Œå¯ä»¥ä¸Šjenkinsçš„å…¨å±€è®¾ç½®é‡ŒæŸ¥çœ‹jenkinsä¸»ç›®å½•ï¼Œç„¶åæŸ¥çœ‹sshè·¯å¾„scp -r /root/.ssh/id_rsa.pub 192.168.31.147:/root/.ssh/authorized_keys<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœjenkinså¯åŠ¨æ—¶æœ€åæç¤ºæ‰¾ä¸åˆ°JAVA_HOMEï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ</p><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-job-error1.png" alt="java-home é”™è¯¯"></p><p>è¿™ä¸ªæƒ…å†µéœ€è¦å†tomcatçš„binç›®å½•ä¸‹æ‰¾åˆ°setclasspath.shæ–‡ä»¶ï¼Œæ·»åŠ ä¸ŠJAVA_HOMEç›®å½•ã€‚<br><img src="/loading.gif" data-original="/images/linux/jenkins-install-set-classpath.png" alt="æ‰¾åˆ°tomcatçš„æ–‡ä»¶"></p><p>æ·»åŠ </p><pre class="line-numbers language-shell"><code class="language-shell">JAVA_HOME=/usr/local/java/jdk1.8.0_151JRE_HOME=/usr/local/java/jdk1.8.0_151/jre<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-set-java-home.png" alt="è®¾ç½®tomcatçš„java home"></p><p>2.3ã€jenkinsæ„å»ºé‡Œçš„ä¸€äº›å‘½ä»¤ï¼š<br><img src="/loading.gif" data-original="/images/linux/jenkins-install-job-shell.png" alt="æ„å»ºjobçš„shell"></p><pre class="line-numbers language-shell"><code class="language-shell">#åˆ é™¤é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸­éƒ¨ç½²çš„åŒ…ssh -p 22 root@x.x.x.x 'bash -x -s' < /opt/auto-deploy-scripts/remove-aliyun-questionnaire-test.sh#ä½¿ç”¨scpå‘½ä»¤æŠŠjenkinsæœ€æ–°Buildçš„åŒ…ä¼ é€åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨1ä¸­scp -P 22 /var/lib/jenkins/workspace/chuangke_testserver_auto_deploy/target/questionnaire.war root@x.x.x.x:/opt/tomcat8_test/webappsssh -p 22 root@x.x.x.x 'bash -x -s' < /opt/auto-deploy-scripts/start_tomcat8_test.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸¤ä¸ªè„šæœ¬ï¼š<br>remove-aliyun-questionnaire-test.sh</p><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/bashtomcat_pid=`ps -ef | grep tomcat | grep test| grep -v grep | awk '{print $2}'`[ -n "$tomcat_pid" ] && kill -9 $tomcat_pidrm -rf /opt/tomcat8_test/webapps/questionnaire*rm -rf /opt/tomcat8_test/logs/localhost*rm -rf /opt/tomcat8_test/logs/host-manager*rm -rf /opt/tomcat8_test/logs/manager*rm -rf /opt/tomcat8_test/logs/catalina.outrm -rf /opt/tomcat8_test/work/Catalina/*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>start_tomcat8_test.sh</p><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/bash/opt/tomcat8_test/bin/startup.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚æœæ˜¯ç›´æ¥åœ¨jenkins çš„Execute Shellé‡Œæ‰§è¡Œè„šæœ¬ï¼Œè„šæœ¬åœ¨å½“å‰æœåŠ¡å™¨ï¼Œç»™å½“å‰æœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤ï¼Œåˆ™å¦‚ä¸‹å†™æ³•ã€‚<br><img src="/loading.gif" data-original="/images/linux/jenkins-install-job-shell2.png" alt="jenkins job shell "></p><pre class="line-numbers language-shell"><code class="language-shell">sleep 200echo "--------begin deploy webservice --------"date/opt/c2m_scripts/backup_last_month_logs.shrm -rf /mnt/jenkins/jenkins_home/workspace/aliyun-testServer1-c2mwebservice-deploy-for-dev-test/c2mwebservice/target/c2mwebservice.war<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2.5ã€é…ç½®é‚®ä»¶é€šçŸ¥</p><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-set-mail.png" alt="ç®¡ç†å‘˜é‚®ä»¶åœ°å€"></p><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-set-mail-admin.png" alt="è®¾ç½®é‚®ç®±ç”¨æˆ·å"></p><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-set-mail-notification.png" alt="job set notification"></p><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-set-mail-notification-mail.png" alt="æ”¶åˆ°é‚®ä»¶"></p><p>ä»¥ä¸Šæ˜¯æœ€ç®€å•çš„é‚®ä»¶é…ç½®ï¼Œå½“æ„å»ºå‡ºé”™æ˜¯ä¼šå‘é‚®ä»¶ã€‚å¦‚æœè¦ä¿®æ”¹å‘å‡ºçš„é‚®ä»¶çš„é€šçŸ¥å†…å®¹ï¼Œæˆ–æœ‰æ›´åŠ å¤æ‚çš„æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨<a href="https://wiki.jenkins-ci.org/display/JENKINS/Email-ext+plugin">Email Extension Plugin</a>æ’ä»¶è¿›è¡Œé…ç½®ã€‚</p><p>å¦‚æœç”¨è…¾è®¯ä¼ä¸šé‚®ç®±çš„è¯ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-set-mail-tengxun.png" alt="è…¾è®¯é‚®ç®±"></p><p><img src="/loading.gif" data-original="/images/linux/jenkins-install-set-mail-tengxun-username.png" alt="è…¾è®¯é‚®ç®±é…ç½®"></p><p>å¤‡æ³¨ï¼šå¦‚æœä½ ç”¨jenkinsç»™æœ¬æœºéƒ¨ç½²åº”ç”¨ï¼Œæ¯”å¦‚è¿è¡Œä¸€ä¸ªjaråŒ…ï¼Œä¹Ÿè®¸ä¼šå‘ç”Ÿçš„ä¸€ä»¶äº‹ï¼Œé‚£å°±æ˜¯jenkinséƒ¨ç½²æ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯<code>java -jar </code>åçš„åº”ç”¨è¿˜æ²¡å¯åŠ¨è‡ªå·±å°±æ­»äº†ã€‚è¿™æ˜¯å› ä¸ºé»˜è®¤ä¸å…è®¸è¿è¡Œjenkinsçš„è¡ç”Ÿè¿›ç¨‹å¯¼è‡´çš„ï¼Œå¦‚æœæ˜¯è¿œç«¯æœåŠ¡å™¨å°±æ²¡æœ‰é—®é¢˜ï¼Œå¦‚æœæ˜¯æœ¬åœ°è¿è¡Œï¼Œéœ€è¦æŒ‰ç…§å¦‚ä¸‹åœ°å€çš„è¯´æ˜é…ç½®ä¸€ä¸‹ã€‚<br> <a href="https://www.cnblogs.com/rongfengliang/p/7805977.html">jenkinsä¸­é€šè¿‡execute shellå¯åŠ¨çš„è¿›ç¨‹ä¼šè¢«æ€æ­»çš„é—®é¢˜</a></p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="http://blog.csdn.net/yougoule/article/details/78188333">Centos7ä¸­å®‰è£…æœ€æ–°ç‰ˆmaven3.5.0</a><br><a href="https://www.digitalocean.com/community/tutorials/how-to-install-jenkins-on-ubuntu-16-04">How To Install Jenkins on Ubuntu 16.04</a><br><a href="https://blog.csdn.net/myNameIssls/article/details/70209516">centos7ä¸‹å®‰è£…jenkins</a></p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux ä¿®æ”¹ä¸»æœºåã€æ·»åŠ ç”¨æˆ·ã€å®‰è£…jdkã€å®‰è£…mysqlã€å®‰è£…redis</title>
      <link href="2018/08/12/linux-xiu-gai-zhu-ji-ming-tian-jia-yong-hu-an-zhuang-jdk-an-zhuang-mysql-an-zhuang-redis/"/>
      <url>2018/08/12/linux-xiu-gai-zhu-ji-ming-tian-jia-yong-hu-an-zhuang-jdk-an-zhuang-mysql-an-zhuang-redis/</url>
      
        <content type="html"><![CDATA[<p>å¼€å‘ç¯å¢ƒæ­å»ºâ€”ä¿®æ”¹ä¸»æœºåã€æ·»åŠ ç”¨æˆ·ã€å®‰è£…jdkã€å®‰è£…mysqlã€å®‰è£…redis<br><a href="https://www.jianshu.com/p/26b892faeee8">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="1ã€ä¿®æ”¹ä¸»æœºå"><a href="#1ã€ä¿®æ”¹ä¸»æœºå" class="headerlink" title="1ã€ä¿®æ”¹ä¸»æœºå"></a>1ã€ä¿®æ”¹ä¸»æœºå</h3><p>ã€vi /etc/hostnameã€‘ç¼–è¾‘ä¸Šä½ è¦èµ·çš„åå­—å³å¯ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">[root@localhost ~]# hostnamectl --static set-hostname Linuxidc# é‡å¯CentOS 7 ä¹‹åï¼ˆreboot -f ï¼‰ï¼Œ[root@Linuxidc ~]# hostnamectl --staticLinuxidc[root@Hunk_zhu ~]# hostnamectl --transientLinuxidc[root@Hunk_zhu ~]# hostnamectl --prettyLinuxidc[root@Hunk_zhu ~]# hostnamehostnamectl --static set-hostname&nbsp;testServer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2ã€æ·»åŠ ç”¨æˆ·"><a href="#2ã€æ·»åŠ ç”¨æˆ·" class="headerlink" title="2ã€æ·»åŠ ç”¨æˆ·"></a>2ã€æ·»åŠ ç”¨æˆ·</h3><p>useradd dev</p><p>passwd dev</p><p>è¾“å…¥å¯†ç Ecs201703ï¼Œåˆ›å»ºæˆåŠŸã€‚</p><p>èµ‹äºˆrootæƒé™ï¼š</p><p>ç„¶åç»™devåŠ ä¸ŠåŒrootä¸€æ ·çš„å¦‚ä¸‹ä¸€è¡Œï¼Œä¿å­˜ã€‚</p><p><img src="/loading.gif" data-original="/images/linux/root%E6%9D%83%E9%99%90.png" alt="rootæƒé™"></p><p><strong>ubuntuä¸­ç®¡ç†ç”¨æˆ·å’Œç”¨æˆ·ç»„</strong></p><ol><li>æ·»åŠ ä¸€ä¸ªç”¨æˆ·ç»„å¹¶æŒ‡å®šidä¸º1002</li></ol><p><code>sudo groupadd ï¼g 1002 www</code></p><ol start="2"><li>æ·»åŠ ä¸€ä¸ªç”¨æˆ·åˆ°wwwç»„å¹¶æŒ‡å®šidä¸º1003</li></ol><p><code>sudo useradd wyx -g 1002 -u 1003 -m</code></p><ol start="3"><li>ä¿®æ”¹ç”¨æˆ·çš„å¯†ç </li></ol><p><code>sudo passwd wyx</code></p><ol start="4"><li>åˆ é™¤ä¸€ä¸ªç”¨æˆ·</li></ol><p><code>sudo userdel wyx</code></p><ol start="5"><li><p>ä¸ºè¯¥ç”¨æˆ·æ·»åŠ sudoæƒé™</p><pre class="line-numbers language-shell"><code class="language-shell">sudo usermod -a -G adm wyxsudo usermod -a -G sudo wyx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">cat /etc/passwdcat /etc/group<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3ã€å®‰è£…JDK1-8"><a href="#3ã€å®‰è£…JDK1-8" class="headerlink" title="3ã€å®‰è£…JDK1.8"></a>3ã€å®‰è£…JDK1.8</h3></li></ol><ul><li>  åœ¨çº¿å®‰è£…openjdk<pre class="line-numbers language-shell"><code class="language-shell">sudo apt-get install openjdk-8-jdk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><p>å¦‚æœå®‰è£…æ—¶æŠ¥é”™ï¼Œæ‰§è¡Œã€ sudo apt-get update ã€‘å‘½ä»¤åå†æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ã€‚<br>åœ¨é…ç½®classpathå³å¯ã€‚</p><ul><li><p>  <a href="http://www.cnblogs.com/xqzt/p/4934451.html">æ‰‹åŠ¨å®‰è£…æ•™ç¨‹</a>&nbsp;</p></li><li><p><em>1ã€æºç åŒ…å‡†å¤‡ï¼š</em>*</p></li></ul><p> é¦–å…ˆåˆ°å®˜ç½‘ä¸‹è½½jdk-8u66-linux-x64.tar.gzï¼Œ</p><p> <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a></p><p>æˆ–è€…ä½¿ç”¨å‘½ä»¤ä¸‹è½½</p><pre class="line-numbers language-shell"><code class="language-shell">wget https://download.oracle.com/otn-pub/java/jdk/8u201-b09/42970487e3af4f5aa5bca3f542482c60/jdk-8u201-linux-x64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> <strong>2ã€è§£å‹æºç åŒ…</strong></p><p> é€šè¿‡ç»ˆç«¯åœ¨/usr/localç›®å½•ä¸‹æ–°å»ºjavaæ–‡ä»¶å¤¹ï¼Œå‘½ä»¤è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">sudo mkdir /usr/local/java<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>  ç„¶åå°†ä¸‹è½½åˆ°å‹ç¼©åŒ…æ‹·è´åˆ°javaæ–‡ä»¶å¤¹ä¸­ï¼Œå‘½ä»¤è¡Œï¼š</p><p> è¿›å…¥jdkæºç åŒ…æ‰€åœ¨ç›®å½•</p><pre class="line-numbers language-shell"><code class="language-shell">cp jdk-8u66-linux-x64.tar.gz /usr/local/java<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> ç„¶åè¿›å…¥javaç›®å½•ï¼Œå‘½ä»¤è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">cd /usr/local/java<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> è§£å‹å‹ç¼©åŒ…ï¼Œå‘½ä»¤è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">sudo tar zxvf jdk-8u66-linux-x64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> ç„¶åå¯ä»¥æŠŠå‹ç¼©åŒ…åˆ é™¤ï¼Œå‘½ä»¤è¡Œï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">sudo rm jdk-8u66-linux-x64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>3ã€è®¾ç½®jdkç¯å¢ƒå˜é‡</strong><br>è¿™é‡Œé‡‡ç”¨å…¨å±€è®¾ç½®æ–¹æ³•ï¼Œå°±æ˜¯ä¿®æ”¹etc/profileï¼Œå®ƒæ˜¯æ˜¯æ‰€æœ‰ç”¨æˆ·çš„å…±ç”¨çš„ç¯å¢ƒå˜é‡</p><pre class="line-numbers language-shell"><code class="language-shell">vi /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰“å¼€ä¹‹ååœ¨æœ«å°¾æ·»åŠ </p><pre class="line-numbers language-shell"><code class="language-shell">JAVA_HOME=/usr/local/java/jdk1.8.0_66JRE_HOME=/usr/local/java/jdk1.8.0_66/jreCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/libPATH=$JAVA_HOME/bin:$PATHexport PATH JAVA_HOME CLASSPATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</p><pre class="line-numbers language-shell"><code class="language-shell">source /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>çœ‹çœ‹è‡ªå·±çš„é…ç½®æ˜¯å¦éƒ½æ­£ç¡®</p><pre class="line-numbers language-shell"><code class="language-shell">echo $JAVA_HOME echo $CLASSPATH echo $PATH<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> <strong>4ã€ä¿®æ”¹é»˜è®¤JDK</strong></p><p>å¦‚æœç³»ç»Ÿå·²ç»å®‰è£…äº†å…¶ä»–ç‰ˆæœ¬çš„Java</p><pre class="line-numbers language-shell"><code class="language-shell">JAVA_HOME=/usr/local/java/jdk1.8.0_66JRE_HOME=/usr/local/java/jdk1.8.0_66/jreCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/libPATH=$JAVA_HOME/bin:$PATHexport PATH JAVA_HOME CLASSPATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>5ã€æ£€éªŒæ˜¯å¦å®‰è£…æˆåŠŸ</strong></p><p>åœ¨ç»ˆç«¯</p><pre class="line-numbers language-shell"><code class="language-shell">java -version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>çœ‹çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼ŒæˆåŠŸåˆ™æ˜¾ç¤ºå¦‚ä¸‹</p><pre class="line-numbers language-shell"><code class="language-shell">java version "1.8.0_66"Java(TM) SE Runtime Environment (build 1.8.0_66-b17)Java HotSpot(TM) 64-Bit Server VM (build 25.65-b01, mixed mode)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="4ã€Ubuntu-16-04-å®‰è£…mysqlå¹¶è®¾ç½®è¿œç¨‹è®¿é—®"><a href="#4ã€Ubuntu-16-04-å®‰è£…mysqlå¹¶è®¾ç½®è¿œç¨‹è®¿é—®" class="headerlink" title="4ã€Ubuntu 16.04 å®‰è£…mysqlå¹¶è®¾ç½®è¿œç¨‹è®¿é—®"></a>4ã€Ubuntu 16.04 å®‰è£…mysqlå¹¶è®¾ç½®è¿œç¨‹è®¿é—®</h3><pre class="line-numbers language-shell"><code class="language-shell">sudo apt-get  install mysql-server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p> <a href="http://www.cppblog.com/colorful/archive/2012/04/29/173122.html">Linuxæ–°æ‰‹å…¥é—¨ï¼šUnable to locate packageé”™è¯¯è§£å†³åŠæ³•</a></p><p>æœ€è¿‘åˆšå¼€å§‹æ¥è§¦<a href="http://www.letuknowit.com/topics/linux" title="å…³äºLinuxçš„å­¦ä¹ å¿ƒå¾—">Linux</a>ï¼Œåœ¨è™šæ‹Ÿæœºä¸­è£…äº†ä¸ª<a href="http://www.letuknowit.com/topics/tag/ubuntu" title="å…³äºubuntuçš„å­¦ä¹ å¿ƒå¾—">Ubuntu</a>ï¼Œå½“å‰çš„ç‰ˆæœ¬æ˜¯<a href="http://www.letuknowit.com/topics/tag/ubuntu-11-10">Ubuntu 11.10</a>ï¼Œè£…å¥½åè‡ªç„¶å°‘ä¸äº†å®‰è£…ä¸€äº›è½¯ä»¶ï¼Œåœ¨è®¾ç½®äº†è½¯ä»¶çš„æºåï¼Œå°±å¼€å§‹äº† sudo apt-get installï¼Œç»“æœå‡ºç°äº†ä¸‹é¢çš„Unable to locate packageé”™è¯¯ï¼š</p><ol><li><p> letuknowit@ubuntu:~$&nbsp;sudo apt-get install mysql-server mysql-client</p></li><li><p> [sudo] password for letuknowit:</p></li><li><p> Reading package listsâ€¦ Done</p></li><li><p> Building dependency tree&nbsp;&nbsp;&nbsp;&nbsp;</p></li><li><p> Reading state informationâ€¦ Done</p></li><li><p> E: Unable to locate package mysql-server</p></li><li><p> E: Unable to locate package mysql-client</p></li><li><p> letuknowit@ubuntu:~$</p></li></ol><p>ã€€ã€€è¿™å«ä¸€ä¸ªéƒé—·å•Šï¼Œå‡ºå¸ˆä¸åˆ©ï¼Œä¸å¸¦è¿™ä¹ˆå“å”¬åˆšç©Ubuntuçš„å°æœ‹å‹å§~äºæ˜¯èµ¶ç´§æ‰¾èµ„æ–™ï¼Œåˆå›é¡¾ä¸‹å‰é¢çš„æ“ä½œï¼Œæœ€åå‘ç°é—®é¢˜å‡º<strong>åœ¨æ‰§è¡Œsudo apt-get installä¹‹å‰æ›´æ¢äº†è½¯ä»¶æºï¼Œä½†æ˜¯å´å¿˜äº†updateä¸‹</strong>äº†ï¼Œäºæ˜¯æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><ol><li> sudo apt-get update</li></ol><p>ç­‰ä¸Šé¢å‘½ä»¤æ‰§è¡Œå®Œåï¼Œå†æ‰§è¡Œsudo apt-get installå°±å¯ä»¥äº†ï¼å…¶å®é”™è¯¯ä¿¡æ¯å·²ç»å¾ˆæ˜ç¡®äº†ï¼ŒUnable to locate packetå°±æ˜¯æ— æ³•æ‰¾åˆ°åŒ…å˜›ï¼Œé‚£è¿˜ä¸èµ¶ç´§sudo apt-get updateä¸‹ï¼</p><p>è¯´æ˜ï¼š</p><p>ã€€ã€€ä¸€ä¸ªæœ‹å‹åœ¨ä½¿ç”¨ubuntu-server 16.04å®‰è£…mysqlï¼Œè®¾ç½®è¿œç¨‹è®¿é—®çš„æ—¶å€™å‡ºç°äº†é—®é¢˜ï¼Œè¯·æˆ‘å¸®å¿™ã€‚ä½†æ˜¯ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰ä½¿ç”¨è¿‡ubuntuå®‰è£…mysqlï¼Œäºæ˜¯ä¹æœç´¢äº†å¾ˆå¤šæŠ€æœ¯æ–‡ä»¶ï¼Œæ¯”ç€è‘«èŠ¦ç”»ç“¢ã€‚ä½†æ˜¯ï¼Œç”±äºmysqlç‰ˆæœ¬çš„å·®å¼‚ï¼Œå¯¼è‡´åœ¨å®‰è£…è®¾ç½®çš„è¿‡ç¨‹ä¸­å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼šå°±æ˜¯ä¸èƒ½è¿œç¨‹è®¿é—®ã€‚</p><p>ä¸€ã€å®‰è£…mysql</p><p>ã€€ã€€1.&nbsp;å®‰è£…éœ€è¦ä½¿ç”¨rootè´¦å·ï¼Œå¦‚æœä¸ä¼šè®¾ç½®rootè´¦å·çš„è¯·è‡ªè¡Œgoogleã€‚å®‰è£…mysqlè¿‡ç¨‹ä¸­ï¼Œéœ€è¦è®¾ç½®mysqlçš„rootè´¦å·çš„å¯†ç ï¼Œä¸è¦å¿½ç•¥äº†ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">sudo&nbsp;apt-get&nbsp;install&nbsp;mysql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨centOSä¸Šæ‰§è¡Œå‘½ä»¤å¯èƒ½ç¢°åˆ°æ‰¾ä¸åˆ°mysql-serverçš„æƒ…å†µï¼Œæƒ³ä¸‹é¢è¿™æ ·ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">[azq@localhost ~]$ sudo yum install mysql-serverå·²åŠ è½½æ’ä»¶ï¼šfastestmirror, langpacksLoading mirror speeds from cached hostfile* base: mirrors.163.com* extras: mirrors.163.com* updates: centos.ustc.edu.cnæ²¡æœ‰å¯ç”¨è½¯ä»¶åŒ… mysql-serverã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶å‚è€ƒ<a href="https://linux.it.net.cn/e/server/nginx/2016/0617/23706.html">è§£å†³CentOS7ä¸‹yum install mysql-serveræ²¡æœ‰å¯ç”¨åŒ…çš„é—®</a><br>å¯è§£å†³ã€‚<br>ã€€ã€€2. ä»¥ä¸Š3ä¸ªè½¯ä»¶åŒ…å®‰è£…å®Œæˆåï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥è¯¢æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">sudo&nbsp;netstat&nbsp;-tap&nbsp;|&nbsp;grep&nbsp;mysql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ã€€ã€€æŸ¥è¯¢ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¡¨ç¤ºå®‰è£…æˆåŠŸã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">root@xyz:~#&nbsp;netstat&nbsp;-tap&nbsp;|&nbsp;grep&nbsp;mysqltcp6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;[::]:mysql&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[::]:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LISTEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7510/mysqld&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root@xyz:~#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>äºŒã€è®¾ç½®mysqlè¿œç¨‹è®¿é—®</p><p>1. ç¼–è¾‘mysqlé…ç½®æ–‡ä»¶ï¼ŒæŠŠå…¶ä¸­bind-address = 127.0.0.1æ³¨é‡Šäº†</p><pre class="line-numbers language-shell"><code class="language-shell">vi&nbsp;/etc/mysql/mysql.conf.d/mysqld.cnf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2. ä½¿ç”¨rootè¿›å…¥mysqlå‘½ä»¤è¡Œ[mysql -uroot -p]ï¼Œæ‰§è¡Œå¦‚ä¸‹2ä¸ªå‘½ä»¤ï¼Œç¤ºä¾‹ä¸­mysqlçš„rootè´¦å·å¯†ç ï¼šroot</p><pre class="line-numbers language-shell"><code class="language-shell">grant&nbsp;all&nbsp;on&nbsp;*.*&nbsp;to&nbsp;root@'%'&nbsp;identified&nbsp;by&nbsp;'root'&nbsp;with&nbsp;grant&nbsp;option;flush&nbsp;privileges;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="3"><li>é‡å¯mysql</li></ol><pre class="line-numbers language-shell"><code class="language-shell">/etc/init.d/mysql&nbsp;restart<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ã€€ã€€é‡å¯æˆåŠŸåï¼Œåœ¨å…¶ä»–è®¡ç®—æœºä¸Šï¼Œä¾¿å¯ä»¥ç™»å½•ã€‚</p><p>å¤‡æ³¨ï¼šå¦‚æœä¿®æ”¹å¯†ç æ—¶æç¤ºæ²¡æœ‰passwordå­—æ®µçš„é”™è¯¯ï¼Œåº”è¯¥ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p><p><img src="/loading.gif" data-original="/images/linux/mysql-no-pwd.png" alt="unknow column password"></p><pre><code>update mysql.user set authentication_string=password('root') where user='root' ;</code></pre><p>è¿œç¨‹ç™»å½•ï¼Œæœ‰å¦‚ä¸‹é”™è¯¯æç¤º</p><p><img src="/loading.gif" data-original="/images/linux/mysql-not-remote-login.png" alt="è¿œç¨‹ç™»å½•å¤±è´¥"></p><p>è§£å†³åŠæ³•ï¼š</p><p>åœ¨æœåŠ¡å™¨ä¸Šç”¨ã€mysql -uroot -pã€‘å‘½ä»¤è¾“å…¥å¯†ç ç™»å½•ï¼Œ</p><p>ç„¶åæ‰§è¡Œä¸‹é¢çš„ä¸¤æ¡å‘½ä»¤</p><pre class="line-numbers language-shell"><code class="language-shell">GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'QDyy201703' WITH GRANT OPTION; &nbsp; &nbsp;FLUSH PRIVILEGES;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚ä¸‹ï¼š</p><p><img src="/loading.gif" data-original="/images/linux/mysql-set-PRIVILEGES.png" alt="è®¾ç½®è¿œç¨‹å®¢æˆ·ç«¯ç™»å½•è´¦å·"></p><p><img src="/loading.gif" data-original="/images/linux/mysql-client-connect-success.png" alt="å®¢æˆ·ç«¯ç™»å½•æˆåŠŸ"></p><p>å®Œç¾è§£å†³mysqlæœåŠ¡é—®é¢˜ã€‚</p><blockquote><p>æœ¬åœ°å‘½ä»¤è¡Œè¿æ¥è¿œç¨‹mysql server</p></blockquote><p>è¿›å…¥å‘½ä»¤è¡Œï¼Œè¿æ¥ï¼š</p><p>mysql -u ç”¨æˆ·å -på¯†ç  -h&nbsp;æœåŠ¡å™¨IPåœ°å€ -P&nbsp;æœåŠ¡å™¨ç«¯MySQLç«¯å£å· -D æ•°æ®åº“å</p><p>æ³¨æ„ï¼š</p><p>&nbsp;&nbsp;&nbsp; (1)æœåŠ¡å™¨ç«¯å£æ ‡å¿—-Pä¸€å®šè¦å¤§äº›ä»¥åŒºåˆ«äºç”¨æˆ·-p,å¦‚æœç›´æ¥è¿æ¥æ•°æ®åº“æ ‡å¿—-Dä¹Ÿè¦å¤§å†™ï¼›</p><p>&nbsp;&nbsp;&nbsp; (2)å¦‚æœè¦ç›´æ¥è¾“å…¥å¯†ç -påé¢ä¸èƒ½ç•™æœ‰ç©ºæ ¼å¦‚-pmypassword;</p><p>&nbsp;&nbsp;&nbsp; (3)å‘½ä»¤ç»“æŸæ®µæ²¡æœ‰â€™;â€™åˆ†å·ã€‚</p><p>ä¾‹å­ï¼š</p><p><code>mysql -u&nbsp;lzpddd -pmypassword -h 192.168.1.88 -P 3306 -D mydb</code></p><h3 id="5ã€å®‰è£…redis"><a href="#5ã€å®‰è£…redis" class="headerlink" title="5ã€å®‰è£…redis"></a>5ã€å®‰è£…redis</h3><p>1ã€&nbsp; ä»<a href="http://redis.io/">http://redis.io/</a>&nbsp;ä¸‹è½½redis-3.2.4.tar.gz</p><p>2ã€ ä¸Šä¼ åˆ°linuxåç§»åŠ¨åˆ°/opt/redisç›®å½•ä¸‹</p><p>3ã€ è§£å‹ sudo tar -zxvf redis-3.2.4.tar.gz</p><p>4ã€ è¿›å…¥è§£å‹åçš„æ–‡ä»¶å¤¹è¿›è¡Œç¼–è¯‘ make</p><p>5ã€ å®‰è£… make install</p><p>6ã€ æµ‹è¯•ä¸€ä¸‹&nbsp;make test</p><pre class="line-numbers language-shell"><code class="language-shell">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;æŠ¥é”™ç¼ºå°‘tcl ï¼ˆtcl æ˜¯ä¸€ç§è§£è¯‘è¯­è¨€ï¼Œä¹Ÿæ˜¯ä¸€å¥— C çš„å‡½å¼åº“ï¼‰&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;å®‰è£…tcl&nbsp; apt-get&nbsp;install&nbsp;tcl&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;æŠ¥é”™Executing test client: NOREPLICAS Not enoughgood slaves to write..&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ä¿®æ”¹æ–‡ä»¶tests/integration/replication-2.tclï¼Œå°†after 1000æ”¹ä¸ºafter 10000ä»¥å»¶é•¿ç­‰å¾…æ—¶é—´ã€‚&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; æŠ¥é”™[err]: Server is able to generate a stack trace on selected systems in tests/integration/logging.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; åªæ˜¯æŸä¸ªæµ‹è¯•æ²¡æœ‰é€šè¿‡ï¼Œå¯ä»¥å¿½ç•¥ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>7ã€åˆ›å»ºRedisé…ç½®ç›®å½• /etc/redis&nbsp;<br><code>mkdir /etc/redis</code><br>8ã€æ‹·è´é…ç½®æ–‡ä»¶ï¼š<br><code>cp /opt/redis/redis-3.2.4/redis.conf/ /etc/redis</code><br>9ã€ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆæš‚æœªç¼–è¾‘ï¼‰<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ä¿®æ”¹ç«¯å£ã€é…ç½®æ•°æ®åº“ä¿å­˜ç›®å½•ã€å…¶å®ƒ<br>10ã€ï¼ˆ1ï¼‰é€šè¿‡æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨ï¼›<br><code>redis-server /etc/redis/redis.conf</code><br>(2ï¼‰é€šè¿‡å‘½ä»¤redis-server å¯åŠ¨ï¼Œå¯åœ¨å‘½ä»¤ååŠ ä¸Š<code>&amp;</code>å·ä½¿redisä»¥åå°ç¨‹åºæ–¹å¼è¿è¡Œï¼›<br><code>redis-server &amp;</code><br>11ã€å®¢æˆ·ç«¯ç™»é™† redis-cli<br>12ã€å…³é—­RedisæœåŠ¡ redis-cli shutdown </p><p><strong>è®¾ç½®rediså¼€æœºå¯åŠ¨</strong></p><p>ä¿®æ”¹redis.confï¼ˆ/etc/redisä¸‹ï¼‰</p><pre class="line-numbers language-shell"><code class="language-shell"> #æ‰“å¼€åå°è¿è¡Œé€‰é¡¹daemonize yes#è®¾ç½®æ—¥å¿—æ–‡ä»¶è·¯å¾„logfile "/var/log/redis/redis.log"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç¼–å†™è„šæœ¬</p><p><code>vim /etc/init.d/redis</code></p><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/sh# chkconfig: 2345 10 90# description: Start and Stop redis PATH=/usr/local/binREDISPORT=6379EXEC=/usr/local/bin/redis-serverREDIS_CLI=/usr/local/bin/redis-cliPIDFILE=/var/run/redis.pidCONF="/etc/redis/redis.conf" case "$1" in    start)        if [ -f $PIDFILE ]        then            echo "$PIDFILE exists, process is already running or crashed."        else            echo "Starting Redis server..."            $EXEC $CONF        fi        if [ "$?"="0" ]        then            echo "Redis is running..."        fi        ;;    stop)        if [ ! -f $PIDFILE ]        then            echo "$PIDFILE exists, process is not running."        else            PID=$(cat $PIDFILE)            echo "Stopping..."            $REDIS_CLI -p $REDISPORT SHUTDOWN            while [ -x $PIDFILE ]            do                echo "Waiting for Redis to shutdown..."                sleep 1            done            echo "Redis stopped"        fi        ;;    restart|force-reload)        ${0} stop        ${0} start        ;;    *)        echo "Usage: /etc/init.d/redis {start|stop|restart|fore-reload}"        exit 1esac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ·»åŠ è„šæœ¬çš„æ‰§è¡Œæƒé™<br><code>sudo chmod +x /etc/init.d/redis</code><br>è®¾ç½®å¼€æœºè‡ªåŠ¨å¯åŠ¨<br><code>sudo update-rc.d redis defaults</code><br>æŠ¥é”™ï¼š<br><img src="/loading.gif" data-original="/images/linux/redis-auto-start-error1.png" alt="reidiså¼€å¯è‡ªå¯è®¾ç½®å¤±è´¥"></p><p>ä¸Šé¢ä¸ºä¸¤ä¸ªé”™è¯¯<br>ç¬¬ä¸€ä¸ªå‚è€ƒ<a href="https://my.oschina.net/u/943306/blog/345923">https://my.oschina.net/u/943306/blog/345923</a><br>è§£å†³æ–¹æ³•ï¼šå®‰è£…ä¸€ä¸ªä¸­æ–‡è¯­è¨€ï¼Œç³»ç»Ÿå°±çŸ¥é“zh_CN.UTF-8äº†ï¼Œè¿™ä¸ªæ—¶å€™ç”¨perlå°±ä¸ä¼šæŠ¥é”™äº†<br><code>apt-get install language-pack-zh-hans</code><br>ç¬¬äºŒä¸ªå‚è€ƒï¼š<a href="http://bashell.nodemedia.cn/archives/directspace-debian-6-vps-vzquota-missing.html">http://bashell.nodemedia.cn/archives/directspace-debian-6-vps-vzquota-missing.html</a><br>è§£å†³æ–¹æ³•ï¼šç¼–è¾‘/etc/init.d/redis<br>åœ¨æ–‡ä»¶å¤´éƒ¨#!/bin/shä¸‹é¢æ·»åŠ </p><pre class="line-numbers language-shell"><code class="language-shell">### BEGIN INIT INFO# Provides: OSSEC HIDS# Required-Start: $network $remote_# Required-Stop:# Default-Start: 2 3 4 5# Default-Stop: 0 1 6# Short-Description: OSSEC HIDS### END INIT INFO<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨è„šæœ¬å¯åŠ¨æœåŠ¡</p><blockquote><p>å¼€å¯redisï¼š service redis start<br>åœæ­¢redisï¼š service redis stop<br>é‡å¯redisï¼š service redis restart<br>æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼šservice redis status</p></blockquote><p>æœ€åå°†æœºå™¨å…³æœºï¼Œé‡æ–°å¯åŠ¨,æ­¤æ—¶redisæœåŠ¡ä¹Ÿå¯åŠ¨äº†ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="http://blog.csdn.net/ruglcc/article/details/7802077">ubuntuæ°¸ä¹…ä¿®æ”¹ä¸»æœºå</a><br><a href="https://www.cnblogs.com/iscodercn/p/5488633.html">Ubuntu 16.04 å®‰è£…mysqlå¹¶è®¾ç½®è¿œç¨‹è®¿é—®</a><br><a href="https://www.cnblogs.com/vincedotnet/p/4017574.html">ubuntuä¸­ç®¡ç†ç”¨æˆ·å’Œç”¨æˆ·ç»„</a><br><a href="http://www.linuxidc.com/Linux/2016-09/135288.htm">CentOS7 64ä½ä¸‹MySQL5.7å®‰è£…ä¸é…ç½®</a><br><a href="http://blog.csdn.net/qq_19399235/article/details/78313633">Centos 7.4 å®‰è£… Redis å…¨è¿‡ç¨‹</a></p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Springboot ä¹‹ è‡ªå®šä¹‰æ–¹æ³•å‚æ•°è§£æå™¨</title>
      <link href="2018/08/02/springboot-zhi-zi-ding-yi-fang-fa-can-shu-jie-xi-qi/"/>
      <url>2018/08/02/springboot-zhi-zi-ding-yi-fang-fa-can-shu-jie-xi-qi/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨springçš„è‡ªå®šä¹‰æ–¹æ³•å‚æ•°è§£æå™¨è·å–å½“å‰ç”¨æˆ·çš„demoã€‚<br><a href="https://www.jianshu.com/p/0347bdde0c6d">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æ˜¨å¤©ï¼ˆ2018-08-01ï¼‰æˆ‘åŒäº‹Damonåœ¨åˆ†äº«Spring AOPæ³¨è§£å¤±æ•ˆçš„ä¸»é¢˜ä¸Šï¼Œé¡ºå¸¦ç€ä»‹ç»äº†ä¸‹ã€Šè‡ªå®šä¹‰æ–¹æ³•å‚æ•°è§£æå™¨ã€‹çš„ä½¿ç”¨ï¼Œä¸ªäººè§‰å¾—è¿˜æŒºæœ‰ç”¨çš„ï¼Œå†æ¬¡è®°å½•ä¸€ä¸‹ï¼Œä»¥åç”¨çš„æ—¶å€™å¥½æŸ¥ã€‚</p><h3 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><p>ä¸€ä¸ªä¸šåŠ¡åœºæ™¯ï¼Œæœ€è¿‘å¾®ä¿¡å°ç¨‹åºå¦‚æ—¥ä¸­å¤©ï¼Œå¤§æœ‰ä¸€å‘ä¸å¯æ”¶æ‹¾ä¹‹å±€åŠ¿ï¼Œæˆ‘å¸æ–°æ¥çš„ä¸€äº›ä¸šåŠ¡ä¹Ÿæ˜¯è¶çƒ­æ‰“é“ä»¥å¾®ä¿¡å°ç¨‹åºçš„å½¢å¼å…¬è¯¸äºä¸–ï¼Œå› æ­¤ä¹Ÿæœ‰äº†è¿™ä¸ªåœºæ™¯ã€‚</p><p>ä¸ä¹‹å‰ç©APPä¸ä¸€æ ·äº†ï¼Œä¹‹å‰çš„appç”¨æˆ·æ³¨å†Œï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯æ‰‹æœºå·+éªŒè¯ç çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·ä¸Šæ¥éƒ½æœ‰æ‰‹æœºå·ç™»å½•çš„è¿‡ç¨‹ï¼Œç™»é™†ä»¥åæ”¾å›tokenï¼Œè®¿é—®æ›¿ä»–é¡µé¢ä¼šå¸¦ç€è¿™ä¸ªtokenï¼Œåå°ä¹Ÿå°±é€šè¿‡tokenè¯†åˆ«å‡ºè¿™ä¸ªç”¨æˆ·æ˜¯è°äº†ã€‚</p><p>ç°åœ¨å°ç¨‹åºï¼Œè‡ªç„¶æ˜¯å¾®ä¿¡ç™»å½•æœ€æ–¹ä¾¿ï¼Œè€Œä¸”ä¸ç”¨éº»çƒ¦ç”¨æˆ·å†ç»‘å®šæ‰‹æœºå·ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ä¸€ä¸ªç”¨æˆ·å”¯ä¸€æ ‡è¯†çš„é—®é¢˜ï¼Œè¿™å°±æ˜¯å¾®ä¿¡æä¾›çš„openIdï¼Œæˆ‘ä»¬ç°åœ¨çš„åšæ³•å°±æ˜¯åœ¨æ‰€æœ‰è¦è¯·æ±‚çš„æ¥å£ä¸Šåœ¨headé‡Œéƒ½å¸¦ç€è¿™ä¸ªopenIdï¼Œåå°é€šè¿‡è¿™ä¸ªopenIdæ£€æŸ¥æ˜¯æ–°ç”¨æˆ·è¿˜æ˜¯è€ç”¨æˆ·ï¼Œç”¨æˆ·çš„ä¿¡æ¯ä¹Ÿå°±ç›¸åº”çš„æ‹¿åˆ°äº†ã€‚</p><h3 id="ä¸šåŠ¡å¤„ç†"><a href="#ä¸šåŠ¡å¤„ç†" class="headerlink" title="ä¸šåŠ¡å¤„ç†"></a>ä¸šåŠ¡å¤„ç†</h3><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‰ç«¯è¯·æ±‚æ˜¯è¿™æ ·çš„ï¼š<br><img src="/loading.gif" data-original="/images/java/springboot/springboot-api-header.png" alt="postman api header"></p><p><strong>1ã€å„è‡ªæ¥å£åˆ†åˆ«å¤„ç†</strong><br>åœ¨éœ€è¦åˆ¤è¯»å½“å‰ç”¨æˆ·æ˜¯è°çš„æ¥å£é€»è¾‘é‡Œåˆ†åˆ«åŠ ä¸Šï¼Œæœ¬æ¬¡å®éªŒï¼Œæ”¾åœ¨controllerå±‚ï¼Œå®é™…å†™ä»£ç æ—¶ä¸‹é¢çš„é€»è¾‘åº”è¯¥åœ¨serviceä»£ç é‡Œå®ç°ã€‚</p><pre class="line-numbers language-java"><code class="language-java"> <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/public/api/demo1"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> Object <span class="token function">getUser1</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">)</span> <span class="token punctuation">{</span>        String mobile <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">"openId"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        CurrentUser currentUser <span class="token operator">=</span> <span class="token punctuation">(</span>CurrentUser<span class="token punctuation">)</span> redisService<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>mobile<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>currentUser <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            List<span class="token operator">&lt;</span>HaierUser<span class="token operator">></span> userList <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findByMobileAndUserState</span><span class="token punctuation">(</span>mobile<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>userList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>                currentUser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                BeanUtils<span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>userList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> currentUser<span class="token punctuation">)</span><span class="token punctuation">;</span>                redisService<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mobile<span class="token punctuation">,</span> currentUser<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RtnResult</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>currentUser<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> ç»“æœï¼š<br><img src="/loading.gif" data-original="/images/java/springboot/springboot-api-response.png" alt="postman api å¾—åˆ°response"></p><p><strong>2ã€è‡ªå®šä¹‰æ–¹æ³•å‚æ•°è§£æå™¨å®ç°</strong><br>å…ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•å‚æ•°è§£æå™¨</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>hczt<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>db<span class="token punctuation">.</span>user<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>HaierUser<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>hczt<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>db<span class="token punctuation">.</span>user<span class="token punctuation">.</span>repository<span class="token punctuation">.</span>HaierUserRepository<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>hczt<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>mobileoffice<span class="token punctuation">.</span>usercenter<span class="token punctuation">.</span>service<span class="token punctuation">.</span>api<span class="token punctuation">.</span>RedisService<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>BeanUtils<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>MethodParameter<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Component<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>support<span class="token punctuation">.</span>WebDataBinderFactory<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>context<span class="token punctuation">.</span>request<span class="token punctuation">.</span>NativeWebRequest<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>method<span class="token punctuation">.</span>support<span class="token punctuation">.</span>HandlerMethodArgumentResolver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>method<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ModelAndViewContainer<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Resource<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletRequest<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-08-03 14:38 * @desc æ–¹æ³•å‚æ•°è§£æå™¨ * ä½¿ç”¨ **/</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CurrentUserArgumentResolver</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerMethodArgumentResolver</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> RedisService redisService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> HaierUserRepository userRepository<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supportsParameter</span><span class="token punctuation">(</span>MethodParameter methodParameter<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> methodParameter<span class="token punctuation">.</span><span class="token function">getParameterType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>CurrentUser<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> Object <span class="token function">resolveArgument</span><span class="token punctuation">(</span>MethodParameter methodParameter<span class="token punctuation">,</span> ModelAndViewContainer modelAndViewContainer<span class="token punctuation">,</span> NativeWebRequest nativeWebRequest<span class="token punctuation">,</span> WebDataBinderFactory webDataBinderFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        HttpServletRequest request <span class="token operator">=</span> nativeWebRequest<span class="token punctuation">.</span><span class="token function">getNativeRequest</span><span class="token punctuation">(</span>HttpServletRequest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String openId <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">"openId"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        CurrentUser currentUser <span class="token operator">=</span> <span class="token punctuation">(</span>CurrentUser<span class="token punctuation">)</span> redisService<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>openId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>currentUser <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>            List<span class="token operator">&lt;</span>HaierUser<span class="token operator">></span> userList <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findByMobileAndUserState</span><span class="token punctuation">(</span>openId<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>userList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>                currentUser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                BeanUtils<span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>userList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> currentUser<span class="token punctuation">)</span><span class="token punctuation">;</span>                redisService<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>openId<span class="token punctuation">,</span> currentUser<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> currentUser<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ«å¿˜äº†è¦å°†è‡ªå®šä¹‰çš„å‚æ•°è§£æå™¨é…ç½®åˆ°springå®¹å™¨ä¸­ï¼Œæ–°å»ºä¸€ä¸ªconfigç±»ï¼Œç»§æ‰¿<code>WebMvcConfigurationSupport</code>,ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>web<span class="token punctuation">.</span>PageableHandlerMethodArgumentResolver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>method<span class="token punctuation">.</span>support<span class="token punctuation">.</span>HandlerMethodArgumentResolver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ResourceHandlerRegistry<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>WebMvcConfigurationSupport<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Resource<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-08-03 16:23 * @desc ${DESCRIPTION} **/</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebMvcConfigurationSupport</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> CurrentUserArgumentResolver currentUserArgumentResolver<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">addArgumentResolvers</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>HandlerMethodArgumentResolver<span class="token operator">></span> argumentResolvers<span class="token punctuation">)</span> <span class="token punctuation">{</span>        argumentResolvers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>currentUserArgumentResolver<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// æ³¨å†ŒSpring data jpa pageableçš„å‚æ•°åˆ†è§£å™¨</span>        argumentResolvers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PageableHandlerMethodArgumentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// swagger2 è®¿é—®</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addResourceHandlers</span><span class="token punctuation">(</span>ResourceHandlerRegistry registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>        registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">"swagger-ui.html"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token string">"classpath:/META-INF/resources/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token string">"classpath:/static/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">"/webjars/**"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span><span class="token string">"classpath:/META-INF/resources/webjars/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">addResourceHandlers</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åè®¿é—®çš„controlleré‡Œæ¥æ”¶currentè¿™ä¸ªå‚æ•°ï¼Œå°†å˜å¾—å¦‚æ­¤ç®€å•ï¼š</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/public/api/demo2"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> Object <span class="token function">getUser2</span><span class="token punctuation">(</span>CurrentUser currentUser<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>currentUser<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RtnResult</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>currentUser<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ£€æµ‹ç»“æœ<br><img src="/loading.gif" data-original="/images/java/springboot/springboot-api-ArgumentResolver.png" alt="api"></p><p>è´´ä¸ŠCurrentç±»ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>ToString<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Serializable<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** *  * @Auther: marvin.mma * @Date: 2018/8/3 14:38 * @return    */</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@ToString</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CurrentUser</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 1L<span class="token punctuation">;</span>    <span class="token keyword">private</span> String userId<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * æ‰‹æœºå·     */</span>    <span class="token keyword">private</span> String mobile<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * é‚®ç®±     */</span>    <span class="token keyword">private</span> String mail<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * ç”¨æˆ·å·¥ç‰Œå·     */</span>    <span class="token keyword">private</span> String cardNo<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * ç”¨æˆ·å§“å     */</span>    <span class="token keyword">private</span> String fullName<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * ç”¨æˆ·å§“åæ‹¼éŸ³     */</span>    <span class="token keyword">private</span> String fullNamePinyin<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>1ã€ä¸ºä»€ä¹ˆä¸ç”¨æ‹¦æˆªå™¨æˆ–è€…è¿‡æ»¤å™¨ï¼Ÿ<br>æ‹¦æˆªå™¨æˆ–è€…è¿‡æ»¤å™¨éƒ½èƒ½å®ç°è·å–requestçš„headerçš„openIdï¼Œä¹Ÿèƒ½æ ¡éªŒrediså’Œæ•°æ®åº“ä¸­æœ‰æ²¡æœ‰è¯¥æ•°æ®ï¼Œæ²¡æœ‰çš„è¯æ–°å»ºåˆ°æ•°æ®åº“æˆ–è€…redisä¸­ï¼Œä½†æ˜¯å°±æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡å®ç°èµ·æ¥éº»çƒ¦ä¸€äº›ã€‚ä¸Šé‡ç‚¹äº†ï¼Œæœ€ä¸»è¦æ˜¯ä¸æ˜¯æ¯ä¸ªæ¥å£éƒ½éœ€è¦æ ¹æ®openIdè·å–ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™æ ·çš„è¯æ‹¦æˆªå™¨å°±æœ‰ç‚¹å¤šä½™äº†ï¼Œé…ç½®å“ªäº›éœ€è¦å“ªäº›ä¸éœ€è¦åˆå¤ªéº»çƒ¦ã€‚æ‰€ä»¥ä½¿ç”¨æ–¹æ³•å‚æ•°è§£æå™¨æœ€åˆé€‚äº†ã€‚</p><p>2ã€è‡ªå®šçš„æ–¹æ³•å‚æ•°è§£æå™¨è¦åˆ›å»ºä¸€ä¸ªç»§æ‰¿<code>WebMvcConfigurationSupport</code>çš„é…ç½®ç±»ï¼Œç„¶åæ·»åŠ åˆ°è§£æå™¨ä¸­ï¼Œå¦åˆ™æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚</p><p>3ã€åœ¨ä½¿ç”¨spring-data-jpaçš„æ¡†æ¶é‡Œï¼Œå› ä¸ºä½¿ç”¨äº†è‡ªå®šä¹‰è§£æå™¨ï¼Œå¯¼è‡´äº†è‡ªå¸¦åˆ†åˆ†é¡µä¸å¥½ä½¿çš„é—®é¢˜ï¼Œå…¶åŸå› æ˜¯è‡ªå®šä¹‰è§£æå™¨ä»¥åï¼Œå¾€ <code>HandlerMethodArgumentResolver</code>é‡Œé¢æ·»åŠ äº†ä»€ä¹ˆè§£æå™¨ï¼Œå®¹å™¨å°±æœ‰äº†ä»€ä¹ˆè§£æå™¨ï¼Œæ²¡æ·»åŠ çš„ä¸ä¼šé»˜è®¤æ·»åŠ äº†ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨æ·»åŠ ,å°±æ˜¯ä¸‹é¢è¿™æ ·çš„æ„æ€</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>web<span class="token punctuation">.</span>PageableHandlerMethodArgumentResolver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>converter<span class="token punctuation">.</span>HttpMessageConverter<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>converter<span class="token punctuation">.</span>StringHttpMessageConverter<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>converter<span class="token punctuation">.</span>json<span class="token punctuation">.</span>MappingJackson2HttpMessageConverter<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>method<span class="token punctuation">.</span>support<span class="token punctuation">.</span>HandlerMethodArgumentResolver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>WebMvcConfigurationSupport<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>core<span class="token punctuation">.</span>JsonGenerator<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>core<span class="token punctuation">.</span>JsonProcessingException<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span>JsonSerializer<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span>ObjectMapper<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span>SerializerProvider<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span>module<span class="token punctuation">.</span>SimpleModule<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span>ser<span class="token punctuation">.</span>std<span class="token punctuation">.</span>ToStringSerializer<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** *  * @Auther: marvin.mma * @Date: 2018/8/3 16:38 * @return    */</span><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebMvcConfigurationSupport</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">addArgumentResolvers</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>HandlerMethodArgumentResolver<span class="token operator">></span> argumentResolvers<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// æ³¨å†ŒSpring data jpa pageableçš„å‚æ•°åˆ†è§£å™¨</span>        argumentResolvers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PageableHandlerMethodArgumentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configureMessageConverters</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>HttpMessageConverter<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">>></span> converters<span class="token punctuation">)</span> <span class="token punctuation">{</span>        MappingJackson2HttpMessageConverter jackson2HttpMessageConverter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MappingJackson2HttpMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ObjectMapper objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">/**         * åºåˆ—æ¢æˆjsonæ—¶,å°†æ‰€æœ‰çš„longå˜æˆstring         * å› ä¸ºjsä¸­å¾—æ•°å­—ç±»å‹ä¸èƒ½åŒ…å«æ‰€æœ‰çš„java longå€¼         */</span>        SimpleModule simpleModule <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        simpleModule<span class="token punctuation">.</span><span class="token function">addSerializer</span><span class="token punctuation">(</span>Long<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> ToStringSerializer<span class="token punctuation">.</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>        simpleModule<span class="token punctuation">.</span><span class="token function">addSerializer</span><span class="token punctuation">(</span>Long<span class="token punctuation">.</span>TYPE<span class="token punctuation">,</span> ToStringSerializer<span class="token punctuation">.</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>        objectMapper<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>simpleModule<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// å°†è¿”å›å€¼nullå¤„ç†æˆç©ºå€¼</span>        SerializerProvider serializerProvider <span class="token operator">=</span> objectMapper<span class="token punctuation">.</span><span class="token function">getSerializerProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        serializerProvider<span class="token punctuation">.</span><span class="token function">setNullValueSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JsonSerializer</span><span class="token operator">&lt;</span>Object<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">serialize</span><span class="token punctuation">(</span>Object o<span class="token punctuation">,</span> JsonGenerator jsonGenerator<span class="token punctuation">,</span> SerializerProvider serializerProvider<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> JsonProcessingException <span class="token punctuation">{</span>                    jsonGenerator<span class="token punctuation">.</span><span class="token function">writeString</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                jackson2HttpMessageConverter<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>objectMapper<span class="token punctuation">)</span><span class="token punctuation">;</span>        converters<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>jackson2HttpMessageConverter<span class="token punctuation">)</span><span class="token punctuation">;</span>        converters<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringHttpMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//        super.configureMessageConverters(converters);</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥é…ç½®æ–‡ä»¶å¢åŠ äº†ä¸¤ä¸ªjsonè½¬æ¢å¤„ç†ï¼Œé¡ºä¾¿è´´å‡ºæ¥ï¼ŒçŸ¥é“åœ¨å“ªåŠ æ€ä¹ˆåŠ å°±è¡Œï¼Œè·Ÿæœ¬æ–‡æ— å…³ã€‚</p><p>4ã€æ­¤å¤„æ˜¯ä»¥æ‰‹æœºå·ä¸¾ä¾‹çš„ï¼Œå®é™…ç”Ÿäº§ä¸­ï¼Œè§†æƒ…å†µè€Œå®šã€‚</p><p>5ã€å…³äºæ³¨è§£ä¸ç”Ÿæ•ˆçš„é—®é¢˜ï¼ŒDamonä¸»è¦ä»¥Asycå’ŒTransactionalä¸ºä¾‹è¯´æ˜çš„ï¼Œä½†æ˜¯å°±å…¶ä¸ç”Ÿæ•ˆçš„åŸå› ï¼Œ<br><a href="https://www.jianshu.com/p/76c9ad71ade4">ç©è½¬Spring â€”â€” æ¶ˆå¤±çš„äº‹åŠ¡</a>åŸºæœ¬ä¸Šè®²æ˜ç™½äº†ã€‚</p><p>å®Œç¾~~~</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> springboot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerå­¦ä¹ æ¡ˆä¾‹ï¼šç”¨dockeréƒ¨ç½²mysqlæœåŠ¡</title>
      <link href="2018/07/25/docker-xue-xi-an-li-yong-docker-bu-shu-mysql-fu-wu/"/>
      <url>2018/07/25/docker-xue-xi-an-li-yong-docker-bu-shu-mysql-fu-wu/</url>
      
        <content type="html"><![CDATA[<p>dockerå®é™…æ¡ˆä¾‹ä¹‹åœ¨centOS7.4ä¸Šç”¨dockeréƒ¨ç½²mysqlæœåŠ¡<br><a href="https://www.jianshu.com/p/185840de08a8">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="ä¸€ã€ä½¿ç”¨docker-runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªmysqlå®¹å™¨"><a href="#ä¸€ã€ä½¿ç”¨docker-runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªmysqlå®¹å™¨" class="headerlink" title="ä¸€ã€ä½¿ç”¨docker runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªmysqlå®¹å™¨"></a>ä¸€ã€ä½¿ç”¨docker runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªmysqlå®¹å™¨</h3><h4 id="1-1-ä¸‹è½½å®˜æ–¹tomcaté•œåƒ"><a href="#1-1-ä¸‹è½½å®˜æ–¹tomcaté•œåƒ" class="headerlink" title="1.1 ä¸‹è½½å®˜æ–¹tomcaté•œåƒ"></a>1.1 ä¸‹è½½å®˜æ–¹tomcaté•œåƒ</h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev ~]# docker search mysqlINDEX       NAME                                                             DESCRIPTION                                     STARS     OFFICIAL   AUTOMATEDdocker.io   docker.io/mysql                                                  MySQL is a widely used, open-source relati...   6589      [OK]       docker.io   docker.io/mariadb                                                MariaDB is a community-developed fork of M...   2086      [OK]       docker.io   docker.io/mysql/mysql-server                                     Optimized MySQL Server Docker images. Crea...   484                  [OK]docker.io   docker.io/zabbix/zabbix-server-mysql                             Zabbix Server with MySQL database support       107                  [OK]docker.io   docker.io/hypriot/rpi-mysql                                      RPi-compatible Docker Image with Mysql          90                   docker.io   docker.io/zabbix/zabbix-web-nginx-mysql                          Zabbix frontend based on Nginx web-server ...   61                   [OK]docker.io   docker.io/centurylink/mysql                                      Image containing mysql. Optimized to be li...   60                   [OK]docker.io   docker.io/1and1internet/ubuntu-16-nginx-php-phpmyadmin-mysql-5   ubuntu-16-nginx-php-phpmyadmin-mysql-5          38                   [OK]docker.io   docker.io/tutum/mysql                                            Base docker image to run a MySQL database ...   32                   docker.io   docker.io/centos/mysql-57-centos7                                MySQL 5.7 SQL database server                   31                   docker.io   docker.io/mysql/mysql-cluster                                    Experimental MySQL Cluster Docker images. ...   31                   docker.io   docker.io/schickling/mysql-backup-s3                             Backup MySQL to S3 (supports periodic back...   20                   [OK]docker.io   docker.io/bitnami/mysql                                          Bitnami MySQL Docker Image                      15                   [OK]docker.io   docker.io/zabbix/zabbix-proxy-mysql                              Zabbix proxy with MySQL database support        15                   [OK]docker.io   docker.io/linuxserver/mysql                                      A Mysql container, brought to you by Linux...   14                   docker.io   docker.io/centos/mysql-56-centos7                                MySQL 5.6 SQL database server                   8                    docker.io   docker.io/circleci/mysql                                         MySQL is a widely used, open-source relati...   6                    docker.io   docker.io/openshift/mysql-55-centos7                             DEPRECATED: A Centos7 based MySQL v5.5 ima...   6                    docker.io   docker.io/dsteinkopf/backup-all-mysql                            backup all DBs in a mysql server                4                    [OK]docker.io   docker.io/frodenas/mysql                                         A Docker Image for MySQL                        2                    [OK]docker.io   docker.io/mysql/mysql-router                                     MySQL Router provides transparent routing ...   2                    docker.io   docker.io/openzipkin/zipkin-mysql                                Mirror of https://quay.io/repository/openz...   1                    docker.io   docker.io/ansibleplaybookbundle/mysql-apb                        An APB which deploys RHSCL MySQL                0                    [OK]docker.io   docker.io/cloudfoundry/cf-mysql-ci                               Image used in CI of cf-mysql-release            0                    docker.io   docker.io/cloudposse/mysql                                       Improved `mysql` service with support for ...   0                    [OK][root@dev mysql]# docker pull mysql:5.7.19Trying to pull repository docker.io/library/mysql ... 5.7.19: Pulling from docker.io/library/mysql85b1f47fba49: Pull complete 27dc53f13a11: Pull complete 095c8ae4182d: Pull complete 0972f6b9a7de: Pull complete 1b199048e1da: Pull complete 159de3cf101e: Pull complete 963d934c2fcd: Pull complete f4b66a97a0d0: Pull complete f34057997f40: Pull complete ca1db9a06aa4: Pull complete 0f913cb2cc0c: Pull complete Digest: sha256:bfb22e93ee87c6aab6c1c9a4e7cdc68e9cb9b64920f28fa289f9ffae9fe8e173Status: Downloaded newer image for docker.io/mysql:5.7.19[root@dev mysql]# docker imagesREPOSITORY          TAG                 IMAGE ID            CREATED             SIZEmarvin/tomcat       latest              098f61ab6f8b        22 hours ago        489 MBnginx_image1        latest              c4d5f5accc06        24 hours ago        109 MBdocker.io/tomcat    latest              2d43521f2b1a        6 days ago          463 MBdocker.io/nginx     latest              8b89e48b5f15        7 days ago          109 MBdocker.io/mysql     5.7.19              3e3878acd190        9 months ago        412 MB[root@dev mysql]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-2-åˆ›å»ºç”¨äºæŒ‚è½½çš„ç›®å½•"><a href="#1-2-åˆ›å»ºç”¨äºæŒ‚è½½çš„ç›®å½•" class="headerlink" title="1.2 åˆ›å»ºç”¨äºæŒ‚è½½çš„ç›®å½•"></a>1.2 åˆ›å»ºç”¨äºæŒ‚è½½çš„ç›®å½•</h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev local]# pwd/usr/local[root@dev local]# mkdir mysql[root@dev local]# mkdir mysql/data[root@dev local]# mkdir mysql/conf.d[root@dev local]# cd mysql/[root@dev mysql]# lltotal 8drwxr-xr-x 2 root root 4096 Jul 24 14:18 conf.ddrwxr-xr-x 2 root root 4096 Jul 24 14:18 data[root@dev mysql]#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘½ä»¤è§£æï¼š<br>mkdir /usr/local/mysql/data      #ç”¨äºæŒ‚è½½mysqlæ•°æ®æ–‡ä»¶<br>mkdir /usr/local/mysql/conf.d    #ç”¨äºæŒ‚è½½mysqlé…ç½®æ–‡ä»¶</p><h4 id="1-3-å¯åŠ¨å®¹å™¨"><a href="#1-3-å¯åŠ¨å®¹å™¨" class="headerlink" title="1.3 å¯åŠ¨å®¹å™¨"></a>1.3 å¯åŠ¨å®¹å™¨</h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev mysql]# docker run --name mysql5.7 -p 3306:3306 -v /usr/local/mysql/data:/var/lib/mysql -v /usr/local/mysql/conf.d:/etc/mysql/conf.d  -e MYSQL_ROOT_PASSWORD=112233 -d mysql:5.7.1910151eef645f8621441585354ad11d1f98514cdb253c5d1b77db6c0c50327420[root@dev mysql]# docker psCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES10151eef645f        mysql:5.7.19        "docker-entrypoint..."   3 seconds ago       Up 2 seconds        0.0.0.0:3306->3306/tcp   mysql5.76f189daf5880        marvin/tomcat       "catalina.sh run"        22 hours ago        Up 22 hours         0.0.0.0:8080->8080/tcp   tomcat8[root@dev mysql]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä»–å‚æ•°ï¼š</p><blockquote><p>â€“restart alwaysï¼šå¼€æœºå¯åŠ¨<br>â€“privileged=trueï¼šæå‡å®¹å™¨å†…æƒé™<br>-e MYSQL_USER=â€marvinâ€ï¼šæ·»åŠ ç”¨æˆ·marvin<br>-e MYSQL_PASSWORD=â€pwd123â€ï¼šè®¾ç½®marvinçš„å¯†ç ä¼Ÿpwd123<br>-e MYSQL_ROOT_PASSWORD=â€rootpwd123â€ï¼šè®¾ç½®rootçš„å¯†ç ä¼Ÿrootpwd123<br>â€“character-set-server=utf8ï¼šè®¾ç½®å­—ç¬¦é›†ä¸ºutf8<br>â€“collation-server=utf8_general_ciï¼šè®¾ç½®å­—ç¬¦æ¯”è¾ƒè§„åˆ™ä¸ºutf8_general_ci</p></blockquote><p>æ³¨æ„ï¼šå¦‚æœè¿è¡Œæ—¶æ·»åŠ äº†marvinç”¨æˆ·ï¼Œç”¨rootç™»å½•åæ‰§è¡Œç”¨æˆ·æˆæƒ<code>ALTER USER 'marvin'@'%' IDENTIFIED WITH mysql_native_password BY 'password123';</code>ï¼Œæ‰èƒ½ç”¨è¿œç¨‹å®¢æˆ·ç«¯è®¿é—®æ•°æ®åº“ã€‚</p><h4 id="1-4-æ£€æŸ¥ç»“æœ"><a href="#1-4-æ£€æŸ¥ç»“æœ" class="headerlink" title="1.4 æ£€æŸ¥ç»“æœ"></a>1.4 æ£€æŸ¥ç»“æœ</h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev mysql]# docker exec -it mysql5.7 mysql -uroot -p112233mysql: [Warning] Using a password on the command line interface can be insecure.Welcome to the MySQL monitor.  Commands end with ; or \g.Your MySQL connection id is 9Server version: 8.0.11 MySQL Community Server - GPLCopyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.mysql> show databases;+--------------------+| Database           |+--------------------+| information_schema || mysql              || performance_schema || sys                |+--------------------+4 rows in set (0.01 sec)mysql> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆåŠŸå®‰è£…mysql</p><h4 id="1-5-è®¾ç½®è¿œç¨‹å®¢æˆ·ç«¯ç™»å½•"><a href="#1-5-è®¾ç½®è¿œç¨‹å®¢æˆ·ç«¯ç™»å½•" class="headerlink" title="1.5 è®¾ç½®è¿œç¨‹å®¢æˆ·ç«¯ç™»å½•"></a>1.5 è®¾ç½®è¿œç¨‹å®¢æˆ·ç«¯ç™»å½•</h4><pre class="line-numbers language-shell"><code class="language-shell">mysql> grant all privileges on *.* to root@"%" identified by "root.123" with grant option;Query OK, 0 rows affected, 1 warning (0.00 sec)mysql> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/linux/docker/docker-mysql-connect.png" alt="è¿œç¨‹å®¢æˆ·ç«¯é“¾æ¥"></p><p>é€šè¿‡å®¢æˆ·ç«¯åˆ›å»ºæ•°æ®ä¸€ä¸ªæ•°æ®åº“ï¼Œåˆ›å»ºä¸€å¼ è¡¨<br><img src="/loading.gif" data-original="/images/linux/docker/docker-mysql-create-table.png" alt="åˆ›å»ºè¡¨"></p><p>åœ¨serverç«¯ç”¨å‘½ä»¤è¡ŒæŸ¥çœ‹:</p><pre class="line-numbers language-shell"><code class="language-shell">mysql> show databases;+--------------------+| Database           |+--------------------+| information_schema || demo               || mysql              || performance_schema || sys                |+--------------------+5 rows in set (0.00 sec)mysql> use demo;Reading table information for completion of table and column namesYou can turn off this feature to get a quicker startup with -ADatabase changedmysql> show tables;+----------------+| Tables_in_demo |+----------------+| test           |+----------------+1 row in set (0.00 sec)mysql> select * from test;Empty set (0.00 sec)mysql> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†çœ‹å®¿ä¸»æœºæ–‡ä»¶ç›®å½•ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">[root@dev data]# pwd/usr/local/mysql/data[root@dev data]# lltotal 188480-rw-r----- 1 polkitd ssh_keys       56 Jul 24 16:46 auto.cnf-rw------- 1 polkitd ssh_keys     1675 Jul 24 16:46 ca-key.pem-rw-r--r-- 1 polkitd ssh_keys     1074 Jul 24 16:46 ca.pem-rw-r--r-- 1 polkitd ssh_keys     1078 Jul 24 16:46 client-cert.pem-rw------- 1 polkitd ssh_keys     1675 Jul 24 16:46 client-key.pemdrwxr-x--- 2 polkitd ssh_keys     4096 Jul 24 16:52 demo-rw-r----- 1 polkitd ssh_keys     1321 Jul 24 16:46 ib_buffer_pool-rw-r----- 1 polkitd ssh_keys 79691776 Jul 24 16:52 ibdata1-rw-r----- 1 polkitd ssh_keys 50331648 Jul 24 16:52 ib_logfile0-rw-r----- 1 polkitd ssh_keys 50331648 Jul 24 16:46 ib_logfile1-rw-r----- 1 polkitd ssh_keys 12582912 Jul 24 16:52 ibtmp1drwxr-x--- 2 polkitd ssh_keys     4096 Jul 24 16:46 mysqldrwxr-x--- 2 polkitd ssh_keys     4096 Jul 24 16:46 performance_schema-rw------- 1 polkitd ssh_keys     1675 Jul 24 16:46 private_key.pem-rw-r--r-- 1 polkitd ssh_keys      451 Jul 24 16:46 public_key.pem-rw-r--r-- 1 polkitd ssh_keys     1078 Jul 24 16:46 server-cert.pem-rw------- 1 polkitd ssh_keys     1675 Jul 24 16:46 server-key.pemdrwxr-x--- 2 polkitd ssh_keys    12288 Jul 24 16:46 sys[root@dev data]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®Œç¾ï¼</p><h3 id="äºŒã€-ä½¿ç”¨dockerfileå¯åŠ¨mysqlå®¹å™¨"><a href="#äºŒã€-ä½¿ç”¨dockerfileå¯åŠ¨mysqlå®¹å™¨" class="headerlink" title="äºŒã€ ä½¿ç”¨dockerfileå¯åŠ¨mysqlå®¹å™¨"></a>äºŒã€ ä½¿ç”¨dockerfileå¯åŠ¨mysqlå®¹å™¨</h3><h4 id="2-1ã€ç¼–å†™docker-file"><a href="#2-1ã€ç¼–å†™docker-file" class="headerlink" title="2.1ã€ç¼–å†™docker file"></a>2.1ã€ç¼–å†™docker file</h4><p>åœ¨å½“å‰ç›®å½•ï¼ˆ/usr/local/mysql/ï¼‰åˆ›å»ºdockerfileæ–‡ä»¶ï¼Œç¼–è¾‘å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">FROM docker.io/mysql:5.7.19 #è®¾ç½®å…å¯†ç™»å½•ENV MYSQL_ALLOW_EMPTY_PASSWORD yes #å°†æ‰€éœ€æ–‡ä»¶æ”¾åˆ°å®¹å™¨ä¸­COPY setup.sh /mysql/setup.shCOPY schema.sql /mysql/schema.sqlCOPY privileges.sql /mysql/privileges.sqlCOPY conf.d /etc/mysql/conf.dRUN chmod 755 /mysql/*.sh# è®¾ç½®å¯ä»¥å…è®¸æŒ‚è½½çš„å·ï¼Œå¯ä»¥ç”¨æ¥å¤‡ä»½æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶# VOLUME  /usr/local/mysql/data# è®¾ç½®å¯ä»¥æ˜ å°„çš„ç«¯å£EXPOSE 3306 #è®¾ç½®å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤CMD ["sh", "/mysql/setup.sh"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2ã€å†™å®¹å™¨å¯åŠ¨è„šæœ¬setup-shå’Œé…ç½®æ–‡ä»¶ã€‚"><a href="#2-2ã€å†™å®¹å™¨å¯åŠ¨è„šæœ¬setup-shå’Œé…ç½®æ–‡ä»¶ã€‚" class="headerlink" title="2.2ã€å†™å®¹å™¨å¯åŠ¨è„šæœ¬setup.shå’Œé…ç½®æ–‡ä»¶ã€‚"></a>2.2ã€å†™å®¹å™¨å¯åŠ¨è„šæœ¬setup.shå’Œé…ç½®æ–‡ä»¶ã€‚</h4><p>setup.shå†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">#!/bin/bashset -e #æŸ¥çœ‹mysqlæœåŠ¡çš„çŠ¶æ€ï¼Œæ–¹ä¾¿è°ƒè¯•ï¼Œè¿™æ¡è¯­å¥å¯ä»¥åˆ é™¤echo `service mysql status` echo '1.å¯åŠ¨mysql....'#å¯åŠ¨mysqlservice mysql startsleep 3echo `service mysql status` echo '2.å¼€å§‹å¯¼å…¥æ•°æ®....'#å¯¼å…¥æ•°æ®mysql < /mysql/schema.sqlecho '3.å¯¼å…¥æ•°æ®å®Œæ¯•....' sleep 3echo `service mysql status` #é‡æ–°è®¾ç½®mysqlå¯†ç echo '4.å¼€å§‹ä¿®æ”¹å¯†ç ....'mysql < /mysql/privileges.sqlecho '5.ä¿®æ”¹å¯†ç å®Œæ¯•....' #sleep 3echo `service mysql status`echo `mysqlå®¹å™¨å¯åŠ¨å®Œæ¯•,ä¸”æ•°æ®å¯¼å…¥æˆåŠŸ` tail -f /dev/null<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¾ç½®å¯æ‰§è¡Œæƒé™ï¼š</p><blockquote><p>chmod  u+x setup.sh</p></blockquote><p>è¿™é‡Œæ˜¯å…ˆå¯¼å…¥æ•°æ®ï¼Œç„¶åæ‰æ˜¯è®¾ç½®ç”¨æˆ·å’Œæƒé™ï¼Œæ˜¯å› ä¸ºmysqlå®¹å™¨ä¸€å¼€å§‹ä¸ºå…å¯†ç™»å½•ï¼ŒDockerfileä¸­æœ‰å¦‚ä¸‹è®¾ç½®ï¼šENV MYSQL_ALLOW_EMPTY_PASSWORD yes,æ­¤æ—¶æ‰§è¡Œå¯¼å…¥æ•°æ®å‘½ä»¤ä¸éœ€è¦ç™»å½•éªŒè¯æ“ä½œï¼Œå¦‚æœæ˜¯å…ˆæ‰§è¡Œæƒé™æ“ä½œï¼Œé‚£ä¹ˆå¯¼å…¥æ•°æ®åˆ™éœ€è¦ç™»å½•éªŒè¯ï¼Œæ•´ä¸ªè¿‡ç¨‹å°±éº»çƒ¦äº†è®¸å¤šã€‚</p><p>conf.dç›®å½•ä¸‹åˆ›å»ºé…ç½®æ–‡ä»¶<code>my.cnf</code>,å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-conf"><code class="language-conf">[client]default-character-set=utf8mb4[mysqld]character-set-client-handshake = FALSEcharacter-set-server = utf8mb4collation-server = utf8mb4_unicode_ciinit_connect=â€™SET NAMES utf8mb4'max_allowed_packet=100M[mysql]default-character-set=utf8mb4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-3ã€éœ€è¦å¯¼å…¥æ•°æ®çš„mysqlè„šæœ¬å‘½ä»¤schema-sqlï¼š"><a href="#2-3ã€éœ€è¦å¯¼å…¥æ•°æ®çš„mysqlè„šæœ¬å‘½ä»¤schema-sqlï¼š" class="headerlink" title="2.3ã€éœ€è¦å¯¼å…¥æ•°æ®çš„mysqlè„šæœ¬å‘½ä»¤schema.sqlï¼š"></a>2.3ã€éœ€è¦å¯¼å…¥æ•°æ®çš„mysqlè„šæœ¬å‘½ä»¤schema.sqlï¼š</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- åˆ›å»ºæ•°æ®åº“</span><span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token punctuation">`</span>docker_mysql<span class="token punctuation">`</span> <span class="token keyword">default</span> <span class="token keyword">character set</span> utf8 <span class="token keyword">collate</span> utf8_general_ci<span class="token punctuation">;</span> <span class="token keyword">use</span> docker_mysql<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- å»ºè¡¨</span><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span><span class="token punctuation">;</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token punctuation">(</span> <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>created_at<span class="token punctuation">`</span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>last_modified<span class="token punctuation">`</span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>email<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>first_name<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>last_name<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>username<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>latin1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- æ’å…¥æ•°æ®</span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>created_at<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>last_modified<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>email<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>first_name<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>last_name<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>username<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token keyword">VALUES</span>  <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1490257904</span><span class="token punctuation">,</span><span class="token number">1490257904</span><span class="token punctuation">,</span><span class="token string">'john.doe@example.com'</span><span class="token punctuation">,</span><span class="token string">'John'</span><span class="token punctuation">,</span><span class="token string">'Doe'</span><span class="token punctuation">,</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºæ˜¯æµ‹è¯•ï¼Œæ‰€ä»¥éšä¾¿å†™äº†ä¸€ä¸ªå»ºè¡¨è¯­å¥ï¼Œå¦‚æœæ˜¯çœŸå®é¡¹ç›®è‚¯å®šä¸æ­¢è¿™ä¸€å¼ è¡¨ï¼Œç›´æ¥å°†å»ºè¡¨è¯­å¥è¦†ç›–è¿‡æ¥å°±å¥½ã€‚</p><h4 id="2-4ã€mysqlæƒé™è®¾ç½®å‘½ä»¤privileges-sqlï¼š"><a href="#2-4ã€mysqlæƒé™è®¾ç½®å‘½ä»¤privileges-sqlï¼š" class="headerlink" title="2.4ã€mysqlæƒé™è®¾ç½®å‘½ä»¤privileges.sqlï¼š"></a>2.4ã€mysqlæƒé™è®¾ç½®å‘½ä»¤privileges.sqlï¼š</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">use</span> mysql<span class="token punctuation">;</span><span class="token keyword">select</span> host<span class="token punctuation">,</span> <span class="token keyword">user</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- å› ä¸ºmysqlç‰ˆæœ¬æ˜¯5.7ï¼Œå› æ­¤æ–°å»ºç”¨æˆ·ä¸ºå¦‚ä¸‹å‘½ä»¤ï¼š</span><span class="token keyword">create</span> <span class="token keyword">user</span> docker identified <span class="token keyword">by</span> <span class="token string">'123456'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- å°†docker_mysqlæ•°æ®åº“çš„æƒé™æˆæƒç»™åˆ›å»ºçš„dockerç”¨æˆ·ï¼Œå¯†ç ä¸º123456ï¼š</span><span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">on</span> docker_mysql<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> docker@'<span class="token operator">%</span><span class="token string">' identified by '</span><span class="token number">123456</span>' <span class="token keyword">with</span> <span class="token keyword">grant</span> <span class="token keyword">option</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- åˆ›å»ºrootç”¨æˆ·ï¼Œè®¾ç½®å¯†ç </span><span class="token keyword">create</span> <span class="token keyword">user</span> root identified <span class="token keyword">by</span> <span class="token string">'root.123'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- æˆæƒrootç”¨æˆ·æ‰€æœ‰æ•°æ®åº“å¯†ç </span><span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> root@"<span class="token operator">%</span><span class="token string">" identified by "</span>root<span class="token number">.123</span>" <span class="token keyword">with</span> <span class="token keyword">grant</span> <span class="token keyword">option</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- è¿™ä¸€æ¡å‘½ä»¤ä¸€å®šè¦æœ‰ï¼š</span>flush <span class="token keyword">privileges</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-5ã€åˆ›å»ºé•œåƒdocker-build-t-marvin-docker-mysql-5-7-19"><a href="#2-5ã€åˆ›å»ºé•œåƒdocker-build-t-marvin-docker-mysql-5-7-19" class="headerlink" title="2.5ã€åˆ›å»ºé•œåƒdocker build -t marvin/docker-mysql:5.7.19 . "></a>2.5ã€åˆ›å»ºé•œåƒ<code>docker build -t marvin/docker-mysql:5.7.19 . </code></h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev mysql]# lltotal 28drwxr-xr-x 2 root    root     4096 Jul 24 19:16 conf.ddrwxr-xr-x 6 polkitd ssh_keys 4096 Jul 26 09:52 datadrwxr-xr-x 2 root    root     4096 Jul 26 12:02 datadir-rw-r--r-- 1 root    root      504 Jul 26 12:41 dockerfile-rw-r--r-- 1 root    root      578 Jul 24 18:38 privileges.sql-rw-r--r-- 1 root    root      713 Jul 24 17:59 schema.sql-rwxr--r-- 1 root    root      592 Jul 24 18:02 setup.sh[root@dev mysql]# rm -rf datadir/[root@dev mysql]# lltotal 24drwxr-xr-x 2 root    root     4096 Jul 24 19:16 conf.ddrwxr-xr-x 6 polkitd ssh_keys 4096 Jul 26 09:52 data-rw-r--r-- 1 root    root      504 Jul 26 12:41 dockerfile-rw-r--r-- 1 root    root      578 Jul 24 18:38 privileges.sql-rw-r--r-- 1 root    root      713 Jul 24 17:59 schema.sql-rwxr--r-- 1 root    root      592 Jul 24 18:02 setup.sh[root@dev mysql]# docker build -t marvin/docker-mysql:5.7.19 .Sending build context to Docker daemon 219.8 MBStep 1/9 : FROM docker.io/mysql:5.7.19 ---> 3e3878acd190Step 2/9 : ENV MYSQL_ALLOW_EMPTY_PASSWORD yes ---> Running in 12565f8c0c75 ---> c3603b8b0ce0Removing intermediate container 12565f8c0c75Step 3/9 : COPY setup.sh /mysql/setup.sh ---> 25f810745d6eRemoving intermediate container c87437761955Step 4/9 : COPY schema.sql /mysql/schema.sql ---> 6336d1ec2e5cRemoving intermediate container d18c0faf05e2Step 5/9 : COPY privileges.sql /mysql/privileges.sql ---> 909fd9a0147eRemoving intermediate container 597ba357c5ddStep 6/9 : COPY conf.d /etc/mysql/conf.d ---> 0df0b1a8419aRemoving intermediate container 5495b6697f5aStep 7/9 : RUN chmod 755 /mysql/*.sh ---> Running in 648c99da183d ---> 9637b6b5e125Removing intermediate container 648c99da183dStep 8/9 : EXPOSE 3306 ---> Running in 0b4514d7ffcc ---> 0acd4a3a39a6Removing intermediate container 0b4514d7ffccStep 9/9 : CMD sh /mysql/setup.sh ---> Running in 9cc069e6e6aa ---> effcf5bab4c1Removing intermediate container 9cc069e6e6aaSuccessfully built effcf5bab4c1[root@dev mysql]# [root@dev mysql]# docker imagesREPOSITORY            TAG                 IMAGE ID            CREATED             SIZEmarvin/docker-mysql   5.7.19              effcf5bab4c1        27 seconds ago      412 MBmarvin/tomcat         latest              098f61ab6f8b        2 days ago          489 MBnginx_image1          latest              c4d5f5accc06        2 days ago          109 MBdocker.io/tomcat      latest              2d43521f2b1a        8 days ago          463 MBdocker.io/nginx       latest              8b89e48b5f15        9 days ago          109 MBdocker.io/mysql       5.7.19              3e3878acd190        9 months ago        412 MB[root@dev mysql]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-6ã€å¯åŠ¨å®¹å™¨docker-run-d-p-13306-3306-v-usr-local-mysql-datadir-var-lib-mysql-marvin-docker-mysql-5-7-19"><a href="#2-6ã€å¯åŠ¨å®¹å™¨docker-run-d-p-13306-3306-v-usr-local-mysql-datadir-var-lib-mysql-marvin-docker-mysql-5-7-19" class="headerlink" title="2.6ã€å¯åŠ¨å®¹å™¨docker run -d -p 13306:3306 -v /usr/local/mysql/datadir:/var/lib/mysql marvin/docker-mysql:5.7.19 "></a>2.6ã€å¯åŠ¨å®¹å™¨<code>docker run -d -p 13306:3306 -v /usr/local/mysql/datadir:/var/lib/mysql marvin/docker-mysql:5.7.19 </code></h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev mysql]# docker run -d -p 13306:3306 -v /usr/local/mysql/datadir:/var/lib/mysql marvin/docker-mysql:5.7.19e55a41a9ace4fb09db5af3e77fab257764f938ffe2f7221ec312bf624f41543e[root@dev mysql]# docker psCONTAINER ID        IMAGE                        COMMAND                  CREATED             STATUS              PORTS                     NAMESe55a41a9ace4        marvin/docker-mysql:5.7.19   "docker-entrypoint..."   4 seconds ago       Up 3 seconds        0.0.0.0:13306->3306/tcp   inspiring_bassi831da6f83e21        mysql:5.7.19                 "docker-entrypoint..."   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp    mysql5.76f189daf5880        marvin/tomcat                "catalina.sh run"        2 days ago          Up 2 days           0.0.0.0:8080->8080/tcp    tomcat8[root@dev mysql]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-7ã€æ£€æŸ¥ç»“æœdocker-exec-it-e55a41a9ace4-mysql-udocker-p123456"><a href="#2-7ã€æ£€æŸ¥ç»“æœdocker-exec-it-e55a41a9ace4-mysql-udocker-p123456" class="headerlink" title="2.7ã€æ£€æŸ¥ç»“æœdocker exec -it e55a41a9ace4 mysql -udocker -p123456 "></a>2.7ã€æ£€æŸ¥ç»“æœ<code>docker exec -it e55a41a9ace4 mysql -udocker -p123456 </code></h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev mysql]# docker exec -it e55a41a9ace4 mysql -udocker -p123456            mysql: [Warning] Using a password on the command line interface can be insecure.Welcome to the MySQL monitor.  Commands end with ; or \g.Your MySQL connection id is 5Server version: 5.7.19 MySQL Community Server (GPL)Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.mysql> show databases;+--------------------+| Database           |+--------------------+| information_schema || docker_mysql       |+--------------------+2 rows in set (0.01 sec)mysql> use docker_mysqlReading table information for completion of table and column namesYou can turn off this feature to get a quicker startup with -ADatabase changedmysql> show tables;+------------------------+| Tables_in_docker_mysql |+------------------------+| user                   |+------------------------+1 row in set (0.01 sec)mysql> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-8ã€è¿œç¨‹ç™»å½•"><a href="#2-8ã€è¿œç¨‹ç™»å½•" class="headerlink" title="2.8ã€è¿œç¨‹ç™»å½•"></a>2.8ã€è¿œç¨‹ç™»å½•</h4><p><img src="/loading.gif" data-original="/images/linux/docker/docker-mysql-connect2.png" alt="è¿œç¨‹é“¾æ¥mysql"></p><p>ç”¨å®¢æˆ·ç«¯é“¾æ¥ååˆ›å»ºäº†æ•°æ®åº“ï¼Œç„¶åé‡æ–°å¯åŠ¨dockerï¼Œæ•°æ®ä»ç„¶åœ¨ã€‚å®Œç¾~~~</p><h3 id="ç¾ä¸­ä¸è¶³"><a href="#ç¾ä¸­ä¸è¶³" class="headerlink" title="ç¾ä¸­ä¸è¶³"></a>ç¾ä¸­ä¸è¶³</h3><p>1ã€æ‰¾ä¸åˆ°mysql.sock<br>åœ¨å®è·µè¿‡ç¨‹ä¸­ä¹Ÿç¢°åˆ°äº†æ¯”è¾ƒæ¶å¿ƒçš„é—®é¢˜ï¼Œå°±æ˜¯å¯åŠ¨æ—¶è€æ˜¯æ‰¾ä¸åˆ°mysql.sockï¼Œæœ€å¼€å§‹åœ¨my.cnfé‡Œæ²¡æœ‰é…ç½®socketçš„è·¯å¾„ï¼Œè¿™æ ·æ²¡é—®é¢˜ã€‚</p><p>ä½†æ˜¯ä¸çŸ¥é“é»˜è®¤çš„mysql.sockçš„å®¹å™¨é‡Œæ˜¯åœ¨ä»€ä¹ˆè·¯å¾„ä¸Šï¼›</p><p>äºæ˜¯åœ¨my.cnfé…ç½®æ–‡ä»¶é‡ŒåŠ ä¸Šè¿™ä¸ªé…ç½®<code>socket=/var/lib/mysql/mysql.sock</code>;</p><p>å¯åŠ¨çš„æ—¶å€™å°±æ€ä¹ˆéƒ½ä¼šæŠ¥é”™äº†<br>é”™è¯¯ä¿¡æ¯å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå°†é…ç½®æ”¹ä¸º<code>socket=/tmp/mysql.sock</code><br>å¯åŠ¨çš„æ—¶å€™åˆå˜æˆè¿™æ ·äº†ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">[root@dev mysql]# docker run -p 13306:3306 -v /usr/local/mysql/datadir:/var/lib/mysql marvin/docker-mysqlMySQL Community Server 5.7.19 is not running.1.å¯åŠ¨mysql......MySQL Community Server 5.7.19 is started.MySQL Community Server 5.7.19 is running.2.å¼€å§‹å¯¼å…¥æ•°æ®....ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>docker stop</code> <code>docker rm</code>  <code>docker rmi</code> <code>docker build</code> åˆé‡æ–°<code>docker run</code><br>åå¤äº†ä¸€ä¸Šåˆã€‚<br>æœ€åè¿˜æ˜¯æ²¡åŠæ³•ï¼ŒæŠŠé…ç½®æ–‡ä»¶ä¸­çš„sockçš„é…ç½®ç»™åˆ é™¤äº†ã€‚</p><p>æ­£å¸¸å¯åŠ¨åæŸ¥çŸ¥sockçš„è·¯å¾„é»˜è®¤çš„åŸæ¥æ˜¯<code>/var/run/mysqld</code></p><pre class="line-numbers language-shell"><code class="language-shell">root@63d3f0b5ea07:/var/run/mysqld# pwd/var/run/mysqldroot@63d3f0b5ea07:/var/run/mysqld# lsmysqld.pid  mysqld.sock  mysqld.sock.lockroot@63d3f0b5ea07:/var/run/mysqld# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åº”è¯¥èƒ½ä¿®æ”¹ï¼Œä¸è¿‡ä¸æƒ³æŠ˜è…¾äº†ã€‚</p><p>2ã€å¦‚æœæŒ‚è½½äº†æ•°æ®æŒä¹…åŒ–çš„æ•°æ®å·ï¼Œå†æ¬¡buildå®¹å™¨ï¼Œå¯åŠ¨æ—¶ä¼šæŠ¥åˆ›å»ºç”¨æˆ·å¤±è´¥ç­‰ï¼Œå› ä¸ºå·²æœ‰ç”¨æˆ·äº†ã€‚<br>å› æ­¤å¦‚æœæ˜¯äºŒæ¬¡è¿è¡Œï¼Œè¦ä¹ˆåˆ é™¤æ‰æŒä¹…åŒ–çš„æ•°æ®ï¼Œè¦ä¹ˆä¿®æ”¹setup.shè„šæœ¬ï¼Œä¸è¦å†æ‰§è¡Œprivileges.sqlå’Œschema.sqlã€‚</p><h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><p>ç”Ÿäº§ç¯å¢ƒä¸­å¯èƒ½æ•°æ®åº“è¦åšä¸»ä»ã€è¯»å†™åˆ†ç¦»ç­‰ç­‰ï¼Œä½†æ˜¯å› ä¸ºæ•°æ®æ˜¯è¦å…±äº«çš„ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ç”¨åˆ°ä¸‹çŸ¥è¯†.</p><h5 id="æ•°æ®å…±äº«"><a href="#æ•°æ®å…±äº«" class="headerlink" title="æ•°æ®å…±äº«"></a>æ•°æ®å…±äº«</h5><p>å¦‚æœè¦æˆæƒä¸€ä¸ªå®¹å™¨è®¿é—®å¦ä¸€ä¸ªå®¹å™¨çš„Volumeï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>-volumes-from</code>å‚æ•°æ¥æ‰§è¡Œ<code>docker run</code>ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">$&nbsp;docker&nbsp;run&nbsp;-it&nbsp;-h&nbsp;NEWCONTAINER&nbsp;--volumes-from&nbsp;container-test&nbsp;debian&nbsp;/bin/bashroot@NEWCONTAINER:/#&nbsp;ls&nbsp;/datatest-fileroot@NEWCONTAINER:/#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å€¼å¾—æ³¨æ„çš„æ˜¯ä¸ç®¡container-testæ˜¯å¦è¿è¡Œï¼Œå®ƒéƒ½ä¼šèµ·ä½œç”¨ã€‚åªè¦æœ‰å®¹å™¨è¿æ¥Volumeï¼Œå®ƒå°±ä¸ä¼šè¢«åˆ é™¤ã€‚</p><h5 id="æ•°æ®å®¹å™¨"><a href="#æ•°æ®å®¹å™¨" class="headerlink" title="æ•°æ®å®¹å™¨"></a>æ•°æ®å®¹å™¨</h5><p>å¸¸è§çš„ä½¿ç”¨åœºæ™¯æ˜¯ä½¿ç”¨çº¯æ•°æ®å®¹å™¨æ¥æŒä¹…åŒ–æ•°æ®åº“ã€é…ç½®æ–‡ä»¶æˆ–è€…æ•°æ®æ–‡ä»¶ç­‰ã€‚<a href="https://docs.docker.com/userguide/dockervolumes/">å®˜æ–¹çš„æ–‡æ¡£</a>ä¸Šæœ‰è¯¦ç»†çš„è§£é‡Šã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">docker run -it -v /dbdata:/dbdata --name dbdata centos<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¯¥å‘½ä»¤å°†ä¼šåˆ›å»ºä¸€ä¸ªå·²ç»åŒ…å«åœ¨Dockerfileé‡Œå®šä¹‰è¿‡Volumeçš„postgresé•œåƒï¼Œè¿è¡Œ<code>echo</code>å‘½ä»¤ç„¶åé€€å‡ºã€‚å½“æˆ‘ä»¬è¿è¡Œ<code>docker ps</code>å‘½ä»¤æ—¶ï¼Œ<code>echo</code>å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯†åˆ«æŸé•œåƒçš„ç”¨é€”ã€‚æˆ‘ä»¬å¯ä»¥ç”¨<code>-volumes-from</code>å‘½ä»¤æ¥è¯†åˆ«å…¶å®ƒå®¹å™¨çš„Volumeï¼š</p><p>åˆ›å»ºdb1å’Œdb2ä¸¤ä¸ªå®¹å™¨ï¼Œå¹¶ä½¿ç”¨â€“volumes-fromæŒ‚è½½dbdataå®¹å™¨ä¸­çš„æ•°æ®å·</p><pre class="line-numbers language-shell"><code class="language-shell">[root@wls12c /]$ docker run -it --volumes-from dbdata --name db1 centos[root@wls12c /]$ docker run -it --volumes-from dbdata --name db2 centos<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™æ ·ä¸‰ä¸ªå®¹å™¨ä»»ä½•ä¸€ä¸ªå®¹å™¨åœ¨è¯¥ç›®å½•ä¸‹å†™å…¥ï¼Œå…¶å®ƒå®¹å™¨éƒ½èƒ½çœ‹è§ã€‚</p><p>ä½¿ç”¨æ•°æ®å®¹å™¨çš„ä¸¤ä¸ªæ³¨æ„ç‚¹ï¼š</p><ul><li>  ä¸è¦è¿è¡Œæ•°æ®å®¹å™¨ï¼Œè¿™çº¯ç²¹æ˜¯åœ¨æµªè´¹èµ„æºã€‚</li><li>  ä¸è¦ä¸ºäº†æ•°æ®å®¹å™¨è€Œä½¿ç”¨â€œæœ€å°çš„é•œåƒâ€ï¼Œå¦‚<code>busybox</code>æˆ–<code>scratch</code>ï¼Œåªä½¿ç”¨æ•°æ®åº“é•œåƒæœ¬èº«å°±å¯ä»¥äº†ã€‚ä½ å·²ç»æ‹¥æœ‰è¯¥é•œåƒï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦å ç”¨é¢å¤–çš„ç©ºé—´ã€‚</li></ul><h5 id="å¤‡ä»½"><a href="#å¤‡ä»½" class="headerlink" title="å¤‡ä»½"></a>å¤‡ä»½</h5><p>å¤‡ä»½dbdataæ•°æ®å·å®¹å™¨ä¸­çš„æ•°æ®åˆ°ä¸»æœºçš„å½“å‰ç›®å½•ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">[root@wls12c /]$ docker run --volumes-from dbdata -v $(pwd):/backup --name worker centos tar zcf /backup/backup.tar.gz /dbdatatar: Removing leading `/' from member names[root@wls12c /]$ lsb2b            boot    dev   lib         media  net   root     srv   tmpbackup.tar.gz  cgroup  etc   lib64       misc   opt   sbin     sys   usrbin            dbdata  home  lost+found  mnt    proc  selinux  test  var[root@wls12c /]$ tar -tvf backup.tar.gz drwxr-xr-x root/root         0 2016-08-26 10:51 dbdata/-rw-r--r-- root/root         0 2016-08-26 10:40 dbdata/demo-rw-r--r-- root/root         6 2016-08-26 10:48 dbdata/test.txt-rw-r--r-- root/root         0 2016-08-26 10:51 dbdata/hello<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="æ¢å¤"><a href="#æ¢å¤" class="headerlink" title="æ¢å¤"></a>æ¢å¤</h5><p>åˆ›å»ºä¸€ä¸ªå¸¦æœ‰æ•°æ®å·çš„å®¹å™¨</p><pre class="line-numbers language-shell"><code class="language-shell">[root@wls12c /]$ docker run -v /dbdata/dbdata --name db centos /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¢å¤</p><pre class="line-numbers language-shell"><code class="language-shell">[root@wls12c /]$ docker run --volumes-from db -v $(pwd):/backup  centos tar xf /backup/backup.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="æƒé™ä¸è®¸å¯"><a href="#æƒé™ä¸è®¸å¯" class="headerlink" title="æƒé™ä¸è®¸å¯"></a>æƒé™ä¸è®¸å¯</h5><p>é€šå¸¸ä½ éœ€è¦è®¾ç½®Volumeçš„æƒé™æˆ–è€…ä¸ºVolumeåˆå§‹åŒ–ä¸€äº›é»˜è®¤æ•°æ®æˆ–è€…é…ç½®æ–‡ä»¶ã€‚è¦æ³¨æ„çš„å…³é”®ç‚¹æ˜¯ï¼Œåœ¨Dockerfileçš„<code>VOLUME</code>æŒ‡ä»¤åçš„ä»»ä½•ä¸œè¥¿éƒ½ä¸èƒ½æ”¹å˜è¯¥Volumeï¼Œæ¯”å¦‚ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">FROM&nbsp;debian:wheezyRUN&nbsp;useradd&nbsp;fooVOLUME&nbsp;/dataRUN&nbsp;touch&nbsp;/data/xRUN&nbsp;chown&nbsp;-R&nbsp;foo:foo&nbsp;/data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥Docker fileä¸èƒ½æŒ‰é¢„æœŸé‚£æ ·è¿è¡Œï¼Œæˆ‘ä»¬æœ¬æ¥å¸Œæœ›<code>touch</code>å‘½ä»¤åœ¨é•œåƒçš„æ–‡ä»¶ç³»ç»Ÿä¸Šè¿è¡Œï¼Œä½†æ˜¯å®é™…ä¸Šå®ƒæ˜¯åœ¨ä¸€ä¸ªä¸´æ—¶å®¹å™¨çš„Volumeä¸Šè¿è¡Œã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">FROM&nbsp;debian:wheezyRUN&nbsp;useradd&nbsp;fooRUN&nbsp;mkdir&nbsp;/data&nbsp;&&&nbsp;touch&nbsp;/data/xRUN&nbsp;chown&nbsp;-R&nbsp;foo:foo&nbsp;/dataVOLUME&nbsp;/data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Dockerå¯ä»¥å°†é•œåƒä¸­Volumeä¸‹çš„æ–‡ä»¶æŒ‚è½½åˆ°Volumeä¸‹ï¼Œå¹¶è®¾ç½®æ­£ç¡®çš„æƒé™ã€‚å¦‚æœä½ æŒ‡å®šVolumeçš„ä¸»æœºç›®å½•å°†ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚</p><p>å¦‚æœä½ æ²¡æœ‰é€šè¿‡<code>RUN</code>æŒ‡ä»¤è®¾ç½®æƒé™ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦åœ¨å®¹å™¨å¯åŠ¨æ—¶ä½¿ç”¨<code>CMD</code>æˆ–<code>ENTRYPOINT</code>æŒ‡ä»¤æ¥æ‰§è¡Œï¼ˆè¯‘è€…æ³¨ï¼šCMDæŒ‡ä»¤ç”¨äºæŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼Œä¸RUNç±»ä¼¼ï¼Œåªæ˜¯RUNæ˜¯é•œåƒåœ¨æ„å»ºæ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼‰ã€‚</p><h5 id="åˆ é™¤Volumes"><a href="#åˆ é™¤Volumes" class="headerlink" title="åˆ é™¤Volumes"></a>åˆ é™¤Volumes</h5><p>è¿™ä¸ªåŠŸèƒ½å¯èƒ½ä¼šæ›´åŠ é‡è¦ï¼Œå¦‚æœä½ å·²ç»ä½¿ç”¨<code>docker rm</code>æ¥åˆ é™¤ä½ çš„å®¹å™¨ï¼Œé‚£å¯èƒ½æœ‰å¾ˆå¤šçš„å­¤ç«‹çš„Volumeä»åœ¨å ç”¨ç€ç©ºé—´ã€‚</p><p>Volumeåªæœ‰åœ¨ä¸‹åˆ—æƒ…å†µä¸‹æ‰èƒ½è¢«åˆ é™¤ï¼š</p><ul><li>  è¯¥å®¹å™¨æ˜¯ç”¨<code>docker rm ï¼v</code>å‘½ä»¤æ¥åˆ é™¤çš„ï¼ˆ<code>-v</code>æ˜¯å¿…ä¸å¯å°‘çš„ï¼‰ã€‚</li><li>  <code>docker run</code>ä¸­ä½¿ç”¨äº†<code>--rm</code>å‚æ•°</li></ul><p>å³ä½¿ç”¨ä»¥ä¸Šä¸¤ç§å‘½ä»¤ï¼Œä¹Ÿåªèƒ½åˆ é™¤æ²¡æœ‰å®¹å™¨è¿æ¥çš„Volumeã€‚è¿æ¥åˆ°ç”¨æˆ·æŒ‡å®šä¸»æœºç›®å½•çš„Volumeæ°¸è¿œä¸ä¼šè¢«dockeråˆ é™¤ã€‚</p><p>é™¤éä½ å·²ç»å¾ˆå°å¿ƒçš„ï¼Œæ€»æ˜¯åƒè¿™æ ·æ¥è¿è¡Œå®¹å™¨ï¼Œå¦åˆ™ä½ å°†ä¼šåœ¨<code>/var/lib/docker/vfs/dir</code>ç›®å½•ä¸‹å¾—åˆ°ä¸€äº›åƒµå°¸æ–‡ä»¶å’Œç›®å½•ï¼Œå¹¶ä¸”è¿˜ä¸å®¹æ˜“è¯´å‡ºå®ƒä»¬åˆ°åº•ä»£è¡¨ä»€ä¹ˆã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://www.jb51.net/article/115422.htm">è¯¦è§£åˆ©ç”¨Dockerfileæ„å»ºmysqlé•œåƒå¹¶å®ç°æ•°æ®çš„åˆå§‹åŒ–åŠæƒé™è®¾ç½®</a><br><a href="http://blog.51cto.com/sf1314/2047686">åŸºäºDockerfileæ„å»ºmysqldæœåŠ¡é•œåƒ</a><br><a href="https://www.cnblogs.com/andyfengzp/p/6424150.html">dockerfile å®ä¾‹</a><br><a href="https://blog.csdn.net/weixin_40539892/article/details/79567422">æ‰¾ä¸åˆ°mysql.sockçš„é”™è¯¯è¯¦è§£</a></p>]]></content>
      
      
      <categories>
          
          <category> è¿ç»´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerå­¦ä¹ æ¡ˆä¾‹ï¼šç”¨dockeréƒ¨ç½²tomcatæœåŠ¡</title>
      <link href="2018/07/23/docker-xue-xi-an-li-yong-docker-bu-shu-tomcat-fu-wu/"/>
      <url>2018/07/23/docker-xue-xi-an-li-yong-docker-bu-shu-tomcat-fu-wu/</url>
      
        <content type="html"><![CDATA[<p>dockerå®é™…æ¡ˆä¾‹ä¹‹åœ¨centOS7.4ä¸Šç”¨dockeréƒ¨ç½²tomcatæœåŠ¡<br><a href="https://www.jianshu.com/p/2c3cbd1dfb08">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="ä¸€ã€ä½¿ç”¨docker-runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªtomcatå®¹å™¨"><a href="#ä¸€ã€ä½¿ç”¨docker-runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªtomcatå®¹å™¨" class="headerlink" title="ä¸€ã€ä½¿ç”¨docker runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªtomcatå®¹å™¨"></a>ä¸€ã€ä½¿ç”¨docker runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªtomcatå®¹å™¨</h3><h4 id="1-1-ä¸‹è½½å®˜æ–¹tomcaté•œåƒ"><a href="#1-1-ä¸‹è½½å®˜æ–¹tomcaté•œåƒ" class="headerlink" title="1.1 ä¸‹è½½å®˜æ–¹tomcaté•œåƒ"></a>1.1 ä¸‹è½½å®˜æ–¹tomcaté•œåƒ</h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev nginx]# docker search tomcatINDEX       NAME                                            DESCRIPTION                                     STARS     OFFICIAL   AUTOMATEDdocker.io   docker.io/tomcat                                Apache Tomcat is an open source implementa...   1942      [OK]       docker.io   docker.io/tomee                                 Apache TomEE is an all-Apache Java EE cert...   51        [OK]       docker.io   docker.io/dordoka/tomcat                        Ubuntu 14.04, Oracle JDK 8 and Tomcat 8 ba...   49                   [OK]docker.io   docker.io/davidcaste/alpine-tomcat              Apache Tomcat 7/8 using Oracle Java 7/8 wi...   27                   [OK]docker.io   docker.io/bitnami/tomcat                        Bitnami Tomcat Docker Image                     19                   [OK]docker.io   docker.io/consol/tomcat-7.0                     Tomcat 7.0.57, 8080, "admin/admin"              16                   [OK]docker.io   docker.io/cloudesire/tomcat                     Tomcat server, 6/7/8                            15                   [OK]docker.io   docker.io/tutum/tomcat                          Base docker image to run a Tomcat applicat...   10                   docker.io   docker.io/meirwa/spring-boot-tomcat-mysql-app   a sample spring-boot app using tomcat and ...   9                    [OK]docker.io   docker.io/jeanblanchard/tomcat                  Minimal Docker image with Apache Tomcat         8                    docker.io   docker.io/aallam/tomcat-mysql                   Debian, Oracle JDK, Tomcat & MySQL              7                    [OK]docker.io   docker.io/rightctrl/tomcat                      CentOS , Oracle Java, tomcat application s...   3                    [OK]docker.io   docker.io/amd64/tomcat                          Apache Tomcat is an open source implementa...   2                    docker.io   docker.io/arm64v8/tomcat                        Apache Tomcat is an open source implementa...   2                    docker.io   docker.io/fabric8/tomcat-8                      Fabric8 Tomcat 8 Image                          2                    [OK]docker.io   docker.io/maluuba/tomcat7-java8                 Tomcat7 with java8.                             2                    docker.io   docker.io/99taxis/tomcat7                       Tomcat7                                         1                    [OK]docker.io   docker.io/camptocamp/tomcat-logback             Docker image for tomcat with logback integ...   1                    [OK]docker.io   docker.io/primetoninc/tomcat                    Apache tomcat 8.5, 8.0, 7.0                     1                    [OK]docker.io   docker.io/jelastic/tomcat                                                                       0                    docker.io   docker.io/oobsri/tomcat8                        Testing CI Jobs with different names.           0                    docker.io   docker.io/picoded/tomcat7                       tomcat7 with jre8 and MANAGER_USER / MANAG...   0                    [OK]docker.io   docker.io/s390x/tomcat                          Apache Tomcat is an open source implementa...   0                    docker.io   docker.io/swisstopo/service-print-tomcat        backend tomcat for service-print "the true...   0                    docker.io   docker.io/trollin/tomcat                                                                        0                    [root@dev nginx]# docker pull docker.io/tomcatUsing default tag: latestTrying to pull repository docker.io/library/tomcat ... latest: Pulling from docker.io/library/tomcat55cbf04beb70: Pull complete 1607093a898c: Pull complete 9a8ea045c926: Pull complete 1290813abd9d: Pull complete 8a6b982ad6d7: Pull complete abb029e68402: Pull complete 8cd067dc06dc: Pull complete 1b9ce2097b98: Pull complete d6db5874b692: Pull complete 25b4aa3d52c5: Pull complete 53ec227dabf0: Pull complete 242938ace8b4: Pull complete Digest: sha256:87ad70ceaafd5c71301b081b37ca2795bd6c7c1a5599a8c92c9447bbd225ae47Status: Downloaded newer image for docker.io/tomcat:latest[root@dev nginx]# docker imagesREPOSITORY          TAG                 IMAGE ID            CREATED             SIZEnginx_image1        latest              c4d5f5accc06        57 minutes ago      109 MBdocker.io/tomcat    latest              2d43521f2b1a        5 days ago          463 MBdocker.io/nginx     latest              8b89e48b5f15        6 days ago          109 MB[root@dev nginx]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-2-å¯åŠ¨å®¹å™¨"><a href="#1-2-å¯åŠ¨å®¹å™¨" class="headerlink" title="1.2 å¯åŠ¨å®¹å™¨"></a>1.2 å¯åŠ¨å®¹å™¨</h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev nginx]# docker run -p 8080:8080 docker.io/tomcat23-Jul-2018 09:31:43.954 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version:        Apache Tomcat/8.5.3223-Jul-2018 09:31:43.966 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server built:          Jun 20 2018 19:50:35 UTC23-Jul-2018 09:31:43.966 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server number:         8.5.32.023-Jul-2018 09:31:43.966 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Name:               Linux23-Jul-2018 09:31:43.966 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Version:            3.10.0-693.2.2.el7.x86_6423-Jul-2018 09:31:43.966 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Architecture:          amd6423-Jul-2018 09:31:43.966 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Java Home:             /usr/lib/jvm/java-8-openjdk-amd64/jre23-Jul-2018 09:31:43.966 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Version:           1.8.0_171-8u171-b11-1~deb9u1-b1123-Jul-2018 09:31:43.966 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Vendor:            Oracle Corporation23-Jul-2018 09:31:43.966 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_BASE:         /usr/local/tomcat23-Jul-2018 09:31:43.967 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_HOME:         /usr/local/tomcat23-Jul-2018 09:31:43.967 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.util.logging.config.file=/usr/local/tomcat/conf/logging.properties23-Jul-2018 09:31:43.967 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager23-Jul-2018 09:31:43.967 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djdk.tls.ephemeralDHKeySize=204823-Jul-2018 09:31:43.967 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.protocol.handler.pkgs=org.apache.catalina.webresources23-Jul-2018 09:31:43.967 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dorg.apache.catalina.security.SecurityListener.UMASK=002723-Jul-2018 09:31:43.967 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dignore.endorsed.dirs=23-Jul-2018 09:31:43.967 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcatalina.base=/usr/local/tomcat23-Jul-2018 09:31:43.967 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcatalina.home=/usr/local/tomcat23-Jul-2018 09:31:43.967 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.io.tmpdir=/usr/local/tomcat/temp23-Jul-2018 09:31:43.968 INFO [main] org.apache.catalina.core.AprLifecycleListener.lifecycleEvent Loaded APR based Apache Tomcat Native library [1.2.17] using APR version [1.5.2].23-Jul-2018 09:31:43.968 INFO [main] org.apache.catalina.core.AprLifecycleListener.lifecycleEvent APR capabilities: IPv6 [true], sendfile [true], accept filters [false], random [true].23-Jul-2018 09:31:43.968 INFO [main] org.apache.catalina.core.AprLifecycleListener.lifecycleEvent APR/OpenSSL configuration: useAprConnector [false], useOpenSSL [true]23-Jul-2018 09:31:43.981 INFO [main] org.apache.catalina.core.AprLifecycleListener.initializeSSL OpenSSL successfully initialized [OpenSSL 1.1.0f  25 May 2017]23-Jul-2018 09:31:44.152 INFO [main] org.apache.coyote.AbstractProtocol.init Initializing ProtocolHandler ["http-nio-8080"]23-Jul-2018 09:31:44.168 INFO [main] org.apache.tomcat.util.net.NioSelectorPool.getSharedSelector Using a shared selector for servlet write/read23-Jul-2018 09:31:44.190 INFO [main] org.apache.coyote.AbstractProtocol.init Initializing ProtocolHandler ["ajp-nio-8009"]23-Jul-2018 09:31:44.193 INFO [main] org.apache.tomcat.util.net.NioSelectorPool.getSharedSelector Using a shared selector for servlet write/read23-Jul-2018 09:31:44.197 INFO [main] org.apache.catalina.startup.Catalina.load Initialization processed in 987 ms23-Jul-2018 09:31:44.247 INFO [main] org.apache.catalina.core.StandardService.startInternal Starting service [Catalina]23-Jul-2018 09:31:44.248 INFO [main] org.apache.catalina.core.StandardEngine.startInternal Starting Servlet Engine: Apache Tomcat/8.5.3223-Jul-2018 09:31:44.281 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory [/usr/local/tomcat/webapps/docs]23-Jul-2018 09:31:44.886 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/usr/local/tomcat/webapps/docs] has finished in [606] ms23-Jul-2018 09:31:44.893 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory [/usr/local/tomcat/webapps/examples]23-Jul-2018 09:31:45.359 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/usr/local/tomcat/webapps/examples] has finished in [465] ms23-Jul-2018 09:31:45.359 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory [/usr/local/tomcat/webapps/ROOT]23-Jul-2018 09:31:45.396 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/usr/local/tomcat/webapps/ROOT] has finished in [37] ms23-Jul-2018 09:31:45.397 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory [/usr/local/tomcat/webapps/manager]23-Jul-2018 09:31:45.454 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/usr/local/tomcat/webapps/manager] has finished in [56] ms23-Jul-2018 09:31:45.454 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory [/usr/local/tomcat/webapps/host-manager]23-Jul-2018 09:31:45.499 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/usr/local/tomcat/webapps/host-manager] has finished in [45] ms23-Jul-2018 09:31:45.504 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler ["http-nio-8080"]23-Jul-2018 09:31:45.533 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler ["ajp-nio-8009"]23-Jul-2018 09:31:45.538 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in 1340 ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-3-æµè§ˆå™¨æŸ¥çœ‹"><a href="#1-3-æµè§ˆå™¨æŸ¥çœ‹" class="headerlink" title="1.3 æµè§ˆå™¨æŸ¥çœ‹"></a>1.3 æµè§ˆå™¨æŸ¥çœ‹</h4><p><img src="/loading.gif" data-original="/images/linux/docker/docker-tomcat.png" alt="tomcat:8080"></p><h4 id="1-4-éƒ¨ç½²è‡ªå·±çš„webåº”ç”¨"><a href="#1-4-éƒ¨ç½²è‡ªå·±çš„webåº”ç”¨" class="headerlink" title="1.4 éƒ¨ç½²è‡ªå·±çš„webåº”ç”¨"></a>1.4 éƒ¨ç½²è‡ªå·±çš„webåº”ç”¨</h4><p>å°†æœ¬åœ°waråŒ…ä¸Šä¼ åˆ°å®¿ä¸»æœº<code>/opt/tomcat8/</code>ç›®å½•ä¸‹ã€‚<br>å…ˆåœæ­¢åŸæ¥çš„tomcatå®¹å™¨ï¼Œç„¶åé‡æ–°æŒ‚åœ¨æ–°çš„waråŒ…å¹¶å¯åŠ¨ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">[root@dev nginx]# docker psCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES00a88a12a6f4        nginx_image1        "/bin/sh -c 'nginx..."   About an hour ago   Up About an hour    0.0.0.0:80->80/tcp   nginx[root@dev nginx]# docker stop 00a88a12a6f400a88a12a6f4[root@dev nginx]# docker rm 00a88a12a6f400a88a12a6f4[root@dev nginx]# cd /opt/tomcat8/[root@dev tomcat8]# lltotal 25852-rw-r--r-- 1 root root 26470421 Jul 23 17:40 weixin.war[root@dev tomcat8]# docker run -d -v /opt/tomcat8/weixin.war:/usr/local/tomcat/webapps/weixin.war -p 8080:8080 docker.io/tomcat  2c2e386b7d1a2635f7be28c404a7a71a0ec8fda074b22035be6d62d28b8f8a50[root@dev tomcat8]# docker psCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                    NAMES2c2e386b7d1a        docker.io/tomcat    "catalina.sh run"   15 seconds ago      Up 14 seconds       0.0.0.0:8080->8080/tcp   mystifying_wilson[root@dev tomcat8]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨æ¥å£æŸ¥çœ‹å¯åŠ¨æƒ…å†µ<br><img src="/loading.gif" data-original="/images/linux/docker/docker-tomcat-config.png" alt="tomcatï¼š8080"><br>å®¹å™¨æ­£å¸¸å¯åŠ¨ã€‚</p><h3 id="äºŒã€ä½¿ç”¨docker-fileå¯åŠ¨tomcatå®¹å™¨"><a href="#äºŒã€ä½¿ç”¨docker-fileå¯åŠ¨tomcatå®¹å™¨" class="headerlink" title="äºŒã€ä½¿ç”¨docker fileå¯åŠ¨tomcatå®¹å™¨"></a>äºŒã€ä½¿ç”¨docker fileå¯åŠ¨tomcatå®¹å™¨</h3><h4 id="2-1ã€ç¼–å†™docker-file"><a href="#2-1ã€ç¼–å†™docker-file" class="headerlink" title="2.1ã€ç¼–å†™docker file"></a>2.1ã€ç¼–å†™docker file</h4><p>åœ¨å½“å‰/opt/tomcat8/ç›®å½•ä¸‹åˆ›å»ºdockerfileæ–‡ä»¶ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">from docker.io/tomcat:8.5.29    MAINTAINER marvin(qdhaiqiang@163.com)   COPY  webapps   /usr/local/tomcat/webappsCOPY  logs  /usr/local/tomcat/logsCOPY  conf/server.xml  /usr/local/tomcat/conf/server.xml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2ã€ç”¨dockerfile-æ„å»ºå‡ºé•œtomcaté•œåƒ"><a href="#2-2ã€ç”¨dockerfile-æ„å»ºå‡ºé•œtomcaté•œåƒ" class="headerlink" title="2. 2ã€ç”¨dockerfile æ„å»ºå‡ºé•œtomcaté•œåƒ"></a>2. 2ã€ç”¨dockerfile æ„å»ºå‡ºé•œtomcaté•œåƒ</h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev tomcat8]# docker build -t marvin/tomcat . Sending build context to Docker daemon 26.48 MBStep 1/5 : FROM docker.io/tomcat:latest ---> 2d43521f2b1aStep 2/5 : MAINTAINER marvin(qdhaiqiang@163.com) ---> Running in de53a8b32cf8 ---> fd9c7980f09eRemoving intermediate container de53a8b32cf8Step 3/5 : COPY webapps /usr/local/tomcat/webapps ---> 010bf40a7e8dRemoving intermediate container 27feb6b70ca8Step 4/5 : COPY logs /usr/local/tomcat/logs ---> 010946977b25Removing intermediate container aff55ea55e30Step 5/5 : COPY conf/server.xml /usr/local/tomcat/conf/server.xml ---> 098f61ab6f8bRemoving intermediate container 18d241c36d15Successfully built 098f61ab6f8b[root@dev tomcat8]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥çœ‹æ–°æ„å»ºçš„é•œåƒ</p><pre class="line-numbers language-shell"><code class="language-shell">[root@dev tomcat8]# docker imagesREPOSITORY          TAG                 IMAGE ID            CREATED             SIZEmarvin/tomcat       latest              098f61ab6f8b        11 seconds ago      489 MBnginx_image1        latest              c4d5f5accc06        About an hour ago   109 MBdocker.io/tomcat    latest              2d43521f2b1a        5 days ago          463 MBdocker.io/nginx     latest              8b89e48b5f15        6 days ago          109 MB[root@dev tomcat8]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-3ã€-è¿è¡Œæ–°æ„å»ºçš„é•œåƒ"><a href="#2-3ã€-è¿è¡Œæ–°æ„å»ºçš„é•œåƒ" class="headerlink" title="2.3ã€ è¿è¡Œæ–°æ„å»ºçš„é•œåƒ"></a>2.3ã€ è¿è¡Œæ–°æ„å»ºçš„é•œåƒ</h4><pre class="line-numbers language-shell"><code class="language-shell">[root@dev tomcat8]# docker run --name tomcat8 -d -p 8080:8080  marvin/tomcat6f189daf58807a5683a8b9d6c01b1b30ae8770045aa551535d27b641681c256a[root@dev tomcat8]# docker psCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                    NAMES6f189daf5880        marvin/tomcat       "catalina.sh run"   3 seconds ago       Up 2 seconds        0.0.0.0:8080->8080/tcp   tomcat8[root@dev tomcat8]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-4ã€-æŸ¥çœ‹é•œåƒè¿è¡Œæ•ˆæœ"><a href="#2-4ã€-æŸ¥çœ‹é•œåƒè¿è¡Œæ•ˆæœ" class="headerlink" title="2.4ã€ æŸ¥çœ‹é•œåƒè¿è¡Œæ•ˆæœ"></a>2.4ã€ æŸ¥çœ‹é•œåƒè¿è¡Œæ•ˆæœ</h4><p><img src="/loading.gif" data-original="/images/linux/docker/docker-tomcat-config2.png" alt="tomcat.png"></p><h4 id="2-5ã€å¦‚æœè¦é…ç½®httpsè¯ä¹¦çš„è¯ï¼Œå¯å°†jksçš„è¯ä¹¦æ”¾äºconfç›®å½•ä¸‹ï¼Œåœ¨serverä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨è¯ä¹¦ï¼Œé…ç½®å¦‚ä¸‹"><a href="#2-5ã€å¦‚æœè¦é…ç½®httpsè¯ä¹¦çš„è¯ï¼Œå¯å°†jksçš„è¯ä¹¦æ”¾äºconfç›®å½•ä¸‹ï¼Œåœ¨serverä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨è¯ä¹¦ï¼Œé…ç½®å¦‚ä¸‹" class="headerlink" title="2.5ã€å¦‚æœè¦é…ç½®httpsè¯ä¹¦çš„è¯ï¼Œå¯å°†jksçš„è¯ä¹¦æ”¾äºconfç›®å½•ä¸‹ï¼Œåœ¨serverä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨è¯ä¹¦ï¼Œé…ç½®å¦‚ä¸‹:"></a>2.5ã€å¦‚æœè¦é…ç½®httpsè¯ä¹¦çš„è¯ï¼Œå¯å°†jksçš„è¯ä¹¦æ”¾äºconfç›®å½•ä¸‹ï¼Œåœ¨serverä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨è¯ä¹¦ï¼Œé…ç½®å¦‚ä¸‹:</h4><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Connector</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>8888<span class="token punctuation">"</span></span> <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.apache.coyote.http11.Http11NioProtocol<span class="token punctuation">"</span></span>               <span class="token attr-name">maxThreads</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>150<span class="token punctuation">"</span></span> <span class="token attr-name">SSLEnabled</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">scheme</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https<span class="token punctuation">"</span></span> <span class="token attr-name">secure</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">URIEncoding</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span>                 <span class="token attr-name">clientAuth</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">sslProtocol</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>TLS<span class="token punctuation">"</span></span> <span class="token attr-name">keystoreFile</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>conf/SHA256withRSA__.haier.net.jks<span class="token punctuation">"</span></span> <span class="token attr-name">keystorePass</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20170905<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æˆ–è€…å¦‚æœæ˜¯pemæ–‡ä»¶çš„è¯</p><pre class="line-numbers language-xml"><code class="language-xml"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Connector</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>8443<span class="token punctuation">"</span></span> <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.apache.coyote.http11.Http11AprProtocol<span class="token punctuation">"</span></span>               <span class="token attr-name">maxThreads</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>150<span class="token punctuation">"</span></span> <span class="token attr-name">SSLEnabled</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>UpgradeProtocol</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.apache.coyote.http2.Http2Protocol<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SSLHostConfig</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Certificate</span> <span class="token attr-name">certificateKeyFile</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>conf/localhost-rsa-key.pem<span class="token punctuation">"</span></span>                         <span class="token attr-name">certificateFile</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>conf/localhost-rsa-cert.pem<span class="token punctuation">"</span></span>                         <span class="token attr-name">certificateChainFile</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>conf/localhost-rsa-chain.pem<span class="token punctuation">"</span></span>                         <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>RSA<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SSLHostConfig</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Connector</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-6ã€åœ¨åˆ†å¸ƒå¼å¾®æœåŠ¡ä¸­çš„åº”ç”¨"><a href="#2-6ã€åœ¨åˆ†å¸ƒå¼å¾®æœåŠ¡ä¸­çš„åº”ç”¨" class="headerlink" title="2.6ã€åœ¨åˆ†å¸ƒå¼å¾®æœåŠ¡ä¸­çš„åº”ç”¨"></a>2.6ã€åœ¨åˆ†å¸ƒå¼å¾®æœåŠ¡ä¸­çš„åº”ç”¨</h4><p> tomcatä½œä¸ºwebå®¹å™¨è¢«å¹¿æ³›åº”ç”¨ï¼Œä½†æˆ‘ä»¬ç›®å‰restfulæ¥å£ç‰¹åˆ«å¤šï¼Œæ¯ä¸ªæ¥å£éƒ½éœ€è¦ä¸€ä¸ªtomcatæ¥å¯åŠ¨ï¼Œä¸ºäº†é…ç½®éš”ç¦»ï¼Œä¸€èˆ¬éƒ½ä¼šæŠŠtomcatå®‰è£…æ–‡ä»¶å¤åˆ¶å¤šéï¼Œåˆ†åˆ«æŠŠwaråŒ…éƒ¨ç½²åœ¨å¯¹åº”çš„webappç›®å½•ä¸‹ï¼Œä½†è¿™æ ·é€ æˆçš„é—®é¢˜å°±æ˜¯tomcatå®‰è£…æ–‡ä»¶å ç”¨äº†å¤§é‡çš„ç£ç›˜ç©ºé—´ï¼Œä¸”ä¸ä¾¿äºç»Ÿä¸€ç®¡ç†ã€‚æ¯”å¦‚è¦ä¿®æ”¹tomcatçš„æŸä¸ªé…ç½®ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ‰€æœ‰çš„tomcatç›®å½•éƒ½è¦ä¿®æ”¹ä¸€éã€‚</p><p>åŸºäºä¸Šè¿°æƒ…å†µï¼Œä½œè€…è®¾è®¡äº†ä¸€ç§åŸºäºdockerçš„tomcatæœåŠ¡åŒ–æ–¹æ¡ˆã€‚</p><p><img src="/loading.gif" data-original="/images/linux/docker/docker-tomcat-config3.png" alt="åˆ†å¸ƒå¼åº”ç”¨"></p><h4 id="2-7ã€æŸ¥çœ‹tomcatæ—¥å¿—"><a href="#2-7ã€æŸ¥çœ‹tomcatæ—¥å¿—" class="headerlink" title="2.7ã€æŸ¥çœ‹tomcatæ—¥å¿—"></a>2.7ã€æŸ¥çœ‹tomcatæ—¥å¿—</h4><p>å› ä¸ºtomcatæ—¥å¿—æ˜¯éšç€ç¨‹åºè¿è¡Œç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨addæˆ–è€…copyå®¿ä¸»æœºç›®å½•çš„å½¢å¼æ·»åŠ åˆ°å®¹å™¨ï¼Œç›®å‰çš„æ€è·¯æ˜¯å°†å®¹å™¨ä¸­çš„logsæ•´ä¸ªç›®å½•copyåˆ°å®¿ä¸»æœºï¼Œå®é™…åº”ç”¨ä¸­å¯ç”¨å®šæ—¶ä»»åŠ¡æ‰§è¡Œè„šæœ¬çš„å½¢å¼è§£å†³ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">[root@dev logs]# docker psCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                    NAMES6f189daf5880        marvin/tomcat       "catalina.sh run"   4 hours ago         Up 4 hours          0.0.0.0:8080->8080/tcp   tomcat8[root@dev logs]# [root@dev logs]# pwd/opt/tomcat8/logs[root@dev logs]# lltotal 0[root@dev logs]#  docker cp 6f189daf5880:/usr/local/tomcat/logs /opt/tomcat8/[root@dev logs]# lltotal 16-rw-r----- 1 root root 7863 Jul 23 18:08 catalina.2018-07-23.log-rw-r----- 1 root root    0 Jul 23 18:07 host-manager.2018-07-23.log-rw-r----- 1 root root  930 Jul 23 18:08 localhost.2018-07-23.log-rw-r----- 1 root root 1424 Jul 23 22:49 localhost_access_log.2018-07-23.txt-rw-r----- 1 root root    0 Jul 23 18:07 manager.2018-07-23.log[root@dev logs]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-8-å¦ä¸€ä¸ªtomcat-jdkçš„ä¾‹å­"><a href="#2-8-å¦ä¸€ä¸ªtomcat-jdkçš„ä¾‹å­" class="headerlink" title="2.8 å¦ä¸€ä¸ªtomcat+jdkçš„ä¾‹å­"></a>2.8 å¦ä¸€ä¸ªtomcat+jdkçš„ä¾‹å­</h4><pre class="line-numbers language-shell"><code class="language-shell">#tomcat8 openjdk8FROM centos:7MAINTAINER fengzp <fengzp@gzyitop.com>ENV LANG en_US.UTF-8ENV TOMCAT_VERSION 8.5.13ENV CATALINA_HOME /opt/apache-tomcat-$TOMCAT_VERSIONENV PATH $CATALINA_HOME/bin:$PATHENV JDK_VERSION 1.8.0WORKDIR $CATALINA_HOMERUN ln -sf /usr/share/zoneinfo/Asia/Shanghai  /etc/localtimeRUN yum -y install java-$JDK_VERSION-openjdk-devel && rm -rf /var/cache/yum/*ENV JAVA_HOME /usr/lib/jvm/java-openjdkRUN yum -y install wgetRUN cd /opt/ && wget "http://apache.fayea.com/tomcat/tomcat-8/v$TOMCAT_VERSION/bin/apache-tomcat-$TOMCAT_VERSION.tar.gz"RUN cd /opt/ && tar -zxf apache-tomcat-$TOMCAT_VERSION.tar.gzRUN cd /opt/ && rm -rf apache-tomcat-$TOMCAT_VERSION.tar.gzRUN chmod +x $CATALINA_HOME/bin/*.shVOLUME $CATALINA_HOME/webapps VOLUME $CATALINA_HOME/logsVOLUME $CATALINA_HOME/confEXPOSE 8080CMD $CATALINA_HOME/bin/startup.sh && tail -F $CATALINA_HOME/logs/catalina.out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¸‰ã€ä¸é€‚ç”¨å®¹å™¨è‡ªå¸¦jdk"><a href="#ä¸‰ã€ä¸é€‚ç”¨å®¹å™¨è‡ªå¸¦jdk" class="headerlink" title="ä¸‰ã€ä¸é€‚ç”¨å®¹å™¨è‡ªå¸¦jdk"></a>ä¸‰ã€ä¸é€‚ç”¨å®¹å™¨è‡ªå¸¦jdk</h3><p>3.1 å…ˆå°†ä¸‹è½½å¥½çš„jdkå’Œtomcatä¸Šä¼ åˆ°å®¿ä¸»æœåŠ¡å™¨</p><pre class="line-numbers language-shell"><code class="language-shell">[root@dev tomcat8]# lsapache-tomcat-7.0.70.tar.gz  jdk-7u80-linux-x64.tar.gz <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>3.2 dockerfileæ–‡ä»¶å¦‚ä¸‹</p><pre class="line-numbers language-shell"><code class="language-shell">#pull down centos imageFROM centosMAINTAINER test@test.com#copy jdk and tomcat into imageADD ./apache-tomcat-7.0.70.tar.gz /rootADD ./jdk-7u80-linux-x64.tar.gz /root#set environment variableENV JAVA_HOME /root/jdk1.7.0_80ENV PATH $JAVA_HOME/bin:$PATH#define entry point which will be run first when the container starts upENTRYPOINT /root/apache-tomcat-7.0.70/bin/startup.sh && tail -F /root/apache-tomcat-7.0.70/logs/catalina.out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å››ã€å‚è€ƒæ–‡ç« ï¼š"><a href="#å››ã€å‚è€ƒæ–‡ç« ï¼š" class="headerlink" title="å››ã€å‚è€ƒæ–‡ç« ï¼š"></a>å››ã€å‚è€ƒæ–‡ç« ï¼š</h3><p><a href="https://blog.csdn.net/qq_32351227/article/details/78673591">https://blog.csdn.net/qq_32351227/article/details/78673591</a><br><a href="https://www.cnblogs.com/zydev/p/5804289.html">https://www.cnblogs.com/zydev/p/5804289.html</a></p>]]></content>
      
      
      <categories>
          
          <category> è¿ç»´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerå­¦ä¹ æ¡ˆä¾‹ï¼šç”¨dockeréƒ¨ç½²nginxæœåŠ¡</title>
      <link href="2018/07/22/docker-xue-xi-an-li-yong-docker-bu-shu-nginx-fu-wu/"/>
      <url>2018/07/22/docker-xue-xi-an-li-yong-docker-bu-shu-nginx-fu-wu/</url>
      
        <content type="html"><![CDATA[<p>dockerå®é™…æ¡ˆä¾‹ä¹‹åœ¨centOS7.4ä¸Šç”¨dockeréƒ¨ç½²nginxæœåŠ¡<br>[ç®€ä¹¦åœ°å€]](<a href="https://www.jianshu.com/p/1aa87bf713d5">https://www.jianshu.com/p/1aa87bf713d5</a>)</p><span id="more"></span><h3 id="ä¸€ã€ä½¿ç”¨docker-runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªnginxå®¹å™¨"><a href="#ä¸€ã€ä½¿ç”¨docker-runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªnginxå®¹å™¨" class="headerlink" title="ä¸€ã€ä½¿ç”¨docker runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªnginxå®¹å™¨"></a>ä¸€ã€ä½¿ç”¨docker runå‘½ä»¤ç›´æ¥å¯åŠ¨ä¸€ä¸ªnginxå®¹å™¨</h3><p>ç›´æ¥ä¸Šç»“æœ<br>è¿è¡Œè„šæœ¬ï¼š<br>1ã€ä¸‹è½½æœ€æ–°ç‰ˆnginxçš„dockeré•œåƒ</p><pre class="line-numbers language-shell"><code class="language-shell">$ docker pull nginx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ã€å¯åŠ¨å®¹å™¨</p><pre class="line-numbers language-shell"><code class="language-shell">docker run \--name centos_nginx \-d -p 80:80 \-v /usr/local/nginx/html:/usr/share/nginx/html \-v /usr/local/nginx/logs:/var/log/nginx \-v /usr/local/nginx/conf/nginx.conf:/etc/nginx/nginx.conf:ro \-v /usr/local/nginx/conf/conf.d:/etc/nginx/conf.d \nginx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™é‡Œæœ‰å‡ ä¸ªæ³¨æ„äº‹é¡¹ï¼š<br>ï¼ˆ1ï¼‰ç¬¬ä¸€ä¸ªâ€œ-vâ€ï¼Œæ˜¯é¡¹ç›®ä½ç½®ï¼ŒæŠŠé¡¹ç›®æ”¾åˆ°æŒ‚è½½åˆ°çš„ç›®å½•ä¸‹å³å¯ï¼›<br>ï¼ˆ2ï¼‰ç¬¬äºŒä¸ªâ€œ-vâ€ï¼Œæ˜¯æŒ‚è½½çš„ä¸»é…ç½®æ–‡ä»¶â€nginx.confâ€ï¼Œæ³¨æ„â€nginx.confâ€æ–‡ä»¶å†…æœ‰ä¸€è¡Œâ€include /etc/nginx/conf.d/*.conf;â€ï¼Œè¿™ä¸ªincludeæŒ‡å‘äº†å­é…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼Œæ­¤å¤„æ³¨æ„includeåæ‰€è·Ÿçš„è·¯å¾„ä¸€å®šä¸è¦å‡ºé”™ã€‚<br>ï¼ˆ3ï¼‰ç¬¬ä¸‰ä¸ªâ€œ-vâ€ï¼ŒæŠŠdockerå†…å­é…ç½®æ–‡ä»¶çš„è·¯å¾„ä¹ŸæŒ‚è½½äº†å‡ºæ¥ï¼Œæ³¨æ„è¦ä¸ï¼ˆ2ï¼‰ä¸­includeæŒ‡å‘è·¯å¾„ä¸€è‡´<br>ï¼ˆ4ï¼‰é‡ç‚¹å¼ºè°ƒä¸€ä¸‹ï¼Œnginx.confæ˜¯æŒ‚è½½äº†ä¸€ä¸ªæ–‡ä»¶ï¼ˆdockeræ˜¯ä¸æ¨èè¿™æ ·ç”¨çš„ï¼‰ï¼Œconf.dæŒ‚è½½çš„æ˜¯ä¸€ä¸ªç›®å½•</p></blockquote><p>å†çœ‹å®¿ä¸»æœºé…ç½®ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">[root@dev nginx]# lltotal 12drwxr-xr-x 3 root root 4096 Jul 19 11:15 confdrwxr-xr-x 3 root root 4096 Jul 19 10:34 htmldrwxr-xr-x 2 root root 4096 Jul 19 10:41 logs[root@dev nginx]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>/usr/local/nginx/conf/nginx.conf</p></blockquote><pre class="line-numbers language-conf"><code class="language-conf">user  root;worker_processes  1;error_log  /var/log/nginx/error.log warn;pid        /var/run/nginx.pid;  events {    worker_connections  1024;}http {    include       /etc/nginx/mime.types;    default_type  application/octet-stream;    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '                      '$status $body_bytes_sent "$http_referer" '                      '"$http_user_agent" "$http_x_forwarded_for"';    access_log  /var/log/nginx/access.log  main;    sendfile        on;    #tcp_nopush     on;    keepalive_timeout  65;    autoindex  on;    #gzip  on;      client_max_body_size         100M;    client_header_buffer_size     128k;     large_client_header_buffers  4  128k;      include /etc/nginx/conf.d/*.conf; }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>/usr/local/nginx/conf/conf.d/default.conf</p></blockquote><pre class="line-numbers language-conf"><code class="language-conf">server {      listen       80;      server_name  localhost;        #charset koi8-r;      #access_log  /var/log/nginx/log/host.access.log  main;        location / {          root   /usr/share/nginx/html/default;          index  index.html index.htm;          autoindex  on;          #try_files $uri /index/index/page.html;      }        #error_page  404              /404.html;        # redirect server error pages to the static page /50x.html      #      error_page   500 502 503 504  /50x.html;      location = /50x.html {          root   /usr/share/nginx/html;      }        # proxy the PHP scripts to Apache listening on 127.0.0.1:80      #      #location ~ \.php$ {      #    proxy_pass   http://127.0.0.1;      #}        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000      #      #location ~ \.php$ {      #    root           html;      #    fastcgi_pass   127.0.0.1:9000;      #    fastcgi_index  index.php;      #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;      #    include        fastcgi_params;      #}        # deny access to .htaccess files, if Apache's document root      # concurs with nginx's one      #      #location ~ /\.ht {      #    deny  all;      #}  }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>/usr/local/nginx/html/default/index.html</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Welcome to nginx! This is a demo!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">    <span class="token selector">body </span><span class="token punctuation">{</span>        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">35</span>em<span class="token punctuation">;</span>        <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> auto<span class="token punctuation">;</span>        <span class="token property">font-family</span><span class="token punctuation">:</span> Tahoma, Verdana, Arial, sans-serif<span class="token punctuation">;</span>    <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>****************************<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>Welcome to nginx! <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>****************************<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>If you see this page, the nginx web server is successfully installed andworking. Further configuration is required.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>For online documentation and support please refer to<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://nginx.org/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>nginx.org<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>Commercial support is available at<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://nginx.com/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>nginx.com<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>em</span><span class="token punctuation">></span></span>Thank you for using nginx.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>em</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>/usr/local/nginx/logs/access.log</p></blockquote><pre class="line-numbers language-shell"><code class="language-shell">194.105.136.181 - - [19/Jul/2018:04:29:59 +0000] "GET / HTTP/1.1" 200 742 "-" "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36" "-"94.102.52.77 - - [19/Jul/2018:04:41:30 +0000] "GET / HTTP/1.1" 200 742 "-" "libwww-perl/6.34" "-"187.74.100.192 - - [19/Jul/2018:04:59:21 +0000] "GET / HTTP/1.1" 200 742 "-" "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36" "-"106.11.225.139 - - [19/Jul/2018:05:17:41 +0000] "GET / HTTP/1.1" 200 742 "-" "Mozilla/5.0 (iPad; CPU OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1" "-"103.3.76.194 - - [19/Jul/2018:05:33:48 +0000] "GET / HTTP/1.1" 200 742 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36" "-"106.11.226.243 - - [19/Jul/2018:05:42:05 +0000] "GET / HTTP/1.1" 200 742 "-" "Mozilla/5.0 (iPad; CPU OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1" "-"177.137.62.62 - - [19/Jul/2018:06:18:32 +0000] "GET / HTTP/1.1" 200 742 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36" "-"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯åŠ¨æ•ˆæœï¼š<br><img src="/loading.gif" data-original="/images/linux/docker/docker-nginx.png" alt="default nginx"></p><hr><h3 id="äºŒã€-ä½¿ç”¨docker-fileå¯åŠ¨nginxå®¹å™¨"><a href="#äºŒã€-ä½¿ç”¨docker-fileå¯åŠ¨nginxå®¹å™¨" class="headerlink" title="äºŒã€ ä½¿ç”¨docker fileå¯åŠ¨nginxå®¹å™¨"></a>äºŒã€ ä½¿ç”¨docker fileå¯åŠ¨nginxå®¹å™¨</h3><p>doekerå¸¸ç”¨å‘½ä»¤ï¼š<br><img src="/loading.gif" data-original="/images/linux/docker/docker-nginx1.png" alt="docker file"></p><h6 id="1ã€ç¼–å†™docker-file"><a href="#1ã€ç¼–å†™docker-file" class="headerlink" title="1ã€ç¼–å†™docker file"></a>1ã€ç¼–å†™docker file</h6><p>åœ¨ä»»æ„ç›®å½•åˆ›å»ºä¸€ä¸ªnginx.Dockerfile æ–‡ä»¶ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell"># Base images åŸºç¡€é•œåƒFROM nginx MAINTAINER marvinENV RUN_USER nginx ENV RUN_GROUP nginx ENV DATA_DIR /usr/share/nginx/htmlENV LOG_DIR /var/log/nginxRUN mkdir /var/log/nginx -p RUN chown nginx.nginx -R /var/log/nginxADD html  /usr/share/nginx/htmlADD logs  /var/log/nginxADD conf/nginx.conf /etc/nginx/nginx.confADD conf/conf.d /etc/nginx/conf.dEXPOSE 80ENTRYPOINT nginx -g "daemon off;"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åšäº†è¿™ä¹ˆå‡ ä»¶äº‹ï¼š</p><p>1ã€æ‹‰å–ä¸€ä¸ªnginxé•œåƒã€‚<br>2ã€è®¾ç½®äº†å‡ ä¸ªå˜é‡ã€‚<br>3ã€åˆ›å»ºäº†å‡ ä¸ªéœ€è¦çš„ç›®å½•ã€‚<br>4ã€æŠŠå½“å‰ç›®å½•ä¸‹çš„webç¨‹åºå¤åˆ¶åˆ°é•œåƒçš„/data/webç›®å½•ã€‚<br>5ã€æŠŠnginx.confé…ç½®æ–‡ä»¶å’Œdefault.confé…ç½®æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒä¸­ã€‚<br>6ã€è®¾ç½®ä¸€ä¸ªé»˜è®¤ç«¯å£ã€‚<br>7ã€æœ€åè®¾ç½®äº†å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤ï¼Œæˆ‘ç”¨æ¥å¯åŠ¨nginxç¨‹åºï¼Œæ³¨æ„è¿™ä¸ªå‘½ä»¤ä¸èƒ½é”™ï¼Œä¸ç„¶å®¹å™¨å¯åŠ¨ä¸äº†ã€‚è¿™æ ·è®¾ç½®åï¼Œå½“ä½ docker runè¿è¡Œæ­¤é•œåƒæ—¶ä¸éœ€è¦åœ¨åé¢å†æ¬¡æ‰§è¡Œéœ€è¦æ‰§è¡Œçš„å‘½ä»¤äº†ã€‚<br>8ã€ADDåé¢srcçš„è·¯å¾„ä¸è¦æ˜¯ç»å¯¹è·¯å¾„ï¼Œæœ€å¥½æ˜¯dockerfileå’Œè¿™äº›æ·»åŠ çš„ç›®å½•æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸‹ï¼Œå¦åˆ™buildæ—¶ä¼šæç¤º<code>lstat usr/local/nginx/html: no such file or directory</code>çš„é”™è¯¯ï¼Œåˆ«é—®ä¸ºä»€ä¹ˆï¼Œç»éªŒä¹‹è°ˆï¼</p><h6 id="2ã€ç”¨dockerfile-æ„å»ºå‡ºé•œnginxé•œåƒ"><a href="#2ã€ç”¨dockerfile-æ„å»ºå‡ºé•œnginxé•œåƒ" class="headerlink" title="2ã€ç”¨dockerfile æ„å»ºå‡ºé•œnginxé•œåƒ"></a>2ã€ç”¨dockerfile æ„å»ºå‡ºé•œnginxé•œåƒ</h6><pre class="line-numbers language-shell"><code class="language-shell">[root@dev nginx]# lsconf  dockerfile  html  logs[root@dev nginx]# docker build -t nginx_image1 . Sending build context to Docker daemon 27.65 kBStep 1/14 : FROM nginx ---> 8b89e48b5f15Step 2/14 : MAINTAINER marvin ---> Using cache ---> fc935dc63140Step 3/14 : ENV RUN_USER nginx ---> Using cache ---> 7ca3b90ddc2aStep 4/14 : ENV RUN_GROUP nginx ---> Using cache ---> a2e2674d4c9fStep 5/14 : ENV DATA_DIR /usr/share/nginx/html ---> Using cache ---> f031dd5f8ce0Step 6/14 : ENV LOG_DIR /var/log/nginx ---> Using cache ---> e57a42b5bea0Step 7/14 : RUN mkdir /var/log/nginx -p ---> Using cache ---> 0cbaaac3d55bStep 8/14 : RUN chown nginx.nginx -R /var/log/nginx ---> Using cache ---> 714919c0618bStep 9/14 : ADD html /usr/share/nginx/html ---> 1c75fe9cdd3fRemoving intermediate container 702f4e3ace2eStep 10/14 : ADD logs /var/log/nginx ---> 545ba7cc270bRemoving intermediate container 123bb6c3703cStep 11/14 : ADD conf/nginx.conf /etc/nginx/nginx.conf ---> d96a6dfa8ba9Removing intermediate container db2394df7691Step 12/14 : ADD conf/conf.d /etc/nginx/conf.d ---> d02f5acc99deRemoving intermediate container fdc7c2542990Step 13/14 : EXPOSE 80 ---> Running in 679ecad9d883 ---> 9ee05d0ab66fRemoving intermediate container 679ecad9d883Step 14/14 : ENTRYPOINT nginx -g "daemon off;" ---> Running in 774ac2a000ac ---> c4d5f5accc06Removing intermediate container 774ac2a000acSuccessfully built c4d5f5accc06[root@dev nginx]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„æœ€åé¢çš„ç‚¹ (â€œ.â€)ï¼Œè¡¨ç¤ºdockerfileæ‰€åœ¨å½“å‰ç›®å½•ã€‚</p><p>ä»æ‰§è¡Œè¿‡ç¨‹å¯ä»¥çœ‹å‡ºä¸€å…±åä¸‰ä¸ªæ­¥éª¤ï¼Œéƒ½å®Œæˆäº†ã€‚å†æŸ¥çœ‹ç›®å‰çš„é•œåƒï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">[root@dev nginx]# docker imagesREPOSITORY          TAG                 IMAGE ID            CREATED             SIZEnginx_image1        latest              c4d5f5accc06        47 seconds ago      109 MBdocker.io/nginx     latest              8b89e48b5f15        6 days ago          109 MB[root@dev nginx]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ä»å®˜æ–¹æ‹‰å–äº†ä¸€ä¸ªnginxé•œåƒï¼Œç„¶ååœ¨æ­¤é•œåƒçš„åŸºç¡€ä¸Šæ„å»ºäº†nginx_image1é•œåƒã€‚æ³¨æ„ï¼Œç”±äºnginx_image1æ˜¯åœ¨nginxé•œåƒçš„åŸºç¡€ä¸Šæ„å»ºå‡ºæ¥çš„ï¼Œæ‰€ä»¥å¦‚æœä½ è¦åˆ é™¤nginxé•œåƒæ˜¯ä¸å…è®¸çš„ï¼Œåªæœ‰å…ˆåˆ é™¤nginx_image1é•œåƒåæ‰å¯ä»¥åˆ é™¤nginxé•œåƒã€‚</p><h6 id="3ã€-è¿è¡Œæ–°æ„å»ºçš„é•œåƒ"><a href="#3ã€-è¿è¡Œæ–°æ„å»ºçš„é•œåƒ" class="headerlink" title="3ã€ è¿è¡Œæ–°æ„å»ºçš„é•œåƒ"></a>3ã€ è¿è¡Œæ–°æ„å»ºçš„é•œåƒ</h6><pre class="line-numbers language-shell"><code class="language-shell">[root@dev nginx]# docker imagesREPOSITORY          TAG                 IMAGE ID            CREATED             SIZEnginx_image1        latest              c4d5f5accc06        47 seconds ago      109 MBdocker.io/nginx     latest              8b89e48b5f15        6 days ago          109 MB[root@dev nginx]# docker run --name nginx -d -p 80:80 nginx_image100a88a12a6f4037c406a64f12e8c664cd1f1cbe1eb8c1c29371aa091a01ca161[root@dev nginx]# docker psCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES00a88a12a6f4        nginx_image1        "/bin/sh -c 'nginx..."   15 seconds ago      Up 14 seconds       0.0.0.0:80->80/tcp   nginx[root@dev nginx]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä»–é…ç½®ä¸ä¸Šé¢æƒ…å†µä¸€ä¸‹çš„é…ç½®ï¼Œæµè§ˆå™¨æŸ¥çœ‹æ•ˆæœ<br><img src="/loading.gif" data-original="/images/linux/docker/docker-nginx2.png" alt="nginxï¼š80"></p><h3 id="ä¸‰ã€-å¤‡æ³¨"><a href="#ä¸‰ã€-å¤‡æ³¨" class="headerlink" title="ä¸‰ã€ å¤‡æ³¨"></a>ä¸‰ã€ å¤‡æ³¨</h3><p>3.1 docker run æ‰§è¡Œå®Œæ²¡æœ‰å‡ºé”™ï¼Œä½†æ˜¯docker psæ—¶æ²¡æœ‰è¿è¡Œçš„å®¹å™¨ã€‚<br>æ–¹æ¡ˆï¼šç”¨docker ps -a èƒ½çœ‹åˆ°æ²¡æœ‰å¯åŠ¨å®¹å™¨ã€‚<br>ç”¨docker logs <contain name=""> æŸ¥çœ‹å®¹å™¨å¯åŠ¨æ—¶çš„log</contain></p><p>3.2 åˆ é™¤docker é•œåƒä¸­REPOSITORY å’Œ TAG ä¸º Noneçš„é•œåƒ</p><blockquote><p>docker images|grep none|awk â€˜{print $3}â€™|xargs docker rmi </p></blockquote><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç»™æŸä¸ªé•œåƒæŒ‡å®šREPOSITORY å’ŒTAG:<br>docker tag [image id] [name]:[ç‰ˆæœ¬]</p><p>ä¾‹å¦‚:</p><blockquote><p>docker tag b03b74b01d97 docker-redis:0.0.1</p></blockquote><h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h3><p><a href="https://my.oschina.net/u/3375733/blog/1591091">https://my.oschina.net/u/3375733/blog/1591091</a><br><a href="http://www.ywnds.com/?p=7611">http://www.ywnds.com/?p=7611</a></p>]]></content>
      
      
      <categories>
          
          <category> è¿ç»´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è½¬--ä»Eclipseè½¬ç§»åˆ°IntelliJ IDEAä¸€ç‚¹å¿ƒå¾—</title>
      <link href="2018/07/11/zhuan-cong-eclipse-zhuan-yi-dao-intellij-idea-yi-dian-xin-de/"/>
      <url>2018/07/11/zhuan-cong-eclipse-zhuan-yi-dao-intellij-idea-yi-dian-xin-de/</url>
      
        <content type="html"><![CDATA[<p>ä»eclipseåˆ°Intellijçš„å„ç§ä¸é€‚åº”åœ¨æ­¤è§£å†³<br><a href="https://www.jianshu.com/p/87da42c638ad">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ä½¿ç”¨IntelliJ IDEAå…¶å®å¹¶ä¸å¤ªä¹…ï¼Œç”¨äº†è¿™æ®µæ—¶é—´ä»¥åï¼Œè§‰å¾—çš„ç¡®å¾ˆæ˜¯å¥½ç”¨ã€‚åˆšåˆšä»Eclipseè½¬è¿‡æ¥çš„å¾ˆå¤šäººå¼€å§‹å¯èƒ½ä¸é€‚åº”ï¼Œæˆ‘å°±æŠŠä½¿ç”¨è¿‡ç¨‹ä¸­çš„ä¸€äº›ç»éªŒå’Œå¸¸ç”¨åŠŸèƒ½åˆ†äº«ä¸‹ï¼Œå½“ç„¶åœ¨çœ‹è¿™ç¯‡ä¹‹å‰æ¨èä½ å…ˆçœ‹å®Œ<a href="http://www.oschina.net/question/12_70799">IntelliJ IDEA çš„ 20 ä¸ªä»£ç è‡ªåŠ¨å®Œæˆçš„ç‰¹æ€§</a>ï¼Œè¿™ç¯‡æ–‡ç« å¯¹è‡ªåŠ¨å®Œæˆçš„ç‰¹æ€§ä»‹ç»çš„éå¸¸å¥½ï¼Œåªæ˜¯å¿«æ·é”®è¯´æ˜éƒ¨åˆ†è¿˜å¯ä»¥æ›´å®Œå–„ä¸€äº›ï¼Œå¯ä»¥ç…§é¡¾ä¸‹é»˜è®¤ç»‘å®šé”®ä½ä¸ä¸€è‡´çš„ç«¥é‹ã€‚æœ¬æ–‡åœ¨è¯´æ˜å¿«æ·é”®çš„æ—¶å€™æ˜¯æ ¹æ®Mac OSX 10.5+çš„é»˜è®¤keymapï¼Œå½“ç„¶ä¹Ÿä¼šæä¾›ç›¸å…³çš„æ–‡å­—è¯´æ˜ï¼Œå¦‚æœå’Œæˆ‘çš„ç»‘å®šä¸ä¸€è‡´çš„å¯ä»¥ç›´æ¥å»keymapä¸­æœç´¢å³å¯ã€‚</p><h2 id="åŸºæœ¬è®¾ç½®"><a href="#åŸºæœ¬è®¾ç½®" class="headerlink" title="åŸºæœ¬è®¾ç½®"></a>åŸºæœ¬è®¾ç½®</h2><h3 id="æ˜¾ç¤ºè¡Œå·"><a href="#æ˜¾ç¤ºè¡Œå·" class="headerlink" title="æ˜¾ç¤ºè¡Œå·"></a>æ˜¾ç¤ºè¡Œå·</h3><p>è¿™ä¸ªä»¥å‰åœ¨Eclipseä¸­æ˜¯ä¸ªå¾ˆç®€å•çš„é—®é¢˜ï¼Œè½¬ç§»åˆ°IntelliJä¸Šä»¥åçš„ä¸€äº›äººä¹Ÿé—®è¿‡è¿™ä¸ªé—®é¢˜ã€‚ä½¿ç”¨åŒæ ·çš„æ–¹å¼è®¾ç½®äº†ä»¥åå‘ç°åªæ˜¯å¯¹å½“å‰æ–‡ä»¶èµ·ä½œç”¨äº†ï¼Œæ‰“å¼€å¦å¤–ä¸€ä¸ªæ–‡ä»¶ä¾ç„¶æ²¡æœ‰è¡Œå·ã€‚å°±å¥½æ¯”ä½ åªæ˜¯åœ¨vimä¸­æ‰§è¡Œå‘½ä»¤<code>set number</code>ï¼Œè€Œä¸æ˜¯åœ¨.vimrcä¸­è®¾ç½®ä¸€æ ·çš„æ•ˆæœã€‚è¿™ä¸ªæ˜¯éœ€è¦åœ¨IDE Settingsä¸­è®¾ç½®ä¸‹çš„ï¼Œå¦‚å›¾æ‰€ç¤ºå‹¾é€‰å³å¯:<br><img src="/loading.gif" data-original="/images/tools/idea-setting-line-num.png" alt="æ˜¾ç¤ºè¡Œå·"></p><p>å…¶ä»–è®¾ç½®å¯å‚ç…§è¯¥è®¾ç½®é¡¹å‹¾é€‰å³å¯ï¼Œä¾‹å¦‚æ˜¾ç¤ºç©ºæ ¼ç­‰ç­‰.</p><h3 id="æ–‡ä»¶å’Œå¯¼èˆªå…³è”"><a href="#æ–‡ä»¶å’Œå¯¼èˆªå…³è”" class="headerlink" title="æ–‡ä»¶å’Œå¯¼èˆªå…³è”"></a>æ–‡ä»¶å’Œå¯¼èˆªå…³è”</h3><p>æˆ‘ä»¬åœ¨å†™ä»£ç çš„æ—¶å€™ç»å¸¸éœ€è¦æ‰“å¼€æŸä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œæƒ³åœ¨å·¦è¾¹çš„æ–‡ä»¶æ ‘ä¸Šè‡ªåŠ¨æ‰“å¼€å…³è”åˆ°ä½ç½®ï¼Œè¿™æ ·å¾ˆæ–¹ä¾¿çš„æ‰¾å¯»æœ¬ç›®å½•ä¸‹çš„å…¶ä»–æ–‡ä»¶æˆ–è€…å…¶ä»–çš„ç›¸å…³æ–‡ä»¶ï¼Œå…¶å®è¿™ä¸ªIntelliJæä¾›äº†å¥½å‡ ç§è§£å†³æ–¹æ¡ˆï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯å’ŒEclipseä¸€æ ·çš„æ–¹å¼ï¼Œå¦‚ä¸‹:</p><ul><li>ä»¥å‰åœ¨Eclipseä¸­è®¾ç½®ä¹Ÿå¾ˆç®€å•ï¼Œä½†æ˜¯IntelliJé‡Œé¢ç¨å¾®æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œå¦‚æœæƒ³ä¸´æ—¶ä¸€æ¬¡çš„è¯ï¼Œæ‰“å¼€æ–‡ä»¶çš„æ—¶å€™ç‚¹å‡»ä¸‹å›¾çš„å°åœ°çƒï¼ˆç¬¬ä¸€çœ¼çœ‹çš„æ—¶å€™å¾ˆåƒä¸ªå°åœ°çƒä»ªï¼‰å›¾æ ‡å³å¯<br><img src="/loading.gif" data-original="/images/tools/idea-setting-tofile.png" alt="å¿«é€Ÿå®šä½æ–‡ä»¶ä½ç½®"></li></ul><p>å¦‚æœä½ æƒ³å’ŒEclipseçš„é‚£ä¸ªä¸€æ ·ï¼Œè®©è¿™ä¸€åˆ‡è‡ªåŠ¨çš„è¯ï¼Œé‚£ä¹ˆåœ¨ä¸Šå›¾çš„æµ®å±‚ä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªé€‰é¡¹<code>AutoScroll to Source</code>å’Œ<code>AutoScroll from source</code>ï¼ŒIntelliJå¾ˆäººæ€§åŒ–çš„åˆ†äº†ä¸¤ä¸ªè®¾ç½®åœ¨é‡Œé¢ï¼Œä½ ä¸¤ä¸ªéƒ½å‹¾é€‰å°±æ˜¯åŸºæœ¬å’ŒEclipseçš„åŠŸèƒ½ä¿æŒäº†å®Œå…¨ä¸€è‡´ï¼Œåªæ˜¯å‹¾é€‰ä¸€ä¸ªè‡ªç„¶ä¹Ÿå¯ä»¥.</p><p>è¿˜æœ‰ä¸€ç§æ–¹å¼å°±æ˜¯åˆ©ç”¨IntelliJæä¾›çš„<strong>Navigation Bar</strong>ï¼ŒIntelliJå¾ˆå¤šåŠŸèƒ½æ“ä½œéƒ½å¯ä»¥é”®ç›˜åŒ–ï¼Œè¿™ä¸ªå°±æ˜¯å–œæ¬¢é”®ç›˜åŒ–æ“ä½œçš„äººçš„å¿…å¤‡åŠŸèƒ½ï¼Œæ“ä½œæ–¹å¼å°±æ˜¯æ‰“å¼€æ–‡ä»¶çš„æ—¶å€™ï¼Œä½¿ç”¨å¿«æ·é”®<code>âŒ˜+UP (Jump to Navigation Bar)</code>ï¼Œç„¶åå°±ä¼šå‡ºç°ä¸€ä¸ªä¸‹æ‹‰ï¼ŒåŸºæœ¬å°±æ˜¯è¿™ä¸ªæ–‡ä»¶æ‰€åœ¨ç›®å½•çš„æ–‡ä»¶åˆ—è¡¨ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<strong>ä¸Šä¸‹å·¦å³çš„é”®ä½</strong>æ¥é€‰æ‹©å…¶ä»–ç›®å½•ï¼Œæ˜¯ä¸æ˜¯å¾ˆé…·ï¼Ÿ</p><p>**å¤‡æ³¨:**æ­¤å¤„å»ºè®®æŠŠ<code>View &gt; Navigation Bar</code>çš„é€‰é¡¹ç‚¹æ‰ï¼Œè¿™æ ·å°±ä½¿ç”¨å¿«æ·é”®ä¹‹åå°±ä¼šåœ¨ä½ é¼ æ ‡çš„ä½ç½®å‡ºç°ï¼Œæ„Ÿè§‰ä¼šæ›´è¾“å…¥ä¸€äº›ï¼Œå½“ç„¶è¿™æ ·ä½ å°±åŸºæœ¬å¤±å»äº†ä½¿ç”¨é¼ æ ‡çš„æƒåˆ©ï¼Œè¿™ä¸ªéœ€è¦ä½ æ ¹æ®ä¸ªäººç™–å¥½ä½¿ç”¨å³å¯ã€‚</p><h2 id="å¿«æ·é”®ä½¿ç”¨"><a href="#å¿«æ·é”®ä½¿ç”¨" class="headerlink" title="å¿«æ·é”®ä½¿ç”¨"></a>å¿«æ·é”®ä½¿ç”¨</h2><p>å¦‚æœä½ æ˜¯è‹¹æœç”µè„‘ç”¨æˆ·çš„è¯ï¼Œå»ºè®®ä½ æ”¹æˆMac OSX 10.5+çš„é”®ä½ç»‘å®šï¼Œå› ä¸ºMac OSX 10.5è¿™ä¸ªå…¼å®¹Windowsçš„ç‰ˆæœ¬çš„é”®ä½å®åœ¨æ˜¯å¤ªè¹©è„šäº†ï¼Œç”¨ç€æ˜¯çœŸéš¾å—ï¼Œå¥½æ¯”ä½ é»˜è®¤ä¹ æƒ¯<code>âŒ˜+w</code>æ˜¯å…³é—­æ ‡ç­¾ï¼Œåœ¨è¿™ä¸ªé”®ä½ç»‘å®šä¸­ç«Ÿç„¶æ˜¯æ ¹æ®ç¬¦å·é€‰æ‹©æ–‡æœ¬çš„ä¸€ä¸ªå¿«æ·é”®.</p><p>è¿™é‡Œä¸»è¦ä»‹ç»å‡ ä¸ªå¯èƒ½å¤§å®¶å¸¸ç”¨çš„ï¼Œæˆ–è€…æ˜¯ä½ å¯èƒ½å¹¶ä¸çŸ¥é“IntelliJä¸­æœ‰çš„å‡ ä¸ªå¿«æ·é”®ï¼Œç‰¹åˆ«å¸¸ç”¨çš„ä½ ç›´æ¥å‚ç…§å®˜ç½‘çš„Keymapä»‹ç»<a href="http://www.jetbrains.com/idea/documentation/index.jsp">Getting Started</a>å°±å¯ä»¥äº†ã€‚å­¦ä¼šåœ¨Keymapä¸­è‡ªå·±æŸ¥è¯¢éœ€è¦çš„å¿«æ·é”®æ˜¯ä¸»è¦çš„ï¼Œä¸è¦æ¯æ¬¡éƒ½æ‰“å¼€é‚£ä¸ªæ²¡ç”¨çš„ç™¾åº¦ï¼Œå…·ä½“å¯ä»¥å‚ç…§æœ¬æ–‡æœ€åç»™å‡ºçš„é“¾æ¥ã€‚</p><h3 id="Outlineè°ƒå‡º"><a href="#Outlineè°ƒå‡º" class="headerlink" title="Outlineè°ƒå‡º"></a>Outlineè°ƒå‡º</h3><p>ä»¥å‰åœ¨Eclipseä¸­ç”¨çš„å¾ˆå¤šçš„ä¸€ä¸ªå¿«æ·é”®å°±æ˜¯<code>ctrl+o</code>ï¼Œè¿™æ ·å¯ä»¥è°ƒå‡ºä»£ç æ–‡ä»¶çš„æ‰€æœ‰æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒæœç´¢å¾ˆæ˜¯æ–¹ä¾¿ï¼ŒIntelliJè¿™ç§åŸºæœ¬çš„åŠŸèƒ½è‡ªç„¶æ˜¯æœ‰ï¼Œæ–°æ‰‹çš„è¯è¿˜ç»å¸¸é—®ï¼Œè¿™ä¸ªåœ¨IntellJä¸­çš„å¿«æ·é”®æ˜¯<code>âŒ˜+F12 (File Structure)</code>ã€‚å¦‚æœä½ ä¸æ˜¯Mac OSX 10.5+é”®ä½ç»‘å®šçš„è¯ï¼Œå°æ‹¬å·ä¸­çš„å†…å®¹å°±æ˜¯ä½ å¯ä»¥å»Keymapä¸­å»æœç´¢çš„å†…å®¹ã€‚</p><p>###åŸºæœ¬æ“ä½œ</p><ul><li>**å¤åˆ¶æ•´è¡Œæˆ–è€…å—:**åœ¨Eclipseä¸­ä½¿ç”¨<code>ctrl+alt+Up</code>ï¼ŒIntelliJé»˜è®¤æ˜¯<code>âŒ˜+D (Duplicate Line or Block)</code>ï¼Œå…¶å®è¿™ä¸ªå’ŒEclipseä¸­çš„æœ‰å·®è·ï¼Œå°¤å…¶æ˜¯å¤šè¡Œçš„æ—¶å€™æˆ–è€…é€‰ä¸­å†…å®¹çš„æ—¶å€™ï¼Œä¸ä¿¡ä½ å¯ä»¥è¯•è¯•ã€‚æ‰€ä»¥ä½ å¯ä»¥æŠŠKeymapä¸­çš„<code>Duplicate Lines</code>å®šä¹‰ä¸Šä¸€ä¸ªå¿«æ·é”®ï¼Œæˆ‘å®šä¹‰çš„æ˜¯<code>Option+D</code>ï¼Œè¿™ä¸ªé”®ä½åœ¨æˆ‘çš„é»˜è®¤ç»‘å®šä¸­æ˜¯æ²¡ä»»ä½•å¿«æ·é”®çš„ï¼Œä½ å¯ä»¥è‡ªå·±ç»‘å®šä¸€ä¸ªè¯•è¯•ã€‚</li><li>**æ ¹æ®ç¬¦å·é€‰æ‹©æ–‡æœ¬:**è¿™ä¸ªé”®ä½ç”¨çš„å¤ªå¤šäº†ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯éå¸¸çš„å¥½ç”¨ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæœ‰è¿™æ ·ä¸€è¡Œä»£ç <code>&lt;name&gt;SpringSource Milestones Proxy&lt;/name&gt;</code> ä½ å…‰æ ‡åœ¨Milestonesä¸­çš„æŸä¸€ä¸ªä½ç½®ï¼Œä½ æƒ³æ›¿æ¢<code>SpringSource Milestones Proxy</code>ä¸ºå…¶ä»–å•è¯ï¼Œå‡è®¾æƒ³æ›¿æ¢ä¸º<code>Test XX</code>ï¼Œå…¶å®è¿™æ ·ä½ åªéœ€è¦<code>Option+Up (Select Word at Caret)</code>ä¸¤ä¸‹å°±å¯ä»¥é€‰ä¸­ä½ æƒ³è¦çš„å•è¯äº†ï¼Œå½“ä½ æƒ³åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªé”®ä½ç”¨çš„å¤ªå¤šäº†ï¼Œå¤šåˆ°æ¢äº†å…¶ä»–æ²¡æœ‰è¿™ä¸ªé”®ä½çš„ç¼–è¾‘å™¨æˆ–è€…IDEä¸Šï¼Œå¾ˆæ˜¯ä¸ä¹ æƒ¯ã€‚</li><li><strong>åˆ é™¤æ•´è¡Œ:</strong> å¯ä»¥ç›´æ¥<code>âŒ˜+delete (Delete Line)</code>æˆ–è€…åˆ©ç”¨IntelliJæ™ºèƒ½çš„åŠŸèƒ½ï¼Œå‰ªåˆ‡çš„å¿«æ·é”®ï¼Œå½“æœ¬è¡Œé€‰ä¸­æ–‡æœ¬çš„æ—¶å€™å‰ªåˆ‡``âŒ˜+x<code>ä¼šæŒ‰ç…§é€‰ä¸­çš„æ–‡æœ¬å®ç°å‰ªåˆ‡ï¼Œä½†æ˜¯ä½ æœ¬è¡Œå†…æ— ä»»ä½•é€‰ä¸­æ–‡æœ¬çš„æ—¶å€™ä¼šè‡ªåŠ¨å‰ªåˆ‡æ•´è¡Œï¼Œé‚£ä¹ˆè‡ªç„¶å°±ç±»ä¼¼ä¸€ä¸ªåˆ é™¤æœ¬è¡Œçš„å¿«æ·é”®ï¼Œä½†æ˜¯è¿™ä¸ªå…¶å®è¿˜æ˜¯æ¯”è¾ƒè¹©è„šçš„ï¼Œå»ºè®®ä½¿ç”¨</code>âŒ˜+delete`ã€‚</li><li><strong>æƒ³ç›´æ¥è·³è½¬åˆ°æ¥å£çš„å®ç°æ–¹æ³•:</strong> <code>âŒ˜+option+é¼ æ ‡å•å‡»</code>æˆ–è€…<code>âŒ˜+option+B</code>ã€‚</li><li>**è¯­å¥è‡ªåŠ¨å®Œæˆ Statements completion:**è¿™ä¸ªåœ¨<a href="http://www.oschina.net/question/12_70799">IntelliJ IDEA çš„ 20 ä¸ªä»£ç è‡ªåŠ¨å®Œæˆçš„ç‰¹æ€§</a>ä¸­å·²ç»è¯´æ˜ï¼Œè¿™é‡Œè¿˜æ˜¯ç€é‡è¯´ä¸‹ï¼Œå› ä¸ºçš„ç¡®å¾ˆå¥½ç”¨ï¼Œä¹Ÿå¼ºçƒˆæ¨èä¸‹ï¼Œè¿˜æœ‰æ–‡ä¸­è¯´çš„<code>æ™ºèƒ½è‡ªåŠ¨å®Œæˆ ctrl+shift+Space</code>ï¼Œå½“ç»™ä½ çš„æç¤ºå¤ªå¤šçš„æ—¶å€™ï¼Œè¿™ä¸ªé”®ç»å¯¹ä¼šç»™ä½ æƒŠå–œ.</li><li>**åŒæ ·å•è¯ä¹‹é—´è·³è½¬:**åœ¨Eclipseä¸­çš„å¿«æ·é”®æ˜¯<code>ctrl+k</code>ï¼Œè¿™ä¸ªæŒºå¥½ç”¨çš„ï¼Œåœ¨IntelliJä¸­ä¹Ÿä¸ç¼ºè¿™ä¸ªåŠŸèƒ½ï¼Œä½†æ˜¯åœ¨Mac OSX 10.5+çš„é”®ä½ç»‘å®šä¸­é»˜è®¤ä¸ºç©ºã€‚æ®è¯´Windowsçš„é»˜è®¤ç»‘å®šä¸­æ˜¯æœ‰ç»‘å®šçš„ï¼Œè‡ªå·±å¯ä»¥æŸ¥è¯¢ä¸‹ï¼Œæˆ‘è‡ªå·±ç»‘å®šäº†ä¸€ä¸ª<code>âŒ˜+ctrl+k (Find Word at Caret)</code>ï¼Œæ²¡æœ‰çš„éœ€è¦è‡ªå·±ç»‘å®šä¸€ä¸ªï¼Œç„¶åè¿˜èƒ½ç»“åˆå…¶ä»–çš„é”®ä½å®ç°ä¸Šä¸€ä¸ª<code>âŒ˜+G (Find Next)</code>ä¸‹ä¸€ä¸ª<code>âŒ˜+Shift+G (Find Previous)</code>çš„åŠŸèƒ½.å¾ˆæ˜¯å®ç”¨ã€‚</li></ul><p>##ç‰ˆæœ¬æ§åˆ¶è®¾ç½®<br>æˆ‘ä»¬å¼€å‘è‚¯å®šæ˜¯æœ‰ç‰ˆæœ¬æ§åˆ¶çš„ï¼Œå¤§å®¶ä»¥å‰Eclipseçš„æ—¶å€™åœ¨æœ¬åœ°æ–‡ä»¶å’Œç‰ˆæœ¬åº“ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œé‚£ä¹ˆæ–‡ä»¶ä»¥åŠæ‰€åœ¨çš„æ–‡ä»¶å¤¹éƒ½ä¼šå‡ºç°ä¸€ä¸ª<code>ã€‰</code>è¡¨ç¤ºï¼Œå¤§å®¶èƒ½å¾ˆè½»æ¾çš„çœ‹åˆ°æœ¬åœ°æ–‡ä»¶ä¿®æ”¹äº†å“ªä¸€äº›ï¼Œä½†æ˜¯IntelliJä¸­é»˜è®¤æ˜¯ä¸èƒ½è¿™æ ·çš„ã€‚ä»…ä»…æ˜¯ç»™å˜åŒ–çš„æ–‡ä»¶åœ¨ä¿®æ”¹çš„æ—¶å€™æä¾›äº†é¢œè‰²ä¸Šçš„å˜åŒ–ï¼Œä¸åŒ…æ‹¬å…¶æ‰€åœ¨çš„å„ä¸ªçˆ¶çº§æ–‡ä»¶å¤¹å“¦ï¼Œå¦‚æœæƒ³å’ŒEclipseä¸€æ ·çš„è¯éœ€è¦å¦‚ä¸‹å›¾æŠŠè®¾ç½®å‹¾é€‰å°±å¯ä»¥äº†<br><img src="/loading.gif" data-original="/images/tools/idea-setting-version.png" alt="ç‰ˆæœ¬æ§åˆ¶"></p><p>å…¶å®çœ‹è‹±æ–‡è§£é‡Šå°±å¯ä»¥æ˜ç™½äº†ï¼Œè¿™ä¸ªé»˜è®¤å¼€å¯ä»¥åå¦‚æœæƒ³è°ƒæ•´æ–‡ä»¶å¤¹çš„æ˜¾ç¤ºé¢œè‰²çš„æ—¶å€™å°±ç›´æ¥å»<code>Settings &gt; Editor &gt; Colors &amp; Fonts &gt; File Status</code>ä¸­è°ƒæ•´å³å¯äº†ï¼Œå¯ä»¥è°ƒæ•´æˆè‡ªå·±å–œæ¬¢çš„æ ·å­ã€‚</p><p>##Javaèµ„æºæ–‡ä»¶éè‹±æ–‡çš„æƒ…å†µæ˜¾ç¤º<br>IntelliJåœ¨èµ„æºæ–‡ä»¶è¿™æ–¹é¢ä¸ªäººè§‰å¾—ä¹Ÿæ˜¯å®ŒèƒœEclipseçš„ï¼Œåœ¨Resource Bundleæ–¹å¼ä¸‹æƒ³ä¿®æ”¹ä¸€ä¸ªå±æ€§æ˜¯ç›¸å½“æ–¹ä¾¿çš„ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªæ“ä½œç•Œé¢ä¸Šä¿®æ”¹æ‰€æœ‰è¯­è¨€çš„å±æ€§ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/loading.gif" data-original="/images/tools/idea-setting-java-doc.png" alt="java æ–‡æ¡£"></p><p>å¹¶ä¸”è¿˜å¾ˆè´´å¿ƒçš„æœ‰ä¸€ä¸ªæ’åºå’Œåˆ†ç»„çš„åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯è¿™ä¸ªæ’åºã€‚</p><p>é»˜è®¤è®¾ç½®ä¸‹ä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸­æ–‡é»˜è®¤ä¼šæ˜¾ç¤ºä¸ºUnicodeç çš„ï¼Œå…¶å®å‹¾é€‰ä¸€ä¸ªè®¾ç½®(<code>Settings &gt; File Encodings</code>)å°±å¯ä»¥äº†ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="/loading.gif" data-original="/images/tools/idea-setting-file-encode.png" alt="æ–‡ä»¶ç¼–ç "></p><p>è¿™æ ·è®¾ç½®ä»¥åæ‰€æœ‰Unicodeæ˜¾ç¤ºçš„å°±å¯ä»¥è‡ªåŠ¨è½¬åŒ–ä¸ºå…¶åº”è¯¥æ˜¾ç¤ºçš„è¯­è¨€äº†.</p><h2 id="ç¬¦åˆMavençº¦å®šç»“æ„çš„webé¡¹ç›®å¦‚ä½•æ›´å¥½çš„è¿è¡Œ"><a href="#ç¬¦åˆMavençº¦å®šç»“æ„çš„webé¡¹ç›®å¦‚ä½•æ›´å¥½çš„è¿è¡Œ" class="headerlink" title="ç¬¦åˆMavençº¦å®šç»“æ„çš„webé¡¹ç›®å¦‚ä½•æ›´å¥½çš„è¿è¡Œ"></a>ç¬¦åˆMavençº¦å®šç»“æ„çš„webé¡¹ç›®å¦‚ä½•æ›´å¥½çš„è¿è¡Œ</h2><p>è®°å¾—åˆšå¼€å§‹ç”¨Eclipseçš„æ—¶å€™é‚£æ—¶å€™é»˜è®¤æ˜¯ä¸æ”¯æŒJava EEé¡¹ç›®çš„ï¼Œå¿…é¡»ä½¿ç”¨ä¸€ä¸ªMyEclipseçš„æ’ä»¶ï¼Œç›´åˆ°ä»Šå¤©å¥½ä¼¼è¿˜æœ‰äººåœ¨ç”¨è¿™ä¸ªç©æ„ï¼Œå½“å¹´çš„æ—¶å€™æ¯ä¸ªWebé¡¹ç›®ä¿®æ”¹ä¹‹åéƒ½å¿…é¡»Deployä¸€ä¸‹ï¼Œä¿®æ”¹çš„ä¸œè¥¿æ‰ä¼šè¢«æ‰§è¡Œï¼Œå¾ˆæ˜¯ç—›è‹¦ã€‚åæ¥å°±è‡ªå·±åˆ©ç”¨Tomcatæ’ä»¶ï¼Œè¿™ä¸ªå¯ä»¥ä¿è¯ä½ ä¿®æ”¹jspä»¥åŠé™æ€æ–‡ä»¶çš„æ—¶å€™ä¸éœ€è¦Deployç›´æ¥å°±å¯ä»¥è¢«æ‰§è¡Œï¼Œå› ä¸ºTomcatçš„ç›®å½•æŒ‡å‘å…¶å®ç›´æ¥æ˜¯æŒ‡å‘åˆ°äº†ä½ çš„é¡¹ç›®æ–‡ä»¶ï¼Œè¿™æ ·çš„ç¡®çœå¿ƒäº†å¾ˆå¤šã€‚</p><p>åœ¨IntelliJä¸­å¦‚æœä½ æ˜¯ä¼ ç»Ÿçš„Java EEçš„ç»“æ„(æ ¹ç›®å½•ä¸‹é¢æœ‰srcï¼ŒwebMoudleè¿™æ ·çš„ç»“æ„)ï¼Œé‚£ä¹ˆåœ¨ç›´æ¥åœ¨Run Configurationsä¸­æ·»åŠ ä¸€ä¸ªTomcatå³å¯ï¼Œç‚¹å‡»+å·æ·»åŠ å³å¯(å½“ç„¶éœ€è¦æ³¨æ„è™½ç„¶æ²¡æœç´¢æ¡†ï¼Œä½ è¾“å…¥å­—ç¬¦ä¼šè‡ªåŠ¨ç»™ä½ ç­›é€‰ç»“æœ)ï¼Œè¿™æ ·è¿è¡Œçš„æ—¶å€™ä¿®æ”¹Javaæ–‡ä»¶çš„è¯éœ€è¦ä¸»åŠ¨Make Projectä¹Ÿå°±æ˜¯<code>âŒ˜+F9 (Make Project)</code>.ä½†æ˜¯å¦‚æœä½ æ˜¯ç¬¦åˆmavençº¦å®šçš„é¡¹ç›®ç»“æ„çš„è¯å¦‚æœç»§ç»­è¿™æ ·é…ç½®å°±å¾ˆä¸ç†æƒ³äº†ï¼Œæ¯æ¬¡ä¿®æ”¹äº†jspæ–‡ä»¶ç«Ÿç„¶ä¹Ÿéœ€è¦Make Projectæ‰å¯ä»¥ï¼Œå› ä¸ºæ¯æ¬¡Make Projectä»¥åIntelliJä¼šè‡ªåŠ¨ç»™ä½ DeployMentï¼Œè¿™æ ·å¥½ä¼¼åˆå›åˆ°äº†å‡ å¹´å‰é‚£ç§å¾ˆéº»çƒ¦çš„ç¯å¢ƒ.</p><p>è¿™ä¸ªé—®é¢˜å…¶å®å¾ˆå®¹æ˜“è§£å†³ï¼Œå°±æ˜¯ä¸è¦ä½¿ç”¨è¿™ç§æ–¹å¼æ¥è¿è¡Œä½ çš„webé¡¹ç›®ï¼Œæ—¢ç„¶ç¬¦åˆmavenç»“æ„çš„é¡¹ç›®è‡ªç„¶æ˜¯ä½¿ç”¨mavenæˆ–è€…gradleè¿™ç§æ„å»ºå·¥å…·äº†ï¼Œé‚£ä¹ˆä½ éœ€è¦åˆ©ç”¨mavençš„jettyçš„æ’ä»¶æ¥è¿è¡Œé¡¹ç›®å³å¯äº†ï¼Œå¦‚ä¸‹å›¾é…ç½®å³å¯:<br><img src="/loading.gif" data-original="/images/tools/idea-setting-maven.png" alt="image.png"></p><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥å¦‚ä¸‹å›¾ç›´æ¥ç‚¹å‡»è¿è¡Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ª:   </p><p><img src="/loading.gif" data-original="/images/tools/idea-setting-maven-jetty.png" alt="jetty run"></p><p>å‚çœ‹ä¸Šå›¾å…¶å®ä¹Ÿæ²¡å¿…é¡»éç”¨jettyï¼Œç”¨tomcat6æˆ–è€…tomcat7çš„æ’ä»¶è¿è¡Œä¹Ÿå¯ä»¥ã€‚</p><p>##Eclipseçš„webç»“æ„é¡¹ç›®å¦‚ä½•å¯¼å…¥å’Œè¿è¡Œ<br>é‰´äºæœ‰ä¸€äº›ç”¨æˆ·è¿˜æ²¡è½¬å‹Mavenç­‰æ¥æ„å»ºé¡¹ç›®ï¼Œå½“ç„¶æˆ‘ä¹Ÿè¡·å¿ƒçš„è¯´ä¸€å¥ï¼Œæ„å»ºè¿™å—è¿˜æ˜¯èµ¶ç´§è½¬äº†å§.å› ä¸ºä¸è½¬çš„è¯è¿˜å•ç‹¬å‡ºæ¥è¿™ä¸ªç« èŠ‚ï¼Œå¹¶ä¸”æœ‰çš„æ“ä½œè¿˜æ˜¯ç›¸å½“éº»çƒ¦ï¼Œä¸‹é¢ä¹Ÿä¼šè®²åˆ°ï¼Œè¿˜æ˜¯ä¸€ä¸€é“æ¥å§ï¼Œå¯¼å…¥çš„æ—¶å€™æœ‰ä¸¤ä¸ªé€‰æ‹©ç„¶åæˆ‘åˆ†ä¸¤ä¸ªéƒ¨åˆ†è¯´æ˜ï¼Œç‚¹å‡»<code>File &gt; Import Projectâ€¦</code>ï¼Œç„¶åé€‰æ‹©ä½ çš„é¡¹ç›®ç›®å½•ï¼Œç‚¹å‡»OKï¼Œå¦‚ä¸‹å›¾:   </p><p><img src="/loading.gif" data-original="/images/tools/idea-setting-from-eclipse-import.png" alt="idea å¯¼å…¥é¡¹ç›®"></p><h3 id="ä½¿ç”¨æ–°å»ºé¡¹ç›®æ¥å¯¼å…¥"><a href="#ä½¿ç”¨æ–°å»ºé¡¹ç›®æ¥å¯¼å…¥" class="headerlink" title="ä½¿ç”¨æ–°å»ºé¡¹ç›®æ¥å¯¼å…¥"></a>ä½¿ç”¨æ–°å»ºé¡¹ç›®æ¥å¯¼å…¥</h3><p>è¿™ä¸ªæ–¹å¼å›¾ä¸­æ‰€ç¤ºçš„ç¬¬ä¸€ç§ï¼Œå¯¼å…¥åŸºæœ¬å°±æ˜¯ä¸€è·¯nextåˆ°å®Œæˆï¼Œä½†æ˜¯ä½ ç¬¬ä¸€æ¬¡ä¹Ÿå¯ä»¥è´¹ç‚¹å¿ƒæ€æ³¨æ„ä¸‹æ¯ä¸€æ­¥åšäº†å•¥ï¼Œä¾‹å¦‚å¸®ä½ åˆ†æäº†jaræœ‰å“ªä¸€äº›ï¼Œå¦‚æœä½ ä½¿ç”¨äº†Springè¿˜ç»™ä½ åˆ†æä½ çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ã€‚æœ€åå®Œæˆä»¥åé¡¹ç›®å°±å¼€å§‹æ„å»ºç´¢å¼•ï¼Œç­‰ä¸€åˆ‡å°±ç»ªä»¥åæˆ‘ä»¬å°±å¯ä»¥å®Œæˆçš„åŸºæœ¬é…ç½®äº†ï¼Œç”±äºæ˜¯webé¡¹ç›®åŸºæœ¬ä¸Šèƒ½å¤Ÿåœ¨Tomcatç­‰æœåŠ¡å™¨ä¸Šè·‘èµ·æ¥å°±åŸºæœ¬ç®—æˆåŠŸäº†ã€‚ä¸»è¦å‡ ä¸ªç‚¹:  </p><ul><li>å¤„ç†å¥½ä¾èµ–å…³ç³»ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡ä½¿ç”¨mavenï¼Œæ‰€ä»¥ä½ å¾—è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿäº†</li><li>è®¾ç½®javaæ–‡ä»¶çš„ç¼–è¯‘è·¯å¾„ï¼Œå¦‚æœéœ€è¦çš„è¯</li><li>æ·»åŠ ä½ çš„Tomcatï¼Œè¿è¡ŒæˆåŠŸ</li></ul><h4 id="ä¾èµ–å…³ç³»"><a href="#ä¾èµ–å…³ç³»" class="headerlink" title="ä¾èµ–å…³ç³»"></a>ä¾èµ–å…³ç³»</h4><p>æ‰“å¼€<code>File &gt; Project Structure</code> ï¼Œæœ¬èŠ‚æˆ‘ä»¬ä¸»è¦ç”¨åˆ°ä¸‹å›¾å‡ ä¸ªæ ‡çº¢çš„éƒ¨åˆ†:<br><img src="/loading.gif" data-original="/images/tools/idea-setting-project-structure.png" alt="Project Structure"></p><p>æˆ‘ä»¬å…ˆäº†è§£ä¸‹è¿™å‡ ä¸ªä¸»è¦éƒ¨ä»¶:</p><ul><li><p>**SDKs:**ä¸»è¦å­˜æ”¾äº†æˆ‘ä»¬çš„JDKç­‰ï¼Œå¦‚ä¸‹å›¾(æˆ‘è‡ªå·±ä¸‹è½½å¸¦sourceçš„JDKï¼Œè¿™æ ·å¯ä»¥ç›´æ¥æŸ¥çœ‹JDKç›¸å…³çš„Javaæºä»£ç ):<br><img src="/loading.gif" data-original="/images/tools/idea-setting-sdk.png" alt="SDKs"></p></li><li><p>**Global Libraries:**ä¸»è¦æ˜¯å…¬ç”¨çš„jaræ–‡ä»¶ï¼Œä¾‹å¦‚servletçš„å‡ ä¸ªjarå¯èƒ½æ¯ä¸ªé¡¹ç›®éƒ½éœ€è¦ï¼Œä½†æ˜¯Eclipseçš„å˜é‡åœ¨æ­¤å˜å¾—ä¸å¥½ä½¿ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨è¿™ä¸ªåœ°æ–¹æ¥é…ç½®ï¼Œå¦‚ä¸‹å›¾å‚ç…§ä½¿ç”¨å³å¯:<br><img src="/loading.gif" data-original="/images/tools/idea-setting-global-lib.png" alt="Global Libraries"></p></li><li><p>**Facets:**åœ¨æ­¤ä¸åšä»‹ç»ï¼Œå¦‚æœ‰éœ€è¦åç»­æ·»åŠ </p></li><li><p>**Libraries:**è¿™é‡ŒåŸºæœ¬æ˜¯é¡¹ç›®çš„åº“ï¼Œä¸æ˜¯å…¨å±€çš„ï¼Œå¯¼å…¥çš„é¡¹ç›®ä¸€èˆ¬éƒ½ä¼šæŠŠä½ Eclipseä¸­çš„ã€‚classpathä¸­çš„æ‰€æœ‰çš„ä¾èµ–éƒ½å¯¼è¿‡æ¥ä½œä¸ºä¸€ä¸ªlibåº“ï¼Œç„¶ååº”ç”¨åˆ°ä½ çš„é¡¹ç›®çš„æ¨¡å—ä¸­</p></li><li><p>**Modules:**è¿™ä¸ªåŸºæœ¬åŒ…æ‹¬äº†é¡¹ç›®çš„æ¨¡å—ï¼Œé€šå¸¸æ¥è¯´Eclipseçš„é¡¹ç›®ç»“æ„ä¸­æ˜¯å•æ¨¡å—çš„</p></li></ul><p>æˆ‘ä»¬éœ€è¦åšçš„é…ç½®ä¸»è¦åœ¨Modulesä¸­ï¼Œå…¶ä»–çš„å‡ ä¸ªè‡ªå·±æ ¹æ®ç†è§£é…ç½®å³å¯ã€‚</p><ol><li>æˆ‘ä»¬å…ˆæŸ¥çœ‹<strong>Modules</strong>ä¸­çš„<strong>Sources</strong>ï¼Œå¦‚ä¸‹å›¾:<br><img src="/loading.gif" data-original="/images/tools/idea-setting-sources.png" alt="Sources"></li></ol><p>æŠŠé¡¹ç›®æ‰€æœ‰çš„æºç éƒ½æ·»åŠ å³å¯ï¼Œå›¾ä¸­æ‰€ç¤ºæˆ‘çš„é¡¹ç›®ä¸­å…¶å®å°‘äº†resourceçš„æ–‡ä»¶å¤¹ï¼Œè¿™æ ·æˆ‘é€‰ä¸­resourceç„¶åç‚¹å‡»Sourceså³å¯ï¼Œè¿™æ ·å°±ä¼šåœ¨å·¦è¾¹çš„Source Foldersä¸­æ·»åŠ ä¸€ä¸ªresourceçš„æ–‡ä»¶å¤¹ã€‚<br>2. ç„¶åæ˜¯Pathséƒ¨åˆ†ï¼Œè¿™ä¸ªä¸»è¦æ˜¯classçš„è¾“å‡ºè·¯å¾„ï¼Œé»˜è®¤æ˜¯åœ¨æ ¹ç›®å½•ä¸‹çš„outæ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚æœé¡¹ç›®ä¸­å¯¹é…ç½®æ–‡ä»¶çš„è§£æç­‰æœ‰å†™æ­»è·¯å¾„ï¼Œå¿…é¡»ä¸¥æ ¼éµå¾ªJava EEçš„è§„èŒƒçš„è¯ï¼Œé‚£ä¹ˆéœ€è¦å°†æ­¤éƒ¨åˆ†ä¿®æ”¹å¦‚ä¸‹(å¦‚æœä¸å­˜åœ¨æˆ‘å‡è®¾çš„æƒ…å†µå¯å¿½ç•¥æœ¬æ­¥éª¤):<br><img src="/loading.gif" data-original="/images/tools/idea-setting-modules-path.png" alt="path"></p><ol start="3"><li>ç„¶åçš„Dependenciesï¼Œå°±æ›´å¥½é…ç½®äº†ï¼Œæ·»åŠ éœ€è¦çš„ä¾èµ–å³å¯ã€‚</li></ol><p>è¿™äº›æ­¥éª¤å®Œæˆä»¥åæˆ‘ä»¬å°±å¯ä»¥ç‚¹å‡»<code>Run &gt; Edit Configurations</code> ï¼Œç‚¹å‡»å·¦ä¸Šè§’çš„**+<strong>å·ï¼Œç„¶åé€‰æ‹©</strong>Tomcat &gt; Local Server **ï¼Œè¿™äº›æ­¥éª¤å’ŒEclipseç±»ä¼¼ï¼Œé€‰æ‹©ç›¸åº”è·¯å¾„ç­‰ç­‰ï¼Œåªéœ€è¦æ³¨æ„ä¸€ç‚¹å°±å¯ä»¥ï¼Œå°±æ˜¯éœ€è¦æ·»åŠ ä¸€ä¸ªDeployMentï¼Œå¦‚ä¸‹å›¾:<br><img src="/loading.gif" data-original="/images/tools/idea-setting-deployment.png" alt="image.png"></p><p><strong>å¦‚æœæ˜¯Windowsçš„å›¾ä¸­çš„DeployMentä¸­çš„+å·å¯èƒ½æ˜¯åœ¨å³ä¾§</strong>ï¼Œç‚¹å‡»ä¹‹åä¼šå¼¹å‡ºå¯¹è¯æ¡†é€‰æ‹©æ–‡ä»¶å¤¹ï¼Œé€‰æ‹©eclipseé»˜è®¤çš„webMoudleæ–‡ä»¶å¤¹å³å¯(MyEclipseå°±æ˜¯WebRootæ–‡ä»¶å¤¹)ï¼Œè¿™ä¸ªä¸€å®šä¸èƒ½é€‰é”™ï¼Œä¸è¦é€‰æˆé¡¹ç›®çš„ä¸»æ–‡ä»¶å¤¹ï¼Œå¦åˆ™è¿è¡Œå°±ä¸æˆåŠŸäº†ï¼Œå†ç„¶å<code>ctrl+R</code>è¿è¡Œå³å¯ã€‚ä»¥debugæ–¹å¼è¿è¡Œå°±æ˜¯<code>ctrl+D</code>ã€‚</p><h3 id="ä½¿ç”¨IntelliJå¯¹Eclipseé¡¹ç›®çš„æ”¯æŒå¯¼å…¥é¡¹ç›®"><a href="#ä½¿ç”¨IntelliJå¯¹Eclipseé¡¹ç›®çš„æ”¯æŒå¯¼å…¥é¡¹ç›®" class="headerlink" title="ä½¿ç”¨IntelliJå¯¹Eclipseé¡¹ç›®çš„æ”¯æŒå¯¼å…¥é¡¹ç›®"></a>ä½¿ç”¨IntelliJå¯¹Eclipseé¡¹ç›®çš„æ”¯æŒå¯¼å…¥é¡¹ç›®</h3><p>åŸºæœ¬å‚ç…§ä¸Šä¸ªåŸºæœ¬éƒ½ç±»ä¼¼ï¼Œå°±æ˜¯æ­¥éª¤æ¯”ä¸Šä¸ªæ­¥éª¤è¦å°‘ç‚¹ï¼Œå¦‚æœå‡ºç°é—®é¢˜å‚ç…§ä¸Šä¸ªç« èŠ‚å³å¯ã€‚</p><h2 id="HQLæŸ¥è¯¢æ”¯æŒ"><a href="#HQLæŸ¥è¯¢æ”¯æŒ" class="headerlink" title="HQLæŸ¥è¯¢æ”¯æŒ"></a>HQLæŸ¥è¯¢æ”¯æŒ</h2><p>ä»¥å‰Eclipseæœ‰ä¸ªHQLçš„æ’ä»¶å¯ä»¥ç›´æ¥è¾“å…¥HQLè¯­æ³•ï¼ŒæŸ¥è¯¢æµ‹è¯•ç»“æœæ˜¯å¦æ­£ç¡®ï¼Œåœ¨IntelliJä¸­ä½ ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡ä¸éœ€è¦ä»»ä½•æ’ä»¶é»˜è®¤æä¾›æ”¯æŒçš„ï¼Œå¦‚æœåœ¨å¯¼å…¥é¡¹ç›®çš„æ—¶å€™æ²¡æœ‰è‡ªåŠ¨æ·»åŠ Hibernateçš„æ”¯æŒçš„è¯ï¼Œé‚£éœ€è¦æ·»åŠ ä¸€ä¸‹Hibernateçš„æ”¯æŒï¼Œé¼ æ ‡é€‰ä¸­é¡¹ç›®ï¼Œç‚¹å‡»å³é”®å¦‚ä¸‹å›¾:<br><img src="/loading.gif" data-original="/images/tools/idea-setting-hql1.png" alt="HQLæ”¯æŒ"></p><p>ç‚¹å‡»é€‰æ‹©Hibernateå³å¯ï¼Œå¦‚æœæ²¡æœ‰Hibernateåº”è¯¥æ˜¯é¡¹ç›®å·²ç»è‡ªåŠ¨æ·»åŠ äº†Hibernateçš„æ”¯æŒäº†ã€‚ç„¶åå®Œæˆä»¥åå°±å¯ä»¥å¦‚ä¸‹å›¾æ“ä½œå³å¯:<br><img src="/loading.gif" data-original="/images/tools/idea-setting-hql2.png" alt="HQLæ”¯æŒ"></p><p>é€‰ä¸­ä¸Šé¢HQLå›¾æ ‡ï¼Œåœ¨å‡ºæ¥çš„æ§åˆ¶å°è¾“å…¥ä½ æƒ³è¾“å…¥çš„HQLå³å¯äº†ï¼Œä¸€æ ·å¯ä»¥è‡ªåŠ¨å®Œæˆçš„å“¦ã€‚</p><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ol><li>IntelliJå¯¹äºæ–‡ä»¶æ˜¯é»˜è®¤éšæ—¶ä¿å­˜çš„ï¼ŒåŸºæœ¬ä¸éœ€è¦ä½ <code>âŒ˜+s</code>(è¿™ä¸ªé”®ä½é»˜è®¤æ˜¯ä¿å­˜æ‰€æœ‰)ï¼Œæ‰€ä»¥éœ€è¦æ³¨æ„ä¸è¦éšæ‰‹ä¸å°å¿ƒæŠŠæŸä¸ªæ–‡ä»¶æ”¹äº†ä¸‹ï¼Œç„¶åç›´æ¥å…³é—­æ ‡ç­¾äº†ï¼Œå…¶å®ä½ çš„æ— æ„çš„æ“ä½œå·²ç»å¯¼è‡´ä¿®æ”¹äº†æ–‡ä»¶ï¼Œå¯èƒ½å¯¼è‡´ä½ åœ¨é¡¹ç›®è¿è¡Œçš„æ—¶å€™å‘ç°ä¸€ä¸ªå¾ˆç¦»å¥‡çš„é”™è¯¯ï¼Œæˆ‘æš‚æ—¶æ²¡å‘ç°å¯ä»¥å…³é—­è‡ªåŠ¨ä¿å­˜çš„è®¾ç½®ï¼Œå¦‚æœä½ å¯¹æ­¤éæœ‰å¼ºè¿«ç—‡çš„è¯ï¼Œvimçš„æ’ä»¶å¯èƒ½ä¼šå¸®åŠ©åˆ°ä½ ã€‚</li><li>IntelliJä¸­çš„æ–‡ä»¶æ˜¯å®æ—¶å’Œæœ¬åœ°æ–‡ä»¶åŒæ­¥çš„ï¼Œæ‰€ä»¥Eclipseçš„åˆ·æ–°åŠŸèƒ½å°±ä¸è¦é—®äº†ï¼Œå› ä¸ºåœ¨è¿™æ ¹æœ¬ä¸éœ€è¦é‚£ä¸ªåŠŸèƒ½ã€‚æœ‰çš„ç¼–è¾‘å™¨ä¼šæé†’ä½ æ˜¯å¦å’Œæœ¬åœ°æ–‡ä»¶æ›´æ–°ï¼Œè¿™é‡Œä¹Ÿæ˜¯é»˜è®¤ä¸ç»™ä»»ä½•æé†’çš„ï¼Œåªè¦ä½ ä¿®æ”¹äº†ï¼Œè¿™é‡Œå°±ä¼šç«‹å³è‡ªåŠ¨åŒæ­¥æ›´æ–°æ–‡ä»¶ã€‚</li><li>åœ¨ä¸»èœå•<code>File</code>ä¸‹é¢ï¼Œæœ‰ä¸ªå¥‡æ€ªçš„Power Save Modeï¼Œè¿™é‡Œä¹Ÿè¯´æ˜ä¸‹ï¼Œè¿™ä¸ªé¡¾åæ€ä¹‰æ˜¯çœç”µæ¨¡å¼ã€‚å½“ä½ å‹¾é€‰æ­¤æ¨¡å¼ä»¥åï¼ŒIntelliJä¸ä¼šç»™ä½ å®Œæˆä»»ä½•è‡ªåŠ¨å®Œæˆçš„åŠŸèƒ½ï¼Œä¾‹å¦‚æœ¬æ¥ä½ è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¼šè‡ªåŠ¨æç¤ºçš„ï¼Œå‹¾é€‰ä»¥åå°±æ²¡æœ‰äº†ï¼Œå¦‚æœå‡ºç°æ­¤é—®é¢˜çš„è¯å¯ä»¥è€ƒè™‘æ˜¯ä¸æ˜¯è‡ªå·±æ‰‹è´±ç‚¹è¿‡è¿™ä¸ªæŒ‰é’®å™¢ï¼Œè¿™ä¸ªè¿˜æ˜¯æ¯”è¾ƒé€‚åˆå¼€ä¼šçš„æ—¶å€™æ— èŠçœ‹ä»£ç ç”¨çš„ï¼Œåˆçœç”µåˆä¸å½±å“ä½ çœ‹ä»£ç ã€‚</li><li>Eclipseä¸­æœ‰ä¸ª<code>F2</code>çš„åŠŸèƒ½ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°Javaæ–‡ä»¶å®šä¹‰ï¼Œä½ åœ¨Springçš„é…ç½®æ–‡ä»¶ä¸­å¯èƒ½éœ€è¦é…ç½®è¿™ä¸ªå€¼ï¼Œä½†æ˜¯åœ¨IntelliJä¸­è¿™ä¸ªæ˜¯ä¸éœ€è¦çš„ï¼Œå› ä¸ºå¯¹äºSpringè¿™æ ·çš„æ”¯æŒå¾ˆæ˜¯å®Œå–„ï¼Œä½ åªéœ€è¦åœ¨classçš„å±æ€§ä¸­è¾“å…¥classçš„åå­—ç„¶å<code>ctrl+ç©ºæ ¼ (Basic è¿™ä¸ªåœ¨codeçš„completionä¸‹é¢)</code>è‡ªåŠ¨å°±å®Œæˆäº†å…¨è·¯å¾„ï¼Œåœ¨æ™ºèƒ½çš„æ¡ä»¶ä¸‹å¯èƒ½å°±ä¸éœ€è¦è¹©è„šçš„å®ç°ã€‚</li><li>é¡¹ç›®åˆšå¼€å§‹å¯¼å…¥æˆ–è€…æ¸…é™¤cacheé‡æ–°æ‰“å¼€çš„æ—¶å€™ï¼Œä¸‹é¢çš„çŠ¶æ€æ éƒ¨åˆ†ä¼šæ˜¾ç¤ºIndexingï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±ç­‰ç€å°±å¯ä»¥äº†ï¼ŒåŸºæœ¬ä½ æƒ³åšçš„äº‹æƒ…ä»€ä¹ˆéƒ½ä¸èƒ½åšï¼Œåˆ«åœ¨è¿™ä¸ªæ—¶å€™ç€æ€¥ç‚¹æ¥ç‚¹å»ï¼Œä¸è¿‡å®ƒç´¢å¼•çš„é€Ÿåº¦æŒºå¿«çš„ï¼Œåˆ«ç€æ€¥ã€‚</li><li>Eclipseæœ‰ä¸ªSave Actionsçš„åŠŸèƒ½ï¼Œä¸»è¦æ˜¯é’ˆå¯¹Javaå¯ä»¥è‡ªåŠ¨æ ¼å¼åŒ–ä»¥åŠä¼˜åŒ–importç­‰åŠŸèƒ½ï¼Œè¿™ä¸ªåœ¨IntelliJä¸Šå…¶å®é»˜è®¤æ˜¯æ²¡æœ‰çš„ï¼Œæƒ³åœ¨IntelliJä¸­ä½¿ç”¨è¿™åŠŸèƒ½å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªæ€è·¯:<ul><li>åˆ©ç”¨<strong>å®å½•åˆ¶</strong>ï¼Œå®åœ¨å¼€å§‹ä»¥åä½ å°±æ ¼å¼åŒ–ä¸‹ä»£ç ï¼Œç„¶åä¼˜åŒ–ä¸‹importç­‰æ“ä½œï¼Œç„¶åç»“æŸæŠŠå®å®šä¹‰ä¸€ä¸ª<code>âŒ˜+s</code>ï¼Œä¸è¿‡é—®é¢˜å°±æ˜¯ä¸ç®¡ä»€ä¹ˆæ–‡ä»¶éƒ½ä¼šæ‰§è¡Œè¿™ä¸ªå®ï¼Œä¸ä»…ä»…æ˜¯javaæ–‡ä»¶ï¼Œæˆ‘å°±æ˜¯åˆ©ç”¨è¿™ä¸ªå®ä¸»è¦å®ŒæˆæŠŠtabè½¬ä¸ºç©ºæ ¼ã€‚</li><li>ä½¿ç”¨<strong>Eclipse Code Formatter</strong>çš„æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶åŸºæœ¬å’ŒEclipseé»˜è®¤çš„åŠŸèƒ½ç±»ä¼¼ï¼Œä½†æ˜¯ä¹Ÿæœ‰å°‘è®¸åŒºåˆ«ï¼Œç”¨æˆ·è‡ªå·±æ€é‡æ˜¯å¦ä½¿ç”¨å³å¯ã€‚</li></ul></li><li>åœ¨Macä¸‹IntelliJä»£ç åŒºåŸŸæ˜¯æ”¯æŒæ‰‹åŠ¿æ”¾å¤§çš„ï¼Œè¿™ä¸ªåœ¨ç»™åˆ«äººæ¼”ç¤ºçš„æ—¶å€™å¾ˆæ˜¯æ–¹ä¾¿ã€‚ä½†æ˜¯Runã€Debugç­‰è§†å›¾çš„æ—¶å€™é»˜è®¤èƒ½ä½¿æƒ³åˆ°çš„å°±æ˜¯æ‰‹åŠ¨çš„æ‹–åŠ¨å¤§å°ï¼Œå¾ˆæ˜¯ä¸ä¾¿ã€‚ä½ å¯ä»¥å°è¯•ä¸‹<code>âŒ˜+shift+up/down (Stretch to Top / Bottom)</code>ï¼Œå½“ç„¶å…¶ä»–çš„projectè§†å›¾ç­‰çš„ä¹Ÿéƒ½å¯ä»¥åˆ©ç”¨è¿™ä¸ªå¿«æ·é”®é…ç½®ä¸Šä¸‹å·¦å³çš„æ–¹å‘é”®æ¥é…ç½®ä½¿ç”¨ï¼Œæ–¹ä¾¿çš„å¾ˆï¼Œå¼ºçƒˆæ¨èä½¿ç”¨ã€‚</li><li>Eclipseä¸­å¯ä»¥åŒä¸€ä¸ªçª—å£æ‰“å¼€å¤šä¸ªé¡¹ç›®ï¼Œä½†æ˜¯IntelliJ IDEAåœ¨è¿™é‡Œçš„è®¾è®¡æ˜¯ä¸ä¸€æ ·çš„ï¼Œå…·ä½“å¯ä»¥å‚çœ‹<a href="http://www.jetbrains.com/idea/documentation/migration_faq.html">IntelliJ IDEA Q&amp;A for Eclipse Users</a>ã€‚</li><li>jarçš„sourceä¾èµ–é—®é¢˜ï¼Œå¦‚æœä½ æ˜¯ä½¿ç”¨Mavençš„è¯éƒ½æ˜¯å¯ä»¥è‡ªåŠ¨å®Œæˆçš„ï¼Œåªéœ€è¦ä½ å‘å¸ƒå‡ºä½ çš„source jarå°±å¯ä»¥ï¼Œä½†æ˜¯å¦‚æœä½ é¡¹ç›®ä¸æ˜¯ä½¿ç”¨mavençš„è¯ä½ å°±éœ€è¦åœ¨é¡¹ç›®é…ç½®çš„ä¾èµ–çš„åœ°æ–¹ï¼Œç‚¹å‡»ä½ çš„éœ€è¦å¼•å…¥sourceçš„jarï¼Œç„¶åå³é”®ç¼–è¾‘ï¼Œaddä½ çš„æœ¬åœ°sourceç›®å½•å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦åšProjectçš„å¤šä¸ªmoudleå³å¯ï¼Œè¿™é‡Œå’ŒEclipseä¸­çš„åŸºæœ¬ç›¸ä¼¼ã€‚</li></ol><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ç¬¬ä¸€æ¬¡å‘æ–‡ï¼Œå¦‚æœæœ‰ä»€ä¹ˆé—®é¢˜æ¬¢è¿ç•™è¨€äº¤æµï¼ŒåŸå§‹æ–‡æ¡£æ”¾åœ¨<a href="https://github.com/fxl545826/Documents">github</a>ä¸Šï¼Œå„ä½å¦‚æœä¹Ÿæœ‰ä¸€äº›æŠ€å·§ä¸å¦¨å…±åŒå®Œå–„ä¸‹æœ¬æ–‡æ¡£ã€‚åªéœ€è¦Fockç„¶åPull Requestå°±å¯ä»¥äº†ï¼Œå¦‚æœä½ è§‰å¾—æœ‰ä¸ªgithubå¸å·è¿‡äºéº»çƒ¦çš„è¯ï¼Œé‚£æˆ‘ä¸ªäººè§‰å¾—ä½ è¿˜æ˜¯è½¬è¡Œæ¯”è¾ƒåˆé€‚ã€‚å¦‚æœä¸æƒ³æ›´æ–°åªæ˜¯æƒ³è®¢é˜…æŒç»­æ›´æ–°çš„å†…å®¹ï¼Œåªéœ€è¦Watchè¯¥é¡¹ç›®å³å¯ã€‚è¿˜å¯ä»¥å¯¹é¡¹ç›®Starï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨è‡ªå·±çš„å¸å·é¡µé¢å¿«é€Ÿæ‰¾åˆ°æœ¬é¡¹ç›®ã€‚</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><ul><li><p>Winå¿«æ·é”® <a href="http://www.jetbrains.com/idea/docs/IntelliJIDEA_ReferenceCard.pdf">Win Keymap</a></p></li><li><p>Mac OS å¿«æ·é”® <a href="http://www.jetbrains.com/idea/docs/IntelliJIDEA_ReferenceCard_Mac.pdf">Mac OS Keymap</a></p></li></ul><p>åŸæ–‡åœ°å€ï¼š<a href="https://github.com/ethanfu/Documents/blob/master/intellij/intellij_idea_use_documents.md">https://github.com/ethanfu/Documents/blob/master/intellij/intellij_idea_use_documents.md</a> </p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
            <tag> intellij idea </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³springboot waråŒ…åœ¨tomcatéƒ¨ç½²æ—¶å¯åŠ¨æ…¢çš„é—®é¢˜</title>
      <link href="2018/07/10/jie-jue-springboot-war-bao-zai-tomcat-bu-shu-shi-qi-dong-man-de-wen-ti/"/>
      <url>2018/07/10/jie-jue-springboot-war-bao-zai-tomcat-bu-shu-shi-qi-dong-man-de-wen-ti/</url>
      
        <content type="html"><![CDATA[<p>linuxä¸Šçš„tomcatä¸Šéƒ¨ç½²ä¸Šspringbootçš„waråŒ…å¯åŠ¨æ€»æ˜¯å¾ˆæ…¢ï¼Œåˆ†æå¯åŠ¨logï¼Œä¸‰æ­¥è°ƒæ•´ï¼Œä½¿å¯åŠ¨æ—¶é—´ä»10åˆ†é’Ÿè°ƒæ•´åˆ°3åˆ†é’Ÿã€‚<br><a href="https://www.jianshu.com/p/b16ae3a83ccf">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æœ€è¿‘æµ‹è¯•æœåŠ¡å™¨tomcatå‘å¸ƒä¸€æ¬¡å¾ˆæ…¢ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç‰¹åœ°çœ‹äº†tomcatçš„logæ–‡ä»¶ï¼Œå¯åŠ¨æ—¥å¿—åœ¨tomcat/logs/catalina.outæ–‡ä»¶ä¸­ã€‚</p><h3 id="1ã€INFOï¼šorg-apache-catalina-startup-HostConfig-deployDirectory-Deploying-web-application-directory-xxx-warå¡é¡¿"><a href="#1ã€INFOï¼šorg-apache-catalina-startup-HostConfig-deployDirectory-Deploying-web-application-directory-xxx-warå¡é¡¿" class="headerlink" title="1ã€INFOï¼šorg.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory  xxx.warå¡é¡¿"></a>1ã€INFOï¼šorg.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory  xxx.warå¡é¡¿</h3><p><a href="https://www.cnblogs.com/mycifeng/p/6972446.html">åˆºé£</a>åŒå­¦å°±æ˜¯<strong>å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´</strong>çš„å®è·µè€…ï¼Œè¢«æˆ‘ä¹Ÿç”¨ä¸Šäº†ã€‚<br>æ‰¾åˆ°jdk1.x.x_xx/jre/lib/security/<a href="http://lib.csdn.net/base/java" title="Java çŸ¥è¯†åº“">Java</a>.securityæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°securerandom.sourceè¿™ä¸ªè®¾ç½®é¡¹ï¼Œå°†å…¶æ”¹ä¸ºï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">securerandom.source=file:/dev/./urandom<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‡å¯tomcat,è¿™ä¸€æ­¥çš„é€Ÿåº¦æ˜æ˜¾åŠ å¿«ã€‚<br>åŸç†æ®è¯´æ˜¯è¿™æ ·çš„ï¼š</p><blockquote><p>linuxæˆ–è€…éƒ¨åˆ†unixç³»ç»Ÿæä¾›éšæœºæ•°è®¾å¤‡æ˜¯/dev/random å’Œ/dev/urandom ï¼Œ<br>ä¸¤ä¸ªæœ‰åŒºåˆ«ï¼Œurandomå®‰å…¨æ€§æ²¡æœ‰randomé«˜ï¼Œä½†randoméœ€è¦æ—¶é—´é—´éš”ç”Ÿæˆéšæœºæ•°ã€‚jdké»˜è®¤è°ƒç”¨randomã€‚</p></blockquote><h3 id="2ã€-WARN-Establishing-SSL-connection-without-serverâ€™s-identity-verification-is-not-recommended"><a href="#2ã€-WARN-Establishing-SSL-connection-without-serverâ€™s-identity-verification-is-not-recommended" class="headerlink" title="2ã€ WARN: Establishing SSL connection without serverâ€™s identity verification is not recommended."></a>2ã€ WARN: Establishing SSL connection without serverâ€™s identity verification is not recommended.</h3><p>å…·ä½“é”™è¯¯æ˜¯è¿™æ ·çš„ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">Mon Jul 09 09:30:13 CST 2018 WARN: Establishing SSL connection without server's identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn't set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to 'false'. You need either to explicitly disable SSL by setting useSSL=false, or set useSSL=true and provide truststore for server certificate verification.Mon Jul 09 09:30:13 CST 2018 WARN: Establishing SSL connection without server's identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn't set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to 'false'. You need either to explicitly disable SSL by setting useSSL=false, or set useSSL=true and provide truststore for server certificate verification.Mon Jul 09 09:30:14 CST 2018 WARN: Establishing SSL connection without server's identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn't set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to 'false'. You need either to explicitly disable SSL by setting useSSL=false, or set useSSL=true and provide truststore for server certificate verification.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªé”™è¯¯ä¼šæ‰“å‡ éï¼Œæ¯ä¸€ééƒ½ä¼šå¡ä¸€ä¼šå„¿ï¼Œåº”è¯¥æ˜¯åœ¨éªŒè¯mysqlçš„SSLé…ç½®ã€‚<br>æŸ¥é˜…èµ„æ–™è¯´mysqlçš„é«˜ç‰ˆæœ¬é»˜è®¤è¦æ±‚ä½¿ç”¨SSLé“¾æ¥ï¼Œæ‰€ä»¥åœ¨æ²¡æœ‰é…ç½®SSLä¹Ÿæ²¡æœ‰è¯´SSLä¸éœ€è¦æ—¶ï¼Œå°±ä¼šä¸€ç›´éªŒè¯ï¼ŒéªŒè¯å¥½å‡ éä»¥åæ”¾å¼ƒã€‚<br>è¿™ä¸ªæ—¶é—´å¤§æ¦‚æœ‰1åˆ†é’Ÿã€‚<br>å½“ç„¶ï¼Œæ–¹æ¡ˆå°±æ˜¯åœ¨jdbcçš„é“¾æ¥ä¸ŠåŠ ä¸ŠuserSSL=falseè¿™ä¸ªå‚æ•°ï¼Œ<br><code>jdbc:p6spy:mysql://127.0.0.1:3306/chuangke?characterEncoding=utf-8&amp;useSSL=false&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=Hongkong&amp;autoReconnect=true</code><br>ç±»ä¼¼è¿™æ ·ã€‚</p><h3 id="3ã€-ç¦ç”¨Springbootçš„JNDIåŠŸèƒ½"><a href="#3ã€-ç¦ç”¨Springbootçš„JNDIåŠŸèƒ½" class="headerlink" title="3ã€ ç¦ç”¨Springbootçš„JNDIåŠŸèƒ½"></a>3ã€ ç¦ç”¨Springbootçš„JNDIåŠŸèƒ½</h3><p>åŸæ¥çš„log</p><pre class="line-numbers language-shell"><code class="language-shell">10:40:24.103 [localhost-startStop-1] DEBUG org.springframework.web.context.support.StandardServletEnvironment - Replacing PropertySource 'servletContextInitParams' with 'servletContextInitParams'10:40:24.685 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging.exception-conversion-word]10:40:24.686 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging.exception-conversion-word] not found - trying original name [logging.exception-conversion-word]. javax.naming.NameNotFoundException: Name [logging.exception-conversion-word] is not bound in this Context. Unable to find [logging.exception-conversion-word].10:40:24.687 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging.exception-conversion-word]10:40:24.687 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiPropertySource - JNDI lookup for name [logging.exception-conversion-word] threw NamingException with message: Name [logging.exception-conversion-word] is not bound in this Context. Unable to find [logging.exception-conversion-word].. Returning null.10:40:24.687 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging.exception_conversion_word]10:40:24.688 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging.exception_conversion_word] not found - trying original name [logging.exception_conversion_word]. javax.naming.NameNotFoundException: Name [logging.exception_conversion_word] is not bound in this Context. Unable to find [logging.exception_conversion_word].10:40:24.688 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging.exception_conversion_word]10:40:24.688 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiPropertySource - JNDI lookup for name [logging.exception_conversion_word] threw NamingException with message: Name [logging.exception_conversion_word] is not bound in this Context. Unable to find [logging.exception_conversion_word].. Returning null.10:40:24.689 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging.exceptionConversionWord]10:40:24.689 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging.exceptionConversionWord] not found - trying original name [logging.exceptionConversionWord]. javax.naming.NameNotFoundException: Name [logging.exceptionConversionWord] is not bound in this Context. Unable to find [logging.exceptionConversionWord].10:40:24.689 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging.exceptionConversionWord]10:40:24.689 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiPropertySource - JNDI lookup for name [logging.exceptionConversionWord] threw NamingException with message: Name [logging.exceptionConversionWord] is not bound in this Context. Unable to find [logging.exceptionConversionWord].. Returning null.10:40:24.689 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging.exceptionconversionword]10:40:24.689 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging.exceptionconversionword] not found - trying original name [logging.exceptionconversionword]. javax.naming.NameNotFoundException: Name [logging.exceptionconversionword] is not bound in this Context. Unable to find [logging.exceptionconversionword].10:40:24.689 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging.exceptionconversionword]10:40:24.690 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiPropertySource - JNDI lookup for name [logging.exceptionconversionword] threw NamingException with message: Name [logging.exceptionconversionword] is not bound in this Context. Unable to find [logging.exceptionconversionword].. Returning null.10:40:24.690 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging.EXCEPTION-CONVERSION-WORD]10:40:24.690 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging.EXCEPTION-CONVERSION-WORD] not found - trying original name [logging.EXCEPTION-CONVERSION-WORD]. javax.naming.NameNotFoundException: Name [logging.EXCEPTION-CONVERSION-WORD] is not bound in this Context. Unable to find [logging.EXCEPTION-CONVERSION-WORD].10:40:24.690 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging.EXCEPTION-CONVERSION-WORD]10:40:24.691 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiPropertySource - JNDI lookup for name [logging.EXCEPTION-CONVERSION-WORD] threw NamingException with message: Name [logging.EXCEPTION-CONVERSION-WORD] is not bound in this Context. Unable to find [logging.EXCEPTION-CONVERSION-WORD].. Returning null.10:40:24.691 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging.EXCEPTION_CONVERSION_WORD]10:40:24.691 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging.EXCEPTION_CONVERSION_WORD] not found - trying original name [logging.EXCEPTION_CONVERSION_WORD]. javax.naming.NameNotFoundException: Name [logging.EXCEPTION_CONVERSION_WORD] is not bound in this Context. Unable to find [logging.EXCEPTION_CONVERSION_WORD].10:40:24.691 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging.EXCEPTION_CONVERSION_WORD]10:40:24.691 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiPropertySource - JNDI lookup for name [logging.EXCEPTION_CONVERSION_WORD] threw NamingException with message: Name [logging.EXCEPTION_CONVERSION_WORD] is not bound in this Context. Unable to find [logging.EXCEPTION_CONVERSION_WORD].. Returning null.10:40:24.691 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging.EXCEPTIONCONVERSIONWORD]10:40:24.691 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging.EXCEPTIONCONVERSIONWORD] not found - trying original name [logging.EXCEPTIONCONVERSIONWORD]. javax.naming.NameNotFoundException: Name [logging.EXCEPTIONCONVERSIONWORD] is not bound in this Context. Unable to find [logging.EXCEPTIONCONVERSIONWORD].10:40:24.691 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging.EXCEPTIONCONVERSIONWORD]10:40:24.691 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiPropertySource - JNDI lookup for name [logging.EXCEPTIONCONVERSIONWORD] threw NamingException with message: Name [logging.EXCEPTIONCONVERSIONWORD] is not bound in this Context. Unable to find [logging.EXCEPTIONCONVERSIONWORD].. Returning null.10:40:24.691 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging_exception-conversion-word]10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging_exception-conversion-word] not found - trying original name [logging_exception-conversion-word]. javax.naming.NameNotFoundException: Name [logging_exception-conversion-word] is not bound in this Context. Unable to find [logging_exception-conversion-word].10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging_exception-conversion-word]10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiPropertySource - JNDI lookup for name [logging_exception-conversion-word] threw NamingException with message: Name [logging_exception-conversion-word] is not bound in this Context. Unable to find [logging_exception-conversion-word].. Returning null.10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging_exception_conversion_word]10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging_exception_conversion_word] not found - trying original name [logging_exception_conversion_word]. javax.naming.NameNotFoundException: Name [logging_exception_conversion_word] is not bound in this Context. Unable to find [logging_exception_conversion_word].10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging_exception_conversion_word]10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiPropertySource - JNDI lookup for name [logging_exception_conversion_word] threw NamingException with message: Name [logging_exception_conversion_word] is not bound in this Context. Unable to find [logging_exception_conversion_word].. Returning null.10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging_exceptionConversionWord]10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging_exceptionConversionWord] not found - trying original name [logging_exceptionConversionWord]. javax.naming.NameNotFoundException: Name [logging_exceptionConversionWord] is not bound in this Context. Unable to find [logging_exceptionConversionWord].10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging_exceptionConversionWord]10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiPropertySource - JNDI lookup for name [logging_exceptionConversionWord] threw NamingException with message: Name [logging_exceptionConversionWord] is not bound in this Context. Unable to find [logging_exceptionConversionWord].. Returning null.10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [java:comp/env/logging_exceptionconversionword]10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/logging_exceptionconversionword] not found - trying original name [logging_exceptionconversionword]. javax.naming.NameNotFoundException: Name [logging_exceptionconversionword] is not bound in this Context. Unable to find [logging_exceptionconversionword].10:40:24.692 [localhost-startStop-1] DEBUG org.springframework.jndi.JndiTemplate - Looking up JNDI object with name [logging_exceptionconversionword]           <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‚è€ƒ<a href="https://blog.csdn.net/qq_30739519/article/details/78536965">é…ç½®æ•™ç¨‹</a>ä¿®æ”¹ã€‚</p><p>æ‘˜è¦ï¼šåœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ä½¿ç”¨springbootçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨jaråŒ…çš„æ–¹å¼è¿è¡Œé¡¹ç›®ï¼Œä¹Ÿå¯ä»¥å°†springbooté¡¹ç›®æ‰“æˆwaråŒ…ä½¿ç”¨ã€‚springboot waråŒ…è¿è¡Œå¯èƒ½ä¼šå‡ºç°</p><pre class="line-numbers language-shell"><code class="language-shell">&nbsp;[localhost-startStop-1] DEBUG org.springframework.jndi.JndiLocatorDelegate - Converted JNDI name [java:comp/env/LOGGING.pattern_level] not found - trying original name [LOGGING.pattern_level]. javax.naming.NameNotFoundException: Name [LOGGING.pattern_level] is not bound in this Context. Unable to find [LOGGING.pattern_level]ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åæ­£å°±æ˜¯è¯¸å¦‚æ­¤ç±»çš„é—®é¢˜å§ã€‚</p><p>ä¸Šè¿°çš„é—®é¢˜ï¼Œåœ¨é«˜ç‰ˆæœ¬çš„spring bootä¸­ä¼šå‡ºç°çš„ï¼Œä½ç‰ˆæœ¬ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚å› ä¸ºé«˜ç‰ˆæœ¬ä¸­å¼•å…¥äº†JNDIæŸ¥è¯¢çš„æ“ä½œã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­æ–°å»º<code>spring.properties</code>é…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/loading.gif" data-original="/images/java/springboot/spring.properties.png" alt="spring.properties"></p><p>æ·»åŠ å±æ€§ä»¥åŠå€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">spring.jndi.ignore=true<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŸç†:</p><p>æ‰“å¼€<code>StandardServletEnvironment</code>ç±»ï¼Œè¯¥ç±»ä¸­çš„<code>customizePropertySources</code>æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String JNDI_PROPERTY_SOURCE_NAME <span class="token operator">=</span> <span class="token string">"jndiProperties"</span><span class="token punctuation">;</span><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">customizePropertySources</span><span class="token punctuation">(</span>MutablePropertySources propertySources<span class="token punctuation">)</span> <span class="token punctuation">{</span>propertySources<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StubPropertySource</span><span class="token punctuation">(</span>SERVLET_CONFIG_PROPERTY_SOURCE_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>propertySources<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StubPropertySource</span><span class="token punctuation">(</span>SERVLET_CONTEXT_PROPERTY_SOURCE_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>JndiLocatorDelegate<span class="token punctuation">.</span><span class="token function">isDefaultJndiEnvironmentAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>propertySources<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JndiPropertySource</span><span class="token punctuation">(</span>JNDI_PROPERTY_SOURCE_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">customizePropertySources</span><span class="token punctuation">(</span>propertySources<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>JndiLocatorDelegate<span class="token punctuation">.</span><span class="token function">isDefaultJndiEnvironmentAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ä»£ç å¦‚ä¸‹ï¼š<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String IGNORE_JNDI_PROPERTY_NAME <span class="token operator">=</span> <span class="token string">"spring.jndi.ignore"</span><span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> shouldIgnoreDefaultJndiEnvironment <span class="token operator">=</span>SpringProperties<span class="token punctuation">.</span><span class="token function">getFlag</span><span class="token punctuation">(</span>IGNORE_JNDI_PROPERTY_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isDefaultJndiEnvironmentAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å¦‚æœå¿½ç•¥jndiåˆ™è¿”å›false</span><span class="token keyword">if</span> <span class="token punctuation">(</span>shouldIgnoreDefaultJndiEnvironment<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>                  <span class="token comment" spellcheck="true">//å‡†å¤‡jndiç¯å¢ƒ</span>        <span class="token keyword">new</span> <span class="token class-name">InitialContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ä¸Šæ–‡å¯çŸ¥ï¼š</p><p>1ã€å¦‚æœæˆ‘ä»¬éœ€è¦å¿½ç•¥jndiåˆ™å¯ä»¥é…ç½®<code>spring.jndi.ignore</code>å€¼ä¸ºtrueå³å¯ã€‚</p><p>2ã€åœ¨å“ªé‡Œé…ç½®å‘¢ï¼Ÿæˆ‘ä»¬ä¸å¦¨è·Ÿè¿›<code>SpringProperties</code>ç±»ä¸­çš„getFlagæ–¹æ³•ã€‚</p><p>spring.jndi.ignoreè·å–åŸç†</p><p>SpringPropertiesç±»çš„getFlagæ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">getFlag</span><span class="token punctuation">(</span>String key<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> Boolean<span class="token punctuation">.</span><span class="token function">parseBoolean</span><span class="token punctuation">(</span><span class="token function">getProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç»§ç»­è·Ÿè¿›getPropertyæ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">getProperty</span><span class="token punctuation">(</span>String key<span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token comment" spellcheck="true">//è·å–spring.jndi.ignoreå€¼</span>String value <span class="token operator">=</span> localProperties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//è·å–ç³»ç»Ÿçš„å˜é‡</span>    value <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> value<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šè¿°çš„æ–¹æ³•å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š</p><p>ä»localPropertiesé›†åˆä¸­è·å–<code>spring.jndi.ignore</code>å±æ€§ï¼Œå¦‚æœæ²¡æœ‰è·å–åˆ°åˆ™ç›´æ¥ä»ç¯å¢ƒå˜é‡ä¸­è¿›è¡Œè·å–ã€‚localPropertiesé›†åˆåœ¨å“ªé‡Œåˆå§‹åŒ–çš„å‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸‹SpringPropertiesç±»ä¸­çš„é™æ€ä»£ç å—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String PROPERTIES_RESOURCE_LOCATION <span class="token operator">=</span> <span class="token string">"spring.properties"</span><span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token punctuation">{</span><span class="token keyword">try</span> <span class="token punctuation">{</span>    ClassLoader cl <span class="token operator">=</span> SpringProperties<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    URL url <span class="token operator">=</span> <span class="token punctuation">(</span>cl <span class="token operator">!=</span> null <span class="token operator">?</span> cl<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span>PROPERTIES_RESOURCE_LOCATION<span class="token punctuation">)</span> <span class="token operator">:</span>ClassLoader<span class="token punctuation">.</span><span class="token function">getSystemResource</span><span class="token punctuation">(</span>PROPERTIES_RESOURCE_LOCATION<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Found 'spring.properties' file in local classpath"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        InputStream is <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">openStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            localProperties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">finally</span> <span class="token punctuation">{</span>            is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹åˆ°ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬æ˜ç™½äº†ï¼ŒåŸæ¥è¿™é‡Œæ˜¯ç›´æ¥è¯»å–è·Ÿç›®å½•ä¸­çš„spring.propertiesæ–‡ä»¶ä¸­çš„æ‰€æœ‰å±æ€§ã€‚çœ‹åˆ°è¿™é‡Œï¼Œç„•ç„¶å¤§æ‚Ÿã€‚åŸæ¥å¦‚æ­¤ã€‚</p><ul><li>è°ƒè¯•ä¸­ï¼Œæˆ‘ä¿®æ”¹äº†<code>application.yml</code>æˆ–è€…<code>application-dev.yml</code>é…ç½®æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­åŠ å…¥äº†<code>spring.jndi.ignore=true</code>å‡ä¸ºç”Ÿæ•ˆï¼Œå¿…é¡»æ–°å»ºä¸€ä¸ª<code>spring.properties</code>ï¼Œæˆ‘æ²¡æœ‰éªŒè¯<code>spring.yml</code>è¡Œä¸è¡Œã€‚</li></ul><p>é‡å¯tomcatå®¹å™¨ï¼Œæ²¡æœ‰jndiçš„è­¦å‘Šæ—¥å¿—äº†ã€‚</p><p>æ³¨æ„ï¼šè¿™ç§æ—¥å¿—å¦‚æœåœ¨æœ¬åœ°ä»¥ç›´æ¥è¿è¡Œspringbootçš„å…¥å£æ–‡ä»¶çš„æ–¹å¼å¯åŠ¨ï¼Œæ˜¯æ²¡æœ‰çš„ï¼Œåªæœ‰å½“æ‰“æˆwaråŒ…ï¼Œæ”¾åœ¨tomcaté‡Œï¼Œå¯åŠ¨<code>tomcat/bin/startup.sh</code>æ—¶æ‰ä¼šæœ‰ã€‚</p><p>ç»è¿‡å‡ æ­¥ä¿®æ”¹ï¼Œtomcatå¯åŠ¨é€Ÿåº¦æ˜æ˜¾æé«˜ã€‚</p><p>éƒ¨ç½²æ…¢ä¿®æ”¹åŸæ–‡ï¼š<a href="https://www.cnblogs.com/mycifeng/p/6972446.html">https://www.cnblogs.com/mycifeng/p/6972446.html</a><br>ç¦ç”¨jndiæ–¹å¼åŸæ–‡ï¼š<a href="https://blog.csdn.net/qq_30739519/article/details/78536965">https://blog.csdn.net/qq_30739519/article/details/78536965</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
            <tag> server </tag>
            
            <tag> tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>reactJSé¡¹ç›®buildæ—¶å‘ç”Ÿâ€œv8::internal::V8::FatalProcessOutOfMemoryâ€å¼‚å¸¸</title>
      <link href="2018/07/07/reactjs-xiang-mu-build-shi-fa-sheng-v8-internal-v8-fatalprocessoutofmemory-yi-chang/"/>
      <url>2018/07/07/reactjs-xiang-mu-build-shi-fa-sheng-v8-internal-v8-fatalprocessoutofmemory-yi-chang/</url>
      
        <content type="html"><![CDATA[<p>jenkinsä¸Šbuild Ant design Proç®¡ç†åå°é¡¹ç›®æ—¶å†…å­˜æº¢å‡ºå¼‚å¸¸è§£å†³<br><a href="https://www.jianshu.com/p/9c531b065018">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="ç°è±¡"><a href="#ç°è±¡" class="headerlink" title="ç°è±¡"></a>ç°è±¡</h2><p>æœ€è¿‘å·¥ç¨‹é‡Œæœ‰ä¸ªç”¨<a href="https://pro.ant.design/index-cn">Ant Design Pro</a>æ­å»ºçš„å‰åç«¯åˆ†ç¦»çš„åå°ç®¡ç†ç³»ç»Ÿï¼Œä¸€ç›´ä½¿ç”¨jenkinsè‡ªåŠ¨éƒ¨ç½²çš„ï¼Œä½†æ˜¯ä»Šå¤©ä¸€ä¸å°å¿ƒbuildå¤±è´¥äº†ã€‚è™½ç„¶å¾ˆå¿«å°±æå®šäº†ï¼Œä½†æ˜¯è¿˜æ˜¯è®°å½•ä¸€ä¸‹ï¼Œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ã€‚</p><h2 id="é—®é¢˜å‡ºç°"><a href="#é—®é¢˜å‡ºç°" class="headerlink" title="é—®é¢˜å‡ºç°"></a>é—®é¢˜å‡ºç°</h2><p>æ„å»ºå¤±è´¥ä¿¡æ¯æ˜¯è¿™æ ·çš„ï¼š</p><pre class="line-numbers language-log"><code class="language-log"><pre class="console-output" style="box-sizing: border-box; white-space: pre-wrap; word-wrap: break-word; margin: 0px; color: rgb(51, 51, 51); font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Started by user [è¶…çº§ç®¡ç†å‘˜](http://jenkins.haier.haiqiang.xin:7776/user/admin)Building in workspace /var/lib/jenkins/workspace/chuangke_pre_portal_web_auto_deploy > git rev-parse --is-inside-work-tree # timeout=10Fetching changes from the remote Git repository > git config remote.origin.url git@git.3vyd.com:portalmanage.git # timeout=10Fetching upstream changes from git@git.3vyd.com:portalmanage.git > git --version # timeout=10 > git fetch --tags --progress git@git.3vyd.com:portalmanage.git +refs/heads/*:refs/remotes/origin/* > git rev-parse refs/remotes/origin/master^{commit} # timeout=10 > git rev-parse refs/remotes/origin/origin/master^{commit} # timeout=10Checking out Revision c9a9d48ae6453a8d84734920f8718abec5598f2a (refs/remotes/origin/master) > git config core.sparsecheckout # timeout=10 > git checkout -f c9a9d48ae6453a8d84734920f8718abec5598f2aCommit message: "ç›´æ’­ç»Ÿè®¡" > git rev-list --no-walk 34ede46c51b5a223746b1c07d0845952d7d0eefd # timeout=10[chuangke_pre_portal_web_auto_deploy] $ /bin/sh -xe /tmp/jenkins1426166608252484443.sh+ yarnyarn install v1.3.2[1/4] Resolving packages...success Already up-to-date.Done in 2.31s.+ REACT_APP_BRANCH=PRE+ yarn buildyarn run v1.3.2$ node scripts/build.jsCreating an optimized production build...<--- Last few GCs --->  780502 ms: Mark-sweep 1323.4 (1408.7) -> 1317.3 (1408.7) MB, 955.6 / 0.0 ms [allocation failure] [GC in old space requested].  781304 ms: Mark-sweep 1317.3 (1408.7) -> 1317.3 (1410.7) MB, 802.4 / 0.0 ms [allocation failure] [GC in old space requested].  782171 ms: Mark-sweep 1317.3 (1410.7) -> 1326.8 (1403.7) MB, 866.5 / 0.0 ms [last resort gc].  782958 ms: Mark-sweep 1326.8 (1403.7) -> 1336.9 (1403.7) MB, 787.3 / 0.0 ms [last resort gc].<--- JS stacktrace --->==== JS stack trace =========================================Security context: 0x1116596cf781 <JS Object>    1: stringify [native json.js:~176] [pc=0x1ab7d7e562d3] (this=0x1116596c92a1 <a JSON with map 0xa5d18e09b09>,E=0x27fe2de64711 <an Object with map 0x23d396b32619>,F=0x111659604381 <undefined>,S=0x111659604381 <undefined>)    2: arguments adaptor frame: 1->3    3: /* anonymous */(aka /* anonymous */) [/var/lib/jenkins/workspace/chuangke_pre_portal_web_auto_deploy/node_modules/webpack/lib/Sou...FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out of memory 1: node::Abort() [node] 2: 0xdf1d9c [node] 3: v8::Utils::ReportApiFailure(char const*, char const*) [node] 4: v8::internal::V8::FatalProcessOutOfMemory(char const*, bool) [node] 5: v8::internal::Factory::NewRawTwoByteString(int, v8::internal::PretenureFlag) [node] 6: v8::internal::String::SlowFlatten(v8::internal::Handle<v8::internal::ConsString>, v8::internal::PretenureFlag) [node] 7: v8::internal::String::Flatten(v8::internal::Handle<v8::internal::String>, v8::internal::PretenureFlag) [node] 8: v8::internal::BasicJsonStringifier::SerializeString(v8::internal::Handle<v8::internal::String>) [node] 9: v8::internal::BasicJsonStringifier::Result v8::internal::BasicJsonStringifier::Serialize_<false>(v8::internal::Handle<v8::internal::Object>, bool, v8::internal::Handle<v8::internal::Object>) [node]10: v8::internal::BasicJsonStringifier::SerializeJSArraySlow(v8::internal::Handle<v8::internal::JSArray>, unsigned int, unsigned int) [node]11: v8::internal::BasicJsonStringifier::Result v8::internal::BasicJsonStringifier::Serialize_<true>(v8::internal::Handle<v8::internal::Object>, bool, v8::internal::Handle<v8::internal::Object>) [node]12: v8::internal::BasicJsonStringifier::Result v8::internal::BasicJsonStringifier::Serialize_<false>(v8::internal::Handle<v8::internal::Object>, bool, v8::internal::Handle<v8::internal::Object>) [node]13: v8::internal::BasicJsonStringifier::Stringify(v8::internal::Handle<v8::internal::Object>) [node]14: v8::internal::Runtime_BasicJSONStringify(int, v8::internal::Object**, v8::internal::Isolate*) [node]15: 0x1ab7ca0092a7error Command failed with signal "SIGABRT".info Visit [https://yarnpkg.com/en/docs/cli/run](https://yarnpkg.com/en/docs/cli/run) for documentation about this command.Build step 'Execute shell' marked build as failureSending e-mails to: marvin.ma@3vyd.com damon.shen@3vyd.comFinished: FAILURE</pre><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="è§£å†³æ€è·¯"><a href="#è§£å†³æ€è·¯" class="headerlink" title="è§£å†³æ€è·¯"></a>è§£å†³æ€è·¯</h2><p>1ã€JenkinsæœåŠ¡å™¨ç³»ç»Ÿå†…å­˜ä¸å¤Ÿ<br>çœ‹äº†çœ‹jenkinsæ‰€åœ¨æœåŠ¡å™¨çš„å†…å­˜ï¼Œåœ¨jenkinsæ‰§è¡Œè¿™ä¸ªjobçš„æ—¶å€™ï¼Œå†…å­˜æœ€é«˜ä¹Ÿå°±140%ï¼Œå› ä¸ºæœåŠ¡å™¨æ˜¯Centos 4æ ¸16Gçš„é…ç½®ï¼Œç”¨freeæŸ¥çœ‹ï¼Œå¯ç”¨å†…å­˜ä»ç„¶9Gå¤šã€‚å½“æ—¶æ²¡æœ‰æˆªå›¾ï¼Œæ‰€ä»¥å°±ä¸è´´å›¾äº†ï¼Œä½†æ˜¯è‚¯å®šä¸æ˜¯è¯´æœåŠ¡å™¨å†…å­˜åƒç´§å¯¼è‡´çš„ã€‚</p><p>2ã€æ’é™¤äº†æœåŠ¡å™¨æœ¬èº«å†…å­˜å°çš„é—®é¢˜ï¼Œè€ƒè™‘æœ¬æ¬¡buildæ–°è¿›çš„ä»£ç çš„é—®é¢˜ï¼Œçœ‹äº†ä¸€ä¸‹å°±ä¸¤ä¸ªcommitï¼Œå› ä¸ºç½‘ä¸Šæœ‰è¯´æ˜¯è°ƒç”¨file.writeçš„æ—¶å€™å¤„ç†ä¸å½“ï¼Œä¼šå¯¼è‡´è¯¥é—®é¢˜çš„äº§ç”Ÿçš„ï¼Œæ­£å¥½æœ¬æ¬¡buildæœ‰ä¸€ä¸ªcommitæ˜¯æ·»åŠ äº†å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ã€‚<br>ä½†æ˜¯æ£€æŸ¥ä¸€åœˆå¥½åƒæ²¡æœ‰é—®é¢˜ã€‚</p><p>3ã€æ¡†æ¶é—®é¢˜ï¼Œé™åˆ¶äº†å†…å­˜ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>æœ€åé€šè¿‡<a href="https://stackoverflow.com/questions/38558989/node-js-heap-out-of-memory%E4%B8%80%E6%96%87%E6%89%BE%E5%88%B0%E4%BA%86%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E3%80%82%E5%85%88%E5%81%9A%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%E5%B0%9D%E8%AF%95%EF%BC%8C%E4%BF%AE%E6%94%B9%E8%AF%A5job%E7%9A%84build%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%B0%86%E5%8E%9F%E6%9D%A5%E7%9A%84">https://stackoverflow.com/questions/38558989/node-js-heap-out-of-memoryä¸€æ–‡æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆã€‚å…ˆåšæœ¬åœ°éƒ¨ç½²å°è¯•ï¼Œä¿®æ”¹è¯¥jobçš„buildå‘½ä»¤ï¼Œå°†åŸæ¥çš„</a></p><blockquote><p>yarn<br>REACT_APP_BRANCH=PRE yarn build</p></blockquote><p>æ”¹æˆäº†</p><blockquote><p>yarn<br>REACT_APP_BRANCH=PRE node â€“max-old-space-size=4096 scripts/build.js</p></blockquote><p><img src="/loading.gif" data-original="/images/fontend/rn-build-shell.png" alt="jenkins build shell"></p><p>é‡æ–°buildï¼Œsuccessã€‚</p><p>ç„¶åå› ä¸ºè¯¥é¡¹ç›®åˆ†å¼€å‘ï¼Œæµ‹è¯•ã€ç”Ÿäº§ç­‰å¤šä¸ªç¯å¢ƒï¼Œå› æ­¤æ‰“ç®—åœ¨ä»£ç æ¡†æ¶é‡Œç›´æ¥ä½œä¸ºé…ç½®é¡¹ï¼Œå…·ä½“çš„åšæ³•æ˜¯åœ¨package.jsonçš„buildå‘½ä»¤å‰åŠ ä¸ŠæŒ‡å®šå†…å­˜çš„å‚æ•°<code>--max-old-space-size=4096</code>ã€‚å°†åŸæ¥çš„ï¼š</p><pre class="line-numbers language-json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"node scripts/start.js"</span><span class="token punctuation">,</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"node scripts/build.js"</span><span class="token punctuation">,</span>    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"node scripts/test.js --env=jsdom"</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹ä¸ºï¼š</p><pre class="line-numbers language-json"><code class="language-json">  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"node scripts/start.js"</span><span class="token punctuation">,</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"node --max-old-space-size=4096 scripts/build.js"</span><span class="token punctuation">,</span>    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"node scripts/test.js --env=jsdom"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æäº¤ä»£ç ï¼Œjenkinsä¿®æ”¹å›åŸæ¥çš„<code>yarn start</code>ï¼Œé‡æ–°buildï¼Œ SUCCESSã€‚<br>ä¸€åŠ³æ°¸é€¸ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jenkins </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tcpdumpæŠ“åŒ…å¹¶ç”¨WireSharkè¿›è¡Œæ•°æ®åˆ†æ</title>
      <link href="2018/07/07/tcpdump-zhua-bao-bing-yong-wireshark-jin-xing-shu-ju-fen-xi/"/>
      <url>2018/07/07/tcpdump-zhua-bao-bing-yong-wireshark-jin-xing-shu-ju-fen-xi/</url>
      
        <content type="html"><![CDATA[<p>åœ¨linuxä¸Šä½¿ç”¨tcpdumpæŠ“å–http/tcpæŠ¥æ–‡ï¼Œä½¿ç”¨WireSharkè¿›è¡Œå‚æ•°åˆ†æã€‚<br><a href="https://www.jianshu.com/p/4af0d0fe5624">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="1ã€ä½¿ç”¨èƒŒæ™¯"><a href="#1ã€ä½¿ç”¨èƒŒæ™¯" class="headerlink" title="1ã€ä½¿ç”¨èƒŒæ™¯"></a>1ã€ä½¿ç”¨èƒŒæ™¯</h2><p>æœ€è¿‘åœ¨é¡¹ç›®å¼€å‘æ—¶é‡åˆ°ä¸€ç§æƒ…å†µï¼Œå†™çš„æ¥å£å‰ç«¯åŒäº‹åé¦ˆæ˜¯400ï¼Œåç«¯åŒäº‹è®¤ä¸ºhttp status æ˜¯4å¼€å¤´çš„ï¼Œè‚¯å®šæ˜¯å‰ç«¯çš„é—®é¢˜ï¼Œå‰ç«¯çš„åŒäº‹åˆä¸çŸ¥é“æ¥å£æ˜¯æ€ä¹ˆå†™çš„ï¼Œéœ€è¦ä¼ çš„å‚æ•°ä¹Ÿä¼ äº†ï¼Œä½†æ˜¯å°±æ˜¯400ï¼Œé‚£ä¹ˆä½œä¸ºè´Ÿè´£äººï¼Œä¸èƒ½ä»»ç”±ä¸¤è¾¹è¸¢çš®çƒå§ï¼Œå¾—æ‹¿å‡ºä¸ªæ–¹æ¡ˆçœ‹çœ‹ä¸ºå•¥400ã€‚<br>å½“ç„¶tacpdumpè¿™æ¬¾å¼ºå¤§çš„æŠ“åŒ…å·¥å…·ä¸åªæ˜¯ç”¨ä½¿ç”¨è§£å†³æˆ‘è¿™ä¸ªå¾ˆlowçš„é—®é¢˜ï¼Œæˆ‘çš„åœºæ™¯å¦‚æœæ˜¯å‰åç«¯é…åˆå¾—å½“çš„è¯ï¼Œæˆ–è€…å·²æœ‰é»˜å¥‘çš„è¯ï¼Œæ›´å¥½ç‚¹ï¼Œå¦‚æœæœ‰æ–‡æ¡£ï¼Œå°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜äº†ã€‚åºŸè¯å°‘è¯´ï¼Œç›´æ¥è¯´æ€ä¹ˆåšçš„å§ã€‚<br>æœ€åé€‰æ‹©linuxæœåŠ¡å™¨ä¸ŠæŠ“å¥½æŠ¥æ–‡ï¼Œç”¨WireSharkè¿™æ¬¾å¼ºå¤§çš„æŠ“åŒ…å·¥å…·æ¥åˆ†æä¸€ä¸‹å•¦ã€‚</p><h2 id="å·¥å…·ä»‹ç»"><a href="#å·¥å…·ä»‹ç»" class="headerlink" title="å·¥å…·ä»‹ç»"></a>å·¥å…·ä»‹ç»</h2><ul><li><p>Wiresharkæ˜¯ä¸€ä¸ªç½‘ç»œåè®®æ£€æµ‹å·¥å…·ï¼Œæ”¯æŒWindowså¹³å°å’ŒUnixå¹³å°ï¼Œæˆ‘ä¸€èˆ¬åªåœ¨Windowså¹³å°ä¸‹ä½¿ç”¨Wiresharkï¼Œå¦‚æœæ˜¯Linuxçš„è¯ï¼Œæˆ‘ç›´æ¥ç”¨tcpdumpäº†ï¼Œå› ä¸ºæˆ‘å·¥ä½œç¯å¢ƒä¸­çš„Linuxä¸€èˆ¬åªæœ‰å­—ç¬¦ç•Œé¢ï¼Œä¸”ä¸€èˆ¬è€Œè¨€Linuxéƒ½è‡ªå¸¦çš„tcpdumpï¼Œæˆ–è€…ç”¨tcpdumpæŠ“åŒ…ä»¥åç”¨Wiresharkæ‰“å¼€åˆ†æã€‚<br>åœ¨Windowså¹³å°ä¸‹ï¼ŒWiresharké€šè¿‡WinPcapè¿›è¡ŒæŠ“åŒ…ï¼Œå°è£…çš„å¾ˆå¥½ï¼Œä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„åˆ¶å®šæŠ“åŒ…è¿‡æ»¤å™¨æˆ–è€…æ˜¾ç¤ºè¿‡æ»¤å™¨ï¼Œå…·ä½“åœ¨ä¸‹é¢ä»‹ç»ã€‚Wiresharkæ˜¯ä¸€ä¸ªå…è´¹çš„å·¥å…·ï¼Œåªè¦googleä¸€ä¸‹å°±èƒ½å¾ˆå®¹æ˜“æ‰¾åˆ°ä¸‹è½½çš„åœ°æ–¹ã€‚</p></li><li><p>tcpdumpæ˜¯åŸºäºUnixç³»ç»Ÿçš„å‘½ä»¤è¡Œå¼çš„æ•°æ®åŒ…å—…æ¢å·¥å…·ã€‚å¦‚æœè¦ä½¿ç”¨tcpdumpæŠ“å–å…¶ä»–ä¸»æœºMACåœ°å€çš„æ•°æ®åŒ…ï¼Œå¿…é¡»å¼€å¯ç½‘å¡æ··æ‚æ¨¡å¼ï¼Œæ‰€è°“æ··æ‚æ¨¡å¼ï¼Œç”¨æœ€ç®€å•çš„è¯­è¨€å°±æ˜¯è®©ç½‘å¡æŠ“å–ä»»ä½•ç»è¿‡å®ƒçš„æ•°æ®åŒ…ï¼Œä¸ç®¡è¿™ä¸ªæ•°æ®åŒ…æ˜¯ä¸æ˜¯å‘ç»™å®ƒæˆ–è€…æ˜¯å®ƒå‘å‡ºçš„ï¼Œç‚¹å‡»ã€<a href="http://en.wikipedia.org/wiki/Promiscuous_mode">http://en.wikipedia.org/wiki/Promiscuous_mode</a>ã€‘è·å–æ›´å¤šæœ‰å…³æ··æ‚æ¨¡å¼çš„èµ„æ–™ã€‚ä¸€èˆ¬è€Œè¨€ï¼ŒUnixä¸ä¼šè®©æ™®é€šç”¨æˆ·è®¾ç½®æ··æ‚æ¨¡å¼ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥çœ‹åˆ°åˆ«äººçš„ä¿¡æ¯ï¼Œæ¯”å¦‚telnetçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œè¿™æ ·ä¼šå¼•èµ·ä¸€äº›å®‰å…¨ä¸Šçš„é—®é¢˜ï¼Œæ‰€ä»¥åªæœ‰rootç”¨æˆ·å¯ä»¥å¼€å¯æ··æ‚æ¨¡å¼ï¼Œå¼€å¯æ··æ‚æ¨¡å¼çš„å‘½ä»¤æ˜¯ï¼šifconfig eth0 promisc, eth0æ˜¯ä½ è¦æ‰“å¼€æ··æ‚æ¨¡å¼çš„ç½‘å¡ã€‚è‚¯å®šæœ‰äººè¦é—®å¦‚æœåœ¨windowsä¸‹è¦ä¸è¦æ‰“å¼€æ··æ‚æ¨¡å¼ï¼Œwindowsä¸‹ç½‘å¡æ²¡æœ‰ä»€ä¹ˆæ··æ‚æ¨¡å¼ä¸æ··æ‚æ¨¡å¼ï¼Œåœ¨äºåº”ç”¨ç¨‹åºæœ¬èº«ï¼Œå¦‚ä½¿ç”¨WiresharkæŠ“åŒ…çš„æ—¶å€™å¯ä»¥é€šè¿‡è®¾ç½®ä¸ºåœ¨æ··æ‚æ¨¡å¼ä¸‹æŠ“åŒ…ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¯¥æ­»çš„ARPæ¬ºéª—ç—…æ¯’å¯ä»¥çŒ–ç‹‚çš„åŸå› ï¼‰ã€‚<br>tcpdumpå½“ç„¶ä¹Ÿå¯ä»¥æŒ‡å®šæŠ“åŒ…è¿‡æ»¤å™¨ï¼Œè€Œä¸”å…¶è¿‡æ»¤å™¨è¯­è¨€éå¸¸è‘—åï¼Œå«åšBerkeleyåŒ…è¿‡æ»¤ï¼Œç®€ç§°BPFè¯­è¨€ã€‚</p></li></ul><h2 id="2ã€å®é™…æ“ä½œ"><a href="#2ã€å®é™…æ“ä½œ" class="headerlink" title="2ã€å®é™…æ“ä½œ"></a>2ã€å®é™…æ“ä½œ</h2><p>å®é™…æ“ä½œè¿‡ç¨‹å› ä¸ºæˆ‘ä½œä¸ºåç«¯å·¥ç¨‹å¸ˆï¼Œæ²¡æœ‰å‰ç«¯ç¯å¢ƒï¼Œå› æ­¤ç”¨æˆ‘æœ¬åœ°æ¥å£è°ƒè¯•ç¥å¥‡postmanæ¥æ¨¡æ‹Ÿå‰ç«¯ã€‚<br>æœåŠ¡ç«¯æœ‰ä¸€ä¸ªæ¥å£æ˜¯è¿™æ ·çš„ï¼š</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"tests"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> RtnResult<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token function">testPost</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> DataVo vo<span class="token punctuation">)</span> <span class="token punctuation">{</span>        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"post data:{}"</span> <span class="token punctuation">,</span> JSONObject<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>vo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RtnResult</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"ä¿å­˜æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”¨postmanæœ¬åœ°æµ‹è¯•ï¼Œæ•…æ„ä¸ä¼ å‚æ•°ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š<br><img src="/loading.gif" data-original="/images/tools/tcpdump-postman.png" alt="å‚æ•°é”™è¯¯400çš„åœºæ™¯"><br>æ¥ä¸‹æ¥ï¼ŒæŠ“åŒ…æŸ¥çœ‹ã€‚</p><h3 id="2-1ã€å‡†å¤‡å·¥ä½œ"><a href="#2-1ã€å‡†å¤‡å·¥ä½œ" class="headerlink" title="2.1ã€å‡†å¤‡å·¥ä½œ"></a>2.1ã€å‡†å¤‡å·¥ä½œ</h3><ul><li>å…ˆçœ‹çœ‹è‡ªå·±æœ¬åœ°çš„ipï¼Œæœ‰ä¸ªæ¯”è¾ƒå‘çš„åœ°æ–¹ï¼Œå°±æ˜¯ä¸è¦æƒ³å½“ç„¶çš„è®¤ä¸ºåœ¨æœ¬åœ°å‘½ä»¤è¡Œipconfigæˆ–è€…ifconfigæŸ¥çœ‹åˆ°çš„å°±æ˜¯æ‰€è°“çš„æœ¬åœ°ipï¼Œè¦çœ‹å¤–ç½‘å‡ºå»çš„å¯¹å…¬IPåœ°å€ã€‚æ¯”å¦‚<a href="http://www.ip138.com/">http://www.ip138.com/</a>è¿™ä¸ªç½‘ç«™å¯ä»¥å°±å¯ä»¥äº§çœ‹æœ¬åœ°ipï¼Œå¯ä»¥è¯•è¯•ï¼Œä¸¤ç§æ–¹å¼å¾—åˆ°çš„ipåœ°å€æ˜¯ä¸ä¸€æ ·çš„ã€‚</li></ul><p><img src="/loading.gif" data-original="/images/tools/tcpdumu-local-ip.png" alt="æˆ‘çš„æœ¬åœ°IPåœ°å€"></p><ul><li>ç¡®ä¿æœåŠ¡å™¨å®‰è£…äº†tcpdumpï¼Œä¸€èˆ¬linuxéƒ½è‡ªå¸¦äº†è¿™ä¸ªå‘½ä»¤ï¼Œå¦‚æœæ²¡æœ‰çš„è‡ªè¡Œç™¾åº¦å®‰è£…ã€‚</li><li>ç¡®å®šæœåŠ¡å™¨çš„ç½‘å¡å·ï¼Œä¸€èˆ¬é»˜è®¤æ˜¯eth0ã€‚<h3 id="2-2ã€æŠ“å–æœåŠ¡ç«¯æŠ¥æ–‡"><a href="#2-2ã€æŠ“å–æœåŠ¡ç«¯æŠ¥æ–‡" class="headerlink" title="2.2ã€æŠ“å–æœåŠ¡ç«¯æŠ¥æ–‡"></a>2.2ã€æŠ“å–æœåŠ¡ç«¯æŠ¥æ–‡</h3>ä¾‹å¦‚æˆ‘æˆªå–æœ¬æœº<code> 112.224.67.134</code>å’Œä¸»æœº<code>39.106.35.56</code>ä¹‹é—´çš„æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨<code>39.106.35.56</code>çš„ä»»æ„ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</li></ul><pre class="line-numbers language-shell"><code class="language-shell">[root@dev ~]# tcpdump -A -i eth0 -w dump-file1 host 112.224.67.134tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åœ¨æœ¬åœ°ç”¨postè¯·æ±‚æœåŠ¡å™¨çš„æ¥å£<br><img src="/loading.gif" data-original="/images/tools/tcpdump-postman-api.png" alt="9.png"></p><p>Ctrl+Cåœæ­¢ä¿å­˜æŠ“åŒ…ï¼ŒæŠ¥æ–‡å†…å®¹ä¿å­˜åœ¨dump-file1æ–‡ä»¶å†…</p><pre class="line-numbers language-shell"><code class="language-shell">[root@dev ~]# tcpdump -A -i eth0 -w dump-file1 host 112.224.67.134tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes^C24 packets captured25 packets received by filter0 packets dropped by kernel[root@dev ~]# lltotal 4-rw-r--r-- 1 tcpdump tcpdump 2880 Jul  3 14:05 dump-file1[root@dev ~]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥ä½¿ç”¨<code>tcpdump -r dump-file1</code>å‘½ä»¤æŸ¥çœ‹</p><pre class="line-numbers language-shell"><code class="language-shell">[root@dev ~]# tcpdump -r dump-file1 reading from file dump-file1, link-type EN10MB (Ethernet)14:04:30.636260 IP dev.ssh > 112.224.67.134.26919: Flags [P.], seq 332116900:332116952, ack 3962938602, win 255, length 5214:04:30.661616 IP dev.ssh > 112.224.67.134.26919: Flags [P.], seq 52:184, ack 1, win 255, length 13214:04:30.710115 IP 112.224.67.134.26919 > dev.ssh: Flags [.], ack 184, win 66, length 014:04:49.658756 IP 112.224.67.134.26920 > dev.ssh: Flags [P.], seq 3449703456:3449703492, ack 3469026640, win 64, length 3614:04:49.698057 IP dev.ssh > 112.224.67.134.26920: Flags [.], ack 36, win 255, length 014:05:04.771846 IP 112.224.67.134.58166 > dev.d-s-n: Flags [S], seq 3379667287, win 17520, options [mss 1400,nop,wscale 8,nop,nop,sackOK], length 014:05:04.771914 IP dev.d-s-n > 112.224.67.134.58166: Flags [S.], seq 2331290743, ack 3379667288, win 29200, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 014:05:04.811492 IP 112.224.67.134.58166 > dev.d-s-n: Flags [.], ack 1, win 68, length 014:05:04.820465 IP 112.224.67.134.58166 > dev.d-s-n: Flags [P.], seq 1:415, ack 1, win 68, length 41414:05:04.820496 IP dev.d-s-n > 112.224.67.134.58166: Flags [.], ack 415, win 237, length 014:05:04.824051 IP dev.d-s-n > 112.224.67.134.58166: Flags [P.], seq 1:354, ack 415, win 237, length 35314:05:04.824297 IP dev.d-s-n > 112.224.67.134.58166: Flags [P.], seq 354:359, ack 415, win 237, length 514:05:04.871458 IP 112.224.67.134.58166 > dev.d-s-n: Flags [.], ack 359, win 67, length 014:05:05.911468 IP 112.224.67.134.58166 > dev.d-s-n: Flags [.], seq 414:415, ack 359, win 67, length 114:05:05.911526 IP dev.d-s-n > 112.224.67.134.58166: Flags [.], ack 415, win 237, options [nop,nop,sack 1 {414:415}], length 014:05:06.951486 IP 112.224.67.134.58166 > dev.d-s-n: Flags [.], seq 414:415, ack 359, win 67, length 114:05:06.951537 IP dev.d-s-n > 112.224.67.134.58166: Flags [.], ack 415, win 237, options [nop,nop,sack 1 {414:415}], length 014:05:08.011588 IP 112.224.67.134.58166 > dev.d-s-n: Flags [.], seq 414:415, ack 359, win 67, length 114:05:08.011644 IP dev.d-s-n > 112.224.67.134.58166: Flags [.], ack 415, win 237, options [nop,nop,sack 1 {414:415}], length 014:05:09.051406 IP 112.224.67.134.58166 > dev.d-s-n: Flags [.], seq 414:415, ack 359, win 67, length 114:05:09.051452 IP dev.d-s-n > 112.224.67.134.58166: Flags [.], ack 415, win 237, options [nop,nop,sack 1 {414:415}], length 014:05:10.091399 IP 112.224.67.134.58166 > dev.d-s-n: Flags [.], seq 414:415, ack 359, win 67, length 114:05:10.091451 IP dev.d-s-n > 112.224.67.134.58166: Flags [.], ack 415, win 237, options [nop,nop,sack 1 {414:415}], length 014:05:10.130248 IP 112.224.67.134.26919 > dev.ssh: Flags [P.], seq 1:53, ack 184, win 66, length 52[root@dev ~]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-2ã€ç”¨wiresharkåˆ†ææŠ¥æ–‡å†…å®¹"><a href="#2-2ã€ç”¨wiresharkåˆ†ææŠ¥æ–‡å†…å®¹" class="headerlink" title="2.2ã€ç”¨wiresharkåˆ†ææŠ¥æ–‡å†…å®¹"></a>2.2ã€ç”¨wiresharkåˆ†ææŠ¥æ–‡å†…å®¹</h3><p>äº†è§£tcpç½‘ç»œåè®®çš„ï¼Œçœ‹åˆ°ä»¥ä¸ŠæŠ¥æ–‡ï¼Œåº”è¯¥å·²ç»äº†è§£ä¸€äºŒäº†ã€‚<br>ä¸ºäº†å°†å…¶è½¬æ¢æˆå¸¸ç”¨çš„httpåè®®ï¼Œæˆ‘ä»¬ç”¨wiresharkè¿™æ¬¾å·¥å…·å†åˆ†æä¸€ä¸‹ã€‚<br>ä¸‹è½½è¯¥æ–‡ä»¶ï¼Œåœ¨windowsä¸Šå¯ä»¥ç›´æ¥å°†è¯¥æ–‡ä»¶æ‹–å…¥åˆ°wiresharkï¼Œä¼šè‡ªåŠ¨æ‰“å¼€ã€‚<br><img src="/loading.gif" data-original="/images/tools/tcpdump-wireshark.png" alt="tcpdumpæ–‡ä»¶åœ¨WireSharkä¸­æ‰“å¼€"></p><p>å¯ä»¥çœ‹åˆ°ä¸‰æ¬¡æ¡æ‰‹çš„å…·ä½“æŠ¥æ–‡ã€‚åŒæ—¶çœ‹åˆ°äº†ä¸€ä¸ªpostçš„http requestå’Œä¸€ä¸ªhttp statusä¸º200çš„http responseã€‚å³å‡»postè¯·æ±‚ï¼Œé€‰æ‹©ã€è¿½è¸ªæµã€‘-&gt;ã€TCPæµã€‘ï¼š</p><p><img src="/loading.gif" data-original="/images/tools/tcpdump-wireshark-response.png" alt="TCPæµæŸ¥çœ‹"><br>çœ‹åˆ°äº†å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°å’Œè¿”å›å€¼ã€‚</p><p>å½“ç„¶ï¼ŒæŸ¥çœ‹æœåŠ¡å™¨logï¼Œä¹Ÿçœ‹åˆ°äº†æ—¥å¿—ä¿¡æ¯</p><pre class="line-numbers language-shell"><code class="language-shell">2018-07-03 14:24:16.660  INFO 29004 --- [nio-8086-exec-6] com.hczt.shop.weixin.config.CorsFilter   : requesturi is : /weixin/tests2018-07-03 14:24:16.661  INFO 29004 --- [nio-8086-exec-6] c.h.s.weixin.controller.TestController   : post data:{"address":"å±±ä¸œé’å²›","age":28,"name":"å¼ ä¸‰","sex":"ç”·"}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™é‡Œæ¼”ç¤ºçš„æ­£å¸¸è¿”å›çš„ï¼Œå¦‚æœæ¥å£æ˜¯400ï¼ŒæœåŠ¡ç«¯ä¹Ÿå°±æ²¡æœ‰è¿™æ¡logï¼Œè¿™æ—¶å€™æŠ“åŒ…ä¹Ÿæ‰æ›´æœ‰æ„ä¹‰äº†ã€‚<br>åˆ°è¿™é‡Œï¼ŒåŸºæœ¬çš„ä½¿ç”¨å°±ä»‹ç»å®Œäº†ã€‚è‡³äºWireSharkåœ¨æœ¬åœ°æ€ä¹ˆä½¿ç”¨ï¼Œæ€ä¹ˆæ·»åŠ è¿‡æ»¤å™¨ç­‰ï¼ŒæŸ¥çœ‹å…¶å®ƒåšæ–‡å­¦ä¹ ã€‚</p><h2 id="3ã€æ¨è"><a href="#3ã€æ¨è" class="headerlink" title="3ã€æ¨è"></a>3ã€æ¨è</h2><p><a href="https://www.cnblogs.com/Jerry-zhao2110/p/8282427.html">WireSharkæŠ“åŒ…ä½¿ç”¨æ•™ç¨‹</a><br><a href="https://www.jianshu.com/p/a62ed1bb5b20">tcpdumpè¯­æ³•ä»‹ç»ä¸å¸¸ç”¨å‚æ•°ä¸¾ä¾‹</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>â€œSpringBoot2.0ä¸å®¹é”™è¿‡çš„æ–°ç‰¹æ€§ WebFluxå“åº”å¼ç¼–ç¨‹â€å­¦ä¹ ç¬”è®°(ä¸€)</title>
      <link href="2018/07/07/springboot2.0-webflux-xue-xi-bi-ji-1/"/>
      <url>2018/07/07/springboot2.0-webflux-xue-xi-bi-ji-1/</url>
      
        <content type="html"><![CDATA[<p>WebFluxå“åº”å¼ç¼–ç¨‹å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´<br><a href="https://www.jianshu.com/p/682caeeb468d">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>æ…•è¯¾ç½‘å­¦ä¹ åœ°å€ï¼š<a href="https://coding.imooc.com/class/209.html">https://coding.imooc.com/class/209.html</a><br>åŸè¯¾ç¨‹æ˜¯ä»˜è´¹çš„ï¼Œä½†æ˜¯åŒäº‹å‘äº†æˆ‘ä¸‹è½½ç¦»çº¿ç‰ˆï¼Œæ‹¿æ¥æŠ½ç©ºå­¦å‘—ï¼Œå­¦æ— æ­¢å¢ƒã€‚</p><h2 id="ç¬¬ä¸€èŠ‚-è¯¾ç¨‹ä»‹ç»"><a href="#ç¬¬ä¸€èŠ‚-è¯¾ç¨‹ä»‹ç»" class="headerlink" title="ç¬¬ä¸€èŠ‚  è¯¾ç¨‹ä»‹ç»"></a>ç¬¬ä¸€èŠ‚  è¯¾ç¨‹ä»‹ç»</h2><p><img src="/loading.gif" data-original="/images/java/springboot/springboot-webflux1.png" alt="å­¦ä¹ ä¹‹è·¯"></p><h2 id="ç¬¬äºŒèŠ‚-å‡½æ•°å¼ç¼–ç¨‹å’Œlambdaè¡¨è¾¾å¼"><a href="#ç¬¬äºŒèŠ‚-å‡½æ•°å¼ç¼–ç¨‹å’Œlambdaè¡¨è¾¾å¼" class="headerlink" title="ç¬¬äºŒèŠ‚  å‡½æ•°å¼ç¼–ç¨‹å’Œlambdaè¡¨è¾¾å¼"></a>ç¬¬äºŒèŠ‚  å‡½æ•°å¼ç¼–ç¨‹å’Œlambdaè¡¨è¾¾å¼</h2><ul><li><p>æ•°ç»„é‡Œå–æœ€å°å€¼</p><pre class="line-numbers language-java"><code class="language-java">  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">666</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">}</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> min <span class="token operator">=</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">:</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> min<span class="token punctuation">)</span> <span class="token punctuation">{</span>              min <span class="token operator">=</span> i<span class="token punctuation">;</span>          <span class="token punctuation">}</span>      <span class="token punctuation">}</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>min<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// jdk8 </span>      <span class="token keyword">int</span> min2 <span class="token operator">=</span> IntStream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAsInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>min2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å¤šçº¿ç¨‹ åŒ¿åå†…éƒ¨ç±»</p><pre class="line-numbers language-java"><code class="language-java">  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>      Object target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token annotation punctuation">@Override</span>          <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>              System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Runnable<span class="token punctuation">)</span> target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// jdk8 lambda</span>      Object target2 <span class="token operator">=</span> <span class="token punctuation">(</span>Runnable<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      Runnable target3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>target2 <span class="token operator">==</span> target3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// false</span>            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Runnable<span class="token punctuation">)</span> target2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å‡½æ•°æ¥å£ä»¥åŠé“¾å¼æ“ä½œ</p></li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>text<span class="token punctuation">.</span>DecimalFormat<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span>Function<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">MyMoney</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> money<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">MyMoney</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>money <span class="token operator">=</span> money<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printMoney</span><span class="token punctuation">(</span>Function<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> String<span class="token operator">></span> moneyFormat<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆ‘çš„å­˜æ¬¾ï¼š"</span> <span class="token operator">+</span> moneyFormat<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MoneyDemo</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        MyMoney me <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyMoney</span><span class="token punctuation">(</span><span class="token number">99999999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Function<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> String<span class="token operator">></span> moneyFormat <span class="token operator">=</span> i <span class="token operator">-</span><span class="token operator">></span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"#,###"</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å‡½æ•°æ¥å£é“¾å¼æ“ä½œ</span>        me<span class="token punctuation">.</span><span class="token function">printMoney</span><span class="token punctuation">(</span>moneyFormat<span class="token punctuation">.</span><span class="token function">andThen</span><span class="token punctuation">(</span>s <span class="token operator">-</span><span class="token operator">></span> <span class="token string">"äººæ°‘å¸ "</span> <span class="token operator">+</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œæ•ˆæœ</p><blockquote><p>æˆ‘çš„å­˜æ¬¾ï¼šäººæ°‘å¸ 99,999,999</p></blockquote><ul><li>å‡½æ•°å¼æ¥å£<br><img src="/loading.gif" data-original="/images/java/springboot/springboot-webflux-lambda.png" alt="å¸¸ç”¨çš„lambdaæ¥å£"><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// æ–­è¨€å‡½æ•°æ¥å£</span>  IntPredicate predicate <span class="token operator">=</span> i <span class="token operator">-</span><span class="token operator">></span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>  System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>predicate<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å»ºè®®ä½¿ç”¨å¸¦ç±»å‹çš„æ¥å£ï¼Œè¿™æ ·å°±ä¸ç”¨å†™æ³›å‹äº†</span>  <span class="token comment" spellcheck="true">// IntConsumer</span>  <span class="token comment" spellcheck="true">// æ¶ˆè´¹å‡½æ•°æ¥å£</span>  Consumer<span class="token operator">&lt;</span>String<span class="token operator">></span> consumer <span class="token operator">=</span> s <span class="token operator">-</span><span class="token operator">></span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>  consumer<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">"è¾“å…¥çš„æ•°æ®"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>æ–¹æ³•å¼•ç”¨</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ArrayList<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span>Consumer<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span>IntUnaryOperator<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author marvin.ma * @create 2018-07-03 18:58 * @desc ${DESCRIPTION} **/</span><span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String name <span class="token operator">=</span> <span class="token string">"å“®å¤©çŠ¬"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * é»˜è®¤10æ–¤ç‹—ç²®     */</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> food <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * å¸¦å‚æ•°çš„æ„é€ å‡½æ•°     *     * @param name     */</span>    <span class="token keyword">public</span> <span class="token function">Dog</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * ç‹—å«ï¼Œé™æ€æ–¹æ³•     *     * @param dog     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">bark</span><span class="token punctuation">(</span>Dog dog<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dog <span class="token operator">+</span> <span class="token string">"å«äº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * åƒç‹—ç²® JDK     *     * é»˜è®¤ä¼šæŠŠå½“å‰å®ä¾‹ä¼ å…¥åˆ°éé™æ€æ–¹æ³•ï¼Œå‚æ•°åä¸ºthisï¼Œä½ç½®æ˜¯ç¬¬ä¸€ä¸ªï¼›     *     * @param num     * @return è¿˜å‰©ä¸‹å¤šå°‘æ–¤     */</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åƒäº†"</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">"æ–¤ç‹—ç²®"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>food <span class="token operator">-=</span> num<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>food<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MethodRefrenceDemo</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Dog dog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dog<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// æ–¹æ³•å¼•ç”¨</span>        Consumer<span class="token operator">&lt;</span>String<span class="token operator">></span> consumer <span class="token operator">=</span> System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">;</span>        consumer<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">"æ¥å—çš„æ•°æ®"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// é™æ€æ–¹æ³•çš„æ–¹æ³•å¼•ç”¨</span>        Consumer<span class="token operator">&lt;</span>Dog<span class="token operator">></span> consumer2 <span class="token operator">=</span> Dog<span class="token operator">:</span><span class="token operator">:</span>bark<span class="token punctuation">;</span>        consumer2<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// éé™æ€æ–¹æ³•ï¼Œä½¿ç”¨å¯¹è±¡å®ä¾‹çš„æ–¹æ³•å¼•ç”¨</span>        <span class="token comment" spellcheck="true">// Function&lt;Integer, Integer> function = dog::eat;</span>        <span class="token comment" spellcheck="true">// UnaryOperator&lt;Integer> function = dog::eat;   //å…¥å‚å‡ºå‚éƒ½æ˜¯Integerï¼Œå¯ä»¥ç”¨è¿™ä¸ª</span>        IntUnaryOperator function <span class="token operator">=</span> dog<span class="token operator">:</span><span class="token operator">:</span>eat<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// dogç½®ç©ºï¼Œä¸å½±å“ä¸‹é¢çš„å‡½æ•°æ‰§è¡Œï¼Œå› ä¸ºjava å‚æ•°æ˜¯ä¼ å€¼</span>        dog <span class="token operator">=</span> null<span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿˜å‰©ä¸‹"</span> <span class="token operator">+</span> function<span class="token punctuation">.</span><span class="token function">applyAsInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"æ–¤"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//</span>        <span class="token comment" spellcheck="true">// // ä½¿ç”¨ç±»åæ¥æ–¹æ³•å¼•ç”¨</span>        <span class="token comment" spellcheck="true">// BiFunction&lt;Dog, Integer, Integer> eatFunction = Dog::eat;</span>        <span class="token comment" spellcheck="true">// System.out.println("è¿˜å‰©ä¸‹" + eatFunction.apply(dog, 2) + "æ–¤");</span>        <span class="token comment" spellcheck="true">//</span>        <span class="token comment" spellcheck="true">// // æ„é€ å‡½æ•°çš„æ–¹æ³•å¼•ç”¨</span>        <span class="token comment" spellcheck="true">// Supplier&lt;Dog> supplier = Dog::new;</span>        <span class="token comment" spellcheck="true">// System.out.println("åˆ›å»ºäº†æ–°å¯¹è±¡ï¼š" + supplier.get());</span>        <span class="token comment" spellcheck="true">//</span>        <span class="token comment" spellcheck="true">// å¸¦å‚æ•°çš„æ„é€ å‡½æ•°çš„æ–¹æ³•å¼•ç”¨</span>        Function<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Dog<span class="token operator">></span> function2 <span class="token operator">=</span> Dog<span class="token operator">:</span><span class="token operator">:</span><span class="token keyword">new</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åˆ›å»ºäº†æ–°å¯¹è±¡ï¼š"</span> <span class="token operator">+</span> function2<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">"æ—ºè´¢"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// æµ‹è¯•javaå˜é‡æ˜¯ä¼ å€¼è¿˜æ˜¯ç©¿å¼•ç”¨</span>        List<span class="token operator">&lt;</span>String<span class="token operator">></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">test</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>String<span class="token operator">></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>        list <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿è¡Œè¾“å‡ºï¼š<br>åƒäº†3æ–¤ç‹—ç²®<br>æ¥å—çš„æ•°æ®<br>å“®å¤©çŠ¬å«äº†<br>åƒäº†2æ–¤ç‹—ç²®<br>è¿˜å‰©ä¸‹5æ–¤<br>åˆ›å»ºäº†æ–°å¯¹è±¡ï¼šæ—ºè´¢</p></blockquote><ul><li>ç±»å‹å¼•ç”¨</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">interface</span> <span class="token class-name">IMath</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">interface</span> <span class="token class-name">IMath2</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TypeDemo</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å˜é‡ç±»å‹å®šä¹‰</span>        IMath lambda <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// æ•°ç»„é‡Œ</span>        IMath<span class="token punctuation">[</span><span class="token punctuation">]</span> lambdas <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> x <span class="token operator">+</span> y <span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å¼ºè½¬</span>        Object lambda2 <span class="token operator">=</span> <span class="token punctuation">(</span>IMath<span class="token punctuation">)</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// é€šè¿‡è¿”å›ç±»å‹</span>        IMath createLambda <span class="token operator">=</span> <span class="token function">createLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                TypeDemo demo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TypeDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å½“æœ‰äºŒä¹‰æ€§çš„æ—¶å€™ï¼Œä½¿ç”¨å¼ºè½¬å¯¹åº”çš„æ¥å£è§£å†³</span>        demo<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>IMath2<span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> x <span class="token operator">+</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span>IMath math<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span>IMath2 math<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> IMath <span class="token function">createLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span>  <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>çº§è”è¡¨è¾¾å¼å’Œç‚é‡ŒåŒ–<br>çº§è”è¡¨è¾¾å¼ï¼šæœ‰å¤šä¸ªç®­å¤´çš„å‡½æ•°<br>æŸ¯é‡ŒåŒ–ï¼šæŠŠå¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬æ¢ä¸ºåªæœ‰ä¸€ä¸ªå‚æ•°çš„å‡½æ•°<br>é«˜é˜¶å‡½æ•°ï¼šå°±æ˜¯è¿”å›å‡½æ•°çš„å‡½æ•°</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span>Function<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * çº§è”è¡¨è¾¾å¼å’ŒæŸ¯é‡ŒåŒ–  * æŸ¯é‡ŒåŒ–:æŠŠå¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬æ¢ä¸ºåªæœ‰ä¸€ä¸ªå‚æ•°çš„å‡½æ•°  * æŸ¯é‡ŒåŒ–çš„ç›®çš„ï¼šå‡½æ•°æ ‡å‡†åŒ– * é«˜é˜¶å‡½æ•°ï¼šå°±æ˜¯è¿”å›å‡½æ•°çš„å‡½æ•° */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CurryDemo</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å®ç°äº†x+yçš„çº§è”è¡¨è¾¾å¼</span>        Function<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> Function<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> Integer<span class="token operator">>></span> fun <span class="token operator">=</span> x <span class="token operator">-</span><span class="token operator">></span> y <span class="token operator">-</span><span class="token operator">></span> x                <span class="token operator">+</span> y<span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>fun<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Function<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> Function<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> Function<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> Integer<span class="token operator">>>></span> fun2 <span class="token operator">=</span> x <span class="token operator">-</span><span class="token operator">></span> y <span class="token operator">-</span><span class="token operator">></span> z <span class="token operator">-</span><span class="token operator">></span> x                <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>fun2<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>        Function f <span class="token operator">=</span> fun2<span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>f <span class="token keyword">instanceof</span> <span class="token class-name">Function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                Object obj <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    f <span class="token operator">=</span> <span class="token punctuation">(</span>Function<span class="token punctuation">)</span> obj<span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è°ƒç”¨ç»“æŸï¼šç»“æœä¸º"</span> <span class="token operator">+</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œç»“æœ</p><blockquote><p>5<br>9<br>è°ƒç”¨ç»“æŸï¼šç»“æœä¸º9</p></blockquote><h2 id="ç¬¬ä¸‰èŠ‚-Streamæµç¼–ç¨‹"><a href="#ç¬¬ä¸‰èŠ‚-Streamæµç¼–ç¨‹" class="headerlink" title="ç¬¬ä¸‰èŠ‚  Streamæµç¼–ç¨‹"></a>ç¬¬ä¸‰èŠ‚  Streamæµç¼–ç¨‹</h2><ul><li>demo1</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>IntStream<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-03 22:17 * @desc ${DESCRIPTION} **/</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StreamDemo1</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å¤–éƒ¨è¿­ä»£</span>        <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">:</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>            sum <span class="token operator">+=</span> i<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç»“æœä¸ºï¼š"</span> <span class="token operator">+</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// ä½¿ç”¨streamçš„å†…éƒ¨è¿­ä»£</span>        <span class="token comment" spellcheck="true">// mapå°±æ˜¯ä¸­é—´æ“ä½œï¼ˆè¿”å›streamçš„æ“ä½œï¼‰</span>        <span class="token comment" spellcheck="true">// sumå°±æ˜¯ç»ˆæ­¢æ“ä½œ</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç»“æœä¸ºï¼š"</span> <span class="token operator">+</span> IntStream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> sum2 <span class="token operator">=</span> IntStream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>i <span class="token operator">-</span><span class="token operator">></span> i<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç»“æœä¸ºï¼š"</span> <span class="token operator">+</span> sum2<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æƒ°æ€§æ±‚å€¼å°±æ˜¯ç»ˆæ­¢æ²¡æœ‰è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œä¸­é—´æ“ä½œä¸ä¼šæ‰§è¡Œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        IntStream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>StreamDemo1<span class="token operator">:</span><span class="token operator">:</span>doubleNum<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">doubleNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œäº†ä¹˜ä»¥2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œç»“æœ:</p><blockquote><p>ç»“æœä¸ºï¼š6<br>ç»“æœä¸ºï¼š6<br>ç»“æœä¸ºï¼š12<br>æƒ°æ€§æ±‚å€¼å°±æ˜¯ç»ˆæ­¢æ²¡æœ‰è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œä¸­é—´æ“ä½œä¸ä¼šæ‰§è¡Œ</p></blockquote><ul><li>demo 2, æµçš„åˆ›å»º<br><img src="/loading.gif" data-original="/images/java/springboot/springboot-webflux-create-stream.png" alt="æµçš„åˆ›å»ºæ–¹å¼"></li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StreamDemo2</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>String<span class="token operator">></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// ä»é›†åˆåˆ›å»º</span>        list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">parallelStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// ä»æ•°ç»„åˆ›å»º</span>        Arrays<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// åˆ›å»ºæ•°å­—æµ</span>        IntStream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        IntStream<span class="token punctuation">.</span><span class="token function">rangeClosed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// ä½¿ç”¨randomåˆ›å»ºä¸€ä¸ªæ— é™æµ</span>        <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Random random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è‡ªå·±äº§ç”Ÿæµ</span>        Stream<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>demo3ï¼Œæµçš„ä¸­é—´æ“ä½œ<br><img src="/loading.gif" data-original="/images/java/springboot/springboot-webflux-stream-opt.png" alt="æµçš„ä¸­é—´æ“ä½œ"></li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Random<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>Stream<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-03 22:39 * @desc æµçš„ä¸­é—´æ“ä½œ **/</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StreamDemo3</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        String str <span class="token operator">=</span> <span class="token string">"my name is 007"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//æŠŠæ¯ä¸ªå•è¯çš„é•¿åº¦è°ƒç”¨å‡ºæ¥</span>        Stream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>s <span class="token operator">-</span><span class="token operator">></span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>s <span class="token operator">-</span><span class="token operator">></span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//flatMap é€‚åˆAå…ƒç´ ä¸‹é¢æœ‰Bå±æ€§ï¼ŒBå±æ€§æ˜¯é›†åˆï¼Œæœ€ç»ˆå¾—åˆ°æ‰€æœ‰Aå…ƒç´ é‡Œé¢çš„æ‰€æœ‰Bå±æ€§çš„é›†åˆ</span>        <span class="token comment" spellcheck="true">// intStream/longStream å¹¶ä¸æ˜¯Streamçš„å­ç±»ï¼Œæ‰€ä»¥è¦è¿›è¡Œè£…ç®±  boxed</span>        Stream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>s <span class="token operator">-</span><span class="token operator">></span> s<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boxed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>i <span class="token operator">-</span><span class="token operator">></span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>i<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//peek ç”¨äºdebugï¼Œæ˜¯ä¸ªä¸­é—´æ“ä½œï¼Œä¸foreachä¸åŒï¼Œforeachæ˜¯ç»ˆæ­¢æ“ä½œ</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"--------------peek------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Stream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//limitçš„ä½¿ç”¨</span>        <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>i <span class="token operator">-</span><span class="token operator">></span> i <span class="token operator">></span> <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>streamçš„ç»ˆæ­¢æ“ä½œ<br><img src="/loading.gif" data-original="/images/java/springboot/springboot-webflux-stream-end.png" alt="streamç»ˆæ­¢æ“ä½œ"></li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>Collectors<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>Stream<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-06 13:33 * @desc ${DESCRIPTION} **/</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StreamDemo4</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        String str <span class="token operator">=</span> <span class="token string">"my name is 007"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ä½¿ç”¨å¹¶è¡Œæµ</span>        str<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>i <span class="token operator">-</span><span class="token operator">></span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// ä½¿ç”¨ forEachOrdered ä¿è¯é¡ºåº</span>        str<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEachOrdered</span><span class="token punctuation">(</span>i <span class="token operator">-</span><span class="token operator">></span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//æ”¶é›†åˆ°list/set   setæ—¶æœ€åä½¿ç”¨toSetæ–¹æ³•</span>        List<span class="token operator">&lt;</span>String<span class="token operator">></span> list  <span class="token operator">=</span> Stream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ä½¿ç”¨reduceæ‹¼æ¥å­—ç¬¦ä¸²</span>        Optional<span class="token operator">&lt;</span>String<span class="token operator">></span> letters <span class="token operator">=</span> Stream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> s1 <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>letters<span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//å¸¦åˆå§‹å€¼çš„reduce</span>        String reduce <span class="token operator">=</span> Stream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span>                <span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> s1 <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>reduce<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//è®¡ç®—æ‰€æœ‰å•è¯æ€»é•¿åº¦</span>        Integer length <span class="token operator">=</span> Stream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>s <span class="token operator">-</span><span class="token operator">></span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> s1 <span class="token operator">+</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ä½¿ç”¨maxå‡½æ•°</span>        Optional<span class="token operator">&lt;</span>String<span class="token operator">></span> max <span class="token operator">=</span> Stream<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>Comparator<span class="token punctuation">.</span><span class="token function">comparingInt</span><span class="token punctuation">(</span>String<span class="token operator">:</span><span class="token operator">:</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>max<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//// ä½¿ç”¨ findFirst çŸ­è·¯æ“ä½œ</span>        OptionalInt findFirst <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>i <span class="token operator">-</span><span class="token operator">></span> i <span class="token operator">></span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>findFirst<span class="token punctuation">.</span><span class="token function">getAsInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœï¼š</p><blockquote><p>immnae7y 0 0 s<br>my name is 007<br>[my, name, is, 007]&gt;<br>my|name|is|007<br>|my|name|is|007<br>11<br>name<br>113660557</p></blockquote><ul><li>å¹¶è¡Œæµ &amp; ä¸²è¡ŒæµçŸ¥è¯†ç‚¹<br>1ã€è°ƒç”¨parallel äº§ç”Ÿä¸€ä¸ªå¹¶è¡Œæµ.<br>2ã€è°ƒç”¨sequential äº§ç”Ÿä¸²è¡Œæµ.<br>3ã€å¤šæ¬¡è°ƒç”¨ parallel / sequential, ä»¥æœ€åä¸€æ¬¡è°ƒç”¨ä¸ºå‡†.<br>4ã€å¹¶è¡Œæµä½¿ç”¨çš„é»˜è®¤çº¿ç¨‹æ± åç§°: ForkJoinPool.commonPoolï¼Œé»˜è®¤çš„çº¿ç¨‹æ•°æ˜¯ å½“å‰æœºå™¨çš„cpuä¸ªæ•°.<br>5ã€ä½¿ç”¨è¿™ä¸ªå±æ€§å¯ä»¥ä¿®æ”¹é»˜è®¤çš„çº¿ç¨‹æ•°ï¼šSystem.setProperty(â€œjava.util.concurrent.ForkJoinPool.common.parallelismâ€, â€œ20â€);<br>6ã€ä¸€èˆ¬åœ°ï¼Œæ¨èä½¿ç”¨è‡ªå·±çš„çº¿ç¨‹æ± , ä¸ä½¿ç”¨é»˜è®¤çº¿ç¨‹æ± , é˜²æ­¢ä»»åŠ¡è¢«é˜»å¡ã€‚æ³¨æ„åœ¨mainå‡½æ•°ä¸­è°ƒç”¨ï¼Œè¦è®©mainå‡½æ•°ä¸é€€å‡ºï¼Œç­‰ä¼šå„¿å†é€€å‡ºã€‚è‡ªå·±æ–°èµ·çš„çº¿ç¨‹è¦ç”¨shutdownå…³é—­ï¼Œä¸ç„¶ä¼šä¸€ç›´æ‰§è¡Œç€ã€‚</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>  ForkJoinPool pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ForkJoinPool</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pool<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> IntStream<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span>StreamDemo5<span class="token operator">:</span><span class="token operator">:</span>debug<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>pool<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                pool<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">debug</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" debug "</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœ</p><blockquote><p>ForkJoinPool-1-worker-25 debug 65<br>ForkJoinPool-1-worker-18 debug 31<br>ForkJoinPool-1-worker-11 debug 90<br>ForkJoinPool-1-worker-4 debug 15<br>ForkJoinPool-1-worker-19 debug 56<br>ForkJoinPool-1-worker-15 debug 81<br>ForkJoinPool-1-worker-8 debug 21<br>ForkJoinPool-1-worker-26 debug 40<br>ForkJoinPool-1-worker-29 debug 43<br>ForkJoinPool-1-worker-12 debug 93<br>ForkJoinPool-1-worker-5 debug 28<br>ForkJoinPool-1-worker-30 debug 78<br>ForkJoinPool-1-worker-22 debug 96<br>ForkJoinPool-1-worker-23 debug 87<br>ForkJoinPool-1-worker-1 debug 6<br>ForkJoinPool-1-worker-9 debug 12<br>ForkJoinPool-1-worker-16 debug 18<br>ForkJoinPool-1-worker-2 debug 3<br>ForkJoinPool-1-worker-27 debug 48<br>ForkJoinPool-1-worker-20 debug 37</p></blockquote><ul><li>æ”¶é›†å™¨<br>æ‰€æ”¶é›†çš„å¯¹è±¡ä¿¡æ¯</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> Gender gender<span class="token punctuation">;</span>    <span class="token keyword">private</span> Grade grade<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">Student</span><span class="token punctuation">(</span>String name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">,</span> Gender gender<span class="token punctuation">,</span> Grade grade<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> gender<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>grade <span class="token operator">=</span> grade<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> age<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> Gender <span class="token function">getGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> gender<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setGender</span><span class="token punctuation">(</span>Gender gender<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> gender<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> Grade <span class="token function">getGrade</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> grade<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setGrade</span><span class="token punctuation">(</span>Grade grade<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>grade <span class="token operator">=</span> grade<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"[name="</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">", age="</span> <span class="token operator">+</span> age <span class="token operator">+</span> <span class="token string">", gender="</span> <span class="token operator">+</span> gender                <span class="token operator">+</span> <span class="token string">", grade="</span> <span class="token operator">+</span> grade <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/** * æ€§åˆ« */</span><span class="token keyword">enum</span> Gender <span class="token punctuation">{</span>    MALE<span class="token punctuation">,</span> FEMALE<span class="token punctuation">}</span><span class="token comment" spellcheck="true">/** * ç­çº§ */</span><span class="token keyword">enum</span> Grade <span class="token punctuation">{</span>    ONE<span class="token punctuation">,</span> TWO<span class="token punctuation">,</span> THREE<span class="token punctuation">,</span> FOUR<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ç±»ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>collections<span class="token punctuation">.</span>MapUtils<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Arrays<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>IntSummaryStatistics<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>Collectors<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-07 22:37 * @desc æµæ”¶é›†å™¨demo **/</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CollectDemo</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// æµ‹è¯•æ•°æ®</span>        List<span class="token operator">&lt;</span>Student<span class="token operator">></span> students <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°æ˜"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>MALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>ONE<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å¤§æ˜"</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>MALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>THREE<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°ç™½"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>FEMALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>TWO<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°é»‘"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>FEMALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>FOUR<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°çº¢"</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>FEMALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>THREE<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°é»„"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>MALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>ONE<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°é’"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>FEMALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>THREE<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°ç´«"</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>FEMALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>TWO<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°ç‹"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>MALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>ONE<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°æ"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>MALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>ONE<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°é©¬"</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>FEMALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>FOUR<span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"å°åˆ˜"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> Gender<span class="token punctuation">.</span>MALE<span class="token punctuation">,</span> Grade<span class="token punctuation">.</span>FOUR<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å¾—åˆ°æ‰€æœ‰å­¦ç”Ÿçš„å¹´é¾„åˆ—è¡¨</span>        <span class="token comment" spellcheck="true">// æ¨èä½¿ç”¨æ–¹æ³•å¼•ç”¨Student::getAgeï¼Œä¸è¦ä½¿ç”¨s->s.getAge(),å°±ä¸ä¼šå¤šç”Ÿæˆä¸€ä¸ªç±»ä¼¼ lambda$0è¿™æ ·çš„å‡½æ•°</span>        List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> ages <span class="token operator">=</span> students<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Student<span class="token operator">:</span><span class="token operator">:</span>getAge<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‰€æœ‰å­¦ç”Ÿçš„å¹´é¾„:"</span> <span class="token operator">+</span> ages<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// ç»Ÿè®¡æ±‡æ€»ä¿¡æ¯</span>        IntSummaryStatistics agesSummaryStatistics <span class="token operator">=</span> students<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">summarizingInt</span><span class="token punctuation">(</span>Student<span class="token operator">:</span><span class="token operator">:</span>getAge<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¹´é¾„æ±‡æ€»ä¿¡æ¯:"</span> <span class="token operator">+</span> agesSummaryStatistics<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//åˆ†å—</span>        Map<span class="token operator">&lt;</span>Boolean<span class="token punctuation">,</span> List<span class="token operator">&lt;</span>Student<span class="token operator">>></span> genders <span class="token operator">=</span> students<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">partitioningBy</span><span class="token punctuation">(</span>s <span class="token operator">-</span><span class="token operator">></span> s<span class="token punctuation">.</span><span class="token function">getGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Gender<span class="token punctuation">.</span>MALE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//System.out.println("ç”·å¥³å­¦ç”Ÿåˆ—è¡¨:" + genders);</span>        MapUtils<span class="token punctuation">.</span><span class="token function">verbosePrint</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token punctuation">,</span> <span class="token string">"ç”·å¥³å­¦ç”Ÿåˆ—è¡¨"</span><span class="token punctuation">,</span> genders<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//åˆ†ç»„ï¼Œæ¯”å¦‚åˆ†å—å°±æ˜¯åˆ†ä¸¤ç»„ï¼Œè¿”å›boolean</span>        Map<span class="token operator">&lt;</span>Grade<span class="token punctuation">,</span> List<span class="token operator">&lt;</span>Student<span class="token operator">>></span> grades <span class="token operator">=</span> students<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span>Student<span class="token operator">:</span><span class="token operator">:</span>getGrade<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        MapUtils<span class="token punctuation">.</span><span class="token function">verbosePrint</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token punctuation">,</span> <span class="token string">"å­¦ç”Ÿç­çº§åˆ—è¡¨"</span><span class="token punctuation">,</span> grades<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//å¾—åˆ°æ‰€æœ‰ç­çº§å­¦ç”Ÿçš„ä¸ªæ•°</span>        Map<span class="token operator">&lt;</span>Grade<span class="token punctuation">,</span> Long<span class="token operator">></span> gradesCount <span class="token operator">=</span> students<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>Collectors<span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span>Student<span class="token operator">:</span><span class="token operator">:</span>getGrade<span class="token punctuation">,</span> Collectors<span class="token punctuation">.</span><span class="token function">counting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        MapUtils<span class="token punctuation">.</span><span class="token function">verbosePrint</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token punctuation">,</span> <span class="token string">"å­¦ç”Ÿç­çº§ä¸ªæ•°åˆ—è¡¨"</span><span class="token punctuation">,</span> gradesCount<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœï¼š</p><blockquote><p>Connected to the target VM, address: â€˜javadebugâ€™, transport: â€˜shared memoryâ€™<br>æ‰€æœ‰å­¦ç”Ÿçš„å¹´é¾„:[10, 9, 8, 13, 7, 13, 13, 9, 6, 6, 14, 13]<br>å¹´é¾„æ±‡æ€»ä¿¡æ¯:IntSummaryStatistics{count=12, sum=121, min=6, average=10.083333, max=14}<br>ç”·å¥³å­¦ç”Ÿåˆ—è¡¨ =<br>{<br>    false = [[name=å°ç™½, age=8, gender=FEMALE, grade=TWO], [name=å°é»‘, age=13, gender=FEMALE, grade=FOUR], [name=å°çº¢, age=7, gender=FEMALE, grade=THREE], [name=å°é’, age=13, gender=FEMALE, grade=THREE], [name=å°ç´«, age=9, gender=FEMALE, grade=TWO], [name=å°é©¬, age=14, gender=FEMALE, grade=FOUR]]<br>    true = [[name=å°æ˜, age=10, gender=MALE, grade=ONE], [name=å¤§æ˜, age=9, gender=MALE, grade=THREE], [name=å°é»„, age=13, gender=MALE, grade=ONE], [name=å°ç‹, age=6, gender=MALE, grade=ONE], [name=å°æ, age=6, gender=MALE, grade=ONE], [name=å°åˆ˜, age=13, gender=MALE, grade=FOUR]]<br>}<br>å­¦ç”Ÿç­çº§åˆ—è¡¨ =<br>{<br>    ONE = [[name=å°æ˜, age=10, gender=MALE, grade=ONE], [name=å°é»„, age=13, gender=MALE, grade=ONE], [name=å°ç‹, age=6, gender=MALE, grade=ONE], [name=å°æ, age=6, gender=MALE, grade=ONE]]<br>    FOUR = [[name=å°é»‘, age=13, gender=FEMALE, grade=FOUR], [name=å°é©¬, age=14, gender=FEMALE, grade=FOUR], [name=å°åˆ˜, age=13, gender=MALE, grade=FOUR]]<br>    TWO = [[name=å°ç™½, age=8, gender=FEMALE, grade=TWO], [name=å°ç´«, age=9, gender=FEMALE, grade=TWO]]<br>    THREE = [[name=å¤§æ˜, age=9, gender=MALE, grade=THREE], [name=å°çº¢, age=7, gender=FEMALE, grade=THREE], [name=å°é’, age=13, gender=FEMALE, grade=THREE]]<br>}<br>Disconnected from the target VM, address: â€˜javadebugâ€™, transport: â€˜shared memoryâ€™<br>å­¦ç”Ÿç­çº§ä¸ªæ•°åˆ—è¡¨ =<br>{<br>    ONE = 4<br>    FOUR = 3<br>    TWO = 2<br>    THREE = 3<br>}</p></blockquote><ul><li>Stream è¿è¡Œæœºåˆ¶<br>éªŒè¯ï¼š</li></ul><ol><li>æ‰€æœ‰æ“ä½œæ˜¯é“¾å¼è°ƒç”¨, ä¸€ä¸ªå…ƒç´ åªè¿­ä»£ä¸€æ¬¡ </li><li>æ¯ä¸€ä¸ªä¸­é—´æ“ä½œè¿”å›ä¸€ä¸ªæ–°çš„æµ. æµé‡Œé¢æœ‰ä¸€ä¸ªå±æ€§sourceStage<br> æŒ‡å‘åŒä¸€ä¸ª åœ°æ–¹,å°±æ˜¯Head </li><li>Head-&gt;nextStage-&gt;nextStage-&gt;â€¦ -&gt; null</li><li>æœ‰çŠ¶æ€æ“ä½œä¼šæŠŠæ— çŠ¶æ€æ“ä½œé˜¶æ®µ,å•ç‹¬å¤„ç†</li><li>å¹¶è¡Œç¯å¢ƒä¸‹, æœ‰çŠ¶æ€çš„ä¸­é—´æ“ä½œä¸ä¸€å®šèƒ½å¹¶è¡Œæ“ä½œ</li><li>parallel/ sequetial è¿™2ä¸ªæ“ä½œä¹Ÿæ˜¯ä¸­é—´æ“ä½œ(ä¹Ÿæ˜¯è¿”å›stream)<br>ä½†æ˜¯ä»–ä»¬ä¸åˆ›å»ºæµ, ä»–ä»¬åªä¿®æ”¹ Headçš„å¹¶è¡Œæ ‡å¿—</li></ol><h2 id="ç¬¬ä¸‰èŠ‚-reactive-stream-å“åº”å¼æµ"><a href="#ç¬¬ä¸‰èŠ‚-reactive-stream-å“åº”å¼æµ" class="headerlink" title="ç¬¬ä¸‰èŠ‚  reactive stream å“åº”å¼æµ"></a>ç¬¬ä¸‰èŠ‚  reactive stream å“åº”å¼æµ</h2><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>Flow<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>SubmissionPublisher<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>TimeUnit<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-08 0:03 * @desc å“åº”å¼æµ **/</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlowDemo</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//1.å®šä¹‰å‘å¸ƒè€…ï¼Œå‘å¸ƒçš„æ•°æ®ç±»å‹æ˜¯Integer</span>        <span class="token comment" spellcheck="true">// ç›´æ¥ä½¿ç”¨jdkè‡ªå¸¦çš„SubmissionPublisherï¼Œå®ƒå®ç°äº†Publisheræ¥å£</span>        SubmissionPublisher<span class="token operator">&lt;</span>Integer<span class="token operator">></span> publisher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubmissionPublisher</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//2. å®šä¹‰è®¢é˜…è€…</span>        Flow<span class="token punctuation">.</span>Subscriber<span class="token operator">&lt;</span>Integer<span class="token operator">></span> subscriber <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flow<span class="token punctuation">.</span>Subscriber</span><span class="token operator">&lt;</span>Integer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">private</span> Flow<span class="token punctuation">.</span>Subscription subscription<span class="token punctuation">;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onSubscribe</span><span class="token punctuation">(</span>Flow<span class="token punctuation">.</span>Subscription subscription<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// ä¿å­˜è®¢é˜…å…³ç³»ï¼Œéœ€è¦ç”¨å®ƒæ¥ç»™å‘å¸ƒè€…å“åº”</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription <span class="token operator">=</span> subscription<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// è¯·æ±‚ä¸€ä¸ªæ•°æ®</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onNext</span><span class="token punctuation">(</span>Integer item<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// æ¥æ”¶ä¸€ä¸ªæ•°æ®ï¼Œå¹¶å¤„ç†</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¥æ”¶åˆ°çš„æ•°æ®ï¼š"</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">try</span> <span class="token punctuation">{</span>                    TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token comment" spellcheck="true">// å¤„ç†å®Œè°ƒç”¨requestå†è¯·æ±‚ä¸€ä¸ªæ•°æ®</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//æˆ–è€… å·²ç»è¾¾åˆ°äº†ç›®æ ‡ï¼Œè°ƒç”¨cancelå‘Šè¯‰å‘å¸ƒè€…ä¸å†æ¥æ”¶æ•°æ®äº†</span>                <span class="token comment" spellcheck="true">//this.subscription.cancel();</span>            <span class="token punctuation">}</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span>Throwable throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//å‡ºç°äº†å¼‚å¸¸ï¼ˆä¾‹å¦‚å¤„ç†æ•°æ®çš„æ—¶å€™äº§ç”Ÿäº†å¼‚å¸¸ï¼‰</span>                throwable<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//æˆ‘ä»¬å¯ä»¥å‘Šè¯‰å‘å¸ƒè€…ï¼Œåé¢ä¸æ¥æ”¶æ•°æ®äº†</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// å…¨éƒ¨æ•°æ®å¤„ç†å®Œäº†ï¼ˆå‘å¸ƒè€…å…³é—­äº†ï¼‰</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¤„ç†å®Œäº†ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//3. å‘å¸ƒè€…å’Œè®¢é˜…è€…å»ºç«‹è®¢é˜…å…³ç³»</span>        publisher<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//4. ç”Ÿäº§æ•°æ®ï¼Œå¹¶å‘å¸ƒ   è¿™é‡Œå¿½ç•¥æ•°æ®ç”Ÿäº§è¿‡ç¨‹</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">1000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç”Ÿæˆæ•°æ®ï¼š"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//submit æ˜¯ä¸ªblockæ–¹æ³•</span>            publisher<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//5. ç»“æŸå  å…³é—­å‘å¸ƒè€…</span>        <span class="token comment" spellcheck="true">// æ­£å¼ç¯å¢ƒåº”è¯¥æ”¾åœ¨finallyæˆ–è€…ä½¿ç”¨try-resource ç¡®ä¿å…³é—­</span>        publisher<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ä¸»çº¿ç¨‹å»¶è¿Ÿåœæ­¢ï¼Œ å¦åˆ™æ•°æ®æ²¡æœ‰æ¶ˆè´¹å°±é€€å‡ºäº†</span>        Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//debugçš„æ—¶å€™ï¼Œä¸‹é¢è¿™è¡Œéœ€è¦æœ‰æ–­ç‚¹ã€‚å¦åˆ™ä¸»çº¿ç¨‹ç»“æŸæ— æ³•debug</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œæ•ˆæœ</p><blockquote><p>ç”Ÿæˆæ•°æ®ï¼š262<br>æ¥æ”¶åˆ°çš„æ•°æ®ï¼š6<br>ç”Ÿæˆæ•°æ®ï¼š263<br>æ¥æ”¶åˆ°çš„æ•°æ®ï¼š7<br>ç”Ÿæˆæ•°æ®ï¼š264<br>æ¥æ”¶åˆ°çš„æ•°æ®ï¼š8<br>ç”Ÿæˆæ•°æ®ï¼š265<br>æ¥æ”¶åˆ°çš„æ•°æ®ï¼š9<br>ç”Ÿæˆæ•°æ®ï¼š266<br>æ¥æ”¶åˆ°çš„æ•°æ®ï¼š10<br>ç”Ÿæˆæ•°æ®ï¼š267<br>æ¥æ”¶åˆ°çš„æ•°æ®ï¼š11<br>ç”Ÿæˆæ•°æ®ï¼š268</p></blockquote><p>å¦ä¸€ä¸ªä¾‹å­</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>Flow<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>SubmissionPublisher<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author é©¬æµ·å¼º * @create 2018-07-08 23:14 * @desc å¸¦ process çš„ flow demo *  Processor, éœ€è¦ç»§æ‰¿SubmissionPublisherå¹¶å®ç°Processoræ¥å£ *  è¾“å…¥æºæ•°æ® integer, è¿‡æ»¤æ‰å°äº0çš„, ç„¶åè½¬æ¢æˆå­—ç¬¦ä¸²å‘å¸ƒå‡ºå» **/</span><span class="token keyword">class</span> <span class="token class-name">MyProcessor</span> <span class="token keyword">extends</span> <span class="token class-name">SubmissionPublisher</span><span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">Flow<span class="token punctuation">.</span>Processor</span><span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> Flow<span class="token punctuation">.</span>Subscription subscription<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onSubscribe</span><span class="token punctuation">(</span>Flow<span class="token punctuation">.</span>Subscription subscription<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// ä¿å­˜è®¢é˜…å…³ç³», éœ€è¦ç”¨å®ƒæ¥ç»™å‘å¸ƒè€…å“åº”</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>subscription <span class="token operator">=</span> subscription<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è¯·æ±‚ä¸€ä¸ªæ•°æ®</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onNext</span><span class="token punctuation">(</span>Integer item<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// æ¥å—åˆ°ä¸€ä¸ªæ•°æ®, å¤„ç†</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¤„ç†å™¨æ¥å—åˆ°æ•°æ®: "</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è¿‡æ»¤æ‰å°äº0çš„, ç„¶åå‘å¸ƒå‡ºå»</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token string">"è½¬æ¢åçš„æ•°æ®:"</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// å¤„ç†å®Œè°ƒç”¨requestå†è¯·æ±‚ä¸€ä¸ªæ•°æ®</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// æˆ–è€… å·²ç»è¾¾åˆ°äº†ç›®æ ‡, è°ƒç”¨cancelå‘Šè¯‰å‘å¸ƒè€…ä¸å†æ¥å—æ•°æ®äº†</span>        <span class="token comment" spellcheck="true">// this.subscription.cancel();</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span>Throwable throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å‡ºç°äº†å¼‚å¸¸(ä¾‹å¦‚å¤„ç†æ•°æ®çš„æ—¶å€™äº§ç”Ÿäº†å¼‚å¸¸)</span>        throwable<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// æˆ‘ä»¬å¯ä»¥å‘Šè¯‰å‘å¸ƒè€…, åé¢ä¸æ¥å—æ•°æ®äº†</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å…¨éƒ¨æ•°æ®å¤„ç†å®Œäº†(å‘å¸ƒè€…å…³é—­äº†)</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¤„ç†å™¨å¤„ç†å®Œäº†!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å…³é—­å‘å¸ƒè€…</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlowDemo2</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 1. å®šä¹‰å‘å¸ƒè€…, å‘å¸ƒçš„æ•°æ®ç±»å‹æ˜¯ Integer</span>        <span class="token comment" spellcheck="true">// ç›´æ¥ä½¿ç”¨jdkè‡ªå¸¦çš„SubmissionPublisher</span>        SubmissionPublisher<span class="token operator">&lt;</span>Integer<span class="token operator">></span> publiser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubmissionPublisher</span><span class="token operator">&lt;</span>Integer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 2. å®šä¹‰å¤„ç†å™¨, å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤, å¹¶è½¬æ¢ä¸ºStringç±»å‹</span>        MyProcessor processor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 3. å‘å¸ƒè€… å’Œ å¤„ç†å™¨ å»ºç«‹è®¢é˜…å…³ç³»</span>        publiser<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>processor<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 4. å®šä¹‰æœ€ç»ˆè®¢é˜…è€…, æ¶ˆè´¹ String ç±»å‹æ•°æ®</span>        Flow<span class="token punctuation">.</span>Subscriber<span class="token operator">&lt;</span>String<span class="token operator">></span> subscriber <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flow<span class="token punctuation">.</span>Subscriber</span><span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">private</span> Flow<span class="token punctuation">.</span>Subscription subscription<span class="token punctuation">;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onSubscribe</span><span class="token punctuation">(</span>Flow<span class="token punctuation">.</span>Subscription subscription<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// ä¿å­˜è®¢é˜…å…³ç³», éœ€è¦ç”¨å®ƒæ¥ç»™å‘å¸ƒè€…å“åº”</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription <span class="token operator">=</span> subscription<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// è¯·æ±‚ä¸€ä¸ªæ•°æ®</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onNext</span><span class="token punctuation">(</span>String item<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// æ¥å—åˆ°ä¸€ä¸ªæ•°æ®, å¤„ç†</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¥å—åˆ°æ•°æ®: "</span> <span class="token operator">+</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// å¤„ç†å®Œè°ƒç”¨requestå†è¯·æ±‚ä¸€ä¸ªæ•°æ®</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// æˆ–è€… å·²ç»è¾¾åˆ°äº†ç›®æ ‡, è°ƒç”¨cancelå‘Šè¯‰å‘å¸ƒè€…ä¸å†æ¥å—æ•°æ®äº†</span>                <span class="token comment" spellcheck="true">// this.subscription.cancel();</span>            <span class="token punctuation">}</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span>Throwable throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// å‡ºç°äº†å¼‚å¸¸(ä¾‹å¦‚å¤„ç†æ•°æ®çš„æ—¶å€™äº§ç”Ÿäº†å¼‚å¸¸)</span>                throwable<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// æˆ‘ä»¬å¯ä»¥å‘Šè¯‰å‘å¸ƒè€…, åé¢ä¸æ¥å—æ•°æ®äº†</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>subscription<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// å…¨éƒ¨æ•°æ®å¤„ç†å®Œäº†(å‘å¸ƒè€…å…³é—­äº†)</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¤„ç†å®Œäº†!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 5. å¤„ç†å™¨ å’Œ æœ€ç»ˆè®¢é˜…è€… å»ºç«‹è®¢é˜…å…³ç³»</span>        processor<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 6. ç”Ÿäº§æ•°æ®, å¹¶å‘å¸ƒ</span>        <span class="token comment" spellcheck="true">// è¿™é‡Œå¿½ç•¥æ•°æ®ç”Ÿäº§è¿‡ç¨‹</span>        publiser<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        publiser<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 7. ç»“æŸå å…³é—­å‘å¸ƒè€…</span>        <span class="token comment" spellcheck="true">// æ­£å¼ç¯å¢ƒ åº”è¯¥æ”¾ finally æˆ–è€…ä½¿ç”¨ try-resouce ç¡®ä¿å…³é—­</span>        publiser<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// ä¸»çº¿ç¨‹å»¶è¿Ÿåœæ­¢, å¦åˆ™æ•°æ®æ²¡æœ‰æ¶ˆè´¹å°±é€€å‡º</span>        Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœ:</p><blockquote><p>å¤„ç†å™¨æ¥å—åˆ°æ•°æ®: -111<br>å¤„ç†å™¨æ¥å—åˆ°æ•°æ®: 111<br>å¤„ç†å™¨å¤„ç†å®Œäº†!<br>æ¥å—åˆ°æ•°æ®: è½¬æ¢åçš„æ•°æ®:111<br>å¤„ç†å®Œäº†!</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> springboot </tag>
            
            <tag> webflux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>springbootä¹‹â€œæœåŠ¡ç«¯æ¨é€äº‹ä»¶SSEï¼ˆserver-send-eventsï¼‰â€</title>
      <link href="2018/07/01/springboot-zhi-fu-wu-duan-tui-song-shi-jian-sse-server-send-events/"/>
      <url>2018/07/01/springboot-zhi-fu-wu-duan-tui-song-shi-jian-sse-server-send-events/</url>
      
        <content type="html"><![CDATA[<p>server-send-eventsç®€å•åº”ç”¨demo<br><a href="https://www.jianshu.com/p/9a0e802b2297">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="1-åº”ç”¨åœºæ™¯"><a href="#1-åº”ç”¨åœºæ™¯" class="headerlink" title="1.åº”ç”¨åœºæ™¯"></a>1.åº”ç”¨åœºæ™¯</h2><p>å½“æˆ‘ä»¬åšå¼‚æ­¥è¯·æ±‚å¤„ç†çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯çš„è¯·æ±‚ä¸æ˜¯ç«‹å³è¿”å›çš„ï¼Œè€Œæ˜¯åœ¨æœåŠ¡ç«¯æœ‰æ•°æ®çš„æ—¶å€™æ‰å‘é€ç»™å®¢æˆ·ç«¯çš„ã€‚æœ¬ä¾‹æ¼”ç¤ºæ˜¯æœåŠ¡ç«¯æ•°æ®æ˜¯å¦å¤–çš„äº‹ä»¶è§¦å‘å¹¶æ¨é€ç»™å®¢æˆ·ç«¯çš„ã€‚</p><p>å½“ä½¿ç”¨å¾®ä¿¡æˆ–è€…æ”¯ä»˜å®æ‰«ç æ”¯ä»˜çš„æ—¶å€™ï¼Œåœ¨å®¢æˆ·æ”¯ä»˜æˆåŠŸä¹‹åï¼Œåå°å¾—åˆ°å¾®ä¿¡(æ”¯ä»˜å®)å›è°ƒéœ€è¦é€šçŸ¥æˆ‘ä»¬çš„å®¢æˆ·ç«¯æ”¯ä»˜å·²ç»å®Œæˆï¼Œå®¢æˆ·ç«¯å¾—åˆ°é€šçŸ¥åå¯ä»¥åšä¸€äº›åç»­çš„æ“ä½œã€‚<br>è¿™æ¶‰åŠåˆ°åå°éœ€è¦å°†æ”¯ä»˜æˆåŠŸçš„æ¶ˆæ¯ä¸»åŠ¨æ¨é€ç»™å®¢æˆ·ç«¯ï¼Œè®©å®¢æˆ·ç«¯è®°æ€§åç»­çš„æ“ä½œã€‚</p><ul><li>å®¢æˆ·ç«¯å‘åå°(<code>SseController-&gt;push</code>)å‘é€å¼‚æ­¥è¯·æ±‚ï¼Œå®¢æˆ·ç«¯å¤„äºç›‘å¬ç­‰å¾…çŠ¶æ€;</li><li>å¾®ä¿¡(æ”¯ä»˜å®)æ”¯ä»˜æˆåŠŸåå›è°ƒåå°(<code>SseController-&gt;payCallback</code>æ¨¡æ‹Ÿ);</li><li><code>payCallback</code>æ–¹æ³•é€šè¿‡<code>applicationContext.publishEvent</code>å‘ç³»ç»Ÿå†…éƒ¨å‘é€æ”¯ä»˜å®Œæˆäº‹ä»¶;</li><li>pushæ–¹æ³•é€šè¿‡<code>payCompletedListener</code>ç›‘å¬äº‹ä»¶å¹¶é€šè¿‡<code>SseEmitter</code>å‘é€ç»™å®¢æˆ·ç«¯ã€‚<br>åè¯è§£é‡Šï¼š<code>SSEâ€“server send event</code>æ˜¯ä¸€ç§æœåŠ¡ç«¯æ¨é€çš„æŠ€æœ¯ï¼Œæœ¬ä¾‹ä½¿ç”¨<code>SseEmitter</code>æ¥å®ç°ã€‚<h2 id="2-ä¸Šä»£ç "><a href="#2-ä¸Šä»£ç " class="headerlink" title="2. ä¸Šä»£ç "></a>2. ä¸Šä»£ç </h2>web api æ¥å£ç±»<code>SseController</code></li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SseController</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Autowired</span>    ApplicationContext applicationContext<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    PayCompletedListener payCompletedListener<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/push"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> SseEmitter <span class="token function">push</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> Long payRecordId<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">final</span> SseEmitter emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SseEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>           payCompletedListener<span class="token punctuation">.</span><span class="token function">addSseEmitters</span><span class="token punctuation">(</span>payRecordId<span class="token punctuation">,</span>emitter<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>            emitter<span class="token punctuation">.</span><span class="token function">completeWithError</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> emitter<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/pay-callback"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> String <span class="token function">payCallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> Long payRecordId<span class="token punctuation">)</span><span class="token punctuation">{</span>        applicationContext<span class="token punctuation">.</span><span class="token function">publishEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PayCompletedEvent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>payRecordId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">"è¯·åˆ°ç›‘å¬å¤„æŸ¥çœ‹æ¶ˆæ¯"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ”¯ä»˜å®Œæˆäº‹ä»¶ <code>PayCompletedEvent</code></p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Getter</span><span class="token annotation punctuation">@Setter</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PayCompletedEvent</span> <span class="token keyword">extends</span> <span class="token class-name">ApplicationEvent</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> Long payRecordId<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">PayCompletedEvent</span><span class="token punctuation">(</span>Object source<span class="token punctuation">,</span> Long payRecordId<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>payRecordId <span class="token operator">=</span> payRecordId<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ”¯ä»˜å®Œæˆäº‹ä»¶ç›‘å¬å™¨<code>PayCompletedListener</code></p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PayCompletedListener</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> Map<span class="token operator">&lt;</span>Long<span class="token punctuation">,</span>SseEmitter<span class="token operator">></span> sseEmitters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hashtable</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addSseEmitters</span><span class="token punctuation">(</span>Long payRecordId<span class="token punctuation">,</span> SseEmitter sseEmitter<span class="token punctuation">)</span> <span class="token punctuation">{</span>        sseEmitters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>payRecordId<span class="token punctuation">,</span> sseEmitter<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@EventListener</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deployEventHandler</span><span class="token punctuation">(</span>PayCompletedEvent payCompletedEvent<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>        Long payRecordId <span class="token operator">=</span> payCompletedEvent<span class="token punctuation">.</span><span class="token function">getPayRecordId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        SseEmitter sseEmitter <span class="token operator">=</span> sseEmitters<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>payRecordId<span class="token punctuation">)</span><span class="token punctuation">;</span>        sseEmitter<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"æ”¯ä»˜æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sseEmitter<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-æ•ˆæœæ¼”ç¤º"><a href="#3-æ•ˆæœæ¼”ç¤º" class="headerlink" title="3. æ•ˆæœæ¼”ç¤º"></a>3. æ•ˆæœæ¼”ç¤º</h2><ul><li><p>  å…ˆè®¿é—®<code>http://localhost:8080/push?payRecordId=123</code>,æ­¤æ—¶å®¢æˆ·ç«¯å¤„äºç­‰å¾…çŠ¶æ€.<br><img src="/loading.gif" data-original="/images/java/springboot/springboot-sse1.png" alt="sse1.png"></p></li><li><p>  å†è®¿é—®<code>http://localhost:8080/pay-callback?payRecordId=123</code>,æ¨¡æ‹Ÿå›è°ƒé€šçŸ¥å®¢æˆ·ç«¯æ”¯ä»˜æˆåŠŸ,è¿™æ˜¯ä¼šé€šçŸ¥ä¸Šä¸€æ­¥å¹¶æ¨é€åˆ°å®¢æˆ·ç«¯.<br><img src="/loading.gif" data-original="/images/java/springboot/springboot-sse1.png" alt="sse2.png"></p></li></ul><h2 id="4-å¦å¤–ä¸€ä¸ªæç®€çš„ä¾‹å­"><a href="#4-å¦å¤–ä¸€ä¸ªæç®€çš„ä¾‹å­" class="headerlink" title="4. å¦å¤–ä¸€ä¸ªæç®€çš„ä¾‹å­"></a>4. å¦å¤–ä¸€ä¸ªæç®€çš„ä¾‹å­</h2><ul><li>æœåŠ¡ç«¯æ¨¡æ‹Ÿservletçš„ä¸€ä¸ªgetè¯·æ±‚</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>TimeUnit<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletException<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>WebServlet<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServlet<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletRequest<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletResponse<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * Servlet implementation class SSE */</span><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/SSE"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SSE</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 1L<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * @see HttpServlet#HttpServlet()     */</span>    <span class="token keyword">public</span> <span class="token function">SSE</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// TODO Auto-generated constructor stub</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse     *      response)     */</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span>            HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/event-stream"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// æŒ‡å®šäº‹ä»¶æ ‡è¯†</span>            response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"event:me\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// æ ¼å¼: data: + æ•°æ® + 2ä¸ªå›è½¦</span>            response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"data:"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">"\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse     *      response)     */</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span>            HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// TODO Auto-generated method stub</span>        <span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ¨¡æ‹Ÿå®¢æˆ·ç«¯çš„ä»£ç </li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Insert title here<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">        <span class="token comment" spellcheck="true">// åˆå§‹åŒ–, å‚æ•°ä¸ºurl</span>        <span class="token comment" spellcheck="true">// ä¾èµ–H5</span>        <span class="token keyword">var</span> sse <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span><span class="token string">"SSE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sse<span class="token punctuation">.</span>onmessage <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>data<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// ç›‘å¬æŒ‡å®šäº‹ä»¶, (å°±ä¸ä¼šè¿›å…¥onmessageäº†)</span>        sse<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"me"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"me event"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// å¦‚æœä¸å…³é—­,ä¼šè‡ªåŠ¨é‡è¿</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                sse<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ•ˆæœ<br><img src="/loading.gif" data-original="/images/java/springboot/springboot-sse-no-lis.png" alt="æ²¡æœ‰åŠ ç‰¹æ®Šäº‹ä»¶ç›‘å¬ä¹‹å‰"></li></ul><p><img src="/loading.gif" data-original="/images/java/springboot/springboot-sse-lis-me.png" alt="åªç›‘å¬meäº‹ä»¶"></p><h2 id="5-é¸£è°¢"><a href="#5-é¸£è°¢" class="headerlink" title="5.é¸£è°¢"></a>5.é¸£è°¢</h2><p><a href="http://www.wisely.top/2018/03/01/sse-eventlistener/">http://www.wisely.top/2018/03/01/sse-eventlistener/</a></p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> springboot </tag>
            
            <tag> sse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>springboot ä¹‹ â€œå®šæ—¶ä»»åŠ¡-åŠ¨æ€ä¿®æ”¹è¡¨è¾¾å¼â€</title>
      <link href="2018/06/29/springboot-zhi-ding-shi-ren-wu-dong-tai-xiu-gai-biao-da-shi/"/>
      <url>2018/06/29/springboot-zhi-ding-shi-ren-wu-dong-tai-xiu-gai-biao-da-shi/</url>
      
        <content type="html"><![CDATA[<p>å®šæ—¶ä»»åŠ¡ä¸»è¦ç”¨äºå®šæ—¶å‘é€é‚®ä»¶ã€å¤œé—´è‡ªåŠ¨ç»´æŠ¤ç­‰ã€‚<br><a href="https://www.jianshu.com/p/dedb5f8ecfc0">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>ï¼ˆ1ï¼‰å¼€å¯å®šæ—¶ä»»åŠ¡åŠŸèƒ½  </p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>  <span class="token annotation punctuation">@EnableScheduling</span>  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringTaskScheduleConfig</span> <span class="token punctuation">{</span>      <span class="token annotation punctuation">@Bean</span>      <span class="token keyword">public</span> TaskScheduler <span class="token function">poolScheduler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          ThreadPoolTaskScheduler scheduler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolTaskScheduler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          scheduler<span class="token punctuation">.</span><span class="token function">setThreadNamePrefix</span><span class="token punctuation">(</span><span class="token string">"poolScheduler"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          scheduler<span class="token punctuation">.</span><span class="token function">setPoolSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">return</span> scheduler<span class="token punctuation">;</span>      <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ–è€…åœ¨è¿è¡Œç±»TaskApplicationæ·»åŠ ä¸Š**@EnableScheduling**æ³¨è§£ã€‚<br>ï¼ˆ2ï¼‰ä¸»è§’ç™»åœºï¼Œæ·»åŠ å®šæ—¶ä»»åŠ¡</p><ul><li>ç®€å•æ–¹å¼ï¼šä¿®æ”¹å®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œå‘¨æœŸï¼›</li></ul><p> æŒ‰æ­£å¸¸æ¥è®²ï¼Œä¿®æ”¹å®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œå‘¨æœŸï¼ŒæŠŠæœåŠ¡åœä¸‹æ¥ï¼Œæ”¹ä¸‹ä»»åŠ¡çš„cronå‚æ•°ï¼Œå†é‡å¯æœåŠ¡å°±ææå®šäº†ã€‚è¿™ç§æ–¹å¼å¾ˆç®€å•ï¼Œæ²¡æœ‰å¯è¯´çš„ï¼Œä½†æ˜¯æœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½ï¼Œåœ¨ä¸åœæœåŠ¡çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥åŠ¨æ€çš„ä¿®æ”¹ä»»åŠ¡çš„cronå‚æ•°å‘¢ï¼Ÿå“ˆå“ˆï¼Œé‚£æ˜¯å¿…é¡»çš„å¿…ã€‚<br>æ¯”å¦‚ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>hczt<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>task<span class="token punctuation">.</span>service<span class="token punctuation">.</span>UserTaskService<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>scheduling<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Scheduled<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Component<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Resource<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç”¨æˆ·èœå•å®šæ—¶è®¾ç½® */</span><span class="token annotation punctuation">@Slf4j</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserMenuTask</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Resource</span>    <span class="token keyword">private</span> UserTaskService userTaskService<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * æ¯å¤©ä¸€ç‚¹è¿›è¡ŒåŒæ­¥     */</span>    <span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"0 0 1 * * *"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"-----Start Set User Menus -----"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        userTaskService<span class="token punctuation">.</span><span class="token function">timeSetMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"-----End Set User Menus -----"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åŠ¨æ€ä¿®æ”¹å®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œå‘¨æœŸï¼›</li></ul><p>é¦–å…ˆæˆ‘ä»¬å…ˆä¼šå›é¡¾ä¸‹ï¼Œæˆ‘ä»¬ä¹‹å‰æ˜¯ä½¿ç”¨äº†@Scheduled(cron =â€œ0/5 * * * * *â€)è¿™ç§æ–¹å¼é€‚ç”¨äºå›ºå®šä»»åŠ¡å‘¨æœŸçš„ä»»åŠ¡ï¼Œè‹¥è¦ä¿®æ”¹ä»»åŠ¡æ‰§è¡Œå‘¨æœŸï¼Œåªèƒ½èµ°â€œåœæœåŠ¡â€”ä¿®æ”¹ä»»åŠ¡æ‰§è¡Œå‘¨æœŸâ€”é‡å¯æœåŠ¡â€è¿™æ¡è·¯ã€‚é‚£ä¹ˆå¦‚ä½•åŠ¨æ€ä¿®æ”¹å‘¢ï¼Œæˆ‘ä»¬çœ‹ä¸‹æ­¥éª¤ï¼š</p><p>â‘  åœ¨å®šæ—¶ä»»åŠ¡ç±»ä¸Šå¢åŠ @EnabledSchedulingæ³¨è§£ï¼Œå¹¶å®ç°SchedulingConfigureræ¥å£ã€‚<br>â‘¡ è®¾ç½®ä¸€ä¸ªé™æ€çš„cronï¼Œç”¨äºå­˜æ”¾ä»»åŠ¡æ‰§è¡Œå‘¨æœŸå‚æ•°ã€‚<br>â‘¢ å¼€å¯ä¸€ä¸ªçº¿ç¨‹ï¼Œç”¨äºæ¨¡æ‹Ÿå®é™…ä¸šåŠ¡ä¸­å¤–éƒ¨åŸå› ä¿®æ”¹äº†ä»»åŠ¡æ‰§è¡Œå‘¨æœŸã€‚<br>â‘£ è®¾ç½®ä»»åŠ¡è§¦å‘å™¨ï¼Œè§¦å‘ä»»åŠ¡æ‰§è¡Œã€‚<br> æœ¬é¡¹ç›®æ˜¯åŸºäºspring data jpaçš„ï¼Œæ•°æ®æ£€ç´¢ä½¿ç”¨çš„æ˜¯repositoryï¼Œå…·ä½“åˆ›å»ºæ•°æ®è¡¨ï¼š</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>t_scheduled_task_cron<span class="token punctuation">`</span> <span class="token punctuation">(</span>    <span class="token punctuation">`</span>task_cron_id<span class="token punctuation">`</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'idè‡ªå¢'</span><span class="token punctuation">,</span>    <span class="token punctuation">`</span>task_code<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'å®šæ—¶ä»»åŠ¡ç¼–ç '</span><span class="token punctuation">,</span>    <span class="token punctuation">`</span>task_name<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'å®šæ—¶ä»»åŠ¡åç§°'</span><span class="token punctuation">,</span>    <span class="token punctuation">`</span>task_package<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'å®šæ—¶ä»»åŠ¡åŒ…å'</span><span class="token punctuation">,</span>    <span class="token punctuation">`</span>task_cron<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'å®šæ—¶ä»»åŠ¡æ‰§è¡Œè¡¨è¾¾å¼'</span><span class="token punctuation">,</span>    <span class="token punctuation">`</span>task_cron_description<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span><span class="token punctuation">,</span>    <span class="token punctuation">`</span>remark<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'å¤‡æ³¨'</span><span class="token punctuation">,</span>    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>task_cron_id<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶é—´å­˜å‚¨è¡¨'</span><span class="token keyword">COLLATE</span><span class="token operator">=</span><span class="token string">'utf8mb4_general_ci'</span><span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ›å»ºå®ä½“</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author marvin.ma * @create 2018-06-28 22:35 * @desc å®šæ—¶ä»»åŠ¡è¡¨è¾¾å¼å®ä½“ **/</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@Entity</span><span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"t_scheduled_task_cron"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduledTaskCron</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Id</span>    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> GenerationType<span class="token punctuation">.</span>IDENTITY<span class="token punctuation">)</span>    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"task_cron_id"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> String taskCronId<span class="token punctuation">;</span>    <span class="token keyword">private</span> String taskCode<span class="token punctuation">;</span>    <span class="token keyword">private</span> String taskName<span class="token punctuation">;</span>    <span class="token keyword">private</span> String taskPackage<span class="token punctuation">;</span>    <span class="token keyword">private</span> String taskCron<span class="token punctuation">;</span>    <span class="token keyword">private</span> String taskCronDescription<span class="token punctuation">;</span>    <span class="token keyword">private</span> String remark<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ›å»ºrepository</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>hczt<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>db<span class="token punctuation">.</span>user<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>ScheduledTaskCron<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>repository<span class="token punctuation">.</span>JpaRepository<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author marvin.ma * @create 2018-06-28 22:37 * @desc å®šæ—¶ä»»åŠ¡è¡¨è¾¾å¼dao **/</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ScheduledTaskCronRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token operator">&lt;</span>ScheduledTaskCron<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token punctuation">{</span>    ScheduledTaskCron <span class="token function">findByTaskCode</span><span class="token punctuation">(</span>String taskCode<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ›å»ºå®šæ—¶ä»»åŠ¡</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>hczt<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>db<span class="token punctuation">.</span>user<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>ScheduledTaskCron<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>hczt<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>db<span class="token punctuation">.</span>user<span class="token punctuation">.</span>repository<span class="token punctuation">.</span>ScheduledTaskCronRepository<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>hczt<span class="token punctuation">.</span>haier<span class="token punctuation">.</span>task<span class="token punctuation">.</span>service<span class="token punctuation">.</span>UserTaskService<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang3<span class="token punctuation">.</span>StringUtils<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>scheduling<span class="token punctuation">.</span>Trigger<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>scheduling<span class="token punctuation">.</span>TriggerContext<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>scheduling<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>SchedulingConfigurer<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>scheduling<span class="token punctuation">.</span>config<span class="token punctuation">.</span>ScheduledTaskRegistrar<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>scheduling<span class="token punctuation">.</span>support<span class="token punctuation">.</span>CronTrigger<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Component<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>text<span class="token punctuation">.</span>SimpleDateFormat<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Date<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç²¾è¯šæ‰€è‡³ï¼Œé‡‘çŸ³ä¸ºå¼€ã€‚ * çŸ³ã®ä¸Šã«ã‚‚ä¸‰å¹´;é™½æ°—ã®ç™ºã™ã‚‹æ‰€é‡‘çŸ³äº¦é€ã‚‹ã€‚ * Faith moves mountains. * * @author marvin.ma * @create 2018-06-28 13:27 * @desc åŠ¨æ€è¡¨è¾¾å¼å®šæ—¶ä»»åŠ¡ **/</span><span class="token annotation punctuation">@Component</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicScheduledTask</span> <span class="token keyword">implements</span> <span class="token class-name">SchedulingConfigurer</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> SimpleDateFormat dateFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String DEFAULT_CRON <span class="token operator">=</span> <span class="token string">"0/5 * * * * ?"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> String cron <span class="token operator">=</span> DEFAULT_CRON<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> ScheduledTaskCronRepository scheduledTaskCronRepository<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> UserTaskService userTaskService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configureTasks</span><span class="token punctuation">(</span>ScheduledTaskRegistrar taskRegistrar<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Runnable task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// å®šæ—¶ä»»åŠ¡çš„ä¸šåŠ¡é€»è¾‘</span>                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åŠ¨æ€ä¿®æ”¹å®šæ—¶ä»»åŠ¡cronå‚æ•°ï¼Œå½“å‰æ—¶é—´ï¼š"</span> <span class="token operator">+</span> dateFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                userTaskService<span class="token punctuation">.</span><span class="token function">timeSetMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        Trigger trigger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> Date <span class="token function">nextExecutionTime</span><span class="token punctuation">(</span>TriggerContext triggerContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// å®šæ—¶ä»»åŠ¡è§¦å‘ï¼Œå¯ä¿®æ”¹å®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œå‘¨æœŸ</span>                ScheduledTaskCron scheduledTaskCronEntity <span class="token operator">=</span> scheduledTaskCronRepository<span class="token punctuation">.</span><span class="token function">findByTaskCode</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>null <span class="token operator">==</span> scheduledTaskCronEntity <span class="token operator">||</span> StringUtils<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>scheduledTaskCronEntity<span class="token punctuation">.</span><span class="token function">getTaskCron</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    cron <span class="token operator">=</span> DEFAULT_CRON<span class="token punctuation">;</span>                <span class="token punctuation">}</span>                CronTrigger trigger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CronTrigger</span><span class="token punctuation">(</span>cron<span class="token punctuation">)</span><span class="token punctuation">;</span>                Date nextExecDate <span class="token operator">=</span> trigger<span class="token punctuation">.</span><span class="token function">nextExecutionTime</span><span class="token punctuation">(</span>triggerContext<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> nextExecDate<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        taskRegistrar<span class="token punctuation">.</span><span class="token function">addTriggerTask</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> trigger<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCron</span><span class="token punctuation">(</span>String cron<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>cron <span class="token operator">=</span> cron<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹æ•°æ®åº“åå®šæ—¶ä»»åŠ¡ç«‹å³ç”Ÿæ•ˆã€‚</p><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="http://412887952-qq-com.iteye.com/blog/2367537">http://412887952-qq-com.iteye.com/blog/2367537</a><br><a href="http://rensanning.iteye.com/blog/2361912">http://rensanning.iteye.com/blog/2361912</a></p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> springboot </tag>
            
            <tag> å®šæ—¶ä»»åŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ngrokä¸€åˆ†é’Ÿå®ç°å†…ç½‘ç©¿é€</title>
      <link href="2018/06/26/shi-yong-ngrok-yi-fen-zhong-shi-xian-nei-wang-chuan-tou/"/>
      <url>2018/06/26/shi-yong-ngrok-yi-fen-zhong-shi-xian-nei-wang-chuan-tou/</url>
      
        <content type="html"><![CDATA[<p>ä¸€åˆ†é’Ÿæœ‰ç‚¹å¤¸å¼ ï¼Œ5åˆ†é’Ÿæ€»å¯ä»¥å°†æœ¬åœ°webæœåŠ¡æ˜ å°„åˆ°å…¬ç½‘äº†å§ã€‚<br><a href="https://www.jianshu.com/p/4f008e2b7622">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="1ã€-å› æœ"><a href="#1ã€-å› æœ" class="headerlink" title="1ã€ å› æœ"></a>1ã€ å› æœ</h2><p>å‘¨æœ«ä½œä¸ºçº¯åç«¯ï¼Œä¸å‰ç«¯åŒäº‹è”è°ƒå¾®ä¿¡jsapiçš„æˆæƒæ¥å£ï¼Œå¬è¯´å°±ä¸€ä¸ªæ¥å£ï¼Œä¸ç”¨æ•°æ®åº“ï¼Œä¸é¸Ÿæƒé™çš„äº‹ï¼Œå°±æ˜¯ä»æœåŠ¡ç«¯å‘å¾®ä¿¡å‘èµ·ä¸€ä¸ªè¯·æ±‚tokenå’Œticketçš„æ¥å£ï¼Œè¿”å›ç»™å‰ç«¯è€Œå·²ã€‚åŸè®¡åˆ’åŠä¸ªå°æ—¶æå®šçš„ï¼Œç»“æœæäº†ä¸‰ä¸ªå¤šå°æ—¶ï¼Œå¦‚æœä¸æ˜¯å‚è€ƒåŸæ¥ä¸€ä¸ªé¡¹ç›®é‡Œçš„å®ç°ï¼Œä¼°è®¡åœ¨åŠ ä¸¤ä¸ªå°æ—¶ä¹Ÿä¸ä¸€å®šèƒ½æå‡ºä¸ªæˆå“ã€‚<br>å› ä¸ºå¾®ä¿¡é™åˆ¶è°ƒç”¨é¢‘æ¬¡ï¼Œè€Œä¸”æœ¬åœ°è·å–è¿˜éœ€è¦åŠ ç™½åå•ï¼Œä½†æ˜¯ç»™å‰ç«¯åŒäº‹è”è°ƒçš„è¯è¿˜éœ€è¦æ‰“åŒ…æ‰”åˆ°ä¸€å°å…¬ç½‘æœåŠ¡å™¨ä¸Šï¼Œç”šæ˜¯éº»çƒ¦å•Šï¼Œäºæ˜¯æƒ³è¿™æ¬¡å¼„å®Œçœ‹çœ‹æä¸€ä¸ªå†…ç½‘ç©¿é€ï¼Œå†æœ‰ç±»ä¼¼åœºæ™¯ï¼Œç›´æ¥ä½¿ç”¨ã€‚</p><h2 id="2ã€åè¯è§£é‡Š"><a href="#2ã€åè¯è§£é‡Š" class="headerlink" title="2ã€åè¯è§£é‡Š"></a>2ã€åè¯è§£é‡Š</h2><h3 id="2-1ã€ä¸ºä»€ä¹ˆéœ€è¦å†…ç½‘ç©¿é€"><a href="#2-1ã€ä¸ºä»€ä¹ˆéœ€è¦å†…ç½‘ç©¿é€" class="headerlink" title="2.1ã€ä¸ºä»€ä¹ˆéœ€è¦å†…ç½‘ç©¿é€"></a>2.1ã€ä¸ºä»€ä¹ˆéœ€è¦å†…ç½‘ç©¿é€</h3><p>å½“å†…ç½‘ä¸­çš„ä¸»æœºæ²¡æœ‰é™æ€IPåœ°å€è¦è¢«å¤–ç½‘ç¨³å®šè®¿é—®æ—¶å¯ä»¥ä½¿ç”¨å†…ç½‘ç©¿é€</p><p>åœ¨äº’è”ç½‘ä¸­å”¯ä¸€å®šä½ä¸€å°ä¸»æœºçš„æ–¹æ³•æ˜¯é€šè¿‡å…¬ç½‘çš„IPåœ°å€ï¼Œä½†å›ºå®šIPæ˜¯ä¸€ç§éå¸¸ç¨€ç¼ºçš„èµ„æºï¼Œä¸å¯èƒ½ç»™æ¯ä¸ªå…¬å¸éƒ½åˆ†é…ä¸€ä¸ªï¼Œä¸”è®¸å¤šä¸­å°å…¬å¸ä¸æ„¿æ„ä¸ºé«˜æ˜‚çš„è´¹ç”¨ä¹°å•ï¼Œå¤šæ•°å…¬å¸ç›´æ¥æˆ–é—´æ¥çš„æ‹¨å·ä¸Šç½‘ï¼Œç”µä¿¡éƒ¨é—¨ä¼šç»™æ¥å…¥ç½‘ç»œçš„ç”¨æˆ·åˆ†é…IPåœ°å€ï¼Œä»¥å‰ä¸Šç½‘ç”¨æˆ·å°‘çš„æ—¶å€™åŸºæœ¬åˆ†é…çš„éƒ½æ˜¯ä¸´æ—¶çš„é™æ€IPåœ°å€ï¼Œç§Ÿçº¦è¿‡äº†ä¹‹åå¯èƒ½ä¼šæ›´æ¢æˆå¦ä¸€ä¸ªIPåœ°å€ï¼Œè¿™æ ·å¤–ç½‘è®¿é—®å°±ä¸ç¨³å®šï¼Œå› ä¸ºå†…ç½‘çš„é™æ€IPåœ°å€ä¸€ç›´å˜åŒ–ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨åŠ¨æ€åŸŸåè§£æçš„åŠæ³•å˜æ¢åŸŸåæŒ‡å‘çš„é™æ€IPåœ°å€ã€‚ä½†æ˜¯ç°åœ¨è¶Šæ¥è¶Šå¤šçš„ä¸Šç½‘ç”¨æˆ·ä½¿å¾—ä¸´æ—¶åˆ†é…çš„é™æ€IPåœ°å€ä¹Ÿä¸å¤Ÿç”¨äº†ï¼Œç”µä¿¡éƒ¨é—¨å¼€å§‹åˆ†é…ä¸€äº›è™šæ‹Ÿçš„é™æ€IPåœ°å€ï¼Œè¿™äº›IPæ˜¯å…¬ç½‘ä¸èƒ½ç›´æ¥è®¿é—®çš„ï¼Œå¦‚ä»¥125å¼€å¤´çš„ä¸€äº›IPåœ°å€ï¼Œä»¥å‰å•çº¯çš„åŠ¨æ€åŸŸåè§£æå°±ä¸å¥½ç”¨äº†ã€‚</p><h3 id="2-2ã€å†…ç½‘ç©¿é€çš„å®šä¹‰ä¸éšœç¢"><a href="#2-2ã€å†…ç½‘ç©¿é€çš„å®šä¹‰ä¸éšœç¢" class="headerlink" title="2.2ã€å†…ç½‘ç©¿é€çš„å®šä¹‰ä¸éšœç¢"></a>2.2ã€å†…ç½‘ç©¿é€çš„å®šä¹‰ä¸éšœç¢</h3><p>ç®€å•æ¥è¯´å®ç°ä¸åŒå±€åŸŸç½‘å†…çš„ä¸»æœºä¹‹é—´é€šè¿‡äº’è”ç½‘è¿›è¡Œé€šä¿¡çš„æŠ€æœ¯å«å†…ç½‘ç©¿é€ã€‚</p><p><strong>éšœç¢ä¸€</strong>ï¼šä½äºå±€åŸŸç½‘å†…çš„ä¸»æœºæœ‰ä¸¤å¥— IP åœ°å€ï¼Œä¸€å¥—æ˜¯å±€åŸŸç½‘å†…çš„ IP åœ°å€ï¼Œé€šå¸¸æ˜¯åŠ¨æ€åˆ†é…çš„ï¼Œä»…ä¾›å±€åŸŸç½‘å†…çš„ä¸»æœºé—´é€šä¿¡ä½¿ç”¨ï¼›ä¸€å¥—æ˜¯ç»è¿‡ç½‘å…³è½¬æ¢åçš„å¤–ç½‘ IP åœ°å€ï¼Œç”¨äºä¸å¤–ç½‘ç¨‹ã€‚</p><p><img src="/loading.gif" data-original="/images/tools/ngrok-jiagou.png" alt="ngrokåŸç†å›¾"></p><p><strong>éšœç¢äºŒï¼š</strong>ä½äºä¸åŒå±€åŸŸç½‘å†…çš„ä¸¤å°ä¸»æœºï¼Œå³ä½¿æ˜¯çŸ¥é“äº†å¯¹æ–¹çš„ IP åœ°å€å’Œç«¯å£å·ï¼Œâ€œä¸€å¢æƒ…æ„¿â€åœ°å°†æ•°æ®åŒ…å‘é€è¿‡å»ï¼Œå¯¹æ–¹ä¹Ÿæ˜¯æ¥æ”¶ä¸åˆ°çš„ã€‚</p><p>å› ä¸ºå‡ºäºå®‰å…¨èµ·è§ï¼Œé™¤éæ˜¯ä¸»æœºä¸»åŠ¨å‘å¯¹æ–¹å‘å‡ºäº†è¿æ¥è¯·æ±‚ï¼ˆè¿™æ—¶ä¼šåœ¨è¯¥ä¸»æœºçš„æ•°æ®ç»“æ„ä¸­ç•™ä¸‹ä¸€æ¡è®°å½•ï¼‰ï¼Œå¦åˆ™ï¼Œå½“ä¸»æœºæ¥æ”¶åˆ°æ•°æ®åŒ…æ—¶ï¼Œå¦‚æœåœ¨å…¶æ•°æ®ç»“æ„ä¸­æŸ¥è¯¢ä¸åˆ°å¯¹åº”çš„è®°å½•ï¼Œé‚£äº›ä¸è¯·è‡ªæ¥çš„æ•°æ®åŒ…å°†ä¼šè¢«ä¸¢å¼ƒã€‚</p><p><img src="/loading.gif" data-original="/images/tools/ngrok-jiagou2.png" alt="ngrokåŸç†å›¾2"></p><p>è§£å†³åŠæ³•ï¼šè¦æƒ³è§£å†³ä»¥ä¸Šä¸¤å¤§éšœç¢ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©ä¸€å°å…·æœ‰å…¬ç½‘ IP çš„æœåŠ¡å™¨è¿›è¡Œæ¡¥æ¥ã€‚</p><h2 id="3ã€-é€‰å‹"><a href="#3ã€-é€‰å‹" class="headerlink" title="3ã€ é€‰å‹"></a>3ã€ é€‰å‹</h2><h3 id="3-1ã€èŠ±ç”Ÿå£³"><a href="#3-1ã€èŠ±ç”Ÿå£³" class="headerlink" title="3.1ã€èŠ±ç”Ÿå£³"></a>3.1ã€èŠ±ç”Ÿå£³</h3><p>èŠ±ç”Ÿå£³æ—¢æ˜¯å†…ç½‘ç©¿é€è½¯ä»¶ã€å†…ç½‘æ˜ å°„è½¯ä»¶,ä¹Ÿæ˜¯ç«¯å£æ˜ å°„è½¯ä»¶ã€‚è§„æ¨¡æœ€å¤§ï¼Œè¾ƒæ­£è§„ï¼Œå®Œå–„ã€‚</p><p>æ”¶è´¹é«˜ï¼Œä½¿ç”¨ç®€å•</p><p>å®˜ç½‘ï¼š<a href="http://www.oray.com/">http://www.oray.com/</a></p><p><img src="/loading.gif" data-original="/images/tools/ngrok-huashengke.png" alt="èŠ±ç”Ÿå£³"></p><h3 id="3-2ã€Nat123"><a href="#3-2ã€Nat123" class="headerlink" title="3.2ã€Nat123"></a>3.2ã€Nat123</h3><p>nat123æ˜¯å†…ç½‘ç«¯å£æ˜ å°„ä¸åŠ¨æ€åŸŸåè§£æè½¯ä»¶ï¼Œåœ¨å†…ç½‘å¯åŠ¨æ˜ å°„åï¼Œå¯åœ¨å¤–ç½‘è®¿é—®è¿æ¥å†…ç½‘ç½‘ç«™ç­‰åº”ç”¨ã€‚æ•´ä¸ªç½‘ç«™æˆ‘éƒ½æ²¡æœ‰æ‰¾åˆ°å®¢æœç”µè¯ï¼Œç½‘å‹å‘äº†ä¸€äº›åé¢çš„è¯„ä»·</p><p>æ”¶è´¹ï¼Œä½¿ç”¨ç®€å•</p><p>å®˜ç½‘ï¼š<a href="http://www.nat123.com/">http://www.nat123.com</a></p><p><img src="/loading.gif" data-original="/images/tools/ngrok-nat123.png" alt="Nat123"></p><h3 id="3-3ã€NATAPP"><a href="#3-3ã€NATAPP" class="headerlink" title="3.3ã€NATAPP"></a>3.3ã€NATAPP</h3><p>NATAPPåŸºäºngrokçš„å›½å†…å†…ç½‘ç©¿é€æœåŠ¡ï¼Œå…è´¹ç‰ˆä¼šå¼ºåˆ¶æ›´æ¢åŸŸåï¼Œä¸´æ—¶ç”¨ä¸€ä¸‹å¯ä»¥</p><p>æ”¶è´¹ï¼Œä½¿ç”¨ç®€å•</p><p>å®˜ç½‘ï¼š<a href="https://natapp.cn/">https://natapp.cn/</a></p><p><img src="/loading.gif" data-original="/images/tools/ngrok-NATAPP.png" alt="NATAPP"></p><h3 id="3-4ã€frpä¸å…¶å®ƒ"><a href="#3-4ã€frpä¸å…¶å®ƒ" class="headerlink" title="3.4ã€frpä¸å…¶å®ƒ"></a>3.4ã€frpä¸å…¶å®ƒ</h3><p>frp æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„åå‘ä»£ç†åº”ç”¨ï¼Œå¯ä»¥å¸®åŠ©æ‚¨è½»æ¾åœ°è¿›è¡Œå†…ç½‘ç©¿é€ï¼Œå¯¹å¤–ç½‘æä¾›æœåŠ¡ï¼Œæ”¯æŒ tcp, http, https ç­‰åè®®ç±»å‹ï¼Œå¹¶ä¸” web æœåŠ¡æ”¯æŒæ ¹æ®åŸŸåè¿›è¡Œè·¯ç”±è½¬å‘ã€‚</p><p>å¼€æºå…è´¹</p><p>ä½¿ç”¨ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦ä»£ç†æœåŠ¡å™¨æ”¯æŒ</p><p>å®˜ç½‘ï¼š<a href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a></p><p>æ–‡æ¡£ï¼š<a href="http://www.cnblogs.com/%E6%9F%A5%E7%9C%8B%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3">æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£</a>ï¼Œ<a href="http://www.jianshu.com/p/e8e26bcc6fe6">ç®€ä¹¦ç¤ºä¾‹</a></p><p>åˆ©ç”¨å¤„äºå†…ç½‘æˆ–é˜²ç«å¢™åçš„æœºå™¨ï¼Œå¯¹å¤–ç½‘ç¯å¢ƒæä¾› http æˆ– https æœåŠ¡ã€‚</p><p>å¯¹äº http, https æœåŠ¡æ”¯æŒåŸºäºåŸŸåçš„è™šæ‹Ÿä¸»æœºï¼Œæ”¯æŒè‡ªå®šä¹‰åŸŸåç»‘å®šï¼Œä½¿å¤šä¸ªåŸŸåå¯ä»¥å…±ç”¨ä¸€ä¸ª80ç«¯å£ã€‚</p><p>åˆ©ç”¨å¤„äºå†…ç½‘æˆ–é˜²ç«å¢™åçš„æœºå™¨ï¼Œå¯¹å¤–ç½‘ç¯å¢ƒæä¾› tcp å’Œ udp æœåŠ¡ï¼Œä¾‹å¦‚åœ¨å®¶é‡Œé€šè¿‡ ssh è®¿é—®å¤„äºå…¬å¸å†…ç½‘ç¯å¢ƒå†…çš„ä¸»æœºã€‚</p><p><img src="/loading.gif" data-original="/images/tools/ngrok-frp.png" alt="frp"></p><p>å› ä¸ºfrp ä»ç„¶å¤„äºå‰æœŸå¼€å‘é˜¶æ®µï¼Œæœªç»å……åˆ†æµ‹è¯•ä¸éªŒè¯ï¼Œä¸æ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œæ‰€æœ‰æˆ‘é€‰æ‹©äº†ngrokï¼Œèµ„æ–™æ¯”è¾ƒå¤šã€‚</p><p>è¿˜æœ‰å¦‚åœ£å‰‘å†…ç½‘é€šã€ngrokï¼ˆå¼€æºå…è´¹ï¼‰ã€<a href="https://post.smzdm.com/p/564494/">æ›´å¤šåŠæ³•</a></p><h3 id="3-5ã€ngrok"><a href="#3-5ã€ngrok" class="headerlink" title="3.5ã€ngrok"></a>3.5ã€ngrok</h3><p>ngrokæ˜¯ä¸€ä¸ªåå‘ä»£ç†ï¼Œé€šè¿‡åœ¨å…¬å…±çš„ç«¯ç‚¹å’Œæœ¬åœ°è¿è¡Œçš„WebæœåŠ¡å™¨ä¹‹é—´å»ºç«‹ä¸€ä¸ªå®‰å…¨çš„é€šé“ã€‚ngrokå¯æ•è·å’Œåˆ†ææ‰€æœ‰é€šé“ä¸Šçš„æµé‡ï¼Œä¾¿äºåæœŸåˆ†æä¸å“åº”ã€‚</p><p>å¼€æºå…è´¹</p><p>å®˜ç½‘ï¼š<a href="https://ngrok.com/">https://ngrok.com/</a></p><p>æºç ï¼š<a href="https://github.com/inconshreveable/ngrok">https://github.com/inconshreveable/ngrok</a></p><p><img src="/loading.gif" data-original="/images/tools/ngrok.png" alt="ngrok"></p><p>ngrok1.xå¼€æºï¼Œngrok2.xä¸å¼€æº</p><p>ngrokä½¿ç”¨goè¯­è¨€å¼€å‘ï¼Œæºä»£ç åˆ†ä¸ºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯ã€‚</p><p>å›½å†…å…è´¹æœåŠ¡å™¨ï¼š<a href="http://ngrok.ciqiuwl.cn/">http://ngrok.ciqiuwl.cn/</a>ï¼Œæ›´å¤šå…è´¹æœåŠ¡å™¨è¯·å¤§å®¶æŒ–æ˜ï¼Œèµ„æºå…±äº«ï¼Œæˆ‘éšæ—¶æ›´æ–°ï¼šï¼‰</p><p>å¦‚æœæœ‰æœåŠ¡å™¨ï¼Œä»…å®¢æˆ·ç«¯çš„ä½¿ç”¨æ˜¯ä¸å¤æ‚çš„ï¼Œä»¥ä¸Šé¢çš„å…è´¹æœåŠ¡å™¨ä¸ºç¤ºä¾‹å®Œæˆå†…ç½‘ç©¿é€</p><p><strong>æœ¬å±Œä¸ä¸€å‘æ²¡æœ‰å¤šä½™é’±ç»™æœåŠ¡å•†ï¼Œåªèƒ½æœç´¢å…è´¹çš„ï¼Œæœ€åé€‰äº†ngrok</strong></p><h2 id="3ã€-æ­å»º"><a href="#3ã€-æ­å»º" class="headerlink" title="3ã€ æ­å»º"></a>3ã€ æ­å»º</h2><p>æ­å»ºè¿‡ç¨‹å¾ˆç®€å•ï¼Œå¦‚æœå‚è€ƒå®˜ç½‘ä¼°è®¡ä¼šèµ°ç‚¹å¼¯è·¯ï¼Œå› ä¸ºwindowså¯¹å¾ˆå¤šä¸œè¥¿éƒ½æœ‰è¿™è¦æ±‚ã€‚ä¸è¿‡è¿˜å¥½ï¼Œæ‰¾åˆ°äº†<a href="http://ngrok.ciqiuwl.cn/">å°ç±³çƒngrok</a>ï¼Œè®©æ‰€è°“çš„æ­å»ºå¥½åƒæ²¡ä»€ä¹ˆå¯ä»¥è¯´çš„äº†ã€‚<br>å¤åˆ¶ä¸€ä¸‹ä½¿ç”¨æ•™ç¨‹ã€‚</p><blockquote><p><strong>â—windowsç”¨æˆ·:</strong><br>1ã€ä¸‹è½½windowsç‰ˆæœ¬çš„å®¢æˆ·ç«¯ï¼Œè§£å‹åˆ°ä½ å–œæ¬¢çš„ç›®å½•<br>2ã€åœ¨å‘½ä»¤è¡Œä¸‹è¿›å…¥åˆ°ngrokå®¢æˆ·ç«¯ç›®å½•ä¸‹<br>3ã€æ‰§è¡Œ ngrok -config=ngrok.cfg -subdomain xxx 80 //(xxx æ˜¯ä½ è‡ªå®šä¹‰çš„åŸŸåå‰ç¼€)<br>4ã€å¦‚æœå¼€å¯æˆåŠŸ ä½ å°±å¯ä»¥ä½¿ç”¨ xxx.ngrok.xiaomiqiu.cn æ¥è®¿é—®ä½ æœ¬æœºçš„ 127.0.0.1:80 çš„æœåŠ¡å•¦<br>5ã€å¦‚æœä½ è‡ªå·±æœ‰é¡¶çº§åŸŸåï¼Œæƒ³é€šè¿‡è‡ªå·±çš„åŸŸåæ¥è®¿é—®æœ¬æœºçš„é¡¹ç›®ï¼Œé‚£ä¹ˆå…ˆå°†è‡ªå·±çš„é¡¶çº§åŸŸåè§£æåˆ°&gt;120.25.161.137(åŸŸåéœ€è¦å·²å¤‡æ¡ˆå“¦)ï¼Œç„¶åæ‰§è¡Œ ngrok -config=ngrok.cfg -hostname xxx.xxx.xxx 80 //(xxx.xxx.xxxæ˜¯ä½ è‡ªå®šä¹‰çš„é¡¶çº§åŸŸå)<br>6ã€å¦‚æœå¼€å¯æˆåŠŸ ä½ å°±å¯ä»¥ä½¿ç”¨ä½ çš„é¡¶çº§åŸŸåæ¥è®¿é—®ä½ æœ¬æœºçš„ 127.0.0.1:80 çš„æœåŠ¡å•¦<br>7ã€å¦‚æœå¤±è´¥ å°±åŠ ä¸‹äº¤æµç¾¤ åé¦ˆä¸‹é—®é¢˜ æœ¬å±Œä¼šçœ‹çœ‹ä»€ä¹ˆåŸå› â€¦.å§<br>8ã€å¦‚æœå®åœ¨é—²å‘½ä»¤æ‰“å¼€éº»çƒ¦ï¼Œwindowsç‰ˆæä¾›äº†ä¸€é”®å¯åŠ¨è„šæœ¬ï¼ç›´æ¥å¯åŠ¨å³å¯ï¼ˆå…¶å®ƒç‰ˆæœ¬æ²¡æœ‰è„šæœ¬ï¼‰<br><strong>â—linuxç”¨æˆ·:</strong><br>åªåœ¨centos6.5 amd64 ä¸‹æµ‹è¯•æ²¡æœ‰é—®é¢˜<br>1ã€ä¸‹è½½linuxç‰ˆæœ¬çš„å®¢æˆ·ç«¯ï¼Œè§£å‹åˆ°ä½ å–œæ¬¢çš„ç›®å½•,æ³¨æ„ï¼šè¦ç»™ngrokæ–‡ä»¶çš„å¯æ‰§è¡Œæƒé™<br>2ã€åœ¨å‘½ä»¤è¡Œä¸‹è¿›å…¥åˆ°ngrokå®¢æˆ·ç«¯ç›®å½•ä¸‹<br>3ã€æ‰§è¡Œ ./ngrok -config=ngrok.cfg -subdomain xxx 80 //(xxx æ˜¯ä½ è‡ªå®šä¹‰çš„åŸŸåå‰ç¼€)<br>4ã€å¦‚æœå¼€å¯æˆåŠŸ ä½ å°±å¯ä»¥ä½¿ç”¨ xxx.ngrok.xiaomiqiu.cn æ¥è®¿é—®ä½ æœ¬æœºçš„ 127.0.0.1:80 çš„æœåŠ¡å•¦<br>5ã€å¦‚æœä½ è‡ªå·±æœ‰é¡¶çº§åŸŸåï¼Œæƒ³é€šè¿‡è‡ªå·±çš„åŸŸåæ¥è®¿é—®æœ¬æœºçš„é¡¹ç›®ï¼Œé‚£ä¹ˆå…ˆå°†è‡ªå·±çš„é¡¶çº§åŸŸåè§£æåˆ°120.25.161.137 (åŸŸåéœ€è¦å·²å¤‡æ¡ˆå“¦),ç„¶åæ‰§è¡Œ./ngrok -config=ngrok.cfg -hostname xxx.xxx.xxx 80 //(xxx.xxx.xxxæ˜¯ä½ è‡ªå®šä¹‰çš„é¡¶çº§åŸŸå)<br>6ã€å¦‚æœå¼€å¯æˆåŠŸ ä½ å°±å¯ä»¥ä½¿ç”¨ä½ çš„é¡¶çº§åŸŸåæ¥è®¿é—®ä½ æœ¬æœºçš„ 127.0.0.1:80 çš„æœåŠ¡å•¦<br>7ã€æœ€è¿‘æœ‰å¾ˆå¤šåŒå­¦æåˆ°éœ€è¦linux32ä½ä¸armç‰ˆæœ¬ï¼Œè¿™è¾¹ä¹Ÿæ–°å¢äº†ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼Œç”±äºæœ¬å±Œæ²¡æœ‰ç›¸åº”è®¾å¤‡æˆ–ç¯å¢ƒï¼Œè¯·è‡ªè¡Œæµ‹è¯•ï¼Œå¦‚æœæœ‰é—®é¢˜ï¼Œå¯ä»¥åé¦ˆã€‚<br>8ã€å¦‚æœå¤±è´¥ å°±åŠ ä¸‹äº¤æµç¾¤ åé¦ˆä¸‹é—®é¢˜ æœ¬å±Œä¼šçœ‹çœ‹ä»€ä¹ˆåŸå› â€¦.å§<br><strong>â—Mac ç”¨æˆ·:</strong><br>1ã€å‘ƒ,è™½ç„¶æä¾›äº†macç‰ˆçš„å®¢æˆ·ç«¯ï¼Œä½†æ˜¯æœ¬å±Œæ²¡æœ‰macï¼Œæ‰€æœ‰æ²¡æœ‰æµ‹è¯•ï¼<br>2ã€æ‰€ä»¥ä½ ä¸‹è½½äº†ä¹‹å è‡ªå·±ç¢ç£¨å§(åº”è¯¥å’Œlinuxçš„ä½¿ç”¨ä¸€æ ·â€¦.å§)â€¦â€¦.<br><strong>â—å…¶ä»–ä½¿ç”¨æ–¹æ³•</strong><br>1ã€å‘ƒ,è™½ç„¶æ­å»ºäº†ngrokæœåŠ¡ï¼Œä½†æ˜¯å®é™…ä¸Šä¸Šé¢çš„æ•™ç¨‹åªä»‹ç»äº†ä¸€äº›ç®€å•çš„æ“ä½œ<br>2ã€ngrokè¿˜æœ‰è®¸å¤šä½¿ç”¨æ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥å¤šäº†è§£æ¢ç´¢ä¸€ä¸‹<br>3ã€æ¯”å¦‚ï¼ŒåŒæ—¶å¼€å¯å¤šä¸ªæœåŠ¡ï¼ŒTCPç«¯å£è½¬å‘ï¼Œè¿™äº›å¤§å®¶å¯ä»¥åœ¨.cfgä¸Šè¿›è¡Œé…ç½®ï¼Œæœ¬å±Œå°±ä¸ä¸€ä¸€å™è¿°äº†ã€‚</p></blockquote><h3 id="3-1ã€ä¸‹è½½"><a href="#3-1ã€ä¸‹è½½" class="headerlink" title="3.1ã€ä¸‹è½½"></a>3.1ã€ä¸‹è½½</h3><p><a href="https://pan.baidu.com/s/1xiKDwzaTnOZFloKnGxSM6g">ä¸‹è½½</a> windows 64ä½ç‰ˆï¼ˆå¯†ç : p6n6ï¼‰ï¼Œå¹¶è§£å‹ï¼Œå†…åŒ…å«3ä¸ªæ–‡ä»¶ï¼š</p><blockquote><p>ngrok.cfg<br>ngrok.exe<br>å°ç±³çƒNgrokå¯åŠ¨å·¥å…·.bat</p></blockquote><h3 id="3-2ã€è¿è¡Œæœ¬åœ°webæœåŠ¡"><a href="#3-2ã€è¿è¡Œæœ¬åœ°webæœåŠ¡" class="headerlink" title="3.2ã€è¿è¡Œæœ¬åœ°webæœåŠ¡"></a>3.2ã€è¿è¡Œæœ¬åœ°webæœåŠ¡</h3><p>æˆ‘ç°åœ¨æœ¬åœ°è¿è¡Œæˆ‘çš„ç¨‹åºï¼Œåœ¨80ç«¯å£ä¸Šï¼Œè¿è¡Œèµ·æ¥ä»¥åè®¿é—®æˆ‘å†™çš„è·å–å¾®ä¿¡ç­¾åçš„æ¥å£ï¼š<br><img src="/loading.gif" data-original="/images/tools/ngrok-local-web.png" alt="æœ¬åœ°webæ¥å£"></p><h3 id="3-3ã€å¯åŠ¨ngrokï¼Œé…ç½®æ˜ å°„"><a href="#3-3ã€å¯åŠ¨ngrokï¼Œé…ç½®æ˜ å°„" class="headerlink" title="3.3ã€å¯åŠ¨ngrokï¼Œé…ç½®æ˜ å°„"></a>3.3ã€å¯åŠ¨ngrokï¼Œé…ç½®æ˜ å°„</h3><p><img src="/loading.gif" data-original="/images/tools/ngrok-start.png" alt="é…ç½®è®¿é—®åŸŸåå’Œç«¯å£"><br>å›è½¦ï¼Œæç¤ºé…ç½®æˆåŠŸï¼Œæ˜¾ç¤ºå‡ºè®¿é—®åœ°å€ï¼š</p><p><img src="/loading.gif" data-original="/images/tools/ngrok-address.png" alt="æ˜¾ç¤ºå‡ºç©¿é€åœ°å€"></p><p>æŒ‰ç…§æç¤ºåœ¨æµè§ˆå™¨è®¿é—®ä¸€ä¸‹:<br>![ç”¨å…¬ç”¨åŸŸåè®¿é—®](/images/tools/ngrok-public-host.png</p><p>ç„¶åå†è§‚å¯Ÿngrokçš„æ§åˆ¶å°ï¼Œå‘ç°å·²ç»è®°å½•äº†ä¸€æ¡è®¿é—®access logï¼š<br><img src="/loading.gif" data-original="/images/tools/ngrok-log.png" alt="ngrokæ§åˆ¶å°log"></p><p>åˆ°æ­¤ï¼Œç©¿é€å®Œæ¯•ï¼Œso easyï¼</p><h2 id="é¸£è°¢"><a href="#é¸£è°¢" class="headerlink" title="é¸£è°¢"></a>é¸£è°¢</h2><p>æ„Ÿè°¢<a href="http://ngrok.ciqiuwl.cn/">å°ç±³çƒ</a>çš„åˆ†äº«<br><a href="https://www.jianshu.com/p/c273d3009ded">è¿™ç¯‡</a>æ–‡ç« ç”¨ngrokå®˜ç½‘çš„æŒ‡å¯¼ä½¿ç”¨ä¹Ÿä¸é”™</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
            <tag> server </tag>
            
            <tag> ç½‘ç»œ </tag>
            
            <tag> å†…ç½‘ç©¿é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react nativeé¡¹ç›®ç¼–è¯‘ï¼Œæ‰“åŒ…æˆandroid APP</title>
      <link href="2018/06/15/react-native-xiang-mu-bian-yi-da-bao-cheng-android-app/"/>
      <url>2018/06/15/react-native-xiang-mu-bian-yi-da-bao-cheng-android-app/</url>
      
        <content type="html"><![CDATA[<p>ç¼–è¯‘react nativeé¡¹ç›®ï¼Œå¹¶æœ€ç»ˆæ‰“åŒ…æˆå®‰å“çš„apkåŒ…<br><a href="https://www.jianshu.com/p/2cd763f11004">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h3 id="ç¬¬åç« -ç¦»çº¿æ‰“åŒ…å‘å¸ƒ"><a href="#ç¬¬åç« -ç¦»çº¿æ‰“åŒ…å‘å¸ƒ" class="headerlink" title="ç¬¬åç«  ç¦»çº¿æ‰“åŒ…å‘å¸ƒ"></a>ç¬¬åç«  ç¦»çº¿æ‰“åŒ…å‘å¸ƒ</h3><h4 id="10-2-Androidæ‰“åŒ…å‘å¸ƒ"><a href="#10-2-Androidæ‰“åŒ…å‘å¸ƒ" class="headerlink" title="10.2 Androidæ‰“åŒ…å‘å¸ƒ"></a>10.2 Androidæ‰“åŒ…å‘å¸ƒ</h4><h6 id="1ï¼‰å°†jsä»£ç æ‰“åŒ…æˆjsbundleåŒ…"><a href="#1ï¼‰å°†jsä»£ç æ‰“åŒ…æˆjsbundleåŒ…" class="headerlink" title="1ï¼‰å°†jsä»£ç æ‰“åŒ…æˆjsbundleåŒ…"></a>1ï¼‰å°†jsä»£ç æ‰“åŒ…æˆjsbundleåŒ…</h6><ul><li><p>åœ¨androidå·¥ç¨‹ä¸­åˆ›å»ºassetsæ–‡ä»¶å¤¹ï¼Œå¯ä»¥ç”¨å‘½ä»¤è¡Œåˆ›å»ºï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼Œå‘½ä»¤å¦‚ä¸‹:</p><blockquote><p>mkdir  android/app/src/main/assets </p></blockquote></li></ul><ul><li>åœ¨å·¥ç¨‹çš„æ ¹ç›®å½•è¾“å…¥å¦‚ä¸‹å‘½ä»¤è¿›è¡Œæ‰“åŒ…</li></ul><blockquote><p>react-native bundle â€“entry-file demo/index.js â€“bundle-output ./android/app/src/main/assets/index.android.jsbundle â€“platform android â€“assets-dest ./android/app/src/main/res/ â€“dev false</p></blockquote><p>ã€æ³¨æ„ï¼šä¸Šè¿°å‘½ä»¤ä¸­ â€œdemo/index/.jsâ€æ˜¯ä½ å·¥ç¨‹çš„å®‰å“å…¥å£æ–‡ä»¶ç›®å½•ã€‘</p><blockquote><p>-entry-file æŒ‡å®šå…¥å£æ–‡ä»¶ å› ä¸ºè¦æ‰“åŒ…ioså¹³å°ï¼Œæ‰€ä»¥æŒ‡å®šä¸ºrné¡¹ç›®çš„index.ios.jsä½œä¸ºå…¥å£<br>  â€“bundle-output æŒ‡å®šè¾“å‡ºçš„jsbundleæ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶å æŒ‡å®šåˆ°rné¡¹ç›®çš„ioså·¥ç¨‹æ–‡ä»¶å¤¹ä¸‹ï¼Œè®°å¾—ä¸€å®šè¦å…ˆåˆ›å»ºbundleæ–‡ä»¶å¤¹ï¼Œä¸ç„¶ç»ˆç«¯ä¼šæŠ¥æ–‡ä»¶å¤¹æ‰¾ä¸åˆ°çš„é”™è¯¯<br>  â€“platform æŒ‡å®šå¹³å°ç±»å‹<br>  â€“assets-dest æŒ‡å®šèµ„æºæ–‡ä»¶å¤¹è·¯å¾„ assetsæ–‡ä»¶å¤¹çš„è·¯å¾„ï¼ŒåŒ…å«å›¾ç‰‡ã€nodeæ¨¡å—ç­‰èµ„æº<br>  â€“dev æ˜¯å¦ä¸ºå¼€å‘æ¨¡å¼ å¦‚æœè®¾ç½®ä¸ºfalseï¼Œä¸ä¼šäº§ç”Ÿè­¦å‘Šï¼Œå¹¶ä¸”bundleä¼šè¢«å‹ç¼©<br>  è¿˜æœ‰å…¶ä»–å‘½ä»¤ï¼Œæ¯”å¦‚ï¼štransformerã€prepackã€bundle-encodingç­‰ï¼Œå¯ä»¥åˆ°å®˜ç½‘æŸ¥çœ‹å…·ä½“ä»‹ç»ã€‚</p></blockquote><ul><li>åœ¨<code>MyApplication.java</code>ä¸­çš„ReactNativeHost<code>ä¸­æ·»åŠ </code>getBundleAssetName`æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¿…é¡»ä¸ä¸Šä¸€æ­¥ä¸­ç”Ÿæˆçš„jsbundleæ–‡ä»¶çš„æ–‡ä»¶åä¿æŒä¸€è‡´ã€‚</li></ul><pre class="line-numbers language-java"><code class="language-java">         <span class="token annotation punctuation">@Nullable</span>         <span class="token annotation punctuation">@Override</span>         <span class="token keyword">protected</span> String <span class="token function">getBundleAssetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>             <span class="token keyword">return</span> <span class="token string">"index.android.bundle"</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h6 id="2ï¼‰åˆ©ç”¨å‘½ä»¤è¡Œæ‰“åŒ…å®‰å“APK"><a href="#2ï¼‰åˆ©ç”¨å‘½ä»¤è¡Œæ‰“åŒ…å®‰å“APK" class="headerlink" title="2ï¼‰åˆ©ç”¨å‘½ä»¤è¡Œæ‰“åŒ…å®‰å“APK"></a>2ï¼‰åˆ©ç”¨å‘½ä»¤è¡Œæ‰“åŒ…å®‰å“APK</h6><p>Androidè¦æ±‚æ‰€æœ‰åº”ç”¨éƒ½å¿…é¡»æœ‰ä¸€ä¸ªç­¾åè¯ä¹¦æ‰å…è®¸å®‰è£…åœ¨æ‰‹æœºä¸Šï¼Œæ‰€ä»¥ï¼Œåœ¨æŠŠåº”ç”¨å‘å¸ƒåˆ°åº”ç”¨å¸‚åœºä¹‹å‰å¿…é¡»ç”Ÿæˆ1ä¸ªç­¾åçš„apkåŒ…ã€‚</p><ul><li><p>ç”Ÿæˆç­¾åç§˜é’¥</p><p>åœ¨Windowsä¸Š<code>keytool</code>å‘½ä»¤æ”¾åœ¨JDKçš„binç›®å½•ä¸­ï¼ˆæ¯”å¦‚<code>C:\Program Files\Java\jdkx.x.x_x\bin</code>ï¼‰ï¼Œä½ å¯èƒ½éœ€è¦åœ¨å‘½ä»¤è¡Œä¸­å…ˆè¿›å…¥é‚£ä¸ªç›®å½•æ‰èƒ½æ‰§è¡Œæ­¤å‘½ä»¤ã€‚åœ¨macä¸Šï¼Œå»ºè®®åœ¨å·¥ç¨‹ç›®å½•ä¸‹ç”Ÿæˆï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">$ keytool -genkey -v -keystore my-release-key.keystore -alias my-key-alias -keyalg RSA -keysize 2048 -validity 10000<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><p>ã€æ³¨ï¼škeystoreåç§°å¯è‡ªå·±ä¿®æ”¹ã€‘</p><p>è¿™æ¡å‘½ä»¤ä¼šè¦æ±‚ä½ è¾“å…¥å¯†é’¥åº“ï¼ˆkeystoreï¼‰å’Œå¯¹åº”å¯†é’¥çš„å¯†ç ï¼Œç„¶åè®¾ç½®ä¸€äº›å‘è¡Œç›¸å…³çš„ä¿¡æ¯ã€‚æœ€åå®ƒä¼šç”Ÿæˆä¸€ä¸ªå«åš<code>my-release-key.keystore</code>çš„å¯†é’¥åº“æ–‡ä»¶ã€‚</p><p>åœ¨è¿è¡Œä¸Šé¢è¿™æ¡è¯­å¥ä¹‹åï¼Œå¯†é’¥åº“é‡Œåº”è¯¥å·²ç»ç”Ÿæˆäº†ä¸€ä¸ªå•ç‹¬çš„å¯†é’¥ï¼Œæœ‰æ•ˆæœŸä¸º10000å¤©ã€‚â€“aliaså‚æ•°åé¢çš„åˆ«åæ˜¯ä½ å°†æ¥ä¸ºåº”ç”¨ç­¾åæ—¶æ‰€éœ€è¦ç”¨åˆ°çš„ï¼Œæ‰€ä»¥è®°å¾—è®°å½•è¿™ä¸ªåˆ«åã€‚</p><ul><li><p>è®¾ç½®gradleå˜é‡</p><ol><li><p>æŠŠ<code>my-release-key.keystore</code>æ–‡ä»¶æ”¾åˆ°ä½ å·¥ç¨‹ä¸­çš„<code>android/app</code>æ–‡ä»¶å¤¹ä¸‹ã€‚</p></li><li><p>åœ¨<code>android</code>å·¥ç¨‹çš„<code>gradle.properties</code>æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹ä»£ç ï¼š</p></li></ol></li></ul><pre class="line-numbers language-conf"><code class="language-conf"> MYAPP_RELEASE_STORE_FILE=my-release-key.keystore MYAPP_RELEASE_KEY_ALIAS=my-key-alias MYAPP_RELEASE_STORE_PASSWORD=hongchuang MYAPP_RELEASE_KEY_PASSWORD=hongchuang<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ·»åŠ ç­¾ååˆ°gradleé…ç½®æ–‡ä»¶<br>ç¼–è¾‘ä½ é¡¹ç›®ç›®å½•ä¸‹çš„<code>android/app/build.gradle</code>ï¼Œæ·»åŠ å¦‚ä¸‹çš„ç­¾åé…ç½®ï¼š</li></ul><pre><code>  ...  android {      ...      defaultConfig { ... }      signingConfigs {          release {              storeFile file(MYAPP_RELEASE_STORE_FILE)              storePassword MYAPP_RELEASE_STORE_PASSWORD              keyAlias MYAPP_RELEASE_KEY_ALIAS              keyPassword MYAPP_RELEASE_KEY_PASSWORD          }      }      buildTypes {          release {              ...              signingConfig signingConfigs.release          }      }  }  ...</code></pre><ul><li><p>ç”Ÿæˆç­¾åapkåŒ…</p><blockquote><p>cd android</p><p>./gradlew  assembleRelease</p></blockquote></li></ul><p><code>./gradlew assembleRelease</code>åœ¨macOSã€Linuxæˆ–æ˜¯windowsçš„PowerShellç¯å¢ƒä¸­è¡¨ç¤ºæ‰§è¡Œå½“å‰ç›®å½•ä¸‹çš„åä¸ºgradlewçš„è„šæœ¬æ–‡ä»¶ï¼Œä¸”å…¶è¿è¡Œå‚æ•°ä¸ºassembleReleaseï¼Œæ³¨æ„è¿™ä¸ª<code>./</code>ä¸å¯çœç•¥ï¼›è€Œåœ¨windowsçš„ä¼ ç»ŸCMDå‘½ä»¤è¡Œä¸‹åˆ™éœ€è¦å»æ‰<code>./</code>ã€‚</p><p>Gradleçš„<code>assembleRelease</code>å‚æ•°ä¼šæŠŠæ‰€æœ‰ç”¨åˆ°çš„JavaScriptä»£ç éƒ½æ‰“åŒ…åˆ°ä¸€èµ·ï¼Œç„¶åå†…ç½®åˆ°APKåŒ…ä¸­ã€‚å¦‚æœä½ æƒ³è°ƒæ•´ä¸‹è¿™ä¸ªè¡Œä¸ºï¼ˆæ¯”å¦‚jsä»£ç ä»¥åŠé™æ€èµ„æºæ‰“åŒ…çš„é»˜è®¤æ–‡ä»¶åæˆ–æ˜¯ç›®å½•ç»“æ„ç­‰ï¼‰ï¼Œå¯ä»¥çœ‹çœ‹<code>android/app/build.gradle</code>æ–‡ä»¶ï¼Œç„¶åç¢ç£¨ä¸‹åº”è¯¥æ€ä¹ˆä¿®æ”¹ä»¥æ»¡è¶³ä½ çš„éœ€æ±‚ã€‚</p><p>ç”Ÿæˆçš„APKæ–‡ä»¶ä½äº<code>android/app/build/outputs/apk/app-release.apk</code>ï¼Œå®ƒå·²ç»å¯ä»¥ç”¨æ¥å‘å¸ƒäº†ã€‚</p><ul><li><p>æµ‹è¯•ç­¾ååŒ…</p><p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…ä¸Šä¸€æ­¥ç”Ÿæˆçš„ç­¾ååŒ…ï¼Œæ¥è¿›è¡Œæµ‹è¯•ã€‚</p><blockquote><p>cd android</p><p>./gradlew installRelease</p></blockquote><p>æ³¨æ„<code>installRelease</code>å‚æ•°åªèƒ½åœ¨ä½ å®Œæˆäº†ä¸Šé¢çš„ç­¾åé…ç½®ä¹‹åæ‰å¯ä»¥ä½¿ç”¨ã€‚ ä½ ç°åœ¨å¯ä»¥å…³æ‰è¿è¡Œä¸­çš„packageräº†ï¼Œå› ä¸ºä½ æ‰€æœ‰çš„ä»£ç å’Œæ¡†æ¶ä¾èµ–å·²ç»éƒ½è¢«æ‰“åŒ…åˆ°apkåŒ…ä¸­ï¼Œå¯ä»¥ç¦»çº¿è¿è¡Œäº†ã€‚</p><p>åœ¨debugå’Œreleaseç‰ˆæœ¬é—´æ¥å›åˆ‡æ¢å®‰è£…æ—¶å¯èƒ½ä¼šæŠ¥é”™ç­¾åä¸åŒ¹é…ï¼Œæ­¤æ—¶éœ€è¦å…ˆå¸è½½å‰ä¸€ä¸ªç‰ˆæœ¬å†å°è¯•å®‰è£…ã€‚</p></li><li><p>å¯ç”¨Proguardä»£ç æ··æ·†æ¥ç¼©å°apkæ–‡ä»¶å¤§å°ï¼ˆå¯é€‰ï¼‰</p><p>Proguardæ˜¯ä¸€ä¸ªJavaå­—èŠ‚ç æ··æ·†å‹ç¼©å·¥å…·ï¼Œå®ƒå¯ä»¥ç§»é™¤æ‰React Native Javaï¼ˆå’Œå®ƒçš„ä¾èµ–åº“ä¸­ï¼‰ä¸­æ²¡æœ‰è¢«ä½¿ç”¨åˆ°çš„éƒ¨åˆ†ï¼Œæœ€ç»ˆæœ‰æ•ˆçš„å‡å°‘APKçš„å¤§å°ã€‚</p><p>ã€å¯ç”¨Proguardä¹‹åï¼Œä½ å¿…é¡»å†æ¬¡å…¨é¢åœ°æµ‹è¯•ä½ çš„åº”ç”¨ã€‚Proguardæœ‰æ—¶å€™éœ€è¦ä¸ºä½ å¼•å…¥çš„æ¯ä¸ªåŸç”Ÿåº“åšä¸€äº›é¢å¤–çš„é…ç½®ã€‚å‚è§<code>app/proguard-rules.pro</code>æ–‡ä»¶ã€‚ã€‘</p><p>å¯ç”¨æ–¹æ³•æ˜¯ä¿®æ”¹androidå·¥ç¨‹çš„<code>build.gradle</code>æ–‡ä»¶ï¼Œè®¾ç½®<code>minifyEnabled</code>é€‰é¡¹ä¸º<code>true</code></p></li></ul><pre class="line-numbers language-conf"><code class="language-conf">   buildTypes {            release {                signingConfig signingConfigs.release            minifyEnabled true                proguardFile 'proguard.txt'            }        }   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h6 id="3ï¼‰åˆ©ç”¨androidStudioæ‰“åŒ…ç”Ÿæˆapk"><a href="#3ï¼‰åˆ©ç”¨androidStudioæ‰“åŒ…ç”Ÿæˆapk" class="headerlink" title="3ï¼‰åˆ©ç”¨androidStudioæ‰“åŒ…ç”Ÿæˆapk"></a>3ï¼‰åˆ©ç”¨androidStudioæ‰“åŒ…ç”Ÿæˆapk</h6><ul><li><p>åˆ©ç”¨AndroidStudioç”Ÿæˆç­¾åç§˜é’¥</p><p>å…·ä½“æ–¹æ³•æ˜¯ï¼ŒandroidStudioâ€”&gt;Buildâ€”&gt;Generate Signed apkâ€”&gt;ç‚¹å‡»ã€nextã€‘â€”&gt;ã€Create newã€‘</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/loading.gif" data-original="http://7xqi6y.com1.z0.glb.clouddn.com/keystore1.png"></p><p>ç„¶åè¿›å…¥åˆ›å»ºçª—å£ï¼Œé€‰æ‹©keystoreè·¯å¾„ï¼Œkey storeå¯†ç ï¼Œç„¶åä¸‹é¢å¦‚å›¾æ‰€ç¤ºè¾“å…¥å…¬å¸åŠå¼€å‘è€…ä¿¡æ¯ï¼Œä¿¡æ¯è¾“å…¥å®Œæˆåç‚¹å‡»ã€okã€‘å³å¯ç”Ÿæˆkeystoreã€‚</p><p><img src="/loading.gif" data-original="http://7xqi6y.com1.z0.glb.clouddn.com/keystore2.png"></p><p>æ­¤å¤„çš„keystore password è·Ÿkey  Alias ä»¥åŠpassword éœ€è¦è®°ä½ï¼Œå½“åˆ©ç”¨keystoreæ‰“åŒ…æ—¶éœ€è¦å¡«å†™ã€‚</p></li><li><p>åˆ©ç”¨AndroidStudioæ‰“åŒ…ç”Ÿæˆç­¾åapk</p><p>æ–¹æ³•è¿˜æ˜¯ï¼ŒandroidStudioâ€”&gt;Buildâ€”&gt;Generate Signed apkâ€”&gt;ç‚¹å‡»ã€nextã€‘â€”&gt;ã€Choose existingã€‘â€”&gt;é€‰æ‹©ä¸Šä¸€æ­¥ç”Ÿæˆçš„keystoreæ–‡ä»¶è·¯å¾„â€”&gt;è¾“å…¥keystoreç›¸å…³ä¿¡æ¯â€”&gt;ã€Nextã€‘</p><p><img src="/loading.gif" data-original="http://7xqi6y.com1.z0.glb.clouddn.com/keystore3.png"></p><p> ç„¶åé€‰æ‹©apkå­˜å‚¨è·¯å¾„â€”&gt;Signature Versions é€‰æ‹©ã€V2ï¼ˆFull APK Signatureï¼‰ã€‘â€”&gt;ã€Finishã€‘ç„¶åç­‰å¾…apk æ‰“åŒ…å®Œæˆå³å¯</p><p><img src="/loading.gif" data-original="http://7xqi6y.com1.z0.glb.clouddn.com/keystore4.png"></p><p> åˆ°è¿™é‡Œï¼Œæ‰“åŒ…å·¥ä½œå°±å®Œæˆäº†ï¼ŒæŠŠapkä¸Šä¼ åº”ç”¨å•†åº—å³å¯ã€‚</p></li></ul><h3 id="æ¨è"><a href="#æ¨è" class="headerlink" title="æ¨è"></a>æ¨è</h3><p>   <a href="https://blog.csdn.net/u011272795/article/details/77161942">å¦ä¸€ç¯‡å¥½åšæ–‡</a></p>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
            <tag> android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react-native å®‰å“é¡¹ç›®gradleä¼˜åŒ–</title>
      <link href="2018/06/15/react-native-an-zhuo-xiang-mu-gradle-you-hua/"/>
      <url>2018/06/15/react-native-an-zhuo-xiang-mu-gradle-you-hua/</url>
      
        <content type="html"><![CDATA[<p>å¤§å‰ç«¯å­¦ä¹ ä¹‹å®‰å“é¡¹ç›®ç¼–è¯‘é€Ÿåº¦ä¼˜åŒ–<br><a href="https://www.jianshu.com/p/d039b1ba4b0c">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>profileæŠ¥å‘Šå‘½ä»¤</p><pre class="line-numbers language-shell"><code class="language-shell">./gradlew clean app:assembleDebug --profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/android/build-profile.png" alt="profileæŠ¥å‘Š"></p><p>1ã€debugç¯å¢ƒç¦æ­¢crashLyticsä¸ŠæŠ¥<br>2ã€é¿å…Legacy Multidex</p><p><img src="/loading.gif" data-original="/images/android/build-profile-diff.png" alt="diffä¿®æ”¹ä»£ç "></p><p><img src="/loading.gif" data-original="/images/android/build-profile2.png" alt="profileæŠ¥å‘Š2"></p><h3 id="è®°å½•"><a href="#è®°å½•" class="headerlink" title="è®°å½•"></a>è®°å½•</h3><p>2018-11-06  11:05  clean<br>gradlew clean app:assembleDebug â€“profile</p><p>1ã€ä¿®æ”¹å‚æ•°ï¼ŒåŠ å¿«build<br>org.gradle.jvmargs=-Xmx4608M -XX:MaxPermSize=512m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8<br>å®‰å“ï¼šéå‘å¸ƒç‰ˆç¦ç”¨fabricä¸ŠæŠ¥ï¼Œä¿®æ”¹jvmargså‚æ•°ï¼Œä½¿å¼€å‘ç¯å¢ƒbuildæ—¶é—´é™è‡³2minä»¥å†…<br><a href="http://www.easemob.com/news/852">http://www.easemob.com/news/852</a><br><a href="https://medium.com/exploring-code/how-to-decrease-your-gradle-build-time-by-65-310b572b0c43">https://medium.com/exploring-code/how-to-decrease-your-gradle-build-time-by-65-310b572b0c43</a></p><p>debugç¯å¢ƒç¦ç”¨fabric<br>éå‘å¸ƒç‰ˆæœ¬å…³é—­Fabirc</p><pre class="line-numbers language-conf"><code class="language-conf">android {    buildTypes {        debug {          // Disable fabric build ID generation for debug builds          ext.enableCrashlytics = false          ...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/zhou-guobao/p/disable-crashlytics-for-debug-builds.html">https://www.cnblogs.com/zhou-guobao/p/disable-crashlytics-for-debug-builds.html</a></p><p>2ã€é…ç½®ä¸åŒçš„å›¾æ ‡<br><a href="https://blog.csdn.net/MAIMIHO/article/details/76106700?utm_source=blogxgwz4">https://blog.csdn.net/MAIMIHO/article/details/76106700?utm_source=blogxgwz4</a></p><p>é…ç½®ä¸åŒappåç§°<br>é‡åˆ°ä¸€ä¸ªé”™è¯¯ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">FAILURE: Build failed with an exception.* What went wrong:Execution failed for task ':app:processDebugManifest'.> Manifest merger failed : Attribute application@label value=(@string/app_name_debug) from AndroidManifest.xml:86:9-37      is also present at [:react-native-fetch-blob] AndroidManifest.xml:11:18-50 value=(@string/app_name).      Suggestion: add 'tools:replace="android:label"' to <application> element at AndroidManifest.xml:80:5-324:19 to override.* Try:Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.* Get more help at https://help.gradle.org<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŒ‰ç…§æç¤ºè§£å†³ï¼Œè§£é‡Šï¼š<a href="https://www.2cto.com/kf/201712/702939.html">https://www.2cto.com/kf/201712/702939.html</a></p><p>3ã€é…ç½®ä¸åŒapplicationId<br>fileprovider  ä¿®æ”¹ï¼Œ<a href="https://www.jianshu.com/p/1afa7d4c0afd">https://www.jianshu.com/p/1afa7d4c0afd</a> æé†’<br>FileHelp.javaä¸­ä½¿ç”¨çˆ¶é¡¹ç›®çš„BuildConf.applicationId</p><p>4ã€æ‰“jsbundleåç”Ÿæˆçš„è¿™ä¸ªåƒåœ¾æ–‡ä»¶<br>D:\Git\pingtai\Portal\android\app\src\main\res\drawable-mdpi\js_commonview_echarts_tpl.html</p><p>5ã€android studio ä¸­distributionUrlä½¿ç”¨æœ¬åœ°æ–‡ä»¶<br>D:\Git\pingtai\Portal\android\gradle\wrapper\gradle-wrapper.properties<br><img src="/loading.gif" data-original="/images/android/build-gradle.png" alt="distributionUrl.png"></p><p>6ã€ä¿®æ”¹combile</p><p>7ã€å¼€å‘ç¯å¢ƒä½¿ç”¨æ¯”android studio è‡ªå¸¦çš„ã€apply changesã€‘æ›´ç‰›é€¼çš„ã€JRebel for Androidã€‘</p><ul><li>1ã€å®‰è£…Jrebelæ’ä»¶ï¼š<a href="https://zeroturnaround.com/software/jrebel-for-android/quick-start/#!/installation">https://zeroturnaround.com/software/jrebel-for-android/quick-start/#!/installation</a></li><li>2ã€æ¿€æ´»å¸®åŠ©ï¼š<a href="http://blog.lanyus.com/archives/299.html">http://blog.lanyus.com/archives/299.html</a><blockquote><p>ç”ŸæˆGUIDï¼š<a href="https://www.qvdv.com/tools/guid.html">https://www.qvdv.com/tools/guid.html</a><br>æˆ‘ç”Ÿæˆçš„ï¼š<a href="http://idea.lanyus.com/E086630D-638A-07A7-58D2-68ED4762D053">http://idea.lanyus.com/E086630D-638A-07A7-58D2-68ED4762D053</a></p></blockquote></li></ul><p><img src="/loading.gif" data-original="/images/android/build-activate.png" alt="activate.png"><br><img src="/loading.gif" data-original="/images/android/build-activated.png" alt="activated.png"></p><ul><li>3ã€é…ç½®å‚è€ƒåšå®¢åœ°å€ï¼š<a href="http://www.czhzero.com/2016/08/10/jrebel-for-android-guide/">http://www.czhzero.com/2016/08/10/jrebel-for-android-guide/</a></li></ul><p>8ã€å‡å°APPçš„ä½“ç§¯</p>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react-native </tag>
            
            <tag> android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlæ•°æ®åº“å®‰è£…å’Œä¸€èˆ¬é…ç½®</title>
      <link href="2018/06/15/mysql-shu-ju-ku-an-zhuang-he-yi-ban-pei-zhi/"/>
      <url>2018/06/15/mysql-shu-ju-ku-an-zhuang-he-yi-ban-pei-zhi/</url>
      
        <content type="html"><![CDATA[<p>åœ¨linuxä¸Šå®‰è£…mysql serverï¼Œè¿›è¡Œå¸¸è§„è®¾ç½®<br><a href="https://www.jianshu.com/p/e3eca6195969">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><p>åŒäº‹é‚£é‡Œçš„æ€»ç»“æ‹¿è¿‡æ¥è‡ªå·±ä¿å­˜ä¸€ä»½ï¼Œç±»ä¼¼çš„æ•™ç¨‹å¤ªå¤šäº†ã€‚</p><h2 id="MySQLæ•°æ®åº“å®‰è£…"><a href="#MySQLæ•°æ®åº“å®‰è£…" class="headerlink" title="MySQLæ•°æ®åº“å®‰è£…"></a>MySQLæ•°æ®åº“å®‰è£…</h2><ol><li><p><strong>å®‰è£…</strong></p><pre class="line-numbers language-shell"><code class="language-shell"># æ›´æ–°åŒ…ç´¢å¼•sudo apt-get update# å®‰è£…sudo apt-get install mysql-server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> å®‰è£…è¿‡ç¨‹ä¸­ä¼šæç¤ºè®¾ç½®rootå¯†ç ã€‚</p></li><li><p><strong>è®¾ç½®</strong></p><pre class="line-numbers language-shell"><code class="language-shell"># æ‰§è¡Œå®‰å…¨è„šæœ¬è®¾ç½®sudo mysql_secure_installation# æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬(æŒ‰æ­¤æ–¹æ³•å®‰è£…ä¸ç”¨æ‰§è¡Œ)# 5.7.6ä¹‹å‰çš„ç‰ˆæœ¬æ‰§è¡Œmysql_install_db# 5.7.6åŠåç»­ç‰ˆæœ¬æ‰§è¡Œmysqld --initialize<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æµ‹è¯•</strong></p><pre class="line-numbers language-shell"><code class="language-shell"># æŸ¥çœ‹mysqlè¿è¡ŒçŠ¶æ€systemctl status mysql.service# å¯åŠ¨Mysqlsudo systemctl start mysql# åœæ­¢Mysqlsudo systemctl stop mysql# é‡å¯Mysqlsudo systemctl restart mysql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h2 id="MySQLæ•°æ®åº“é…ç½®"><a href="#MySQLæ•°æ®åº“é…ç½®" class="headerlink" title="MySQLæ•°æ®åº“é…ç½®"></a>MySQLæ•°æ®åº“é…ç½®</h2><p>æŒ‰æ­¤ç§æ–¹å¼å®‰è£…å®ŒMysqlåï¼Œé…ç½®æ–‡ä»¶é»˜è®¤ä½äº/etc/msyqlä¸‹ï¼Œå…¶ä¸­mysql.conf.dä¸‹çš„mysqld.cnfç”¨äºé…ç½®æœåŠ¡ç«¯ï¼Œconf.dä¸‹çš„mysql.cnfç”¨äºé…ç½®å®¢æˆ·ç«¯ã€‚</p><ol><li><strong>å¿½ç•¥å¤§å°å†™</strong></li></ol><pre class="line-numbers language-shell"><code class="language-shell"># ç¼–è¾‘my.cnfæ–‡ä»¶vim /etc/my.cnf# åœ¨[msyqld]ä¸‹æ·»åŠ å¦‚ä¸‹ä»£ç [mysqld]lower_case_table_names=1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><strong>è®¾ç½®ç¼–ç æ ¼å¼ä¸ºutf8mb4ï¼Œå¹¶æ”¯æŒemojiè¡¨æƒ…</strong></li></ol><pre class="line-numbers language-sh"><code class="language-sh"># ç¼–è¾‘my.cnfæ–‡ä»¶vim /etc/my.cnf[client]default-character-set=utf8mb4[mysqld]character-set-client-handshake = FALSEcharacter-set-server = utf8mb4collation-server = utf8mb4_unicode_ciinit_connect=â€™SET NAMES utf8mb4'[mysql]default-character-set=utf8mb4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>  æ•°æ®åº“ã€è¡¨å’Œå­—æ®µçš„è®¾ç½®åˆ†åˆ«å¦‚ä¸‹ï¼š</p><blockquote><p>1ï¼‰ ä¿®æ”¹databaseçš„å­—ç¬¦é›†ï¼š</p><p> ALTER DATABASE <a href="http://lib.csdn.net/base/mysql">æ•°æ®åº“</a>å CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci;</p><p>ç¤ºä¾‹ï¼š</p><p>ALTER DATABASE xxxdb CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci;</p><p>2ï¼‰ æ­¥éª¤1ï¼‰æ‰§è¡Œå®Œæˆä¹‹åï¼Œéœ€è¦æ‰§è¡Œuse æ•°æ®åº“åï¼ŒæŒ‡æ˜å½“å‰éœ€è¦è¿›è¡Œå­—ç¬¦é›†ä¿®æ”¹çš„æ•°æ®åº“ï¼›ç¤ºä¾‹ï¼šuse xxxdb;</p><p>3ï¼‰ä¿®æ”¹tableçš„å­—ç¬¦é›†ï¼š</p><p>ALTER TABLE è¡¨å CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;</p><p>ç¤ºä¾‹ï¼š</p><p>ALTER TABLE user_comments CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;</p><p>4ï¼‰ ä¿®æ”¹columnçš„å­—ç¬¦é›†ï¼š</p><p>ALTER TABLE è¡¨å CHANGE å­—æ®µå å­—æ®µå è¯¥å­—æ®µåŸæ¥çš„æ•°æ®ç±»å‹ CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;</p><p>ç¤ºä¾‹ï¼š</p><p> ALTER TABLE user_comments CHANGE content content TEXT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;</p></blockquote><ol start="3"><li><strong>è®¾ç½®max_allowed_package</strong></li></ol><pre class="line-numbers language-sh"><code class="language-sh"># ç¼–è¾‘my.cnfæ–‡ä»¶vim /etc/my.cnf[mysqld]max_allowed_packet=100M<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li><p><strong>å…è®¸è¿œç¨‹è®¿é—®</strong></p></li><li><p>1 æ’é˜Ÿç½‘ç»œæˆ–é˜²ç«å¢™é—®é¢˜</p></li></ol><p>  å…ˆçœ‹èƒ½å¦pingé€šè¿œç¨‹æœåŠ¡å™¨ï¼Œå¦‚æœä¸å¯ä»¥å°±æ˜¯ç½‘ç»œé—®é¢˜ã€‚ç„¶åï¼Œæ£€æŸ¥ç«¯å£æ˜¯å¦è¢«é˜²ç«å¢™æŒ¡ä½äº†</p><pre class="line-numbers language-shell"><code class="language-shell">telnet ipåœ°å€ 3306<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>  å¦‚æœè¿æ¥å¤±è´¥ï¼Œé…ç½®é˜²ç«å¢™</p><pre class="line-numbers language-shell"><code class="language-shell"># é˜²ç«å¢™æ”¾å¼€Mysqlç«¯å£iptables -A INPUT -p tcp --dport 3306 -j ACCEPT    iptables -A OUTPUT -p tcp --dport 3306 -j ACCEPT<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>  4.2 æ£€æŸ¥MySQLé…ç½®<br>  å¦‚æœå¼€å¯äº†é˜²ç«å¢™ï¼Œtelnetè¿˜æ˜¯å¤±è´¥ï¼Œé€šè¿‡netstatæŸ¥çœ‹3306çš„ç«¯å£çŠ¶æ€</p><pre class="line-numbers language-shell"><code class="language-shell">netstat -apn | grep 3306# è¿”å›ç»“æœtcp6 0 0 127.0.0.1:3306 :::* LISTEN 13524/mysqld<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>  å¦‚æœæ˜¾ç¤º127.0.0.1ï¼š3306è¡¨ç¤º3306è¢«ç»‘å®šåˆ°äº†æœ¬åœ°ã€‚éœ€è¦ä¿®æ”¹mysqld.conf</p><pre class="line-numbers language-shell"><code class="language-shell"># ç¼–è¾‘mysqld.cnfæ–‡ä»¶vim /etc/mysql/mysql.conf.d/mysqld.cnf[mysqld]bind-address=addr<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>  ä¸é…ç½®æˆ–è€…IPé…ç½®ä¸º0.0.0.0ï¼Œè¡¨ç¤ºç›‘å¬æ‰€æœ‰å®¢æˆ·ç«¯è¿æ¥ã€‚</p><p>  4.3 æ£€æŸ¥ç”¨æˆ·è®¿é—®æƒé™    MySQå»ºç”¨æˆ·çš„æ—¶å€™ä¼šæŒ‡å®šä¸€ä¸ªhost,é»˜è®¤æ˜¯127.0.0.1/localhostï¼Œé‚£ä¹ˆè¿™ä¸ªç”¨æˆ·å°±åªèƒ½æœ¬æœºè®¿é—®ï¼Œå…¶ä»–æœºå™¨ç”¨è¿™ä¸ªè´¦å·è®¿é—®ä¼šæç¤ºæ²¡æœ‰æƒé™ï¼Œhostæ”¹ä¸º%ï¼Œè¡¨ç¤ºå…è®¸æ‰€æœ‰æœºå™¨è®¿é—®ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell"># ç™»å½•mysqlæœåŠ¡å™¨mysql -uroot -p# ä½¿ç”¨mysqlæ•°æ®åº“mysql> use mysql;Database changed# ä¿®æ”¹rootç”¨æˆ·è®¿é—®æƒé™mysql> update user set host='%' where user='root';Query OK, 0 rows affected(0.00 sec)Row matched: 1 Changed: 0 Warnings: 0# æŸ¥çœ‹ç»“æœmysql> select host, user from user;+------+-------+|host  |user    |+------+-------+|%     |root    |<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>  é‡å¯Mysqlä½¿ç”¨ä¿®æ”¹ç”Ÿæ•ˆ</p><ol start="5"><li><strong>è®¾ç½®å¼€æœºå¯åŠ¨åŠç¦æ­¢</strong></li></ol><pre class="line-numbers language-shell"><code class="language-shell"># ç¦æ­¢å¯åŠ¨sudo systemctl disable mysqld# å¼€æœºå¯åŠ¨sudo systemctl enable mysqld<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="MySQLç”¨æˆ·åŠæ•°æ®åº“-è¡¨æƒé™é…ç½®"><a href="#MySQLç”¨æˆ·åŠæ•°æ®åº“-è¡¨æƒé™é…ç½®" class="headerlink" title="MySQLç”¨æˆ·åŠæ•°æ®åº“/è¡¨æƒé™é…ç½®"></a>MySQLç”¨æˆ·åŠæ•°æ®åº“/è¡¨æƒé™é…ç½®</h2><p>åŸºæœ¬æ“ä½œå‘½ä»¤ï¼š</p><ul><li>1ã€æŸ¥è¯¢ç”¨æˆ·æƒé™</li></ul><pre class="line-numbers language-shell"><code class="language-shell">show grants for username;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>2ã€ç”¨æˆ·æˆæƒ<pre class="line-numbers language-shell"><code class="language-shell">grant select on db.* to username;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>3ã€å›æ”¶ç”¨æˆ·æƒé™<pre class="line-numbers language-shell"><code class="language-shell">revoke select on db.* from username;(æƒé™ä¸å­˜åœ¨ä¼šæŠ¥é”™)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="1ã€æ–°å»ºç”¨æˆ·"><a href="#1ã€æ–°å»ºç”¨æˆ·" class="headerlink" title="1ã€æ–°å»ºç”¨æˆ·"></a>1ã€æ–°å»ºç”¨æˆ·</h4>ã€€1.1 ç™»å½•MYSQLï¼š<br>ã€€ã€€root@bin&gt;mysql -u root -p<br>&nbsp;&nbsp; &nbsp;Enter password: **********<br>ã€€ã€€1.2 åˆ›å»ºç”¨æˆ·ï¼š<pre class="line-numbers language-sql"><code class="language-sql">ã€€ã€€mysql<span class="token operator">></span> <span class="token keyword">insert</span> <span class="token keyword">into</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">(</span>Host<span class="token punctuation">,</span><span class="token keyword">User</span><span class="token punctuation">,</span>Password<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span><span class="token string">"demo"</span><span class="token punctuation">,</span>password<span class="token punctuation">(</span><span class="token string">"1234"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>ã€€ã€€è¿™æ ·å°±åˆ›å»ºäº†ä¸€ä¸ªåä¸ºï¼šdemo å¯†ç ä¸ºï¼š1234 çš„ç”¨æˆ·ã€‚</li></ul><p>ã€€ã€€æ³¨æ„ï¼šæ­¤å¤„çš„â€localhostâ€ï¼Œæ˜¯æŒ‡è¯¥ç”¨æˆ·åªèƒ½åœ¨æœ¬åœ°ç™»å½•ï¼Œä¸èƒ½åœ¨å¦å¤–ä¸€å°æœºå™¨ä¸Šè¿œç¨‹ç™»å½•ã€‚å¦‚æœæƒ³è¿œç¨‹ç™»å½•çš„è¯ï¼Œå°†â€localhostâ€æ”¹ä¸ºâ€%â€ï¼Œè¡¨ç¤ºåœ¨ä»»ä½•ä¸€å°ç”µè„‘ä¸Šéƒ½å¯ä»¥ç™»å½•ã€‚ä¹Ÿå¯ä»¥æŒ‡å®šæŸå°æœºå™¨å¯ä»¥è¿œç¨‹ç™»å½•ã€‚</p><p>ã€€ã€€1.3 ç„¶åç™»å½•ä¸€ä¸‹ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">ã€€ã€€mysql>exit;ã€€ã€€root@bin>mysql -u demo -p&nbsp;Enter password: **********<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2ã€ç”¨æˆ·æˆæƒ"><a href="#2ã€ç”¨æˆ·æˆæƒ" class="headerlink" title="2ã€ç”¨æˆ·æˆæƒ"></a>2ã€ç”¨æˆ·æˆæƒ</h4><p>æˆæƒæ ¼å¼ï¼šgrant æƒé™ on æ•°æ®åº“.* to ç”¨æˆ·å@ç™»å½•ä¸»æœº identified by â€œå¯†ç â€;ã€€</p><p>ã€€ã€€2.1 ç™»å½•MYSQLï¼ˆæœ‰ROOTæƒé™ï¼‰ï¼Œè¿™é‡Œä»¥ROOTèº«ä»½ç™»å½•ï¼š</p><pre><code>ã€€ã€€root@bin&gt;mysql -u demo -p&nbsp;Enter password: **********</code></pre><p>ã€€ã€€2.2 é¦–å…ˆä¸ºç”¨æˆ·åˆ›å»ºä¸€ä¸ªæ•°æ®åº“(testDB)ï¼š</p><pre class="line-numbers language-sql"><code class="language-sql">ã€€ã€€mysql<span class="token operator">></span><span class="token keyword">create</span> <span class="token keyword">database</span> demoDB<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ã€€ã€€2.3 æˆæƒtestç”¨æˆ·æ‹¥æœ‰testDBæ•°æ®åº“çš„æ‰€æœ‰æƒé™ï¼ˆæŸä¸ªæ•°æ®åº“çš„æ‰€æœ‰æƒé™ï¼‰ï¼š</p><pre><code>```sql</code></pre><p>ã€€ã€€&nbsp;mysql&gt;grant all privileges on demoDB.* to demo@localhost identified by â€˜1234â€™;</p><p>&nbsp;ã€€ã€€mysql&gt;flush privileges;//åˆ·æ–°ç³»ç»Ÿæƒé™è¡¨<br>    ```</p><p>ã€€ã€€æ ¼å¼ï¼šgrant æƒé™ on æ•°æ®åº“.* to ç”¨æˆ·å@ç™»å½•ä¸»æœº identified by â€œå¯†ç â€;ã€€</p><p>ã€€ã€€2.4 å¦‚æœæƒ³æŒ‡å®šéƒ¨åˆ†æƒé™ç»™ä¸€ç”¨æˆ·ï¼Œå¯ä»¥è¿™æ ·æ¥å†™:</p><pre><code>mysql&gt;grant select,update on demoDB.* to demo@localhost identified by '1234';mysql&gt;flush privileges; //åˆ·æ–°ç³»ç»Ÿæƒé™è¡¨</code></pre><p>ã€€ã€€2.5 æˆæƒtestç”¨æˆ·æ‹¥æœ‰æ‰€æœ‰æ•°æ®åº“çš„æŸäº›æƒé™ï¼š ã€€&nbsp;</p><pre><code>mysql&gt;grant select,delete,update,create,drop on *.* to demo@"%" identified by "1234";</code></pre><p>&nbsp; &nbsp; &nbsp;//testç”¨æˆ·å¯¹æ‰€æœ‰æ•°æ®åº“éƒ½æœ‰select,delete,update,create,drop æƒé™ã€‚</p><p>ã€€&nbsp;//@â€%â€ è¡¨ç¤ºå¯¹æ‰€æœ‰éæœ¬åœ°ä¸»æœºæˆæƒï¼Œä¸åŒ…æ‹¬localhostã€‚ï¼ˆlocalhoståœ°å€è®¾ä¸º127.0.0.1ï¼Œå¦‚æœè®¾ä¸ºçœŸå®çš„æœ¬åœ°åœ°å€ï¼Œä¸çŸ¥é“æ˜¯å¦å¯ä»¥ï¼Œæ²¡æœ‰éªŒè¯ã€‚ï¼‰</p><p>ã€€//å¯¹localhostæˆæƒï¼šåŠ ä¸Šä¸€å¥grant all privileges on demoDB.* to demo@localhost identified by â€˜1234â€™;å³å¯ã€‚&nbsp;</p><h4 id="3ã€åˆ é™¤ç”¨æˆ·"><a href="#3ã€åˆ é™¤ç”¨æˆ·" class="headerlink" title="3ã€åˆ é™¤ç”¨æˆ·"></a>3ã€åˆ é™¤ç”¨æˆ·</h4><pre><code>root@bin&gt;mysql -u demo -p&nbsp;&nbsp; &nbsp;Enter password: **********&nbsp;ã€€ã€€mysql&gt;Delete FROM user Where User='demo' and Host='localhost';&nbsp;ã€€ã€€mysql&gt;flush privileges;&nbsp;ã€€ã€€mysql&gt;drop database demoDB; //åˆ é™¤ç”¨æˆ·çš„æ•°æ®åº“</code></pre><p>åˆ é™¤è´¦æˆ·åŠæƒé™ï¼š&gt;drop user ç”¨æˆ·å@â€™%â€™;<br>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&gt;drop user ç”¨æˆ·å@ localhost;&nbsp;</p><h4 id="4ã€ä¿®æ”¹ç”¨æˆ·å¯†ç "><a href="#4ã€ä¿®æ”¹ç”¨æˆ·å¯†ç " class="headerlink" title="4ã€ä¿®æ”¹ç”¨æˆ·å¯†ç "></a>4ã€ä¿®æ”¹ç”¨æˆ·å¯†ç </h4><p>root@bin&gt;mysql -u demo -p<br>&nbsp;&nbsp; &nbsp; &nbsp;Enter password: **********<br>&nbsp; ã€€ã€€mysql&gt;update mysql.user set password=password(â€˜æ–°å¯†ç â€™) where User=â€demoâ€ and Host=â€localhostâ€;<br>&nbsp; ã€€ã€€mysql&gt;flush privileges;</p><p><strong>è¯´æ˜ï¼šgrantå’Œrevokeå¯ä»¥åœ¨å‡ ä¸ªå±‚æ¬¡ä¸Šæ§åˆ¶è®¿é—®æƒé™</strong><br>1.æ•´ä¸ªæœåŠ¡å™¨ï¼šgrant all /revoke all<br>2.æ•´ä¸ªæ•°æ®åº“ï¼šon database.*<br>3.ç‰¹å®šçš„è¡¨ï¼šon database.table<br>4.ç‰¹å®šçš„åˆ—ï¼šgrant select(id, se, rank) on testdb.apache_log to dba@localhost;<br>5.ç‰¹å®šçš„å­˜å‚¨è¿‡ç¨‹ï¼šgrant execute on procedure testdb.pr_add to â€™dbaâ€™@â€™localhostâ€™<br>6.ç‰¹å®šçš„å‡½æ•°ï¼šgrant execute on function testdb.fn_add to â€™dbaâ€™@â€™localhostâ€™</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸Šæ­å»ºçƒ­æ›´æœåŠ¡å™¨å¹¶åœ¨ç§»åŠ¨ç«¯é€šè¿‡react nativeé¡¹ç›®éªŒè¯</title>
      <link href="2018/06/13/linux-shang-da-jian-re-geng-fu-wu-qi-bing-zai-yi-dong-duan-tong-guo-react-native-xiang-mu-yan-zheng/"/>
      <url>2018/06/13/linux-shang-da-jian-re-geng-fu-wu-qi-bing-zai-yi-dong-duan-tong-guo-react-native-xiang-mu-yan-zheng/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»æ­å»ºçƒ­æ›´æœåŠ¡å™¨å¹¶åœ¨æ‰‹æœºä¸Šæµ‹è¯•react nativeçƒ­æ›´çš„å…¨è¿‡ç¨‹ã€‚<br><a href="https://www.jianshu.com/p/7fd2dc0352d2">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="å®‰è£…MySQL"><a href="#å®‰è£…MySQL" class="headerlink" title="å®‰è£…MySQL"></a><a href="https://link.jianshu.com/?t=https://www.mysql.com/downloads/">å®‰è£…MySQL</a></h2><p>å®‰è£…å®Œæˆåï¼Œä¼šå¼¹å‡ºåˆå§‹å¯†ç ï¼Œç²—ç»†çš„æˆ‘ï¼Œéšæ‰‹ç‚¹äº†OKï¼Œæ­¤å¤„æŒ–å‘åŠå¤©ã€‚<br><a href="https://link.jianshu.com/?t=http://blog.csdn.net/u014410695/article/details/50630233">æƒé™å¯†ç é—®é¢˜å¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ï¼Œå…¶å®ƒçš„éƒ½æ˜¯å°é—®é¢˜</a></p><p><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-yuanli.png" alt="appçƒ­æ›´åŸç†.png"></p><h2 id="code-pushçƒ­æ›´æœåŠ¡å™¨æ­å»ºï¼š"><a href="#code-pushçƒ­æ›´æœåŠ¡å™¨æ­å»ºï¼š" class="headerlink" title="code-pushçƒ­æ›´æœåŠ¡å™¨æ­å»ºï¼š"></a>code-pushçƒ­æ›´æœåŠ¡å™¨æ­å»ºï¼š</h2><h4 id="å®‰è£…code-push-server"><a href="#å®‰è£…code-push-server" class="headerlink" title="å®‰è£…code-push-server"></a>å®‰è£…code-push-server</h4><ul><li>npmå®‰è£…</li></ul><pre class="line-numbers language-shell"><code class="language-shell"># å®‰è£…code-push-servernpm install code-push-server -g<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>æºç å®‰è£…ï¼ˆæ¨èï¼‰</li></ul><pre class="line-numbers language-shell"><code class="language-shell"># ä»gitåº“ä¸‹è½½æœ€æ–°ä»£ç git clone https://github.com/lisong/code-push-server.git# è¿›å…¥åˆ°code-push-serverç›®å½•cd code-push-server# å®‰è£…npm install<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Code-Push-Serveré…ç½®"><a href="#Code-Push-Serveré…ç½®" class="headerlink" title="Code-Push-Serveré…ç½®"></a>Code-Push-Serveré…ç½®</h4><p>ä¿®æ”¹config/config.jsæ–‡ä»¶ï¼ŒæŒ‡å®šæ•°æ®åº“ï¼Œæ•°æ®å­˜æ”¾ä½ç½®</p><ul><li>é…ç½®æ•°æ®åº“<pre class="line-numbers language-conf"><code class="language-conf">db: {username: "root",password: "Your PWD",database: "codepush",host: "127.0.0.1",port: 3306,dialect: "mysql"}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>é…ç½®å­˜å‚¨ï¼ˆé»˜è®¤ä¸ºlocal,æœ¬æ¬¡ä¹Ÿé‡‡ç”¨localï¼‰</li></ul><pre class="line-numbers language-conf"><code class="language-conf">common: {   // dataDirç”¨äºè¿›è¡Œå­˜æ”¾æ¯”å¯¹æ–‡ä»¶   dataDir: "/Users/tablee/workspaces/data",   // å­˜å‚¨ç±»å‹ï¼Œå¯é€‰å€¼æœ‰local,oss,qiniu,s3   storageType: "local"},// æ–‡ä»¶å­˜å‚¨åœ¨æœ¬åœ° å½“storageTypeä¸ºlocalæ—¶éœ€è¦é…ç½®local: {   // äºŒè¿›åˆ¶æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œæ–‡ä»¶ä¸‹è½½ç›®å½•ï¼Œä¸è¦ä½¿ç”¨ä¸´æ—¶ç›®å½•   storageDir: "/Users/tablee/workspaces/storage",   // æ–‡ä»¶ä¸‹è½½åœ°å€ CodePushServeråœ°å€ + â€™/downloadâ€˜,downloadå¯¹åº”app.jsé‡Œé¢çš„åœ°å€   //é»˜è®¤æ­¤å¤„çš„ä¸‹è½½åœ°å€æ˜¯127.0.0.1:3000è¿™ä¸ªè‡ªç„¶æ˜¯é”™è¯¯çš„ï¼Œè¦å¤–ç½‘ipåœ°å€   downloadUrl: "https://tech.haier.net:7788/download",   // public static download spacename   public: '/download'},//ä¸ƒç‰›äº‘å­˜å‚¨é…ç½® å½“storageTypeä¸ºqiniuæ—¶éœ€è¦é…ç½®qiniu: {  accessKey: "",  secretKey: "",  bucketName: "",  //æ–‡ä»¶ä¸‹è½½åŸŸååœ°å€  downloadUrl: ""},//é˜¿é‡Œäº‘å­˜å‚¨é…ç½® å½“storageTypeä¸ºossæ—¶éœ€è¦é…ç½®oss: {  accessKeyId: "",  secretAccessKey: "",  endpoint: "",  bucketName: "",  // å¯¹è±¡Keyçš„å‰ç¼€ï¼Œå…è®¸æ”¾åˆ°å­æ–‡ä»¶å¤¹é‡Œé¢  prefix: "",   // æ–‡ä»¶ä¸‹è½½åŸŸååœ°å€ï¼Œéœ€è¦åŒ…å«å‰ç¼€  downloadUrl: "",}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>é…ç½®ç­¾å,å¯ä»¥ä¸ä¿®æ”¹ï¼Œä½†æ˜¯æ¨èæ›´æ”¹<pre class="line-numbers language-conf"><code class="language-conf">jwt: {  // ç™»å½•jwtç­¾åå¯†é’¥ï¼Œå¿…é¡»æ›´æ”¹ï¼Œå¦åˆ™æœ‰å®‰å…¨éšæ‚£ï¼Œå¯ä»¥ä½¿ç”¨éšæœºç”Ÿæˆçš„å­—ç¬¦ä¸²  // Recommended: 63 random alpha-numeric characters  // Generate using: https://www.grc.com/passwords.htm  tokenSecret: 'https://www.grc.com/passwords.htm'}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="åˆå§‹åŒ–æ•°æ®åº“"><a href="#åˆå§‹åŒ–æ•°æ®åº“" class="headerlink" title="åˆå§‹åŒ–æ•°æ®åº“"></a>åˆå§‹åŒ–æ•°æ®åº“</h4>é…ç½®å®Œæˆåï¼Œè¿›è¡Œæ•°æ®åˆå§‹åŒ–å·¥ä½œ</li><li>npmå®‰è£…<pre class="line-numbers language-shell"><code class="language-shell"># åˆå§‹åŒ–æ•°æ®åº“,**æ›¿æ¢ä¸ºæ•°æ®åº“å¯†ç **ï¼ˆå‚è€ƒåé¢é…ç½®è¯´æ˜ï¼‰code-push-server-db init --dbhost localhost --dbuser root --dbpassword **Your PWD** --dbport 3306<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>æºç å®‰è£…<pre class="line-numbers language-shell"><code class="language-shell"># åˆå§‹åŒ–æ•°æ®åº“./bin/db init --dbhost localhost --dbuser root --dbpassword **Your PWD** --dbport 3306<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>*æ³¨æ„äº‹é¡¹**ï¼š</li></ul><ol><li> ä¸è®ºé‡‡å–å“ªç§å®‰è£…æ–¹å¼ï¼Œåˆå§‹åŒ–æ•°æ®åº“æ—¶è¦ä¿è¯æ•°æ®åº“ç”¨æˆ·åå¯†ç æ­£ç¡®ï¼›æ•°æ®åº“ä¸­ä¸èƒ½å­˜åœ¨codepushæ•°æ®åº“(é»˜è®¤æ•°æ®åº“ä¸ºcodepush)</li><li>é‡‡ç”¨æºç å®‰è£…ï¼Œæ‰§è¡Œbinç›®å½•ä¸‹çš„dbå‘½ä»¤æ—¶ï¼Œè¦ä¿è¯æ­¤æ–‡ä»¶å…·æœ‰å¯æ‰§è¡Œæƒé™ï¼Œå¦‚æœæ²¡æœ‰ï¼Œéœ€è¦æ·»åŠ æƒé™<pre class="line-numbers language-shell"><code class="language-shell"># æ·»åŠ dbæ–‡ä»¶çš„å¯æ‰§è¡Œæƒé™chmod +x bin/db<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>å¦‚æœæ•°æ®åº“å¯†ç å¤æ‚ï¼Œå¸¦æœ‰ç‰¹æ®Šç¬¦å·ï¼Œåˆå§‹åŒ–è¯­å¥å°†æ‰§è¡Œå¤±è´¥ã€‚æ­¤æ—¶å› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡å®‰è£…ï¼Œå¯ä»¥åœ¨æ•°æ®åº“æœåŠ¡å™¨æ‰‹åŠ¨åˆ›å»ºåä¸º**<code>codepush</code>**(å¿…é¡»æ˜¯è¿™ä¸ªåå­—)çš„æ•°æ®åº“ï¼Œç„¶åæ‰§è¡Œ<code>/opt/chuangke/code-push-server/sql/</code>ç›®å½•ä¸‹çš„<code>codepush-all.sql</code>è„šæœ¬æ¥åˆå§‹åŒ–æ•°æ®åº“ã€‚<br>åˆå§‹åŒ–æˆåŠŸåæ•°æ®åº“ä¸­çš„è¡¨å¦‚ä¸‹ï¼š<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-db.png" alt="codepush database"><h4 id="æœåŠ¡å¯åŠ¨"><a href="#æœåŠ¡å¯åŠ¨" class="headerlink" title="æœåŠ¡å¯åŠ¨"></a>æœåŠ¡å¯åŠ¨</h4>å®‰è£…é…ç½®æ–‡ä»¶ä¸­çš„ç›®å½•ç»“æ„ï¼Œåˆ°/Usersç›®å½•ä¸­å»ºç«‹å¦‚ä¸‹æ–‡ä»¶å¤¹ /Users/tablee/workspaces/storage </li></ol><ul><li>npmå¯åŠ¨</li></ul><pre class="line-numbers language-shell"><code class="language-shell"># å¯åŠ¨æœåŠ¡ï¼Œé»˜è®¤ä½¿ç”¨3000ç«¯å£,å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://127.0.0.1:3000code-push-server# æŒ‡å®šç«¯å£å·è¿è¡ŒPORT=3000 HOST=127.0.0.1 NODE_ENV=production code-push-server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æºç å¯åŠ¨</li></ul><pre class="line-numbers language-shell"><code class="language-shell"># å¯åŠ¨æœåŠ¡(ä¿è¯wwwå…·æœ‰å¯æ‰§è¡Œæƒé™)ï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://127.0.0.1:3000./bin/www# ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œnohup ./bin/www &# æŒ‡å®šç«¯å£å·è¿è¡ŒPORT=3000 HOST=127.0.0.1 NODE_ENV=production node ./bin/www<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>forever åå°å¯åŠ¨ï¼ˆæ¨èï¼‰</li><li><em>å…ˆå®‰è£…forever</em>*<br>å½“ç„¶ï¼Œæœ‰äººè¯´foreverå·²ç»è¿‡æ—¶äº†ï¼Œæ¨èä½¿ç”¨pm2ä»£æ›¿foreverï¼Œè¯·å‚è€ƒ<a href="https://www.jianshu.com/p/420ec3665d2f">linux npm start ä¿æŒåå°è¿è¡Œ</a><pre class="line-numbers language-shell"><code class="language-shell"># å…¨å±€å®‰è£…$ npm install forever -g# æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ$ forever listinfo:    No forever processes running<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>å¾ˆæŠ±æ­‰ï¼Œå¦‚æœä¸é¡ºåˆ©çš„è¯ï¼Œä¼šæœ‰è¿™ä¹ˆä¸ªæƒ…å†µ</li></ul><pre class="line-numbers language-shell"><code class="language-shell">[root@izm5e3m6sxwr4dw9w7r6h4z lib]# npm install forever -g/opt/software/node-v10.0.0-linux-x64/bin/forever -> /opt/software/node-v10.0.0-linux-x64/lib/node_modules/forever/bin/forevernpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.7 (node_modules/forever/node_modules/fsevents):npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@1.2.7: wanted {"os":"darwin","arch":"any"} (current: {"os":"linux","arch":"x64"})+ forever@0.15.3updated 1 package in 2.109s[root@izm5e3m6sxwr4dw9w7r6h4z lib]# forever list-bash: forever: æœªæ‰¾åˆ°å‘½ä»¤[root@izm5e3m6sxwr4dw9w7r6h4z lib]# <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸ç¾ä¸½äº†ï¼Œå‘½åå®‰è£…æˆåŠŸäº†ï¼Œä½†æ˜¯è¿˜æ˜¯æç¤ºæ‰¾ä¸åˆ°å‘½ä»¤ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘æ¥æ•™ä½ ï¼Œè¿™ä¸ªæ˜¯å› ä¸ºè¿™ä¸ª-gæ˜¯å§å‘½ä»¤å®‰è£…åˆ°äº†nodeæ‰€åœ¨ç›®å½•ï¼Œå¯ä»¥çœ‹çœ‹å…·ä½“åœ¨å“ª</p><pre class="line-numbers language-shell"><code class="language-shell">[root@izm5e3m6sxwr4dw9w7r6h4z ~]# npm list -g --depth 0/opt/software/node-v10.0.0-linux-x64/libâ”œâ”€â”€ forever@0.15.3â””â”€â”€ npm@5.6.0[root@izm5e3m6sxwr4dw9w7r6h4z ~]# cd /opt/software/node-v10.0.0-linux-x64/lib[root@izm5e3m6sxwr4dw9w7r6h4z lib]# lsnode_modules[root@izm5e3m6sxwr4dw9w7r6h4z lib]# cd node_modules/forever/bin/[root@izm5e3m6sxwr4dw9w7r6h4z bin]# lsforever  monitor[root@izm5e3m6sxwr4dw9w7r6h4z bin]#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ¬¡æ˜¯çœŸçš„çœ‹è§foreverè¢«å®‰è£…åˆ°å“ªé‡Œï¼Œæ¥ä¸‹æ¥å°±æ¥ä¸ªè½¯é“¾åˆ°<code>/usr/bin</code>ä¸‹å°±å¯ä»¥äº†</p><pre class="line-numbers language-shell"><code class="language-shell">[root@izm5e3m6sxwr4dw9w7r6h4z bin]# ln -s /opt/software/node-v10.0.0-linux-x64/lib/node_modules/forever/bin/forever /usr/bin/forever[root@izm5e3m6sxwr4dw9w7r6h4z bin]# forever listinfo:    No forever processes running[root@izm5e3m6sxwr4dw9w7r6h4z bin]#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å®Œç¾ï¼Œæ¥ç€ä½¿ç”¨foreverå¯åŠ¨åº”ç”¨å•¦ã€‚<br>æ¯”å¦‚æˆ‘çš„serveræºç çš„ä½ç½®åœ¨<code>/opt/chuangke/code-push-server/</code>ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¯åŠ¨</p><pre class="line-numbers language-shell"><code class="language-shell">NODE_ENV=production forever start -l log/forever.log -o log/info.log -e log/err.log bin/www<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥ç”¨å¦‚ä¸‹ç»å¯¹è·¯å¾„å‘½ä»¤å¯åŠ¨ï¼š</p><pre class="line-numbers language-shell"><code class="language-shell">NODE_ENV=production forever start -l /opt/chuangke/code-push-server/log/forever.log -o /home/haieradmin/codepush/code-push-server/log/info.log -e /home/haieradmin/codepush/code-push-server/log/err.log /home/haieradmin/codepush/code-push-server/bin/www<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>æœåŠ¡å¯åŠ¨éªŒè¯<br>å‘½ä»¤è¡ŒéªŒè¯</li></ul><pre class="line-numbers language-shell"><code class="language-shell">$ forever listinfo:    Forever processes runningdata:        uid  command                   script                                 forever pid   id logfile                                        uptime        data:    [0] 8Or8 /usr/local/node8/bin/node /opt/chuangke/code-push-server/bin/www 60199   60209    /opt/chuangke/code-push-server/log/forever.log 0:15:2:21.503 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œåˆ™ç”¨æµè§ˆå™¨è®¿é—®é»˜è®¤çš„3000ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æ•ˆæœ<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-index.png" alt="é¦–é¡µ"><br>åˆ°æ­¤æœåŠ¡å™¨ç«¯åˆ°é…ç½®å°±å®Œæˆäº†ã€‚</p><h2 id="å®¢æˆ·ç«¯çƒ­æ›´éªŒè¯"><a href="#å®¢æˆ·ç«¯çƒ­æ›´éªŒè¯" class="headerlink" title="å®¢æˆ·ç«¯çƒ­æ›´éªŒè¯"></a>å®¢æˆ·ç«¯çƒ­æ›´éªŒè¯</h2><p>å®¢æˆ·ç«¯æµ‹è¯•ä»£ç ä»¥ <a href="https://github.com/lisong/code-push-demo-app">https://github.com/lisong/code-push-demo-app</a> ä¸ºä¾‹</p><h4 id="å®¢æˆ·ç«¯å®‰è£…code-push-cli"><a href="#å®¢æˆ·ç«¯å®‰è£…code-push-cli" class="headerlink" title="å®¢æˆ·ç«¯å®‰è£…code-push-cli"></a>å®¢æˆ·ç«¯å®‰è£…code-push-cli</h4><pre class="line-numbers language-shell"><code class="language-shell"># å…¨å±€å®‰è£…$ npm install -g code-push-cli # æŸ¥çœ‹ç‰ˆæœ¬$ code-push -v2.1.8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä¸‹è½½å®¢æˆ·ç«¯éªŒè¯ç¨‹åºï¼Œå¹¶å®‰è£…ç¬¬ä¸€ç‰ˆ"><a href="#ä¸‹è½½å®¢æˆ·ç«¯éªŒè¯ç¨‹åºï¼Œå¹¶å®‰è£…ç¬¬ä¸€ç‰ˆ" class="headerlink" title="ä¸‹è½½å®¢æˆ·ç«¯éªŒè¯ç¨‹åºï¼Œå¹¶å®‰è£…ç¬¬ä¸€ç‰ˆ"></a>ä¸‹è½½å®¢æˆ·ç«¯éªŒè¯ç¨‹åºï¼Œå¹¶å®‰è£…ç¬¬ä¸€ç‰ˆ</h4><ol><li>cloneç¨‹åºå¹¶install</li></ol><pre class="line-numbers language-shell"><code class="language-shell">$ git clone git@github.com:lisong/code-push-demo-app.git#  cd  åˆ°demoè·¯å¾„ï¼Œæ‰§è¡Œnpm install å®‰è£…nodeä¾èµ–åŒ…$ cd code-push-demo-app$ npm install<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å¼€å‘½ä»¤ç»ˆç«¯ï¼Œç™»å½•code-push-serveræœåŠ¡å™¨ï¼Œè¿™é‡Œé…ç½®ä¸ºlocalï¼Œæ‰€ä»¥ç™»å½•åœ°å€ä¸º<a href="http://127.0.0.1:3000/">http://127.0.0.1:3000</a> </p><pre class="line-numbers language-shell"><code class="language-shell">$ code-push login http://127.0.0.1:3000  //è´¦å·å¯†ç ä¸ºåšä¸»æä¾›  account:  admin password:  123456ç™»å½•æˆåŠŸä¹‹åè·å–token<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å°†æ–‡æœ¬æ¡†ä¸­çš„keyå¤åˆ¶ç²˜è´´åˆ°ç™»å½•ç»ˆç«¯ï¼Œç‚¹å‡»å›è½¦ç™»å½•æˆåŠŸ<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-login.png" alt="ç™»å½•é¡µé¢"><br>è¾“å…¥è´¦å·å¯†ç ï¼Œç‚¹å‡»ç™»å½•ã€‚è·å–tokenï¼š<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-token.png" alt="è·å–token"></p><pre class="line-numbers language-shell"><code class="language-shell">$ code-push login http://127.0.0.1:3000Please login to Mobile Center in the browser window we've just opened.Enter your token from the browser:  HugyOJpzvzhEhB05galUftoL4zrz4ksvOXqogSuccessfully logged-in. Your session file was written to C:\Users\marvin\AppData\Local\.code-push.config. You can run the code-push logout command at any time to delete this file and terminate your session.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨å‘½ä»¤è¡ŒæŸ¥çœ‹å½“å‰çƒ­æ›´æœåŠ¡å™¨çš„éƒ¨ç½²ä¿¡æ¯ï¼Œ</p><pre class="line-numbers language-shell"><code class="language-shell">$ code-push app listâ”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ Name â”‚ Deployments â”‚â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>æ·»åŠ æ–°çš„APPï¼ˆä»¥å®‰å“ä¸ºä¾‹ï¼‰<pre class="line-numbers language-shell"><code class="language-shell"># å®‰å“ç‰ˆ$ code-push app add CodePushReactNativeDemo-android android react-nativeSuccessfully added the "CodePushReactNativeDemo-android" app, along with the following default deployments:â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ Name       â”‚ Deployment Key                        â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ Production â”‚ VKNbn9Oe5Wj9bPoGkYCUVuzRuqHV4ksvOXqog â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ Staging    â”‚ 6KfLoVvhgdsnFzFCIohRb2t5grmD4ksvOXqog â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜# å†è¿è¡Œå‘½ä»¤æŸ¥çœ‹$ code-push app listâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ Name                            â”‚ Deployments         â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ CodePushReactNativeDemo-android â”‚ Production, Staging â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ä¿®æ”¹é…ç½®<br>æ·»åŠ å®Œæˆä¹‹åå¯ä»¥ç”¨code-push app listå‘½ä»¤æŸ¥çœ‹åˆ›å»ºå¥½çš„appï¼Œå¹¶å°†æµ‹è¯•çš„Staging keyæ‹·è´åˆ°MainApplication.javaä¸­çš„ â€œYour Keyâ€œ çš„ä½ç½®ï¼Œæ¨é€çš„æ—¶å€™é€šè¿‡keyå°†appå’ŒæœåŠ¡å™¨ç«¯å…³è”ã€‚</li></ol><p>ç”¨Android Studioæ‰“å¼€<code>code-push-demo-app/android</code>ç›®å½•åˆ°MainApplication.javaé‡Œé¢ä¿®æ”¹ä»¥ä¸‹ä»£ç ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">protected</span> List<span class="token operator">&lt;</span>ReactPackage<span class="token operator">></span> <span class="token function">getPackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> Arrays<span class="token punctuation">.</span>&lt;ReactPackage<span class="token operator">></span><span class="token function">asList</span><span class="token punctuation">(</span>      <span class="token keyword">new</span> <span class="token class-name">MainReactPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      <span class="token keyword">new</span> <span class="token class-name">CodePush</span><span class="token punctuation">(</span>         <span class="token string">"YourKey"</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// code-push app addé¡¹ç›®åç”Ÿæˆçš„app æ¨é€key</span>         MainApplication<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span>         BuildConfig<span class="token punctuation">.</span>DEBUG<span class="token punctuation">,</span>         <span class="token string">"YourCodePushServerUrl"</span>   <span class="token comment" spellcheck="true">// config.jsä¸­é…ç½®çš„downloadUrl åœ°å€ ä¸éœ€è¦/downloadåç¼€</span>      <span class="token punctuation">)</span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘çš„é…ç½®æ˜¯ï¼š<br>ä¿®æ”¹MainApplication.javaçš„ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> List<span class="token operator">&lt;</span>ReactPackage<span class="token operator">></span> <span class="token function">getPackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> Arrays<span class="token punctuation">.</span>&lt;ReactPackage<span class="token operator">></span><span class="token function">asList</span><span class="token punctuation">(</span>          <span class="token keyword">new</span> <span class="token class-name">MainReactPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token keyword">new</span> <span class="token class-name">CodePushBuilder</span><span class="token punctuation">(</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>string<span class="token punctuation">.</span>reactNativeCodePush_androidDeploymentKey<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setIsDebugMode</span><span class="token punctuation">(</span>BuildConfig<span class="token punctuation">.</span>DEBUG<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">setServerUrl</span><span class="token punctuation">(</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>string<span class="token punctuation">.</span>reactNativeCodePush_androidServerURL<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹<code>android/app/src/main/res/values/strings.xml</code>æ–‡ä»¶ï¼ŒæŒ‡å®šreactNativeCodePush_androidDeploymentKeyå’ŒreactNativeCodePush_androidServerURLçš„å€¼ã€‚</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span> <span class="token attr-name">moduleConfig</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>reactNativeCodePush_androidDeploymentKey<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>6KfLoVvhgdsnFzFCIohRb2t5grmD4ksvOXqog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span> <span class="token attr-name">moduleConfig</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>reactNativeCodePush_androidServerURL<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>http://xxx.xxx:3000/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app_name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>CodePushDemoApp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li><p>cd åˆ°code-push-demo-appç›®å½•ï¼Œå…è®¸react-native start å¯åŠ¨react-native æœåŠ¡ã€‚å¯ä»¥é€‰æ‹©ç”¨æ•°æ®çº¿è¿æ¥æ‰‹æœºï¼Œæ‰‹æœºå¼€å¯å¼€å‘è€…æ¨¡å¼ã€‚ä¹Ÿå¯ä»¥ç›´æ¥å°†<code>code-push-demo-app\android\app\build\outputs\apk\debug</code>ä»¥åçš„apkåŒ…å‘é€åˆ°æ‰‹æœºä¸Šï¼Œç›´æ¥æ‰“å¼€å®‰è£…ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">$ react-native run-android<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨æ‰‹æœºä¸Šè¿è¡Œappçš„æˆªå›¾å¦‚ä¸‹ï¼š<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-demo-app.png" alt="code-push-demo-app"></p></li><li><p>Android Studioç¼–è¯‘å¹¶å°†é¡¹ç›®è¿è¡Œåˆ°æ‰‹æœºä¸Šï¼Œreloadæ›´æ–°åˆ°æœ€æ–°jsåŒ…åœ¨code-push-demo-appä¸­é¦–é¡µéšæ„åšä¸€äº›ä¿®æ”¹ï¼Œè¿™é‡Œæ˜¯å°†CodePushDemoApp/App.jsæ–‡ä»¶åšäº†å¦‚ä¸‹ä¿®æ”¹ã€‚<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-demo-source.png" alt="ä¸€äº›ä¿®æ”¹"><br>æ‰§è¡Œæ¨é€å‘½ä»¤</p></li></ol><pre class="line-numbers language-shell"><code class="language-shell"># æµ‹è¯•ç¯å¢ƒæ‰§è¡Œï¼š$ code-push release-react CodePushReactNativeDemo-android androidDetecting android app version:Using the target binary version value "2.1.0" from "android\app\build.gradle".Running "react-native bundle" command:node node_modules\react-native\local-cli\cli.js bundle --assets-dest C:\Users\marvin\AppData\Local\Temp\CodePush\CodePush --bundle-output C:\Users\marvin\AppData\Local\Temp\CodePush\CodePush\index.android.bundle --dev false --entry-file index.js --platform androidScanning folders for symlinks in D:\Git\oschina\react\code-push-demo-app\node_modules (101ms)Scanning folders for symlinks in D:\Git\oschina\react\code-push-demo-app\node_modules (48ms)Loading dependency graph, done.bundle: Writing bundle output to: C:\Users\marvin\AppData\Local\Temp\CodePush\CodePush\index.android.bundlebundle: Done writing bundle outputbundle: Copying 1 asset filesbundle: Done copying assetsReleasing update contents to CodePush:Successfully released an update containing the "C:\Users\marvin\AppData\Local\Temp\CodePush\CodePush" directory to the "Staging" deployment of the "CodePushReactNativeDemo-android" app.# ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œï¼š$ code-push release-react CodePushReactNativeDemo-android android -d Production#æŒ‡å®šç‰ˆæœ¬ï¼Œæ·»åŠ æ³¨é‡Š$ code-push release-react CodePushReactNativeDemo-android android -d Production --des "marvin code push testing" -t "1.0.0"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Successfully è¡¨ç¤ºçƒ­æ›´åŒ…æ¨é€æˆåŠŸï¼Œç„¶ååœ¨æ‰‹æœºä¸Šç‚¹å‡»<strong>Press for dialog-driven sync</strong>é“¾æ¥ã€‚<br>å¼¹å‡ºä¸‹è½½ç¡®è®¤<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-demo-app-update.png" alt="ç¡®è®¤æ›´æ–°"></p><p>ç‚¹å‡»ã€installã€‘<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-demo-app-updated.png" alt="å·²æ›´æ–°"><br>è‡³æ­¤ï¼Œçƒ­æ›´æœåŠ¡å™¨æ­å»ºï¼ŒåŠandroidç‰ˆappä½“éªŒå®Œæ¯•ã€‚</p><h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><p>1ã€äº§çœ‹æ›´æ–°åŒ…å®‰è£…æƒ…å†µ</p><pre class="line-numbers language-shell"><code class="language-shell"># code-push deployment history appName deploymentNamecode-push deployment history CodePushReactNativeDemo-android Staging<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>Staging æˆ–è€… Production<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-push.png" alt="code push Staging"></p><p>2ã€åˆ—è¡¨éƒ¨ç½²åç§°</p><pre class="line-numbers language-shell"><code class="language-shell">code-push deployment ls CodePushReactNativeDemo-android<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-deployment.png" alt="éƒ¨ç½²å"></p><p>3ã€å¸¸è§é”™è¯¯<br>3.1ã€ downloadåœ°å€å†™é”™ï¼Œé»˜è®¤æ˜¯<a href="http://127.0.0.1:3000/">http://127.0.0.1:3000</a> å¦‚æœä¸æ”¹æˆå¤–ç½‘åŸŸåå’Œç«¯å£ï¼Œä¸‹è½½å°†å¤±è´¥ã€‚<br>appå¯åŠ¨æŠ“åŒ…æŸ¥çœ‹çš„ç»“æœå°±æ˜¯ï¼Œè¿”å›çš„ä¸‹è½½åœ°å€æ— æ³•ä¸‹è½½åˆ°èµ„æºã€‚<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-addr-error.png" alt="ä¸‹è½½åœ°å€é”™è¯¯"></p><p>3.2ã€nginxé™åˆ¶èµ„æºå¤§å°<br>éœ€è¦ä¿®æ”¹é…ç½®ï¼Œæˆ‘ä»¬çš„ä¸€ä¸ªappæ‰“åŒ…åçº¦70Mï¼Œä¸Šä¼ æ—¶å°±æŠ¥é”™äº†ï¼Œåæ¥æ‰çŸ¥é“æ˜¯nginxæŒ‡å®šçš„ä¸Šä¼ å¤§å°æ˜¯50Mï¼Œæ‰€ä»¥è¦ä¿®æ”¹nginxé…ç½®æ–‡ä»¶ï¼ŒåŠ ä¸Š<code>client_max_body_size 100M;  </code>è¿™ä¸ªæ ·é…ç½®ã€‚</p><p>3.3ã€æ•°æ®åº“é…ç½®é”™è¯¯<br>å°†æ•°æ®åº“çš„ç«¯å£ï¼Œæˆ–è€…ç”¨æˆ·åå¯†ç å†™é”™ä¹Ÿå¾ˆå¸¸è§</p><p>3.4ã€ç›®å½•æƒé™é—®é¢˜<br>é…ç½®æ–‡ä»¶é‡Œé»˜è®¤çš„dataDirå’Œstoreageç›®å½•å¿…é¡»æœ‰code-pushè¿è¡Œç”¨æˆ·çš„æ“ä½œæƒé™ï¼Œå¦åˆ™ä¼šæœ‰ä»¥ä¸‹é”™è¯¯ã€‚<br><img src="/loading.gif" data-original="/images/fontend/rn-codepush-server-dir-permission.png" alt="ç›®å½•æƒé™é—®é¢˜"></p><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><pre class="line-numbers language-shell"><code class="language-shell">// è´¦æˆ·ç›¸å…³code-push login ç™»é™†code-push loout æ³¨é”€code-push access-key ls åˆ—å‡ºç™»é™†çš„tokencode-push access-key rm <accessKye> åˆ é™¤æŸä¸ª access-key<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell"><code class="language-shell">// appæ“ä½œç›¸å…³code-push app add <appName> <platform> react-native  åœ¨è´¦å·é‡Œé¢æ·»åŠ ä¸€ä¸ªæ–°çš„appcode-push app remove æˆ–è€… rm åœ¨è´¦å·é‡Œç§»é™¤ä¸€ä¸ª appcode-push app rename é‡å‘½åä¸€ä¸ªå­˜åœ¨ appcode-push app list æˆ–åˆ™ ls åˆ—å‡ºè´¦å·ä¸‹é¢çš„æ‰€æœ‰ appcode-push app transfer æŠŠappçš„æ‰€æœ‰æƒè½¬ç§»åˆ°å¦å¤–ä¸€ä¸ªè´¦å·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell"><code class="language-shell">// åº”ç”¨ä¿¡æ¯ç›¸å…³code-push deployment add <appName> éƒ¨ç½²code-push deployment rm <appName> åˆ é™¤éƒ¨ç½²code-push deployment rename <appName> é‡å‘½åcode-push deployment ls <appName> åˆ—å‡ºåº”ç”¨çš„éƒ¨ç½²æƒ…å†µcode-push deployment ls <appName> -k æŸ¥çœ‹éƒ¨ç½²çš„keycode-push deployment history <appName> <deploymentName> æŸ¥çœ‹å†å²ç‰ˆæœ¬<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell"><code class="language-shell">// å‘å¸ƒcode-push release-react <appName> <platform> -t ç‰ˆæœ¬  -d ç¯å¢ƒ  --des æè¿° -m true ï¼ˆå¼ºåˆ¶æ›´æ–°ï¼‰// æ¸…é™¤å†å²éƒ¨ç½²è®°å½•code-push deployment clear <appName> Production or Staging// å›æ»šcode-push rollback <appName> Production --targetRelease v4(codepushæœåŠ¡éƒ¨ç½²çš„ç‰ˆæœ¬å·)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„äº‹é¡¹ï¼š</p><ol><li><p>æ›´æ–°è§„åˆ™<br>  1&gt; CodePushéƒ¨ç½²ç‰ˆæœ¬ &gt; Appç‰ˆæœ¬</p><p>  æ›´æ–°å¯ç”¨ï¼Œä½†å½“å‰ç‰ˆæœ¬æ¯”è¿è¡Œç‰ˆæœ¬é«˜ã€‚ä¸ä½œæ›´æ–°</p><p>  2&gt; CodePushéƒ¨ç½²ç‰ˆæœ¬ &lt; Appç‰ˆæœ¬</p><p>   ä¸æ‰§è¡Œæ›´æ–°å¤„ç†</p><p>  3&gt; CodePushéƒ¨ç½²ç‰ˆæœ¬ == Appç‰ˆæœ¬</p><p>   è‡ªåŠ¨ä¸‹è½½æ›´æ–°ï¼Œå¹¶æ ¹æ®åŠ è½½ç­–ç•¥åŠ è½½æœ€æ–°bundle</p></li></ol><ol start="2"><li><p>å›æ»š </p><p> å½“éƒ¨ç½²çš„ç‰ˆæœ¬ä¸åŒæ—¶ï¼Œä¸èƒ½è·¨ç‰ˆæœ¬å›æ»šã€‚</p><p> ä¾‹å¦‚ï¼šCodePushå†å²ç‰ˆæœ¬ä¸­ä¸º2.10.1ï¼Œæ­¤æ—¶å‘å¸ƒ2.10.2ç‰ˆæœ¬ã€‚å½“ä»2.10.2å‘èµ·å›æ»šæ“ä½œå›åˆ°2.10.1æ—¶ï¼Œæ˜¯ä¸å¯è¡Œçš„ã€‚</p></li></ol><h2 id="éƒ¨ç½²ä¿¡æ¯å‚æ•°"><a href="#éƒ¨ç½²ä¿¡æ¯å‚æ•°" class="headerlink" title="éƒ¨ç½²ä¿¡æ¯å‚æ•°"></a>éƒ¨ç½²ä¿¡æ¯å‚æ•°</h2><p>åœ¨éƒ¨ç½²äº†ç‰ˆæœ¬ä¹‹åï¼Œæ‰§è¡Œ ã€code-push deployment ls uniApp-Androidã€‘å¯ä»¥æŸ¥çœ‹å½“å‰ç‰ˆæœ¬ã€å½“å‰éƒ¨ç½²ç¯å¢ƒä¸‹çš„éƒ¨ç½²ä¿¡æ¯ï¼š</p><ol><li><p>Update Metadataï¼ˆæ›´æ–°ä¿¡æ¯ï¼‰<br> Labelï¼šæ ‡è¯†å½“å‰éƒ¨ç½²ç‰ˆæœ¬ï¼Œæ¯éƒ¨ç½²æ–°ç‰ˆæœ¬ï¼Œç‰ˆæœ¬å·å¢åŠ 1</p><p> App Versionï¼šå½“å‰éƒ¨ç½²çš„Appç‰ˆæœ¬å·</p><p> Mandatoryï¼šæ˜¯å¦å¼ºåˆ¶æ›´æ–°</p><p> Release Timeï¼šéƒ¨ç½²æ—¶é—´</p><p> Released Byï¼šéƒ¨ç½²ç”¨æˆ·</p><p> Descriptionï¼šéƒ¨ç½² æè¿°ä¿¡æ¯</p></li></ol><p>ä»ä¸Šé¢å†…å®¹ä¸éš¾å‘ç°ï¼Œè¿™äº›ä¿¡æ¯åŸºæœ¬éƒ½ä¼šåœ¨æˆ‘ä»¬æ‰§è¡Œ code-push release æ—¶é…ç½®</p><ol start="2"><li><p>Install Metricsï¼ˆå®‰è£…æŒ‡æ ‡ï¼‰ </p><p> Activeï¼šæˆåŠŸå®‰è£…å¹¶è¿è¡Œå½“å‰releaseçš„ç”¨æˆ·çš„æ•°é‡ï¼Œå³è¡¨ç¤ºå½“å‰ä¸‹è½½æ›´æ–°éƒ¨ç½²çš„æ´»è·ƒç”¨æˆ·æ•°é‡ï¼Œof å·¦è¾¹æ•°ä¼šéšç€ç”¨æˆ·å®‰è£…ã€å¸è½½è€Œ å¢åŠ ã€å‡å°‘ã€‚ofå³è¾¹æ•°ä»£è¡¨å½“å‰å®‰è£…æˆ–æ”¶                    åˆ°éƒ¨ç½²ç‰ˆæœ¬çš„ç”¨æˆ·æ•°ï¼Œå½“æœ‰ç”¨æˆ·å¸è½½Appï¼Œè¯¥æ•°å€¼ä¼šé™ä½ã€‚</p><p> å› æ­¤å®ƒå¾ˆå¥½çš„è§£é‡Šäº†å½“å‰æ›´æ–°åŒ…æœ‰å¤šå°‘æ´»è·ƒç”¨æˆ·ï¼Œå¤šå°‘ç”¨æˆ·æ¥æ”¶è¿‡è¿™ä¸ªå®‰è£…åŒ…</p><p> Totalï¼šæˆåŠŸå®‰è£…éƒ¨ç½²å½“å‰releaseçš„ç”¨æˆ·é‡ï¼Œåªå¢ä¸å‡</p><p> Pendingï¼šå½“å‰releaseç‰ˆæœ¬è¢«ä¸‹è½½çš„æ•°é‡ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰è¢«å®‰è£…ï¼Œè¯¥å€¼ä¼šéšç€ç”¨æˆ·ä¸‹è½½å®‰è£…åå¢åŠ ï¼Œ åœ¨å¸è½½æ—¶é™ä½ã€‚</p></li></ol><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="http://222xiaohuan.iteye.com/blog/2347617">code-push-server æ­å»ºè‡ªå·±çš„æ¨é€æœåŠ¡å™¨æµç¨‹</a><br><a href="https://www.jianshu.com/p/d6a155a6f6f4">çƒ­æ›´æ–°ï¼ˆandroidï¼‰windowsç³»ç»Ÿcode-push-server çš„ä½¿ç”¨</a><br><a href="https://blog.csdn.net/mad2man/article/details/51096829">ReactNativeé›†æˆCodePushæ•™ç¨‹  é›†æˆCode Pushçš„æ¡ˆä¾‹è¯´æ˜</a><br><a href="https://www.jianshu.com/p/8e08c7661275">react-nativeçƒ­æ›´æ–°å…¨æ–¹ä½è®²è§£</a><br><a href="https://juejin.im/post/5911dca544d904007bfdf8ab">é›¶å®¢æˆ·ç«¯å¼€å‘ç»éªŒ React Native çƒ­æ›´æ–° CodePush æ‰“åŒ…é›†æˆæŒ‡åŒ—</a><br><a href="https://www.jianshu.com/p/fa362da953c7">react native codepushçƒ­æ›´æ–°è§£å†³æˆåŠŸæ›´æ–°</a><br><a href="https://blog.csdn.net/yy1300326388/article/details/48344411">Android Studio æƒå¨æ•™ç¨‹ æ‰“åŒ…ã€ç”Ÿæˆjkså¯†é’¥ã€ç­¾åApkã€å¤šæ¸ é“æ‰“åŒ…</a><br><a href="http://www.tl628.com/index.php/2018/05/31/code-push_fa_bu_de_shi_hou_chu_xian_error_upload_error/">http://www.tl628.com/index.php/2018/05/31/code-push_fa_bu_de_shi_hou_chu_xian_error_upload_error/</a></p>]]></content>
      
      
      <categories>
          
          <category> å¤§å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> react-native </tag>
            
            <tag> codepush </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ ä¹¦å•</title>
      <link href="2018/06/10/xue-xi-shu-dan/"/>
      <url>2018/06/10/xue-xi-shu-dan/</url>
      
        <content type="html"><![CDATA[<p>å…è´¹çš„è®¡ç®—æœºç¼–ç¨‹ç±»ä¸­æ–‡ä¹¦ç±ã€‚<br><a href="https://www.jianshu.com/p/31ad74be1ba1">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><blockquote><p>ä½ æƒ³è¦çš„å¹²è´§ï¼Œéƒ½åœ¨è¿™é‡Œå“Ÿï¼</p></blockquote><p><strong>æ‘˜è‡ª:githubä¸Šç”±justjavacæ•´ç†çš„free-programming-books-zh_CN(å…è´¹çš„è®¡ç®—æœºç¼–ç¨‹ç±»ä¸­æ–‡ä¹¦ç±)è§‰å¾—ä¸é”™çš„å¯ä»¥å»starå’Œforkä¸€ä¸‹å“Ÿ!</strong></p><h3 id="å†™åœ¨æœ€å‰é¢çš„è¯"><a href="#å†™åœ¨æœ€å‰é¢çš„è¯" class="headerlink" title="å†™åœ¨æœ€å‰é¢çš„è¯"></a>å†™åœ¨æœ€å‰é¢çš„è¯</h3><p>é¦–å…ˆå£°æ˜,æœ¬ç¯‡åšæ–‡å¹¶éæœ¬äººåŸåˆ›,è€Œæ˜¯æ‘˜è‡ªgithubä¸Šå¤§ç¥<code>justjavac</code>å‘èµ·å¹¶æ•´ç†çš„<code>free-programming-books-zh_CN</code>(å…è´¹çš„è®¡ç®—æœºç¼–ç¨‹ç±»ä¸­æ–‡ä¹¦ç±)å¼€æºé¡¹ç›®,æ—¨åœ¨å¸®åŠ©ä¸ç»å¸¸é€›githubçš„ç«¥é‹å‘æ˜ä¼˜è´¨çš„å­¦ä¹ å¹²è´§,èŠ‚çœå­¦ä¹ æ—¶é—´æˆæœ¬.æœ€åå†æ¬¡æ„Ÿè°¢<code>justjavac</code>çš„æ•´ç†ä¸åˆ†äº«.</p><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><p><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E8%AF%AD%E8%A8%80%E6%97%A0%E5%85%B3%E7%B1%BB">è¯­è¨€æ— å…³ç±»</a></p><ul><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F">æ“ä½œç³»ç»Ÿ</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E6%99%BA%E8%83%BD%E7%B3%BB%E7%BB%9F">æ™ºèƒ½ç³»ç»Ÿ</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F">åˆ†å¸ƒå¼ç³»ç»Ÿ</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86">ç¼–è¯‘åŸç†</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E5%87%BD%E6%95%B0%E5%BC%8F%E6%A6%82%E5%BF%B5">å‡½æ•°å¼æ¦‚å¿µ</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6">è®¡ç®—æœºå›¾å½¢å­¦</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#web%E6%9C%8D%E5%8A%A1%E5%99%A8">WEBæœåŠ¡å™¨</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6">ç‰ˆæœ¬æ§åˆ¶</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%BC%96%E8%BE%91%E5%99%A8">ç¼–è¾‘å™¨</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#nosql">NoSQL</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#postgresql">PostgreSQL</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#mysql">MySQL</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%AE%A1%E7%90%86%E5%92%8C%E7%9B%91%E6%8E%A7">ç®¡ç†å’Œç›‘æ§</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E9%A1%B9%E7%9B%AE%E7%9B%B8%E5%85%B3">é¡¹ç›®ç›¸å…³</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F">è®¾è®¡æ¨¡å¼</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#web">Web</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E5%A4%A7%E6%95%B0%E6%8D%AE">å¤§æ•°æ®</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%BC%96%E7%A8%8B%E8%89%BA%E6%9C%AF">ç¼–ç¨‹è‰ºæœ¯</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E5%85%B6%E5%AE%83">å…¶å®ƒ</a></li></ul></li><li><p><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3%E7%B1%BB">è¯­è¨€ç›¸å…³ç±»</a></p><ul><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#android">Android</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#app">APP</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#awk">AWK</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#cc">C/C++</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#c">C#</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#clojure">Clojure</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#csshtml">CSS/HTML</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#dart">Dart</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#elixir">Elixir</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#erlang">Erlang</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#fortran">Fortran</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#go">Go</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#groovy">Groovy</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#haskell">Haskell</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#ios">iOS</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#java">Java</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#javascript">JavaScript</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#latex">LaTeX</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#lisp">LISP</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#lua">Lua</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#OCaml">OCaml</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#perl">Perl</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#php">PHP</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#prolog">Prolog</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#python">Python</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#r">R</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#ruby">Ruby</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#rust">Rust</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#scala">Scala</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#shell">Shell</a></li><li>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#swift">Swift</a></li></ul></li><li><p>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E5%8F%8A%E5%85%B6%E5%AE%83">è¯»ä¹¦ç¬”è®°åŠå…¶å®ƒ</a></p></li><li><p>  <a href="https://github.com/justjavac/free-programming-books-zh_CN#%E6%B5%8B%E8%AF%95%E7%9B%B8%E5%85%B3">æµ‹è¯•ç›¸å…³</a></p></li></ul><h2 id="ç½®é¡¶"><a href="#ç½®é¡¶" class="headerlink" title="ç½®é¡¶"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%BD%AE%E9%A1%B6"></a>ç½®é¡¶</h2><ul><li>  <a href="https://shenbao.github.io/2017/04/22/justjavac-live/">[ç¬”è®°]å‰ç«¯å·¥ç¨‹å¸ˆçš„å…¥é—¨ä¸è¿›é˜¶</a>&nbsp;</li><li>  <a href="https://github.com/i5ting/How-to-learn-node-correctly">[å…¨æ–‡]å¦‚ä½•æ­£ç¡®çš„å­¦ä¹  Node.js</a>&nbsp;<h2 id="è¯­è¨€æ— å…³ç±»"><a href="#è¯­è¨€æ— å…³ç±»" class="headerlink" title="è¯­è¨€æ— å…³ç±»"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E8%AF%AD%E8%A8%80%E6%97%A0%E5%85%B3%E7%B1%BB"></a>è¯­è¨€æ— å…³ç±»</h2></li></ul><h3 id="æ“ä½œç³»ç»Ÿ"><a href="#æ“ä½œç³»ç»Ÿ" class="headerlink" title="æ“ä½œç³»ç»Ÿ"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"></a>æ“ä½œç³»ç»Ÿ</h3><ul><li>  <a href="http://i.linuxtoy.org/docs/guide/index.html">å¼€æºä¸–ç•Œæ—…è¡Œæ‰‹å†Œ</a></li><li>  <a href="http://vbird.dic.ksu.edu.tw/">é¸Ÿå“¥çš„Linuxç§æˆ¿èœ</a></li><li>  <a href="http://billie66.github.io/TLCL/index.html">The Linux Command Line</a>&nbsp;(ä¸­è‹±æ–‡ç‰ˆ)</li><li>  <a href="http://oss.org.cn/kernel-book/ldd3/index.html">Linux è®¾å¤‡é©±åŠ¨</a>&nbsp;(ç¬¬ä¸‰ç‰ˆ)</li><li>  <a href="http://www.kerneltravel.net/kernel-book/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90Linux%E5%86%85%E6%A0%B8%E6%BA%90%E7%A0%81.html">æ·±å…¥åˆ†æLinuxå†…æ ¸æºç </a></li><li>  <a href="http://cb.vu/unixtoolbox_zh_CN.xhtml">UNIX TOOLBOX</a></li><li>  <a href="https://github.com/widuu/chinese_docker">Dockerä¸­æ–‡æŒ‡å—</a></li><li>  <a href="https://github.com/yeasy/docker_practice">Docker â€”â€” ä»å…¥é—¨åˆ°å®è·µ</a></li><li>  <a href="http://yuedu.baidu.com/ebook/d817967416fc700abb68fca1">Dockerå…¥é—¨å®æˆ˜</a></li><li>  <a href="https://github.com/wsargent/docker-cheat-sheet/tree/master/zh-cn#docker-cheat-sheet">Docker Cheat Sheet</a></li><li>  <a href="http://freeradius.akagi201.org/">FreeRADIUSæ–°æ‰‹å…¥é—¨</a></li><li>  <a href="https://aaaaaashu.gitbooks.io/mac-dev-setup/content/">Mac å¼€å‘é…ç½®æ‰‹å†Œ</a></li><li>  <a href="https://www.freebsd.org/doc/zh_CN/books/handbook/index.html">FreeBSD ä½¿ç”¨æ‰‹å†Œ</a></li><li>  <a href="http://billie66.github.io/TLCL/book/">Linux å‘½ä»¤è¡Œ(ä¸­æ–‡ç‰ˆ)</a></li><li>  <a href="http://works.jinbuguo.com/lfs/lfs62/index.html">Linux æ„å»ºæŒ‡å—</a></li><li>  <a href="https://github.com/me115/linuxtools_rst">Linuxå·¥å…·å¿«é€Ÿæ•™ç¨‹</a></li><li>  <a href="https://www.gitbook.com/book/tinylab/linux-doc/details">Linux Documentation (ä¸­æ–‡ç‰ˆ)</a></li><li>  <a href="https://www.gitbook.com/book/tinylab/elinux/details">åµŒå…¥å¼ Linux çŸ¥è¯†åº“ (eLinux.org ä¸­æ–‡ç‰ˆ)</a></li><li>  <a href="https://github.com/tobegit3hub/understand_linux_process">ç†è§£Linuxè¿›ç¨‹</a></li><li>  <a href="https://github.com/jlevy/the-art-of-command-line/blob/master/README-zh.md">å‘½ä»¤è¡Œçš„è‰ºæœ¯</a></li><li>  <a href="https://spacewander.gitbooks.io/systemtapbeginnersguide_zh/content/index.html">SystemTapæ–°æ‰‹æŒ‡å—</a></li><li>  <a href="https://github.com/wizardforcel/think-os-zh">æ“ä½œç³»ç»Ÿæ€è€ƒ</a></li></ul><h4 id="æ™ºèƒ½ç³»ç»Ÿ"><a href="#æ™ºèƒ½ç³»ç»Ÿ" class="headerlink" title="æ™ºèƒ½ç³»ç»Ÿ"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E6%99%BA%E8%83%BD%E7%B3%BB%E7%BB%9F"></a>æ™ºèƒ½ç³»ç»Ÿ</h4><ul><li>  <a href="https://github.com/phodal/designiot">ä¸€æ­¥æ­¥æ­å»ºç‰©è”ç½‘ç³»ç»Ÿ</a></li></ul><h3 id="åˆ†å¸ƒå¼ç³»ç»Ÿ"><a href="#åˆ†å¸ƒå¼ç³»ç»Ÿ" class="headerlink" title="åˆ†å¸ƒå¼ç³»ç»Ÿ"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F"></a>åˆ†å¸ƒå¼ç³»ç»Ÿ</h3><ul><li>  <a href="http://dcaoyuan.github.io/papers/pdfs/Scalability.pdf">èµ°å‘åˆ†å¸ƒå¼</a></li></ul><h3 id="ç¼–è¯‘åŸç†"><a href="#ç¼–è¯‘åŸç†" class="headerlink" title="ç¼–è¯‘åŸç†"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86"></a>ç¼–è¯‘åŸç†</h3><ul><li>  <a href="https://github.com/DeathKing/Learning-SICP">ã€Šè®¡ç®—æœºç¨‹åºçš„ç»“æ„å’Œè§£é‡Šã€‹å…¬å¼€è¯¾ ç¿»è¯‘é¡¹ç›®</a></li></ul><h3 id="å‡½æ•°å¼æ¦‚å¿µ"><a href="#å‡½æ•°å¼æ¦‚å¿µ" class="headerlink" title="å‡½æ•°å¼æ¦‚å¿µ"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E5%87%BD%E6%95%B0%E5%BC%8F%E6%A6%82%E5%BF%B5"></a>å‡½æ•°å¼æ¦‚å¿µ</h3><ul><li>  <a href="https://github.com/justinyhuang/Functional-Programming-For-The-Rest-of-Us-Cn">å‚»ç“œå‡½æ•°ç¼–ç¨‹</a></li></ul><h3 id="è®¡ç®—æœºå›¾å½¢å­¦"><a href="#è®¡ç®—æœºå›¾å½¢å­¦" class="headerlink" title="è®¡ç®—æœºå›¾å½¢å­¦"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6"></a>è®¡ç®—æœºå›¾å½¢å­¦</h3><ul><li>  <a href="https://github.com/zilongshanren/opengl-tutorials">OpenGL æ•™ç¨‹</a></li><li>  <a href="http://html5.iii.org.tw/course/webgl/">WebGLè‡ªå­¦ç½‘</a></li></ul><h3 id="WEBæœåŠ¡å™¨"><a href="#WEBæœåŠ¡å™¨" class="headerlink" title="WEBæœåŠ¡å™¨"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#web%E6%9C%8D%E5%8A%A1%E5%99%A8"></a>WEBæœåŠ¡å™¨</h3><ul><li>  <a href="http://tengine.taobao.org/book/index.html">Nginxå¼€å‘ä»å…¥é—¨åˆ°ç²¾é€š</a>&nbsp;(æ·˜å®å›¢é˜Ÿå‡ºå“)</li><li>  <a href="http://www.ttlsa.com/nginx/nginx-stu-pdf/">Nginxæ•™ç¨‹ä»å…¥é—¨åˆ°ç²¾é€š</a>(PDFç‰ˆæœ¬ï¼Œè¿ç»´ç”Ÿå­˜æ—¶é—´å‡ºå“)</li><li>  <a href="https://www.gitbook.com/book/moonbingbing/openresty-best-practices/details">OpenRestyæœ€ä½³å®è·µ</a></li><li>  <a href="http://works.jinbuguo.com/apache/menu22/index.html">Apache ä¸­æ–‡æ‰‹å†Œ</a></li></ul><h3 id="ç‰ˆæœ¬æ§åˆ¶"><a href="#ç‰ˆæœ¬æ§åˆ¶" class="headerlink" title="ç‰ˆæœ¬æ§åˆ¶"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6"></a>ç‰ˆæœ¬æ§åˆ¶</h3><ul><li>  <a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000">Gitæ•™ç¨‹</a>&nbsp;ï¼ˆæœ¬æ–‡ç”±&nbsp;<a href="http://www.liaoxuefeng.com/">å»–é›ªå³°</a>&nbsp;åˆ›ä½œï¼Œå¦‚æœè§‰å¾—æœ¬æ•™ç¨‹å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå¯ä»¥å»&nbsp;<a href="https://itunes.apple.com/cn/app/git-jiao-cheng/id876420437">iTunes</a>&nbsp;è´­ä¹°ï¼‰</li><li>  <a href="http://rogerdudler.github.io/git-guide/index.zh.html">git - ç®€æ˜“æŒ‡å—</a></li><li>  <a href="http://backlogtool.com/git-guide/cn/">çŒ´å­éƒ½èƒ½æ‡‚çš„GITå…¥é—¨</a></li><li>  <a href="http://gitref.justjavac.com/">Git å‚è€ƒæ‰‹å†Œ</a></li><li>  <a href="http://git-scm.com/book/zh/v2">Pro Git</a></li><li>  <a href="https://www.gitbook.com/book/0532/progit/details">Pro Git ä¸­æ–‡ç‰ˆ</a>&nbsp;(æ•´ç†åœ¨gitbookä¸Š)</li><li>  <a href="http://www-cs-students.stanford.edu/~blynn/gitmagic/intl/zh_cn/">Git Magic</a></li><li>  <a href="http://www.worldhello.net/gotgithub/index.html">GotGitHub</a></li><li>  <a href="http://www.worldhello.net/gotgit/">Gitæƒå¨æŒ‡å—</a></li><li>  <a href="http://gitbook.liuhui998.com/index.html">Git Community Book ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="https://www.mercurial-scm.org/wiki/ChineseTutorial">Mercurial ä½¿ç”¨æ•™ç¨‹</a></li><li>  <a href="http://bucunzai.net/hginit/">HgInit (ä¸­æ–‡ç‰ˆ)</a></li><li>  <a href="http://igit.linuxtoy.org/">æ²‰æµ¸å¼å­¦ Git</a></li><li>  <a href="https://github.com/flyhigher139/Git-Cheat-Sheet">Git-Cheat-Sheet</a>&nbsp;ï¼ˆæ„Ÿè°¢ @flyhigher139 ç¿»è¯‘äº†ä¸­æ–‡ç‰ˆï¼‰</li><li>  <a href="https://snowdream86.gitbooks.io/github-cheat-sheet/content/zh/index.html">GitHubç§˜ç±</a></li><li>  <a href="https://github.com/waylau/github-help">GitHubå¸®åŠ©æ–‡æ¡£</a></li><li>  <a href="http://danielkummer.github.io/git-flow-cheatsheet/index.zh_CN.html">git-flow å¤‡å¿˜æ¸…å•</a></li><li>  <a href="http://svnbook.red-bean.com/nightly/zh/index.html">svn æ‰‹å†Œ</a></li><li>  <a href="https://github.com/phodal/github-roam">GitHubæ¼«æ¸¸æŒ‡å—</a></li></ul><h3 id="ç¼–è¾‘å™¨"><a href="#ç¼–è¾‘å™¨" class="headerlink" title="ç¼–è¾‘å™¨"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%BC%96%E8%BE%91%E5%99%A8"></a>ç¼–è¾‘å™¨</h3><ul><li>  <a href="http://exvim.github.io/docs-zh/intro/">exvimâ€“vim æ”¹è‰¯æˆIDEé¡¹ç›®</a></li><li>  <a href="http://learnvimscriptthehardway.onefloweroneworld.com/">ç¬¨æ–¹æ³•å­¦Vimscript ä¸­è¯‘æœ¬</a></li><li>  <a href="https://github.com/vimcn/vimcdoc">Vimä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://github.com/yangyangwithgnu/use_vim_as_ide">æ‰€éœ€å³æ‰€è·ï¼šåƒ IDE ä¸€æ ·ä½¿ç”¨ vim</a></li><li>  <a href="https://github.com/dofy/learn-vim">vim å®æ“æ•™ç¨‹</a></li><li>  <a href="https://github.com/wizardforcel/atom-flight-manual-zh-cn">Atomé£è¡Œæ‰‹å†Œä¸­æ–‡ç‰ˆ</a></li><li>  <a href="https://github.com/wizardforcel/markdown-simple-world">MarkdownÂ·ç®€å•çš„ä¸–ç•Œ</a></li><li>  <a href="https://github.com/redguardtoo/mastering-emacs-in-one-year-guide/blob/master/guide-zh.org">ä¸€å¹´æˆä¸º Emacs é«˜æ‰‹</a></li><li>  <a href="http://lifegoo.pluskid.org/upload/blog/152/Survive.in.Emacs.pdf">Emacs ç”Ÿå­˜æŒ‡å—</a></li><li>  <a href="https://atom-china.org/t/atom/62">Atomå®˜æ–¹æ‰‹å†Œ</a></li></ul><h3 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#nosql"></a>NoSQL</h3><ul><li>  <a href="http://old.sebug.net/paper/databases/nosql/Nosql.html">NoSQLæ•°æ®åº“ç¬”è°ˆ</a></li><li>  <a href="http://redisbook.com/">Redis è®¾è®¡ä¸å®ç°</a></li><li>  <a href="http://redisdoc.com/">Redis å‘½ä»¤å‚è€ƒ</a></li><li>  <a href="https://github.com/huangz1990/redis-3.0-annotated">å¸¦æœ‰è¯¦ç»†æ³¨é‡Šçš„ Redis 3.0 ä»£ç </a></li><li>  <a href="https://github.com/huangz1990/annotated_redis_source">å¸¦æœ‰è¯¦ç»†æ³¨é‡Šçš„ Redis 2.6 ä»£ç </a></li><li>  <a href="https://github.com/justinyhuang/the-little-mongodb-book-cn/blob/master/mongodb.md">The Little MongoDB Book</a></li><li>  <a href="https://github.com/JasonLai256/the-little-redis-book/blob/master/cn/redis.md">The Little Redis Book</a></li><li>  <a href="http://docs.neo4j.org.cn/">Neo4j ç®€ä½“ä¸­æ–‡æ‰‹å†Œ v1.8</a></li><li>  <a href="http://neo4j.tw/">Neo4j .rb ä¸­æ–‡è³‡æº</a></li><li>  <a href="http://disquebook.com/">Disque ä½¿ç”¨æ•™ç¨‹</a></li><li>  <a href="https://github.com/JerryLead/SparkInternals/tree/master/markdown">Apache Spark è®¾è®¡ä¸å®ç°</a></li></ul><h3 id="PostgreSQL"><a href="#PostgreSQL" class="headerlink" title="PostgreSQL"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#postgresql"></a>PostgreSQL</h3><ul><li>  <a href="http://works.jinbuguo.com/postgresql/menu823/index.html">PostgreSQL 8.2.3 ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://www.postgres.cn/docs/9.3/index.html">PostgreSQL 9.3.1 ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://www.postgres.cn/docs/9.5/index.html">PostgreSQL 9.5.3 ä¸­æ–‡æ–‡æ¡£</a></li></ul><h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#mysql"></a>MySQL</h3><ul><li>  <a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html">MySQLç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç†</a></li><li>  <a href="http://www.cnblogs.com/mr-wid/archive/2013/05/09/3068229.html">21åˆ†é’ŸMySQLå…¥é—¨æ•™ç¨‹</a></li></ul><h3 id="ç®¡ç†å’Œç›‘æ§"><a href="#ç®¡ç†å’Œç›‘æ§" class="headerlink" title="ç®¡ç†å’Œç›‘æ§"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%AE%A1%E7%90%86%E5%92%8C%E7%9B%91%E6%8E%A7"></a>ç®¡ç†å’Œç›‘æ§</h3><ul><li>  <a href="http://kibana.logstash.es/">ELKstack ä¸­æ–‡æŒ‡å—</a></li><li>  <a href="http://udn.yyuap.com/doc/mastering-elasticsearch/">Mastering Elasticsearch(ä¸­æ–‡ç‰ˆ)</a></li><li>  <a href="https://www.gitbook.com/book/fuxiaopang/learnelasticsearch/details">ElasticSearch æƒå¨æŒ‡å—</a></li><li>  <a href="http://es.xiaoleilu.com/">Elasticsearch æƒå¨æŒ‡å—ï¼ˆä¸­æ–‡ç‰ˆï¼‰</a></li><li>  <a href="https://github.com/chenryn/logstash-best-practice-cn">Logstash æœ€ä½³å®è·µ</a></li><li>  <a href="http://bbs.konotes.org/workdoc/puppet-27/">Puppet 2.7 Cookbook ä¸­æ–‡ç‰ˆ</a></li></ul><h3 id="é¡¹ç›®ç›¸å…³"><a href="#é¡¹ç›®ç›¸å…³" class="headerlink" title="é¡¹ç›®ç›¸å…³"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E9%A1%B9%E7%9B%AE%E7%9B%B8%E5%85%B3"></a>é¡¹ç›®ç›¸å…³</h3><ul><li>  <a href="http://article.yeeyan.org/view/2251/94882">æŒç»­é›†æˆï¼ˆç¬¬äºŒç‰ˆï¼‰</a>&nbsp;(è¯‘è¨€ç½‘)</li><li>  <a href="http://www.ibm.com/developerworks/cn/java/j-ap/">è®©å¼€å‘è‡ªåŠ¨åŒ–ç³»åˆ—ä¸“æ </a></li><li>  <a href="http://www.ibm.com/developerworks/cn/java/j-cq/">è¿½æ±‚ä»£ç è´¨é‡</a></li><li>  <a href="https://github.com/fool2fish/selenium-doc">selenium ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://it-ebooks.flygon.net/selenium-simple-tutorial/">Selenium Webdriver ç®€æ˜“æ•™ç¨‹</a></li><li>  <a href="http://local.joelonsoftware.com/wiki/Chinese_(Simplified)">Joelè°ˆè½¯ä»¶</a></li><li>  <a href="http://local.joelonsoftware.com/wiki/%E9%A6%96%E9%A0%81">ç´„è€³è«‡è»Ÿé«”(Joel on Software)</a></li><li>  <a href="https://github.com/waylau/Gradle-2-User-Guide">Gradle 2 ç”¨æˆ·æŒ‡å—</a></li><li>  <a href="http://yuedu.baidu.com/ebook/f23af265998fcc22bcd10da2">Gradle ä¸­æ–‡ä½¿ç”¨æ–‡æ¡£</a></li><li>  <a href="https://github.com/ecomfe/spec">ç¼–ç è§„èŒƒ</a></li><li>  <a href="http://www.ituring.com.cn/book/1143">å¼€æºè½¯ä»¶æ¶æ„</a></li><li>  <a href="http://docs.huihoo.com/gnu/linux/gmake.html">GNU make æŒ‡å—</a></li><li>  <a href="http://www.yayu.org/book/gnu_make/">GNU make ä¸­æ–‡æ‰‹å†Œ</a></li><li>  <a href="http://12factor.net/zh_cn/">The Twelve-Factor App</a></li></ul><h3 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"></a>è®¾è®¡æ¨¡å¼</h3><ul><li>  <a href="https://github.com/me115/design_patterns">å›¾è¯´è®¾è®¡æ¨¡å¼</a></li><li>  <a href="http://blog.csdn.net/lovelion/article/details/17517213">å²ä¸Šæœ€å…¨è®¾è®¡æ¨¡å¼å¯¼å­¦ç›®å½•</a></li><li>  <a href="https://github.com/AlfredTheBest/Design-Pattern">design pattern åŒ…æ•™ä¸åŒ…ä¼š</a></li><li>  <a href="https://quanke.gitbooks.io/design-pattern-java/content/">è®¾è®¡æ¨¡å¼ Java ç‰ˆ</a></li></ul><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#web"></a>Web</h3><ul><li>  <a href="http://www.20thingsilearned.com/zh-CN/home">å…³äºæµè§ˆå™¨å’Œç½‘ç»œçš„ 20 é¡¹é¡»çŸ¥</a></li><li>  <a href="http://jinlong.github.io/2013/08/29/devtoolsecrets/">æµè§ˆå™¨å¼€å‘å·¥å…·çš„ç§˜å¯†</a></li><li>  <a href="https://github.com/CN-Chrome-DevTools/CN-Chrome-DevTools">Chrome å¼€å‘è€…å·¥å…·ä¸­æ–‡æ‰‹å†Œ</a></li><li>  <a href="http://open.chrome.360.cn/extension_dev/overview.html">Chromeæ‰©å±•å¼€å‘æ–‡æ¡£</a></li><li>  <a href="http://www.gruntjs.net/">Gruntä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://www.gulpjs.com.cn/docs/">gulpä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://github.com/nimojs/gulp-book">Gulp å…¥é—¨æŒ‡å—</a></li><li>  <a href="https://github.com/AlloyTeam/Mars">ç§»åŠ¨Webå‰ç«¯çŸ¥è¯†åº“</a></li><li>  <a href="http://deerchao.net/tutorials/regex/regex.htm">æ­£åˆ™è¡¨è¾¾å¼30åˆ†é’Ÿå…¥é—¨æ•™ç¨‹</a></li><li>  <a href="https://github.com/fouber/blog/issues/2">å‰ç«¯å¼€å‘ä½“ç³»å»ºè®¾æ—¥è®°</a></li><li>  <a href="https://github.com/hoosin/mobile-web-favorites">ç§»åŠ¨å‰ç«¯å¼€å‘æ”¶è—å¤¹</a></li><li>  <a href="https://github.com/darcyliu/google-styleguide/blob/master/JSONStyleGuide.md">JSONé£æ ¼æŒ‡å—</a></li><li>  <a href="https://github.com/bolasblack/http-api-guide">HTTP æ¥å£è®¾è®¡æŒ‡åŒ—</a></li><li>  <a href="https://github.com/hacke2/hacke2.github.io/issues/1">å‰ç«¯èµ„æºåˆ†äº«ï¼ˆä¸€ï¼‰</a></li><li>  <a href="https://github.com/hacke2/hacke2.github.io/issues/3">å‰ç«¯èµ„æºåˆ†äº«ï¼ˆäºŒï¼‰</a></li><li>  <a href="http://coderlmn.github.io/code-standards/">å‰ç«¯ä»£ç è§„èŒƒ åŠ æœ€ä½³å®è·µ</a></li><li>  <a href="https://www.gitbook.com/book/dwqs/frontenddevhandbook/details">å‰ç«¯å¼€å‘è€…æ‰‹å†Œ</a></li><li>  <a href="https://www.gitbook.com/book/leohxj/front-end-database/details">å‰ç«¯å·¥ç¨‹å¸ˆæ‰‹å†Œ</a></li><li>  <a href="https://github.com/wizardforcel/w3school">w3schoolæ•™ç¨‹æ•´ç†</a></li><li>  <a href="http://man.lupaworld.com/content/network/wireshark/index.html">Wiresharkç”¨æˆ·æ‰‹å†Œ</a></li><li>  <a href="https://community.emc.com/thread/194901">ä¸€ç«™å¼å­¦ä¹ Wireshark</a></li><li>  <a href="https://ccbikai.gitbooks.io/http-book/content/">HTTP ä¸‹åˆèŒ¶</a></li><li>  <a href="http://yuedu.baidu.com/ebook/478d1a62376baf1ffc4fad99?pn=1">HTTP/2.0 ä¸­æ–‡ç¿»è¯‘</a></li><li>  <a href="https://github.com/abbshr/rfc7540-translation-zh_cn">RFC 7540 - HTTP/2 ä¸­æ–‡ç¿»è¯‘ç‰ˆ</a></li><li>  <a href="https://www.gitbook.com/book/ye11ow/http2-explained/details">http2è®²è§£</a></li><li>  <a href="https://www.gitbook.com/book/juntao/3-web-designs-in-3-weeks/details">3 Web Designs in 3 Weeks</a></li><li>  <a href="https://github.com/hellorocky/Site-Reliability-Engineering">ç«™ç‚¹å¯é æ€§å·¥ç¨‹</a></li></ul><h3 id="å¤§æ•°æ®"><a href="#å¤§æ•°æ®" class="headerlink" title="å¤§æ•°æ®"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E5%A4%A7%E6%95%B0%E6%8D%AE"></a>å¤§æ•°æ®</h3><ul><li>  <a href="https://github.com/Flowerowl/Big-Data-Resources">å¤§æ•°æ®/æ•°æ®æŒ–æ˜/æ¨èç³»ç»Ÿ/æœºå™¨å­¦ä¹ ç›¸å…³èµ„æº</a></li><li>  <a href="https://github.com/egrcc/guidetodatamining">é¢å‘ç¨‹åºå‘˜çš„æ•°æ®æŒ–æ˜æŒ‡å—</a></li><li>  <a href="https://code.csdn.net/CODE_Translation/spark_matei_phd">å¤§å‹é›†ç¾¤ä¸Šçš„å¿«é€Ÿå’Œé€šç”¨æ•°æ®å¤„ç†æ¶æ„</a></li><li>  <a href="https://github.com/linyiqun/DataMiningAlgorithm">æ•°æ®æŒ–æ˜ä¸­ç»å…¸çš„ç®—æ³•å®ç°å’Œè¯¦ç»†çš„æ³¨é‡Š</a></li><li>  <a href="https://aiyanbo.gitbooks.io/spark-programming-guide-zh-cn/content/">Spark ç¼–ç¨‹æŒ‡å—ç®€ä½“ä¸­æ–‡ç‰ˆ</a></li></ul><h2 id="ç¼–ç¨‹è‰ºæœ¯"><a href="#ç¼–ç¨‹è‰ºæœ¯" class="headerlink" title="ç¼–ç¨‹è‰ºæœ¯"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E7%BC%96%E7%A8%8B%E8%89%BA%E6%9C%AF"></a>ç¼–ç¨‹è‰ºæœ¯</h2><ul><li>  <a href="https://github.com/julycoding/The-Art-Of-Programming-by-July">ç¨‹åºå‘˜ç¼–ç¨‹è‰ºæœ¯</a></li><li>  <a href="http://www.oschina.net/translate/what-every-programmer-should-know-about-memory-part1?print">æ¯ä¸ªç¨‹åºå‘˜éƒ½åº”è¯¥äº†è§£çš„å†…å­˜çŸ¥è¯†(è¯‘)</a>ã€ç¬¬ä¸€éƒ¨åˆ†ã€‘</li><li>  <a href="http://read.douban.com/ebook/4972883/">å–æ‚¦çš„å·¥åºï¼šå¦‚ä½•ç†è§£æ¸¸æˆ</a>&nbsp;(è±†ç“£é˜…è¯»ï¼Œå…è´¹ä¹¦ç±)</li></ul><h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E5%85%B6%E5%AE%83"></a>å…¶å®ƒ</h2><ul><li>  <a href="https://www.gitbook.com/book/softwaredownload/openwrt-fanqiang/details">OpenWrtæ™ºèƒ½ã€è‡ªåŠ¨ã€é€æ˜ç¿»å¢™è·¯ç”±å™¨æ•™ç¨‹</a></li><li>  <a href="https://community.emc.com/docs/DOC-16067">SAN ç®¡ç†å…¥é—¨ç³»åˆ—</a></li><li>  <a href="http://sketchcn.com/sketch-chinese-user-manual.html#introduce">Sketch ä¸­æ–‡æ‰‹å†Œ</a></li><li>  <a href="http://ifeve.com/perfbook/">æ·±å…¥ç†è§£å¹¶è¡Œç¼–ç¨‹</a></li><li>  <a href="http://www.kancloud.cn/kancloud/a-programmer-prepares">ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»</a></li><li>  <a href="https://github.com/phodal/growth-ebook">Growth: å…¨æ ˆå¢é•¿å·¥ç¨‹å¸ˆæŒ‡å—</a></li></ul><h2 id="è¯­è¨€ç›¸å…³ç±»"><a href="#è¯­è¨€ç›¸å…³ç±»" class="headerlink" title="è¯­è¨€ç›¸å…³ç±»"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3%E7%B1%BB"></a>è¯­è¨€ç›¸å…³ç±»</h2><h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#android"></a>Android</h3><ul><li>  <a href="http://www.apkbus.com/design/index.html">Android Design(ä¸­æ–‡ç‰ˆ)</a></li><li>  Google Material Design æ­£é«”ä¸­æ–‡ç‰ˆ (<a href="https://wcc723.gitbooks.io/google_design_translate/content/style-icons.html">è¯‘æœ¬ä¸€</a>&nbsp;<a href="https://github.com/1sters/material_design_zh">è¯‘æœ¬äºŒ</a>)</li><li>  <a href="http://wiki.jikexueyuan.com/project/material-design/">Material Design ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://hukai.me/android-training-course-in-chinese/index.html">Google Androidå®˜æ–¹åŸ¹è®­è¯¾ç¨‹ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://www.stormzhang.com/android/2014/07/07/learn-android-from-rookie/">Androidå­¦ä¹ ä¹‹è·¯</a></li><li>  <a href="https://github.com/bboyfeiyu/android-tech-frontier">Androidå¼€å‘æŠ€æœ¯å‰çº¿(android-tech-frontier)</a></li><li>  <a href="https://github.com/FX-Max/Point-of-Android">Point-of-Android</a>&nbsp;Android ä¸€äº›é‡è¦çŸ¥è¯†ç‚¹è§£ææ•´ç†</li><li>  <a href="http://leanote.com/blog/post/561658f938f41126b2000298?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io">Android6.0æ–°ç‰¹æ€§è¯¦è§£</a></li></ul><h3 id="APP"><a href="#APP" class="headerlink" title="APP"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#app"></a>APP</h3><ul><li>  <a href="https://github.com/waylau/cordova-dev-guide">Apache Cordova å¼€å‘æŒ‡å—</a></li></ul><h3 id="AWK"><a href="#AWK" class="headerlink" title="AWK"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#awk"></a>AWK</h3><ul><li>  <a href="https://github.com/wuzhouhui/awk">awkç¨‹åºè®¾è®¡è¯­è¨€</a></li><li>  <a href="http://awk.readthedocs.org/en/latest/index.html">awkä¸­æ–‡æŒ‡å—</a></li></ul><h3 id="C-C"><a href="#C-C" class="headerlink" title="C/C++"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#cc"></a>C/C++</h3><ul><li>  <a href="http://zh.cppreference.com/">C/C++ ä¸­æ–‡å‚è€ƒæ‰‹å†Œ</a>&nbsp;(æ¬¢è¿å¤§å®¶å‚ä¸åœ¨çº¿ç¿»è¯‘å’Œæ ¡å¯¹)</li><li>  <a href="https://www.gitbook.com/book/tinylab/cbook/details">C è¯­è¨€ç¼–ç¨‹é€è§†</a></li><li>  <a href="https://github.com/forhappy/Cplusplus-Concurrency-In-Practice">C++ å¹¶å‘ç¼–ç¨‹æŒ‡å—</a></li><li>  <a href="http://akaedu.github.io/book/">Linux Cç¼–ç¨‹ä¸€ç«™å¼å­¦ä¹ </a>&nbsp;(å®‹åŠ²æ‰, åŒ—äº¬äºšåµŒæ•™è‚²ç ”ç©¶ä¸­å¿ƒ)</li><li>  <a href="https://github.com/leeyiw/cgdb-manual-in-chinese">CGDBä¸­æ–‡æ‰‹å†Œ</a></li><li>  <a href="https://github.com/hellogcc/100-gdb-tips/blob/master/src/index.md">100ä¸ªgdbå°æŠ€å·§</a></li><li>  <a href="https://github.com/hellogcc/100-gcc-tips/blob/master/src/index.md">100ä¸ªgccå°æŠ€å·§</a></li><li>  <a href="https://github.com/anjuke/zguide-cn">ZMQ æŒ‡å—</a></li><li>  <a href="http://www.ituring.com.cn/book/1203">How to Think Like a Computer Scientist</a>&nbsp;(ä¸­è‹±æ–‡ç‰ˆ)</li><li>  <a href="http://scc.qibebt.cas.cn/docs/linux/base/%B8%FA%CE%D2%D2%BB%C6%F0%D0%B4Makefile-%B3%C2%F0%A9.pdf">è·Ÿæˆ‘ä¸€èµ·å†™Makefile(PDF)</a></li><li>  <a href="http://www.yayu.org/book/gnu_make/">GNU makeä¸­æ–‡æ‰‹å†Œ</a></li><li>  <a href="http://docs.huihoo.com/gnu/linux/gmake.html">GNU make æŒ‡å—</a></li><li>  <a href="http://zh-google-styleguide.readthedocs.org/en/latest/google-cpp-styleguide/contents/">Google C++ é£æ ¼æŒ‡å—</a></li><li>  <a href="https://github.com/andycai/cprimer">C/C++ Primer</a>&nbsp;(by @andycai)</li><li>  <a href="http://www.nowamagic.net/librarys/books/contents/c">ç®€å•æ˜“æ‡‚çš„Cé­”æ³•</a></li><li>  <a href="http://sewm.pku.edu.cn/src/paradise/reference/CMake%20Practice.pdf">Cmake å®è·µ</a>&nbsp;(PDFç‰ˆ)</li><li>  <a href="http://www.sunistudio.com/cppfaq/">C++ FAQ LITE(ä¸­æ–‡ç‰ˆ)</a></li><li>  <a href="https://github.com/Mooophy/Cpp-Primer">C++ Primer 5th Answers</a></li><li>  <a href="https://www.gitbook.com/book/chenxiaowei/cpp_concurrency_in_action/details">C++ å¹¶å‘ç¼–ç¨‹(åŸºäºC++11)</a></li><li>  <a href="http://www.kuqin.com/qtdocument/tutorial.html">QT æ•™ç¨‹</a></li><li>  <a href="http://www.devbean.net/category/qt-study-road-2/">DevBeançš„ã€ŠQtå­¦ä¹ ä¹‹è·¯2ã€‹(Qt5)</a></li><li>  <a href="https://github.com/wuye9036/CppTemplateTutorial">C++ Template è¿›é˜¶æŒ‡å—</a></li><li>  <a href="https://github.com/luohaha/Chinese-uvbook">libuvä¸­æ–‡æ•™ç¨‹</a></li><li>  <a href="http://zh.highscore.de/cpp/boost/">Boost åº“ä¸­æ–‡æ•™ç¨‹</a></li><li>  <a href="https://github.com/wizardforcel/lcthw-zh">ç¬¨åŠæ³•å­¦C</a></li></ul><h3 id="C"><a href="#C" class="headerlink" title="C#"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#c"></a>C#</h3><ul><li>  <a href="https://msdn.microsoft.com/zh-cn/library/kx37x362.aspx">MSDN C# ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://msdn.microsoft.com/zh-cn/library/gg145045.aspx">.NET ç±»åº“å‚è€ƒ</a></li><li>  <a href="http://www.cnblogs.com/powertoolsteam/p/aspnetmvc5-tutorials-grapecity.html">ASP.NET MVC 5 å…¥é—¨æŒ‡å—</a></li><li>  <a href="http://www.cnblogs.com/LonelyShadow/p/4162318.html">è¶…å…¨é¢çš„ .NET GDI+ å›¾å½¢å›¾åƒç¼–ç¨‹æ•™ç¨‹</a></li><li>  <a href="https://github.com/JackWangCUMT/customcontrol">.NETæ§ä»¶å¼€å‘åŸºç¡€</a></li><li>  <a href="https://github.com/sherlockchou86/-free-ebook-.NET-">.NETå¼€å‘è¦ç‚¹ç²¾è®²ï¼ˆåˆç¨¿ï¼‰</a></li></ul><h3 id="Clojure"><a href="#Clojure" class="headerlink" title="Clojure"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#clojure"></a>Clojure</h3><ul><li>  <a href="http://xumingming.sinaapp.com/302/clojure-functional-programming-for-the-jvm-clojure-tutorial/">Clojureå…¥é—¨æ•™ç¨‹</a></li></ul><h3 id="CSS-HTML"><a href="#CSS-HTML" class="headerlink" title="CSS/HTML"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#csshtml"></a>CSS/HTML</h3><ul><li>  <a href="http://zh.learnlayout.com/">å­¦ä¹ CSSå¸ƒå±€</a></li><li>  <a href="https://github.com/chadluo/CSS-Guidelines/blob/master/README.md">é€šç”¨ CSS ç¬”è®°ã€å»ºè®®ä¸æŒ‡å¯¼</a></li><li>  <a href="http://css.doyoe.com/">CSSå‚è€ƒæ‰‹å†Œ</a></li><li>  <a href="http://yanxyz.github.io/emmet-docs/">Emmet æ–‡æ¡£</a></li><li>  <a href="http://alloyteam.github.io/CodeGuide/">å‰ç«¯ä»£ç è§„èŒƒ</a>&nbsp;(è…¾è®¯ AlloyTeam å›¢é˜Ÿ)</li><li>  <a href="http://codeguide.bootcss.com/">HTMLå’ŒCSSç¼–ç è§„èŒƒ</a></li><li>  <a href="http://sass-guidelin.es/zh/">Sass Guidelines ä¸­æ–‡</a></li><li>  <a href="https://github.com/waylau/css3-tutorial">CSS3 Tutorial ã€ŠCSS3 æ•™ç¨‹ã€‹</a></li><li>  <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML">MDN HTML ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS">MDN CSS ä¸­æ–‡æ–‡æ¡£</a></li></ul><h3 id="Dart"><a href="#Dart" class="headerlink" title="Dart"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#dart"></a>Dart</h3><ul><li>  <a href="http://dart.lidian.info/wiki/Language_Tour">Dart è¯­è¨€å¯¼è§ˆ</a></li></ul><h3 id="Elixir"><a href="#Elixir" class="headerlink" title="Elixir"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#elixir"></a>Elixir</h3><ul><li>  <a href="https://github.com/straightdave/programming_elixir">Elixirç¼–ç¨‹å…¥é—¨</a></li></ul><h3 id="Erlang"><a href="#Erlang" class="headerlink" title="Erlang"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#erlang"></a>Erlang</h3><ul><li>  <a href="http://21å¤©å­¦é€šerlang.github.io/">21å¤©å­¦é€šErlang</a></li></ul><h3 id="Fortran"><a href="#Fortran" class="headerlink" title="Fortran"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#fortran"></a>Fortran</h3><ul><li>  <a href="http://micro.ustc.edu.cn/Fortran/ZJDing/">Fortran77å’Œ90/95ç¼–ç¨‹å…¥é—¨</a></li></ul><h3 id="Go"><a href="#Go" class="headerlink" title="Go"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#go"></a>Go</h3><ul><li>  <a href="https://github.com/Unknwon/go-fundamental-programming">Goç¼–ç¨‹åŸºç¡€</a></li><li>  <a href="https://github.com/Unknwon/the-way-to-go_ZH_CN">Goå…¥é—¨æŒ‡å—</a></li><li>  <a href="http://mikespook.com/learning-go/">å­¦ä¹ Goè¯­è¨€</a></li><li>  <a href="https://github.com/astaxie/build-web-application-with-golang">Go Web ç¼–ç¨‹</a>&nbsp;(æ­¤ä¹¦å·²ç»å‡ºç‰ˆï¼Œå¸Œæœ›å¼€å‘è€…ä»¬å»è´­ä¹°ï¼Œæ”¯æŒä½œè€…çš„åˆ›ä½œ)</li><li>  <a href="https://github.com/astaxie/Go-in-Action">Goå®æˆ˜å¼€å‘</a>&nbsp;(å½“æˆ‘æ”¶å½•æ­¤é¡¹ç›®æ—¶ï¼Œä½œè€…å·²ç»å†™å®Œç¬¬ä¸‰ç« ï¼Œå¦‚æœè¯»å®Œå‰é¢ç« èŠ‚è§‰å¾—æœ‰å¸®åŠ©ï¼Œå¯ä»¥ç»™ä½œè€…<a href="https://me.alipay.com/astaxie">æèµ </a>ï¼Œä»¥é¼“åŠ±ä½œè€…çš„ç»§ç»­åˆ›ä½œ)</li><li>  <a href="https://github.com/astaxie/NPWG_zh">Network programming with Go ä¸­æ–‡ç¿»è¯‘ç‰ˆæœ¬</a></li><li>  <a href="http://www.hellogcc.org/effective_go.html">Effective Go</a></li><li>  <a href="https://github.com/polaris1119/The-Golang-Standard-Library-by-Example">Go è¯­è¨€æ ‡å‡†åº“</a></li><li>  <a href="http://godoc.ml/">Golangæ ‡å‡†åº“æ–‡æ¡£</a></li><li>  <a href="http://gorevel.cn/docs/manual/index.html">Revel æ¡†æ¶æ‰‹å†Œ</a></li><li>  <a href="http://blog.csdn.net/dc_726/article/details/46565241">Javaç¨‹åºå‘˜çš„Golangå…¥é—¨æŒ‡å—</a></li><li>  <a href="https://github.com/hyper-carrot/go_command_tutorial">Goå‘½ä»¤æ•™ç¨‹</a></li><li>  <a href="https://github.com/achun/Go-Blog-In-Action">Goè¯­è¨€åšå®¢å®è·µ</a></li><li>  <a href="https://github.com/golang-china/golangdoc.translations">Go å®˜æ–¹æ–‡æ¡£ç¿»è¯‘</a></li><li>  <a href="https://github.com/tiancaiamao/go-internals">æ·±å…¥è§£æGo</a></li><li>  <a href="https://bitbucket.org/golang-china/gopl-zh/wiki/Home">Goè¯­è¨€åœ£ç»(ä¸­æ–‡ç‰ˆ)</a>&nbsp;(<a href="https://www.gitbook.com/book/wizardforcel/gopl-zh/details">GitBook</a>)</li></ul><h3 id="Groovy"><a href="#Groovy" class="headerlink" title="Groovy"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#groovy"></a>Groovy</h3><ul><li>  <a href="http://www.ibm.com/developerworks/cn/java/j-pg/">å®æˆ˜ Groovy ç³»åˆ—</a></li></ul><h3 id="Haskell"><a href="#Haskell" class="headerlink" title="Haskell"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#haskell"></a>Haskell</h3><ul><li>  <a href="http://rwh.readthedocs.org/en/latest/">Real World Haskell ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://fleurer-lee.com/lyah/">Haskellè¶£å­¦æŒ‡å—</a></li></ul><h3 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#ios"></a>iOS</h3><ul><li>  <a href="https://github.com/qinjx/30min_guides/blob/master/ios.md">iOSå¼€å‘60åˆ†é’Ÿå…¥é—¨</a></li><li>  <a href="http://isux.tencent.com/ios-human-interface-guidelines-ui-design-basics-ios7.html">iOS7äººæœºç•Œé¢æŒ‡å—</a></li><li>  <a href="http://zh-google-styleguide.readthedocs.org/en/latest/google-objc-styleguide/">Google Objective-C Style Guide ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://wileam.com/iphone-6-screen-cn/">iPhone 6 å±å¹•æ­ç§˜</a></li><li>  <a href="http://nilsun.github.io/apple-watch/">Apple Watchå¼€å‘åˆæ¢</a></li><li>  <a href="https://developer.apple.com/library/ios/referencelibrary/GettingStarted/RoadMapiOSCh/index.html">é©¬ä¸Šç€æ‰‹å¼€å‘ iOS åº”ç”¨ç¨‹åº</a></li><li>  <a href="https://github.com/jkyin/Subtitle">ç½‘æ˜“æ–¯å¦ç¦å¤§å­¦å…¬å¼€è¯¾ï¼šiOS 7åº”ç”¨å¼€å‘å­—å¹•æ–‡ä»¶</a></li></ul><h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#java"></a>Java</h3><ul><li>  <a href="https://github.com/waylau/apache-shiro-1.2.x-reference">Apache Shiro ç”¨æˆ·æŒ‡å—</a></li><li>  <a href="https://github.com/waylau/Jersey-2.x-User-Guide">Jersey 2.x ç”¨æˆ·æŒ‡å—</a></li><li>  <a href="https://github.com/waylau/spring-framework-4-reference">Spring Framework 4.xå‚è€ƒæ–‡æ¡£</a></li><li>  <a href="https://github.com/qibaoguang/Spring-Boot-Reference-Guide">Spring Bootå‚è€ƒæŒ‡å—</a>&nbsp;(ç¿»è¯‘ä¸­)</li><li>  <a href="http://mybatis.org/mybatis-3/zh/index.html">MyBatisä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://mbg.cndocs.tk/">MyBatis Generator ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://github.com/waylau/RestDemo">ç”¨jerseyæ„å»ºRESTæœåŠ¡</a></li><li>  <a href="https://github.com/waylau/activiti-5.x-user-guide">Activiti 5.x ç”¨æˆ·æŒ‡å—</a></li><li>  <a href="http://www.hawstein.com/posts/google-java-style.html">Google Javaç¼–ç¨‹é£æ ¼æŒ‡å—</a></li><li>  <a href="https://github.com/waylau/netty-4-user-guide">Netty 4.x ç”¨æˆ·æŒ‡å—</a></li><li>  <a href="https://github.com/waylau/essential-netty-in-action">Netty å®æˆ˜(ç²¾é«“)</a></li><li>  <a href="https://github.com/waylau/rest-in-action">REST å®æˆ˜</a></li><li>  <a href="https://github.com/waylau/java-code-conventions">Java ç¼–ç è§„èŒƒ</a></li><li>  <a href="https://github.com/waylau/apache-mina-2.x-user-guide">Apache MINA 2 ç”¨æˆ·æŒ‡å—</a></li><li>  <a href="https://github.com/waylau/h2-database-doc">H2 Database æ•™ç¨‹</a></li><li>  <a href="https://github.com/waylau/servlet-3.1-specification">Java Servlet 3.1 è§„èŒƒ</a></li><li>  <a href="https://github.com/waylau/jsse-reference-guide">JSSE å‚è€ƒæŒ‡å—</a></li><li>  <a href="https://github.com/biezhi/jb">Javaå¼€æºå®ç°åŠæœ€ä½³å®è·µ</a></li><li>  <a href="https://github.com/waylau/essential-java">Java ç¼–ç¨‹è¦ç‚¹</a></li><li>  <a href="http://www.ituring.com.cn/minibook/69">Think Java</a></li><li>  <a href="https://github.com/wizardforcel/modern-java-zh">Java 8 ç®€æ˜æ•™ç¨‹</a></li></ul><h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#javascript"></a>JavaScript</h3><ul><li>  <a href="http://bq69.com/blog/articles/script/868/google-javascript-style-guide.html">Google JavaScript ä»£ç é£æ ¼æŒ‡å—</a></li><li>  <a href="https://github.com/darcyliu/google-styleguide/blob/master/JSONStyleGuide.md">Google JSON é£æ ¼æŒ‡å—</a></li><li>  <a href="https://github.com/adamlu/javascript-style-guide">Airbnb JavaScript è§„èŒƒ</a></li><li>  <a href="http://javascript.ruanyifeng.com/">JavaScript æ ‡å‡†å‚è€ƒæ•™ç¨‹ï¼ˆalphaï¼‰</a></li><li>  <a href="http://pij.robinqu.me/">Javascriptç¼–ç¨‹æŒ‡å—</a>&nbsp;(<a href="https://github.com/RobinQu/Programing-In-Javascript">æºç </a>)</li><li>  <a href="https://github.com/justjavac/12-javascript-quirks">javascript çš„ 12 ä¸ªæ€ªç™–</a></li><li>  <a href="http://bonsaiden.github.io/JavaScript-Garden/zh/">JavaScript ç§˜å¯†èŠ±å›­</a></li><li>  <a href="http://icodeit.org/jsccp/">JavaScriptæ ¸å¿ƒæ¦‚å¿µåŠå®è·µ</a>&nbsp;(PDF) (æ­¤ä¹¦å·²ç”±äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾å‡ºç‰ˆå‘è¡Œï¼Œä½†ä½œè€…ä¾ç„¶å…è´¹æä¾›PDFç‰ˆæœ¬ï¼Œå¸Œæœ›å¼€å‘è€…ä»¬å»è´­ä¹°ï¼Œæ”¯æŒä½œè€…)</li><li>  <a href="https://github.com/jayli/javascript-patterns">ã€ŠJavaScript æ¨¡å¼ã€‹</a>&nbsp;â€œJavaScript patternsâ€ä¸­è¯‘æœ¬</li><li>  <a href="http://justjavac.com/named-function-expressions-demystified.html">å‘½åå‡½æ•°è¡¨è¾¾å¼æ¢ç§˜</a>&nbsp;(æ³¨:åŸæ–‡ç”±<a href="http://www.cn-cuckoo.com/">ä¸ºä¹‹æ¼«ç¬”</a>ç¿»è¯‘ï¼ŒåŸå§‹åœ°å€æ— æ³•æ‰“å¼€ï¼Œæ‰€ä»¥æ­¤å¤„åœ°å€ä¸ºæˆ‘åšå®¢ä¸Šçš„å¤‡ä»½)</li><li>  <a href="http://www.oschina.net/translate/learning-javascript-design-patterns">å­¦ç”¨ JavaScript è®¾è®¡æ¨¡å¼</a>&nbsp;(å¼€æºä¸­å›½)</li><li>  <a href="http://www.cnblogs.com/TomXu/archive/2011/12/15/2288411.html">æ·±å…¥ç†è§£JavaScriptç³»åˆ—</a></li><li>  <a href="http://yanhaijing.com/es5">ECMAScript 5.1 ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://es6.ruanyifeng.com/">ECMAScript 6 å…¥é—¨</a>&nbsp;(ä½œè€…ï¼šé˜®ä¸€å³°)</li><li>  <a href="http://liubin.github.io/promises-book/">JavaScript Promiseè¿·ä½ ä¹¦</a></li><li>  <a href="https://github.com/getify/You-Dont-Know-JS">You-Dont-Know-JS</a>&nbsp;(æ·±å…¥JavaScriptè¯­è¨€æ ¸å¿ƒæœºåˆ¶çš„ç³»åˆ—å›¾ä¹¦)</li><li>  <a href="http://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000">JavaScript æ•™ç¨‹</a>&nbsp;å»–é›ªå³°</li><li>  <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript">MDN JavaScript ä¸­æ–‡æ–‡æ¡£</a></li><li>jQuery<ul><li>  <a href="http://www.cn-cuckoo.com/deconstructed/jquery.html">jQuery è§£æ„</a></li><li>  <a href="http://www.nowamagic.net/librarys/books/contents/jquery">ç®€å•æ˜“æ‡‚çš„JQueryé­”æ³•</a></li><li>  <a href="http://i5ting.github.io/How-to-write-jQuery-plugin/build/jquery.plugin.html">How to write jQuery plugin</a></li><li>  <a href="https://github.com/oneuijs/You-Dont-Need-jQuery/blob/master/README.zh-CN.md">You Donâ€™t Need jQuery</a></li><li>  <a href="https://github.com/MeCKodo/forchange">å¦‚ä½•å®ç°ä¸€ä¸ªç±»jQueryï¼Ÿ</a></li></ul></li><li>Node.js<ul><li>  <a href="http://www.nodebeginner.org/index-zh-cn.html">Nodeå…¥é—¨</a></li><li>  <a href="http://nqdeng.github.io/7-days-nodejs/">ä¸ƒå¤©å­¦ä¼šNodeJS</a></li><li>  <a href="https://github.com/nodejs-tw/nodejs-wiki-book">Nodejs Wiki Book</a>&nbsp;(ç¹ä½“ä¸­æ–‡)</li><li>  <a href="http://expressjs.jser.us/">express.js ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://github.com/guo-yu/koa-guide">koa ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://base-n.github.io/koa-generator-examples/">ä¸€èµ·å­¦koa</a></li><li>  <a href="https://github.com/nswbmw/N-blog">ä½¿ç”¨ Express + MongoDB æ­å»ºå¤šäººåšå®¢</a></li><li>  <a href="http://javascript.ruanyifeng.com/nodejs/express.html">Expressæ¡†æ¶</a></li><li>  <a href="https://github.com/alsotang/node-lessons">Node.js åŒ…æ•™ä¸åŒ…ä¼š</a></li><li>  <a href="https://www.npmjs.com/package/learnyounode-zh-cn">Learn You The Node.js For Much Win! (ä¸­æ–‡ç‰ˆ)</a></li><li>  <a href="http://i5ting.github.io/node-debug-tutorial/">Node debug ä¸‰æ³•ä¸‰ä¾‹</a></li><li>  <a href="https://www.gitbook.com/book/0532/nodejs/details">nodejsä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://github.com/wizardforcel/orm2-doc-zh-cn">orm2 ä¸­æ–‡æ–‡æ¡£</a></li></ul></li><li>underscore.js<ul><li>  <a href="http://learningcn.com/underscore/">Underscore.jsä¸­æ–‡æ–‡æ¡£</a></li></ul></li><li>backbone.js<ul><li>  <a href="http://www.css88.com/doc/backbone/">backbone.jsä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://www.the5fire.com/backbone-js-tutorials-pdf-download.html">backbone.jså…¥é—¨æ•™ç¨‹</a>&nbsp;(PDF)</li><li>  <a href="https://github.com/the5fire/backbonejs-learning-note">Backbone.jså…¥é—¨æ•™ç¨‹ç¬¬äºŒç‰ˆ</a></li><li>  <a href="http://feliving.github.io/developing-backbone-applications/">Developing Backbone.js Applications(ä¸­æ–‡ç‰ˆ)</a></li></ul></li><li>AngularJS<ul><li>  <a href="https://github.com/mgechev/angularjs-style-guide/blob/master/README-zh-cn.md">AngularJSæœ€ä½³å®è·µå’Œé£æ ¼æŒ‡å—</a></li><li>  <a href="https://github.com/peiransun/angularjs-cn">AngularJSä¸­è¯‘æœ¬</a></li><li>  <a href="https://github.com/zensh/AngularjsTutorial_cn">AngularJSå…¥é—¨æ•™ç¨‹</a></li><li>  <a href="https://github.com/xufei/Make-Your-Own-AngularJS/blob/master/01.md">æ„å»ºè‡ªå·±çš„AngularJS</a></li><li>  <a href="http://www.waylau.com/build-angularjs-app-with-yeoman-in-windows/">åœ¨Windowsç¯å¢ƒä¸‹ç”¨Yeomanæ„å»ºAngularJSé¡¹ç›®</a></li></ul></li><li>Zepto.js<ul><li>  <a href="http://mweb.baidu.com/zeptoapi/">Zepto.js ä¸­æ–‡æ–‡æ¡£</a></li></ul></li><li>Sea.js<ul><li>  <a href="http://island205.com/HelloSea.js/">Hello Sea.js</a></li></ul></li><li>React.js<ul><li>  <a href="https://doc.react-china.org/">React.js ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://github.com/fakefish/react-webpack-cookbook">React webpack-cookbook</a></li><li>  <a href="http://fraserxu.me/intro-to-react/">React å…¥é—¨æ•™ç¨‹</a></li><li>  <a href="http://wiki.jikexueyuan.com/project/react-native/">React Native ä¸­æ–‡æ–‡æ¡£(å«æœ€æ–°Androidå†…å®¹)</a></li><li>  <a href="https://github.com/theJian/build-a-hn-front-page">Learn React &amp; Webpack by building the Hacker News front page</a></li></ul></li><li>impress.js<ul><li>  <a href="https://github.com/kokdemo/impress.js-tutorial-in-Chinese">impress.jsçš„ä¸­æ–‡æ•™ç¨‹</a></li></ul></li><li>CoffeeScript<ul><li>  <a href="http://island205.com/coffeescript-cookbook.github.com/">CoffeeScript Cookbook</a></li><li>  <a href="http://island205.com/tlboc/">The Little Book on CoffeeScriptä¸­æ–‡ç‰ˆ</a></li><li>  <a href="https://github.com/geekplux/coffeescript-style-guide">CoffeeScript ç¼–ç é£æ ¼æŒ‡å—</a></li></ul></li><li>TypeScipt<ul><li>  <a href="https://zhongsp.gitbooks.io/typescript-handbook/content/">TypeScript Handbook</a></li></ul></li><li>ExtJS<ul><li>  <a href="http://extjs-doc-cn.github.io/ext4api/">Ext4.1.0 ä¸­æ–‡æ–‡æ¡£</a></li></ul></li><li>Meteor<ul><li>  <a href="http://zh.discovermeteor.com/">Discover Meteor</a></li><li>  <a href="http://docs.meteorhub.org/#/basic/">Meteor ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://angular.meteorhub.org/">Angular-Meteor ä¸­æ–‡æ•™ç¨‹</a></li></ul></li><li>  <a href="http://www.ituring.com.cn/minibook/950">Chromeæ‰©å±•åŠåº”ç”¨å¼€å‘</a></li></ul><h3 id="LaTeX"><a href="#LaTeX" class="headerlink" title="LaTeX"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#latex"></a>LaTeX</h3><ul><li>  <a href="http://liam0205.me/2014/09/08/latex-introduction/">ä¸€ä»½å…¶å®å¾ˆçŸ­çš„ LaTeX å…¥é—¨æ–‡æ¡£</a></li><li>  <a href="http://www.mohu.org/info/lshort-cn.pdf">ä¸€ä»½ä¸å¤ªç®€çŸ­çš„ LATEX 2Îµ ä»‹ç»</a>&nbsp;ï¼ˆPDFç‰ˆï¼‰</li></ul><h3 id="LISP"><a href="#LISP" class="headerlink" title="LISP"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#lisp"></a>LISP</h3><ul><li>Common Lisp<ul><li>  <a href="http://acl.readthedocs.org/en/latest/">ANSI Common Lisp ä¸­æ–‡ç¿»è­¯ç‰ˆ</a></li><li>  <a href="http://www.ituring.com.cn/minibook/862">On Lisp ä¸­æ–‡ç¿»è¯‘ç‰ˆæœ¬</a></li></ul></li><li>Scheme<ul><li>  <a href="http://deathking.github.io/yast-cn/">Yet Another Scheme Tutorial Schemeå…¥é—¨æ•™ç¨‹</a></li><li>  <a href="http://songjinghe.github.io/TYS-zh-translation/">Schemeè¯­è¨€ç®€æ˜æ•™ç¨‹</a></li><li>Racket<ul><li>  <a href="https://github.com/tyrchen/racket-book">Racket book</a></li></ul></li></ul></li></ul><h3 id="Lua"><a href="#Lua" class="headerlink" title="Lua"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#lua"></a>Lua</h3><ul><li>  <a href="https://github.com/andycai/luaprimer">Luaç¼–ç¨‹å…¥é—¨</a></li><li>  <a href="http://www.codingnow.com/2000/download/lua_manual.html">Lua 5.1 å‚è€ƒæ‰‹å†Œ ä¸­æ–‡ç¿»è¯‘</a></li><li>  <a href="http://cloudwu.github.io/lua53doc/">Lua 5.3 å‚è€ƒæ‰‹å†Œ ä¸­æ–‡ç¿»è¯‘</a></li><li>  <a href="http://www.codingnow.com/temp/readinglua.pdf">Luaæºç æ¬£èµ</a></li></ul><h3 id="OCaml"><a href="#OCaml" class="headerlink" title="OCaml"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#ocaml"></a>OCaml</h3><ul><li>  <a href="https://github.com/zforget/translation/tree/master/real_world_ocaml">Real World OCaml</a></li></ul><h3 id="Perl"><a href="#Perl" class="headerlink" title="Perl"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#perl"></a>Perl</h3><ul><li>  <a href="https://github.com/horus/modern_perl_book">Modern Perl ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://perl.linuxtoy.org/">Perl ç¨‹åºå‘˜åº”è¯¥çŸ¥é“çš„äº‹</a></li></ul><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#php"></a>PHP</h3><ul><li>  <a href="http://php.net/manual/zh/">PHP å®˜æ–¹æ‰‹å†Œ</a></li><li>  <a href="http://www.laruence.com/2010/06/21/1608.html">PHPè°ƒè¯•æŠ€æœ¯æ‰‹å†Œ</a>(PDF)</li><li>  PHPä¹‹é“ï¼šphp-the-right-way (<a href="http://wulijun.github.io/php-the-right-way/">@wulijunç‰ˆ</a>&nbsp;<a href="http://laravel-china.github.io/php-the-right-way/">PHPHubç‰ˆ</a>)</li><li>  <a href="https://github.com/justjavac/PHP-Best-Practices-zh_CN">PHP æœ€ä½³å®è·µ</a></li><li>  <a href="https://ryancao.gitbooks.io/php-developer-prepares/content/">PHP å¼€å‘è€…å®è·µ</a></li><li>  <a href="https://github.com/reeze/tipi">æ·±å…¥ç†è§£PHPå†…æ ¸</a></li><li>  <a href="http://www.walu.cc/phpbook/">PHPæ‰©å±•å¼€å‘åŠå†…æ ¸åº”ç”¨</a></li><li>  <a href="http://laravel-china.org/docs/5.1">Laravel5.1 ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://cs.phphub.org/">Laravel 5.1 LTS é€ŸæŸ¥è¡¨</a></li><li>  <a href="http://wiki.jikexueyuan.com/project/symfony-cookbook/">Symfony2 Cookbook ä¸­æ–‡ç‰ˆ</a>(ç‰ˆæœ¬ 2.7.0 LTS)</li><li>  <a href="http://symfony-docs-chs.readthedocs.org/en/latest/">Symfony2ä¸­æ–‡æ–‡æ¡£</a>&nbsp;(æœªè¯‘å®Œ)</li><li>  <a href="http://yiibook.com//doc">YiiBookå‡ æœ¬Yiiæ¡†æ¶çš„åœ¨çº¿æ•™ç¨‹</a></li><li>  <a href="http://www.digpage.com/">æ·±å…¥ç†è§£ Yii 2.0</a></li><li>  <a href="http://www.yiichina.com/">Yii æ¡†æ¶ä¸­æ–‡æ–‡æª”</a></li><li>  <a href="http://www.nowamagic.net/librarys/books/contents/php">ç®€å•æ˜“æ‡‚çš„PHPé­”æ³•</a></li><li>  <a href="https://github.com/LinkedDestiny/swoole-doc">swooleæ–‡æ¡£åŠå…¥é—¨æ•™ç¨‹</a></li><li>  <a href="http://www.phpcomposer.com/">Composer ä¸­æ–‡ç½‘</a></li><li>  <a href="http://ww1.minimee.org/php/slim">Slim ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://lumen.laravel-china.org/">Lumen ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://phpunit.de/manual/current/zh_cn/installation.html">PHPUnit ä¸­æ–‡æ–‡æ¡£</a></li></ul><h3 id="Prolog"><a href="#Prolog" class="headerlink" title="Prolog"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#prolog"></a>Prolog</h3><ul><li>  <a href="http://fengdidi.github.io/blog/2011/11/15/qian-yan/">ç¬¨åŠæ³•å­¦Prolog</a></li></ul><h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#python"></a>Python</h3><ul><li>  <a href="http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000">å»–é›ªå³° Python 2.7 ä¸­æ–‡æ•™ç¨‹</a></li><li>  <a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000">å»–é›ªå³° Python 3 ä¸­æ–‡æ•™ç¨‹</a></li><li>  <a href="http://www.kuqin.com/abyteofpython_cn/">ç®€æ˜Pythonæ•™ç¨‹</a></li><li>  <a href="http://www.kancloud.cn/kancloud/python-basic">é›¶åŸºç¡€å­¦ Python ç¬¬ä¸€ç‰ˆ</a></li><li>  <a href="http://www.kancloud.cn/kancloud/starter-learning-python">é›¶åŸºç¡€å­¦ Python ç¬¬äºŒç‰ˆ</a></li><li>  <a href="http://lovelypython.readthedocs.org/en/latest/">å¯çˆ±çš„ Python</a></li><li>  <a href="http://www.pythondoc.com/pythontutorial27/index.html">Python 2.7 å®˜æ–¹æ•™ç¨‹ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://www.pythondoc.com/pythontutorial3/index.html">Python 3.3 å®˜æ–¹æ•™ç¨‹ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://www.kancloud.cn/thinkphp/python-cookbook">Python Cookbook ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="https://github.com/yidao620c/python3-cookbook">Python3 Cookbook ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://www.kuqin.com/docs/diveintopythonzh-cn-5.4b/html/toc/">æ·±å…¥ Python</a></li><li>  <a href="http://old.sebug.net/paper/books/dive-into-python3/">æ·±å…¥ Python 3</a></li><li>  <a href="https://code.google.com/p/zhong-wiki/wiki/PEP8">PEP8 Pythonä»£ç é£æ ¼è§„èŒƒ</a></li><li>  <a href="http://zh-google-styleguide.readthedocs.org/en/latest/google-python-styleguide/">Google Python é£æ ¼æŒ‡å— ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://liam0205.me/2013/11/02/Python-tutorial-zh_cn/">Pythonå…¥é—¨æ•™ç¨‹</a>&nbsp;(<a href="http://liam0205.me/attachment/Python/The_Python_Tutorial_zh-cn.pdf">PDF</a>)</li><li>  <a href="http://old.sebug.net/paper/books/LearnPythonTheHardWay/">ç¬¨åŠæ³•å­¦ Python</a>&nbsp;(<a href="http://liam0205.me/attachment/Python/PyHardWay/Learn_Python_The_Hard_Way_zh-cn.pdf">PDF</a>&nbsp;<a href="https://www.gitbook.com/download/epub/book/wizardforcel/lpthw">EPUB</a>)</li><li>  <a href="http://pan.baidu.com/s/1qW4pvnY">Pythonè‡ªç„¶è¯­è¨€å¤„ç†ä¸­æ–‡ç‰ˆ</a>&nbsp;ï¼ˆæ„Ÿè°¢é™ˆæ¶›åŒå­¦çš„ç¿»è¯‘ï¼Œä¹Ÿè°¢è°¢&nbsp;<a href="https://github.com/shwley">@shwley</a>&nbsp;è”ç³»äº†ä½œè€…ï¼‰</li><li>  <a href="http://liam0205.me/2014/09/11/matplotlib-tutorial-zh-cn/">Python ç»˜å›¾åº“ matplotlib å®˜æ–¹æŒ‡å—ä¸­æ–‡ç¿»è¯‘</a></li><li>  <a href="http://scrapy-chs.readthedocs.org/zh_CN/latest/">Scrapy 0.25 æ–‡æ¡£</a></li><li>  <a href="https://github.com/carfly/thinkpython-cn">ThinkPython</a></li><li>  <a href="https://github.com/bingjin/ThinkPython2-CN">ThinkPython 2ed</a></li><li>  <a href="http://www.cnblogs.com/vamei/archive/2012/09/13/2682778.html">Pythonå¿«é€Ÿæ•™ç¨‹</a></li><li>  <a href="http://wiki.ubuntu.org.cn/Python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97">Python æ­£åˆ™è¡¨è¾¾å¼æ“ä½œæŒ‡å—</a></li><li>  <a href="http://www.crifan.com/files/doc/docbook/python_beginner_tutorial/release/html/python_beginner_tutorial.html">pythonåˆçº§æ•™ç¨‹ï¼šå…¥é—¨è¯¦è§£</a></li><li>  <a href="https://www.gitbook.com/book/likebeta/twisted-intro-cn/details">Twisted ä¸å¼‚æ­¥ç¼–ç¨‹å…¥é—¨</a></li><li>  <a href="http://textgrocery.readthedocs.org/zh/latest/index.html">TextGrocery ä¸­æ–‡ API</a>&nbsp;( åŸºäºsvmç®—æ³•çš„ä¸€ä¸ªçŸ­æ–‡æœ¬åˆ†ç±» Python åº“ )</li><li>  <a href="http://requests-docs-cn.readthedocs.org/zh_CN/latest/">Requests: HTTP for Humans</a></li><li>  <a href="http://pillow-cn.readthedocs.org/en/latest/#">Pillow ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://pymotwcn.readthedocs.org/en/latest/index.html">PyMOTW ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://data.digitser.net/zh-CN/python_index.html">Python å®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://fabric-chs.readthedocs.org/">Fabric ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://beautifulsoup.readthedocs.org/zh_CN/latest/">Beautiful Soup 4.2.0 ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="http://old.sebug.net/paper/books/scipydoc">ç”¨Pythonåšç§‘å­¦è®¡ç®—</a></li><li>  <a href="http://www.pythondoc.com/sphinx/index.html">Sphinx ä¸­æ–‡æ–‡æ¡£</a></li><li>  <a href="https://github.com/cundi/Mastering.Python.Design.Patterns">ç²¾é€š Python è®¾è®¡æ¨¡å¼</a></li><li>  <a href="https://github.com/smartFlash/pySecurity">python å®‰å…¨ç¼–ç¨‹æ•™ç¨‹</a></li><li>  <a href="https://www.gitbook.com/book/wizardforcel/sjtu-cs902-courseware/details">ç¨‹åºè®¾è®¡æ€æƒ³ä¸æ–¹æ³•</a></li><li>  <a href="https://read.douban.com/ebook/16691849/">çŸ¥ä¹å‘¨åˆŠÂ·ç¼–ç¨‹å°ç™½å­¦Python</a></li><li>  <a href="https://github.com/cloga/scipy-lecture-notes_cn">Scipy è®²ä¹‰</a></li><li>  <a href="http://www.kuqin.com/docs/pythonbasic.html">Python å­¦ä¹ ç¬”è®° åŸºç¡€ç¯‡</a></li><li>  <a href="http://www.kuqin.com/docs/pythonmodule.html">Python å­¦ä¹ ç¬”è®° æ¨¡å—ç¯‡</a></li><li>  <a href="http://old.sebug.net/paper/books/python/%E3%80%8APython%E6%A0%87%E5%87%86%E5%BA%93%E3%80%8B%E4%B8%AD%E6%96%87%E7%89%88.pdf">Python æ ‡å‡†åº“ ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="https://www.gitbook.com/book/eastlakeside/interpy-zh/details">Pythonè¿›é˜¶</a></li><li>  <a href="https://wizardforcel.gitbooks.io/core-python-2e/content/">Python æ ¸å¿ƒç¼–ç¨‹ ç¬¬äºŒç‰ˆ</a>&nbsp;CPyUGè¯‘</li><li>  <a href="http://pythonguidecn.readthedocs.io/zh/latest/">Pythonæœ€ä½³å®è·µæŒ‡å—</a></li><li>  <a href="https://www.gitbook.com/book/wizardforcel/python-essential-tutorial/details">Python ç²¾è¦æ•™ç¨‹</a></li><li>  <a href="https://www.gitbook.com/book/wizardforcel/python-quant-uqer/details">Python é‡åŒ–äº¤æ˜“æ•™ç¨‹</a></li><li>Django<ul><li>  <a href="http://django-chinese-docs.readthedocs.org/en/latest/">Django 1.5 æ–‡æ¡£ä¸­æ–‡ç‰ˆ</a>&nbsp;æ­£åœ¨ç¿»è¯‘ä¸­</li><li>  <a href="http://django-1-7-doc.coding.io/">Diango 1.7 æ–‡æ¡£ä¸­æ–‡ç‰ˆ</a>&nbsp;æ­£åœ¨ç¿»è¯‘ä¸­ï¼Œç›®å‰åªç¿»è¯‘äº†ç›®å½•</li><li>  <a href="http://python.usyiyi.cn/django/index.html">Django 1.8.2 æ–‡æ¡£ä¸­æ–‡ç‰ˆ</a>&nbsp;æ­£åœ¨ç¿»è¯‘ä¸­</li><li>  <a href="https://github.com/yangyubo/zh-django-best-practices">Django æœ€ä½³å®è·µ</a></li><li>  <a href="https://www.gitbook.com/book/andrew-liu/django-blog/details">Djangoæ­å»ºç®€æ˜“åšå®¢æ•™ç¨‹</a></li><li>  <a href="http://djangobook.py3k.cn/2.0/">The Django Book ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="https://github.com/cundi/Django-Design-Patterns-and-Best-Practices">Django è®¾è®¡æ¨¡å¼ä¸æœ€ä½³å®è·µ</a></li><li>  <a href="https://github.com/cundi/Web.Development.with.Django.Cookbook">Django ç½‘ç«™å¼€å‘ Cookbook</a></li><li>  <a href="https://www.gitbook.com/book/djangogirlstaipei/django-girls-taipei-tutorial/details">Django Girls å­¸ç¿’æŒ‡å—</a></li></ul></li><li>Flask<ul><li>  <a href="http://docs.jinkan.org/docs/flask/">Flask æ–‡æ¡£ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://docs.jinkan.org/docs/jinja2/">Jinja2 æ–‡æ¡£ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://werkzeug-docs-cn.readthedocs.org/zh_CN/latest/">Werkzeug æ–‡æ¡£ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://spacewander.github.io/explore-flask-zh/">Flaskä¹‹æ—…</a></li><li>  <a href="https://www.gitbook.com/book/wizardforcel/flask-extension-docs/details">Flask æ‰©å±•æ–‡æ¡£æ±‡æ€»</a></li><li>  <a href="http://www.pythondoc.com/flask-mega-tutorial/index.html">Flask å¤§å‹æ•™ç¨‹</a></li><li>  <a href="https://github.com/sixu05202004/sqlalchemy-docs-cn">SQLAlchemy ä¸­æ–‡æ–‡æ¡£</a></li></ul></li><li>web.py<ul><li>  <a href="http://webpy.org/tutorial3.zh-cn">web.py 0.3 æ–°æ‰‹æŒ‡å—</a></li><li>  <a href="http://webpy.org/cookbook/index.zh-cn">Web.py Cookbook ç®€ä½“ä¸­æ–‡ç‰ˆ</a></li></ul></li><li>Tornado<ul><li>  <a href="http://demo.pythoner.com/itt2zh/index.html">Introduction to Tornado ä¸­æ–‡ç¿»è¯‘</a></li><li>  <a href="http://www.nowamagic.net/academy/detail/13321002">Tornadoæºç è§£æ</a></li><li>  <a href="https://tornado-zh.readthedocs.org/zh/latest/">Tornado 4.3 æ–‡æ¡£ä¸­æ–‡ç‰ˆ</a></li></ul></li></ul><h3 id="R"><a href="#R" class="headerlink" title="R"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#r"></a>R</h3><ul><li>  <a href="https://github.com/yihui/r-ninja">Rè¯­è¨€å¿è€…ç§˜ç¬ˆ</a></li></ul><h3 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#ruby"></a>Ruby</h3><ul><li>  <a href="https://github.com/JuanitoFatas/ruby-style-guide/blob/master/README-zhCN.md">Ruby é£æ ¼æŒ‡å—</a></li><li>  <a href="https://github.com/JuanitoFatas/rails-style-guide/blob/master/README-zhCN.md">Rails é£æ ¼æŒ‡å—</a></li><li>  <a href="http://lrthw.github.io/">ç¬¨æ–¹æ³•å­¸ Ruby</a></li><li>  <a href="http://guides.ruby-china.org/">Ruby on Rails æŒ‡å—</a></li><li>  <a href="https://ihower.tw/rails4/index.html">Ruby on Rails å¯¦æˆ°è–ç¶“</a></li><li>  <a href="http://railstutorial-china.org/">Ruby on Rails Tutorial åŸä¹¦ç¬¬ 3 ç‰ˆ</a>&nbsp;(æœ¬ä¹¦ç½‘é¡µç‰ˆå…è´¹æä¾›ï¼Œç”µå­ç‰ˆä»¥ PDFã€EPub å’Œ Mobi æ ¼å¼æä¾›è´­ä¹°ï¼Œä»…å”® 9.9 ç¾å…ƒ)</li><li>  <a href="http://rails-practice.com/content/index.html">Rails å®è·µ</a></li><li>  <a href="https://www.gitbook.com/book/kelby/rails-beginner-s-guide/details">Rails 5 å¼€å‘è¿›é˜¶(Beta)</a></li><li>  <a href="https://www.gitbook.com/book/rocodev/rails-102/details">Rails 102</a></li><li>  <a href="https://wusuopu.gitbooks.io/write-ruby-extension-with-c/content/">ç¼–å†™Rubyçš„Cæ‹“å±•</a></li><li>  <a href="https://ruby-china.org/topics/22386">Ruby æºç è§£è¯»</a></li><li>  <a href="http://deathking.github.io/metaprogramming-in-ruby/">Rubyä¸­çš„å…ƒç¼–ç¨‹</a></li></ul><h3 id="Rust"><a href="#Rust" class="headerlink" title="Rust"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#rust"></a>Rust</h3><ul><li>  <a href="https://www.gitbook.com/book/kaisery/rust-book-chinese/details">rust book ä¸­æ–‡ç¿»è¯‘</a></li><li>  <a href="https://github.com/rustcc/RustPrimer">rust primer</a></li></ul><h3 id="Scala"><a href="#Scala" class="headerlink" title="Scala"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#scala"></a>Scala</h3><ul><li>  <a href="http://twitter.github.io/scala_school/zh_cn/index.html">Scalaè¯¾å ‚</a>&nbsp;(Twitterçš„Scalaä¸­æ–‡æ•™ç¨‹)</li><li>  <a href="http://twitter.github.io/effectivescala/index-cn.html">Effective Scala</a>(Twitterçš„Scalaæœ€ä½³å®è·µçš„ä¸­æ–‡ç¿»è¯‘)</li><li>  <a href="http://zh.scala-tour.com/">ScalaæŒ‡å—</a></li></ul><h3 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#shell"></a>Shell</h3><ul><li>  <a href="https://github.com/qinjx/30min_guides/blob/master/shell.md">Shellè„šæœ¬ç¼–ç¨‹30åˆ†é’Ÿå…¥é—¨</a></li><li>  <a href="http://blog.sae.sina.com.cn/archives/3606">Bashè„šæœ¬15åˆ†é’Ÿè¿›é˜¶æ•™ç¨‹</a></li><li>  <a href="https://github.com/me115/linuxtools_rst">Linuxå·¥å…·å¿«é€Ÿæ•™ç¨‹</a></li><li>  <a href="https://github.com/wzb56/13_questions_of_shell">shellåä¸‰é—®</a></li><li>  <a href="https://www.gitbook.com/book/tinylab/shellbook/details">Shellç¼–ç¨‹èŒƒä¾‹</a></li></ul><h3 id="Swift"><a href="#Swift" class="headerlink" title="Swift"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#swift"></a>Swift</h3><ul><li>  <a href="http://numbbbbb.github.io/the-swift-programming-language-in-chinese/">The Swift Programming Language ä¸­æ–‡ç‰ˆ</a></li><li>  <a href="http://dev.swiftguide.cn/">Swift è¯­è¨€æŒ‡å—</a></li><li>  <a href="https://github.com/x140yu/Developing_iOS_8_Apps_With_Swift">Stanford å…¬å¼€è¯¾ï¼ŒDeveloping iOS 8 Apps with Swift å­—å¹•ç¿»è¯‘æ–‡ä»¶</a></li><li>  <a href="http://c4ios.swift.gg/">C4iOS - COSMOS</a></li></ul><h3 id="è¯»ä¹¦ç¬”è®°åŠå…¶å®ƒ"><a href="#è¯»ä¹¦ç¬”è®°åŠå…¶å®ƒ" class="headerlink" title="è¯»ä¹¦ç¬”è®°åŠå…¶å®ƒ"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E5%8F%8A%E5%85%B6%E5%AE%83"></a>è¯»ä¹¦ç¬”è®°åŠå…¶å®ƒ</h3><ul><li>  <a href="https://github.com/fool2fish/dragon-book-exercise-answers">ç¼–è¯‘åŸç†ï¼ˆç´«é¾™ä¹¦ï¼‰ä¸­æ–‡ç¬¬2ç‰ˆä¹ é¢˜ç­”æ¡ˆ</a></li><li>  <a href="http://www.hawstein.com/posts/make-thiner-programming-pearls.html">æŠŠã€Šç¼–ç¨‹ç ç‘ã€‹è¯»è–„</a></li><li>  <a href="https://github.com/XiaolongJason/ReadingNote/blob/master/Effective%20C%2B%2B/Effective%20C%2B%2B.md">Effective C++è¯»ä¹¦ç¬”è®°</a></li><li>  <a href="https://github.com/qyuhen/book">Golang å­¦ä¹ ç¬”è®°ã€Python å­¦ä¹ ç¬”è®°ã€C å­¦ä¹ ç¬”è®°</a>&nbsp;(PDF)</li><li>  <a href="https://github.com/code4craft/jsoup-learning">Jsoup å­¦ä¹ ç¬”è®°</a></li><li>  <a href="https://github.com/lzjun567/note">å­¦ä¹ ç¬”è®°: Vimã€Pythonã€memcached</a></li><li>  <a href="http://www.ituring.com.cn/activity/details/2004">å›¾çµå¼€æ”¾ä¹¦ç¿»è¯‘è®¡åˆ’â€“C++ã€Pythonã€Javaç­‰</a></li><li>  <a href="http://g.yeeyan.org/books/2095">è’‚å§†Â·å¥¥è±åˆ©éšç¬”</a>&nbsp;ï¼ˆç”±è¯‘è¨€ç½‘ç¿»è¯‘ï¼Œç”µå­ç‰ˆå…è´¹ï¼‰</li><li>  <a href="http://sicp.readthedocs.org/en/latest/">SICP è§£é¢˜é›†</a></li><li>  <a href="https://github.com/hacke2/hacke2.github.io/issues/2">ç²¾å½©åšå®¢é›†åˆ</a></li><li>  <a href="https://github.com/sparanoid/chinese-copywriting-guidelines">ä¸­æ–‡æ–‡æ¡ˆæ’ç‰ˆæŒ‡åŒ—</a></li><li>  <a href="http://ganquan.info/standard-c/">Standard C è¯­è¨€æ ‡å‡†å‡½æ•°åº“é€ŸæŸ¥ (Cheat Sheet)</a></li><li>  <a href="http://gh.amio.us/git-cheatsheet-chs/">Git Cheatsheet Chs</a></li><li>  <a href="http://www.chengweiyang.cn/gitbook/index.html">GitBookç®€æ˜æ•™ç¨‹</a></li><li>  <a href="https://github.com/qibaoguang/Study-Step-by-Step/blob/master/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/javascript_the_good_parts.md">JavaScriptè¯­è¨€ç²¾ç²¹</a></li><li>  <a href="http://producingoss.com/zh/">åˆ¶é€ å¼€æºè½¯ä»¶</a></li><li>  <a href="http://www.dianbo.org/9238/stone/tiwendezhihui.htm">æé—®çš„æ™ºæ…§</a></li><li>  <a href="https://github.com/LearnShare/Learning-Markdown">Markdown å…¥é—¨å‚è€ƒ</a></li><li>  <a href="https://github.com/stanzgy/wiki/blob/master/markup/asciidoc-guide.asciidoc">AsciiDocç®€æ˜æŒ‡å—</a></li><li>  <a href="http://love-oriented.com/pack/">èƒŒåŒ…é—®é¢˜ä¹è®²</a></li><li>  <a href="https://github.com/qiwsir/ITArticles">è€é½çš„æŠ€æœ¯èµ„æ–™</a></li><li>  <a href="https://github.com/JacksonTian/fks">å‰ç«¯æŠ€èƒ½æ±‡æ€»</a></li><li>  <a href="https://github.com/zhuangbiaowei/learn-with-open-source">å€ŸåŠ©å¼€æºé¡¹ç›®ï¼Œå­¦ä¹ è½¯ä»¶å¼€å‘</a></li><li>  <a href="https://github.com/h5bp/Front-end-Developer-Interview-Questions/tree/master/Translations/Chinese">å‰ç«¯å·¥ä½œé¢è¯•é—®é¢˜</a></li><li>  <a href="https://www.gitbook.com/book/yuanbin/algorithm/details">leetcode/lintcodeé¢˜è§£/ç®—æ³•å­¦ä¹ ç¬”è®°</a></li><li>  <a href="https://github.com/li-xinyang/FEND_Note">å‰ç«¯å¼€å‘ç¬”è®°æœ¬</a></li></ul><h3 id="æµ‹è¯•ç›¸å…³"><a href="#æµ‹è¯•ç›¸å…³" class="headerlink" title="æµ‹è¯•ç›¸å…³"></a><a href="https://github.com/justjavac/free-programming-books-zh_CN#%E6%B5%8B%E8%AF%95%E7%9B%B8%E5%85%B3"></a>æµ‹è¯•ç›¸å…³</h3>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ èµ„æº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨hexo+nextæ‰“é€ è‡ªå·±çš„åšå®¢ç«™ç‚¹</title>
      <link href="2018/06/10/shi-yong-hexo-next-da-zao-zi-ji-de-bo-ke-zhan-dian/"/>
      <url>2018/06/10/shi-yong-hexo-next-da-zao-zi-ji-de-bo-ke-zhan-dian/</url>
      
        <content type="html"><![CDATA[<p>ç”¨hexo+nextæ­å»ºè‡ªå·±çš„åšå®¢ç«™ç‚¹<br><a href="https://www.jianshu.com/p/44e601a7567a">ç®€ä¹¦åœ°å€</a></p><span id="more"></span><h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>è¿™æ®µæ—¶é—´å·¥ä½œå¾ˆå¿™ï¼Œ2018å¹´ï¼Œä»è¿‡äº†å¹´ä»¥åå°±ä¸€ç›´å¾ˆå¿™ï¼Œå°¤å…¶æ˜¯3æœˆ15å·å¼€å§‹åˆ°æµ·å°”é©»åœºä»¥åï¼Œå¹²çš„å·¥ä½œè¶Šæ¥è¶Šæ‚ï¼Œä¸€å¼€å§‹å‰é¢è¿˜æœ‰ä¸ªå•†åŠ¡ï¼Œé¡¹ç›®ä¸Šæœ‰ä¸ªäº§å“ç»ç†ï¼Œ3æœˆåº•å•†åŠ¡è¾èŒäº†ï¼Œå†åæ¥äº§å“ç»ç†ä¹Ÿè°ƒèµ°äº†ï¼Œé¡¹ç›®ä¸Šä¹Ÿæ²¡æœ‰æµ‹è¯•äººå‘˜ï¼Œæ‰€ä»¥æˆ‘å°±å˜æˆäº†ä¸€èº«å¤šèŒçš„è§’è‰²ã€‚</p><p>å› ä¸ºæ€»æ˜¯æ¯”è¾ƒå¿™ï¼Œè€Œä¸”æ— è®ºå¦‚ä½•ä¹Ÿè¿˜æ˜¯ä¸€æšç¨‹åºçŒ¿ï¼Œè¿˜æ˜¯ç å†œï¼Œä½†æ˜¯æˆ‘è§‰å¾—è‡ªå·±çš„å·¥ä½œå†…å®¹ç¦»æŠ€æœ¯è·¯è¿œæœ‰ç‚¹è¶Šèµ°è¶Šè¿œï¼Œæ‰€ä»¥æˆ‘èµ·äº†åœ¨è¿˜æ²¡æœ‰è’åºŸæŠ€æœ¯ä¹‹å‰ï¼Œå°†å·²æœ‰çš„çŸ¥è¯†æ€»ç»“æ€»ç»“ï¼Œå½’çº³å½’çº³ï¼Œæ­å»ºä¸€å¥—å±äºè‡ªå·±çš„åšå®¢ç«™ç‚¹ã€‚<br>æœ€åçš„æ•ˆæœæš‚æ—¶æ˜¯è¿™æ ·çš„ <img src="/loading.gif" data-original="/images/tools/hexo-blog-next.png" alt="ä¸æ—¶é—´èµ›è·‘"></p><hr><h2 id="é€‰å‹"><a href="#é€‰å‹" class="headerlink" title="é€‰å‹"></a>é€‰å‹</h2><h4 id="1ï¼‰java-tomcatåšå®¢"><a href="#1ï¼‰java-tomcatåšå®¢" class="headerlink" title="1ï¼‰java+tomcatåšå®¢"></a>1ï¼‰java+tomcatåšå®¢</h4><p>è¿‡å¹´å‰åå› ä¸ºåœ¨å­¦ä¹ spring cloudï¼ŒdockeræŠ€æœ¯ï¼Œä¹Ÿæ˜¯å‡ºäºæƒ³æŠŠè‡ªå·±å­¦åˆ°çš„ä¸œè¥¿ç§¯æ”’èµ·æ¥ï¼Œè€Œä¸”è‡ªå·±æœ¬èº«å°±æ˜¯javaå¥´ï¼Œæ‰€ä»¥é€‰æ‹©äº†&nbsp;<a href="https://github.com/qdhaiqiang/My-Blog">Docker+SpringBoot+Mybatis+thymeleaf</a>&nbsp;ç»“æ„çš„åšå®¢ï¼Œä¸»è¦æ˜¯é‚£ä¼šå„¿çœ‹ç€è¿™ä¸ªåšå®¢ç¡®å®ä¹Ÿè¿˜æŒºæ¼‚äº®çš„ã€‚æœ‰ä¸ªæˆå‹çš„&nbsp;<a href="http://13blog.site/">åšå®¢</a>&nbsp;ç³»ç»Ÿï¼Œå¯ä»¥çœ‹å‡ºæ¥æ ·å­ç¡®å®è¿˜ä¸é”™ï¼Œç®¡ç†åå°ä¹Ÿæœ‰äº†ï¼Œä¹Ÿé›†æˆäº†å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆä¸»è¦æ˜¯å°ç™½æˆ‘ä¸ä¼šmarkdownè¯­æ³•ï¼Œä¹Ÿä¸æ•¢å»å­¦ï¼‰æ‰€ä»¥è§‰å¾—å¾ˆåˆ°ä½äº†ã€‚äºæ˜¯è‡ªå·±cloneä¸‹æ¥ï¼Œå…ˆç”¨tomcatåšæœåŠ¡å™¨é…ç½®èµ·æ¥ï¼Œå‰åç«¯runèµ·æ¥ä»¥åå†™äº†ä¸€ç¯‡æ–‡ç« ï¼Œå‘ç°å‡ ä¸ªä¸æ–¹ä¾¿çš„åœ°æ–¹ï¼š</p><blockquote><ol><li>ä¸€å…±æœ‰20å¼ å®šæ­»çš„é¦–é¡µå±•ç¤ºå›¾ï¼Œå¹¶ä¸æ˜¯éšæœºçš„ï¼Œè€Œä¸”è·å–è¿™äº›å›¾çš„åœ°æ–¹ï¼Œéšæœºæ•°æ€»æ•°ä¹Ÿæ˜¯å†™æ­»äº†ï¼Œä¸æˆ‘ä»¥ä¸ºæ¯æ¬¡éƒ½ä»æŸä¸€å›¾åº“éšæœºè·å–æœ‰ç‚¹å·®å¼‚ã€‚</li><li>ç®¡ç†åå°ä¸Šä¼ å›¾ç‰‡ä¸å¤ªæ–¹ä¾¿ï¼Œtomcaté‡å¯åå›¾ç‰‡å°±æ²¡æœ‰äº†ï¼Œå› æ­¤æˆ‘æ˜¯åŠ¨ç”¨éƒ½ä¸ƒç‰›çš„å›¾ç‰‡æœåŠ¡å™¨ï¼Œæ‹¿åˆ°é“¾æ¥ååœ¨ä»£ç é‡Œé¢ç›´æ¥ä½¿ç”¨ï¼Œè·Ÿé¢„æƒ³æœ‰å‡ºå…¥ã€‚</li><li>å¯Œæ–‡æœ¬ç¼–è¾‘å™¨çš„æ’ç­ä¸ç†æƒ³ã€‚è·Ÿå‘å¸ƒä»¥åç”Ÿæˆçš„æ•ˆæœæœ‰å·®å¼‚ã€‚</li><li>é¦–é¡µåŠŸèƒ½æœ‰ç‚¹å°‘ï¼Œè‡ªå·±å®šåˆ¶çš„è¯æˆæœ¬æœ‰ç‚¹å¤§ï¼Œä¹Ÿä¸åˆ’ç®—ï¼Œåˆ†äº«ã€è¯„è®ºç­‰åŠŸèƒ½ç¼ºå¤±ã€‚</li><li>å‘å¸ƒæœ‰ç‚¹éº»çƒ¦ï¼Œè¿˜è¦ä»æ–°å¯åŠ¨æœåŠ¡å™¨ã€‚</li></ol></blockquote><h4 id="2ï¼‰wordpressåšå®¢"><a href="#2ï¼‰wordpressåšå®¢" class="headerlink" title="2ï¼‰wordpressåšå®¢"></a>2ï¼‰wordpressåšå®¢</h4><p>WordPressæ˜¯ä½¿ç”¨PHPè¯­è¨€å¼€å‘çš„åšå®¢å¹³å°ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ”¯æŒPHPå’ŒMySQLæ•°æ®åº“çš„æœåŠ¡å™¨ä¸Šæ¶è®¾å±äºè‡ªå·±çš„ç½‘ç«™ã€‚ä¹Ÿå¯ä»¥æŠŠ WordPresså½“ä½œä¸€ä¸ªå†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆ<a href="https://baike.baidu.com/item/CMS/315935">CMS</a>ï¼‰æ¥ä½¿ç”¨ã€‚</p><p>WordPressæ˜¯ä¸€æ¬¾ä¸ªäººåšå®¢ç³»ç»Ÿï¼Œå¹¶é€æ­¥æ¼”åŒ–æˆä¸€æ¬¾å†…å®¹ç®¡ç†ç³»ç»Ÿè½¯ä»¶ï¼Œå®ƒæ˜¯ä½¿ç”¨PHPè¯­è¨€å’ŒMySQLæ•°æ®åº“å¼€å‘çš„ã€‚ç”¨æˆ·å¯ä»¥åœ¨æ”¯æŒ PHP å’Œ MySQLæ•°æ®åº“çš„æœåŠ¡å™¨ä¸Šä½¿ç”¨è‡ªå·±çš„åšå®¢ã€‚</p><p>WordPressæœ‰è®¸å¤šç¬¬ä¸‰æ–¹å¼€å‘çš„å…è´¹æ¨¡æ¿ï¼Œå®‰è£…æ–¹å¼ç®€å•æ˜“ç”¨ã€‚ä¸è¿‡è¦åšä¸€ä¸ªè‡ªå·±çš„æ¨¡æ¿ï¼Œåˆ™éœ€è¦ä½ æœ‰ä¸€å®šçš„ä¸“ä¸šçŸ¥è¯†ã€‚æ¯”å¦‚ä½ è‡³å°‘è¦æ‡‚çš„æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ä¸‹çš„ä¸€ä¸ªåº”ç”¨HTMLä»£ç ã€CSSã€PHPç­‰ç›¸å…³çŸ¥è¯†ã€‚</p><p>WordPresså®˜æ–¹æ”¯æŒä¸­æ–‡ç‰ˆï¼ŒåŒæ—¶æœ‰çˆ±å¥½è€…å¼€å‘çš„ç¬¬ä¸‰æ–¹ä¸­æ–‡è¯­è¨€åŒ…ï¼Œå¦‚wopusä¸­æ–‡è¯­è¨€åŒ…ã€‚WordPressæ‹¥æœ‰æˆåƒä¸Šä¸‡ä¸ªå„å¼æ’ä»¶å’Œä¸è®¡å…¶æ•°çš„ä¸»é¢˜æ¨¡æ¿æ ·å¼ã€‚</p><p>èº«è¾¹å°±æœ‰ä¸¤ä½åŒäº‹åœ¨ä½¿ç”¨ç€åŸºäºphpç¯å¢ƒçš„<a href="https://cn.wordpress.org/">WordPress</a>çš„åšå®¢ï¼Œæˆ‘ä¹ŸæŸ¥è¿‡ï¼Œè¿™æ¬¾åšå®¢çš„å¥½è¯„ç‡ç¡®å®ä¹Ÿå¯ä»¥ï¼Œåº”ç”¨ä¹Ÿæ˜¯ç›¸å½“çš„å¹¿æ³›ï¼Œç”šè‡³è¿˜è¡ç”Ÿå‡ºäº†Jpressè¿™æ ·çš„äº§å“ï¼Œå·ç§°æ˜¯wordpressçš„javaç‰ˆï¼Œ<a href="https://www.oschina.net/p/jpress">è¿™ç¯‡æ–‡ç« </a>é‡Œçš„ä»‹ç»è‡³å°‘çœ‹èµ·æ¥æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰äº²è¯•ï¼Œå€’æ˜¯èº«è¾¹å°±æœ‰ä¸¤ä¸ªåŒäº‹ç”¨çš„wordpressçš„åšå®¢ã€‚<br>ä¸€ä¸ªæ˜¯Dirkçš„åšå®¢ ï¼š <a href="http://101.132.162.138/blog/">å¥‹åŠ›å¥”è·‘çš„èœ—ç‰›</a><br>ä¸€ä¸ªå£®å£®çš„åšå®¢    ï¼š<a href="http://blog.strongfish.site/">StrongFish</a>ã€‚</p><h4 id="3ï¼‰hexo-next-è¶…çº§ç«çš„é™æ€åšå®¢"><a href="#3ï¼‰hexo-next-è¶…çº§ç«çš„é™æ€åšå®¢" class="headerlink" title="3ï¼‰hexo+next è¶…çº§ç«çš„é™æ€åšå®¢"></a>3ï¼‰hexo+next è¶…çº§ç«çš„é™æ€åšå®¢</h4><p>åŸºäºdockerçš„åšå®¢è™½ç„¶æ­èµ·æ¥äº†ï¼Œä¹Ÿå†™äº†ä¸€ç¯‡æ–‡ç« ï¼Œä½†æ˜¯è¿™å°åŠå¹´æ—¶é—´æ²¡æœ‰å†æ›´æ–°äº†ã€‚æœ€è¿‘åœ¨æ˜é‡‘ä¸Šçœ‹åˆ°äº†ä¸å°‘å…³äºåšå®¢çš„å¥½æ–‡ï¼Œæçš„æ¯”è¾ƒå¤šçš„æ˜¯hexoï¼Œå› ä¸ºç°åœ¨éƒ½æµè¡Œé™æ€ç½‘é¡µï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—åŠ¨æ‰‹é‡æ–°DIYä¸€ä¸ªè‡ªå·±çš„ç«™ç‚¹ã€‚è¦èµ°<strong>é«˜ç«¯å¤§æ°”ä¸Šæ¡£æ¬¡ï¼Œç‚«é…·ç‹‚æ‹½å¼ç‚¸å¤©</strong>çš„è·¯çº¿äº†</p><hr><h2 id="æ­å»ºè‡ªå·±çš„å°ç©ºé—´"><a href="#æ­å»ºè‡ªå·±çš„å°ç©ºé—´" class="headerlink" title="æ­å»ºè‡ªå·±çš„å°ç©ºé—´"></a>æ­å»ºè‡ªå·±çš„å°ç©ºé—´</h2><p>ç½‘ä¸Šæ­å»ºç³»ç»Ÿçš„æ–‡ç« å†™çš„å¾ˆå¥½çš„å¤ªå¤šäº†ï¼Œå†è¯´ä¹Ÿå°±é‚£ä¹ˆç‚¹äº‹ï¼Œæ‰€ä»¥ä¸å†æµªè´¹æ—¶é—´ï¼Œç®€å•è®°å½•ä¸‹é‡è¦è¿‡ç¨‹å§ã€‚</p><blockquote><ol><li><strong>2018-06-05</strong> ï¼šclone hexoå’Œnextçš„é¡¹ç›® ä¿®æ”¹ç«™ç‚¹åç§°ï¼Œä½¿ç”¨gitbubä½œä¸ºé¡¹ç›®çš„æœ€ç»ˆéƒ¨ç½²åœ°ï¼Œä½¿ç”¨hexo då‘½ä»¤ï¼Œå°†åŸå§‹ä»£ç éƒ¨ç½²ä¸Šå»ï¼Œå‘ç°<a href="https://qdhaiqiang.github.io/">https://qdhaiqiang.github.io</a>å¯ä»¥è®¿é—®,ç¬¬ä¸€æ­¥å®Œæˆã€‚</li><li><strong>2018-06-06</strong> ï¼šå°†åŸæ¥çš„qdhaiqiqiang.github.ioé¡¹ç›®æ‹‰å‡ºæ¥åˆ é™¤éƒ¨ç½²æ–‡ä»¶ï¼Œé‡æ–°å»ºä¸€ä¸ªé¡¹ç›®å«blogï¼Œblogæ˜¯é¡¹ç›®åŸæ–‡ä»¶ï¼Œè€Œgithub.ioæ˜¯éƒ¨ç½²åçš„æ–‡ä»¶ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ä¸€ä¸ªï¼Œåæ¥æ‰æ˜ç™½åŸæ¥å¯ä»¥ä¸æ˜¯åŒä¸€ä¸ªé¡¹ç›®ã€‚</li><li><strong>2018-06-07</strong> ï¼šä¿®æ”¹hexoçš„ä¸»é¢˜æ–‡ä»¶ï¼Œä¸»è¦ä¿®æ”¹é¡¹å‚è€ƒåšæ–‡<a href="http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html">hexoçš„nextä¸»é¢˜ä¸ªæ€§åŒ–æ•™ç¨‹:æ‰“é€ ç‚«é…·ç½‘ç«™</a>ä¸€æ–‡ï¼Œæ„Ÿè°¢ä½œè€…çš„æ€»ç»“ã€‚</li><li><strong>2018-06-08</strong> ï¼šä¿®æ”¹æ–°å»ºæ–‡ç« æ¨¡æ¿ï¼Œåˆ›å»ºæ—¶åŒæ—¶åˆ›å»ºå›¾åº“ï¼›æ·»åŠ éŸ³ä¹æ’­æ”¾å¤–é“¾ï¼›ä¿®æ”¹ã€é˜…è¯»å…¨æ–‡ã€‘çš„æ ·å¼ï¼›æ·»åŠ æ¥å¿…åŠ›è¯„è®ºç³»ç»Ÿï¼›æ·»åŠ ç™¾åº¦SEOæ”¶å½•ï¼Œè°·æ­ŒSEOæ”¶å½•ã€‚</li><li><strong>2018-06-09</strong> ï¼šæ·»åŠ jiathisåˆ†äº«ï¼›æ·»åŠ ç«™å†…æœç´¢ï¼›ä¿®æ”¹å¤´åƒï¼›å¼•å…¥daovioceåœ¨çº¿äº¤æµï¼Œå¹¶ç»‘å®šå¾®ä¿¡æ¥æ”¶æ¶ˆæ¯ï¼›æ·»åŠ ä¾§æ éŸ³ä¹ï¼›å…³é—­canvasçº¿æ¡ï¼Œå…³é—­æ‰“èµ(è¿˜æ˜¯è„¸çš®é¥±ï¼Œä¸å¥½æ„æ€è¦);</li></ol></blockquote><p>è‡³æ­¤ï¼Œæœ¬ç«™ç‚¹åŸºæœ¬å¯ä»¥ã€‚æ¢é—ç•™å‡ ä¸ªæƒ³æä½†æ²¡æœ‰æèµ·æ¥çš„ä¸œè¥¿</p><blockquote><ul><li>åšå®¢ä¸Šè¿˜æ²¡æœ‰èŒèŒçš„å® ç‰©ï¼Œè¿˜æƒ³å…»åªçŒ«ï¼›</li><li>æ–‡ç« åŠ å¯†è¿˜æ²¡æœ‰åšï¼Œæœ‰éœ€è¦çš„æ—¶å€™å†è€ƒè™‘ï¼›</li><li>ç™¾åº¦æ”¶å½•æ²¡æœ‰æˆåŠŸï¼ŒhttpséªŒè¯æ²¡æœ‰é€šè¿‡ï¼Œå¾ˆé—æ†¾ï¼Œç»§ç»­åŠ æ²¹ï¼›</li><li>åŠ¨æ€èƒŒæ™¯ï¼›</li></ul></blockquote><hr><h2 id="é¸£è°¢-amp-æ¨è"><a href="#é¸£è°¢-amp-æ¨è" class="headerlink" title="é¸£è°¢&amp;æ¨è"></a>é¸£è°¢&amp;æ¨è</h2><p>è¿™é‡Œè¦å…¬å¸ƒå‡ ä¸ªæŸ¥èµ„æ–™æ—¶æŸ¥åˆ°çš„ç”¨hexoå®ç°çš„å¥½çš„åšå®¢ï¼Œå½“ç„¶ï¼Œéƒ½æ˜¯nextä¸»é¢˜çš„ã€‚å¦å¤–å°±æ˜¯é’ˆå¯¹hexo+nextçš„å®ç°çš„ä¸€äº›å¥½çš„åšæ–‡ï¼Œåœ¨æ­¤å…è´¹åšä¸ªæ¨å¹¿ï¼Œåšä¸»å°±ä¸ç”¨è°¢äº†å“ˆã€‚</p><h4 id="å¥½çš„hexoç«™ç‚¹"><a href="#å¥½çš„hexoç«™ç‚¹" class="headerlink" title="å¥½çš„hexoç«™ç‚¹"></a>å¥½çš„hexoç«™ç‚¹</h4><p><strong><a href="http://darryrzhong.site/">darryrzhong</a></strong><br><strong><a href="http://shenzekun.cn/">Moorez</a></strong><br><strong><a href="http://blogwenbo.com/">WenBoä¸¨æ˜Ÿç©ºç¬</a></strong><br><strong><a href="http://51world.win/">æ—¶é—´çš„æœ‹å‹</a></strong></p><p>å¾ˆå·§å¦™çš„æ˜¯ï¼Œåœ¨è¿™æ¬¡æ­å»ºè¿‡ç¨‹ä¸­å‘ç°çš„è¿™å‡ ä¸ªåšå®¢åšä¸»çœ‹èµ·æ¥éƒ½æ˜¯å‰ç«¯å·¥ç¨‹ï¼Œè€Œç”¨wordpressæ­å»ºçš„å¤šæ˜¯åç«¯å·¥ç¨‹å¸ˆï¼Œä¸çŸ¥é“è¿™ä¸ªç ”ç©¶ç»“æœå€¼å¤šå°‘é’±ï¼Œå“ˆå“ˆå“ˆã€‚</p><h4 id="å¥½çš„åšæ–‡"><a href="#å¥½çš„åšæ–‡" class="headerlink" title="å¥½çš„åšæ–‡"></a>å¥½çš„åšæ–‡</h4><p><strong><a href="https://juejin.im/post/598eeaff5188257d592e55bb">æµ…æ Hexo æ­å»ºåšå®¢çš„åŸç†</a></strong><br><strong><a href="http://jet-han.oschina.io/2017/05/27/Hexo-NexT%E4%B8%BB%E9%A2%98%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/">Hexo-NexTä¸»é¢˜æ­å»ºä¸ªäººåšå®¢</a></strong><br><strong><a href="https://www.jianshu.com/p/9a7316c871ef">ç½‘æ˜“äº‘è·Ÿå¸–å…³é—­æœåŠ¡åè½¬ç§»åˆ°æ¥å¿…åŠ›</a></strong><br><strong><a href="http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html">hexoçš„nextä¸»é¢˜ä¸ªæ€§åŒ–é…ç½®æ•™ç¨‹</a></strong><br><strong><a href="http://51world.win/2017/09/04/code/%E7%BC%96%E7%A8%8B%E9%82%A3%E7%82%B9%E4%BA%8B%E5%84%BF-Hexo%20NexT%20%E4%B8%BB%E9%A2%98%E6%B7%BB%E5%8A%A0%E5%8A%A8%E7%94%BB%E6%8F%92%E4%BB%B6/">è¸¢çƒåŠ¨ç”»æ’ä»¶</a></strong></p><h4 id="ç‰¹åˆ«æ¨è"><a href="#ç‰¹åˆ«æ¨è" class="headerlink" title="ç‰¹åˆ«æ¨è"></a>ç‰¹åˆ«æ¨è</h4><p><a href="http://darryrzhong.site/">darryrzhong</a>çš„æ–‡ç« æ˜¯ä»åŸºç¡€ç¯‡ -&gt; è¿›é˜¶ç¯‡ -&gt; é«˜çº§ç¯‡  -&gt; ç™¾åº¦æ”¶å½• -&gt; è°·æ­Œæ”¶å½•ä¸€è·¯èµ°è¿‡æ¥çš„ï¼Œé…ç½®æˆªå›¾ç­‰éƒ½éå¸¸è¯¦ç»†ï¼Œéå¸¸çš„æ•™ç¨‹ï¼Œæ„Ÿè°¢åšä¸»çš„åŠªåŠ›ï¼ŒçœŸæƒ³ç»™æ‰’è¿‡æ¥ï¼Œå‘µå‘µå‘µã€‚<br><img src="/loading.gif" data-original="/images/tools/hexo-next-darryrzhong.png" alt="ç³»åˆ—æ–‡ç« "></p><p>åšå®¢æ­å»ºæš‚æ—¶å‘Šä¸€æ®µæ®µè½ï¼Œå¥½å¥½ä¸°å¯Œå†…å®¹å§ï¼ŒåŠ æ²¹ï¼</p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="2018/06/05/hello-world/"/>
      <url>2018/06/05/hello-world/</url>
      
        <content type="html"><![CDATA[<p>  Hello Hexo</p><span id="more"></span><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/deployment.html">Deployment</a></p><p>æµ‹è¯•è¿œç¨‹å›¾ç‰‡ï¼š<img src="/loading.gif" data-original="http://25.io/mou/Mou_128.png" alt="è¿œç¨‹å›¾ç‰‡"><br>æµ‹è¯•æœ¬åœ°å›¾ç‰‡ï¼š<img src="/loading.gif" data-original="/images/tools/hexo-hello-world.png" alt="æœ¬åœ°å›¾ç‰‡"></p><h3 id="æ·»åŠ éŸ³ä¹"><a href="#æ·»åŠ éŸ³ä¹" class="headerlink" title="æ·»åŠ éŸ³ä¹"></a>æ·»åŠ éŸ³ä¹</h3><p>å»å¾€ç½‘æ˜“äº‘éŸ³ä¹æœç´¢å–œæ¬¢çš„éŸ³ä¹ï¼Œç‚¹å‡»ç”Ÿæˆå¤–é“¾æ’­æ”¾å™¨ï¼Œå¤åˆ¶ä»£ç ç›´æ¥æ”¾åˆ°åšæ–‡æœ«å°¾å³å¯ï¼Œheightè®¾ä¸º0å¯éšè—æ’­æ”¾å™¨ï¼Œä½†ä»ç„¶å¯ä»¥æ’­æ”¾éŸ³ä¹ï¼Œautoè®¾æˆ0å¯æ‰‹åŠ¨æ’­æ”¾ï¼Œé»˜è®¤æ˜¯1è‡ªåŠ¨æ’­æ”¾ï¼Œå¯æŠŠä»£ç æ”¾åˆ°themes/next/layout/_custom/sidebar.swigæ–‡ä»¶é‡Œï¼Œæ’­æ”¾å™¨ä¼šæ˜¾ç¤ºåœ¨ç«™ç‚¹é¢„è§ˆä¸­ã€‚å…¶ä¸­çš„width=298 height=52 å‡æ”¹ä¸º0å°±çœ‹ä¸åˆ°äº†ï¼Œä¾ç„¶å¯ä»¥æ’­æ”¾éŸ³ä¹ã€‚</p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="http://music.163.com/outchain/player?type=2&amp;id=27928457&amp;auto=1&amp;height=32"></iframe>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
